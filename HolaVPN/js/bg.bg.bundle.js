// LICENSE_CODE ZON
(()=>{var __webpack_modules__={2169:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var underscore__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8763);var underscore__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_0__);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_2__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3__);var _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(8552);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_5__);var _util_url_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5305);var _util_url_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_util_url_js__WEBPACK_IMPORTED_MODULE_6__);var _bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1211);var _bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_7__);var _util_escape_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(4336);var _util_escape_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_util_escape_js__WEBPACK_IMPORTED_MODULE_8__);var _util_storage_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(1032);var _util_storage_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_util_storage_js__WEBPACK_IMPORTED_MODULE_9__);var _util_ajax_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(665);var _util_util_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_11__);var _util_date_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_12__);var _util_string_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(5516);var _util_string_js__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(_util_string_js__WEBPACK_IMPORTED_MODULE_13__);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(4130);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14__);var _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(9651);var _bext_vpn_bg_icon_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(8084);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17__);var _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(8076);var _bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(9265);var _bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(1679);var _bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(7666);var _bext_vpn_bg_ccgi_js__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(7362);var _bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(3886);var _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(2227);var _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_24___default=__webpack_require__.n(_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_24__);var _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(6210);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26__);var _bext_vpn_util_no_log_js__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(2181);var _bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(1002);var _bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(4968);var conf__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(9641);var _bext_vpn_bg_bext_config_js__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(39);var _bext_vpn_bg_bext_config_js__WEBPACK_IMPORTED_MODULE_31___default=__webpack_require__.n(_bext_vpn_bg_bext_config_js__WEBPACK_IMPORTED_MODULE_31__);var _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(897);var _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_32___default=__webpack_require__.n(_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_32__);var cookie__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(9813);var cookie__WEBPACK_IMPORTED_MODULE_33___default=__webpack_require__.n(cookie__WEBPACK_IMPORTED_MODULE_33__);var _bext_vpn_bg_ui_api_js__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(9370);var _bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(1225);var _bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_35___default=__webpack_require__.n(_bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_35__);var _bext_vpn_bg_start_worker_js__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(2955);var _bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(7676);var _pub_state_js__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(7619);
// LICENSE_CODE ZON
const v3=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().is_v3;_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26___default().assert_bg("be_bg_main");if(!_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().is_mocha())_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().set_zerr(_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default());_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().set_exception_handler("be",((id,info,err)=>_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr(id,info,{err})));_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().on_unhandled_exception=function(err){_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default()("unhandled_exception %s",err&&err.stack);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("unhandled_exception",{},{err,rate_limit:{count:2}})};const chrome=self.chrome;const assign=Object.assign;const browser=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().browser();const mem_leak_period=3*_util_date_js__WEBPACK_IMPORTED_MODULE_12___default().ms.SEC;const{get_param,persist_param}=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"];let state;let new_uuid;const on_install=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){E.install_ts=+self.hola.t.l_start||_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].now();let ver=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().version();let first_install_ts=+(yield get_param("install_ts",true));let first_install_ver=yield get_param("install_version",true);if(!first_install_ts){first_install_ts=E.install_ts;yield persist_param("install_ts",first_install_ts,true)}if(!first_install_ver){first_install_ver=ver;yield persist_param("install_version",first_install_ver,true)}yield persist_param("last_install_ts",E.install_ts);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("install_version",first_install_ver);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("install_ts",first_install_ts);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("last_install_ts",E.install_ts);send_install_perr()}));const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default().model.extend({model_name:"bg_main",_defaults:function(){this.on("install",on_install);this.on("update",on_update);this.on("up",on_up);this.on("destroy",(()=>E.uninit()));this.set("ver",conf__WEBPACK_IMPORTED_MODULE_30__.version);self.addEventListener("beforeunload",(()=>E._destroy()))}}));E.be_util=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default();E.zerr=self.hola.zerr=_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default();E.be_browser=_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_7___default();E.be_tabs=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default();E.tabs=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default();E.be_ext=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default();E.be_vpn=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_23__.Z;E.etask=_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default();E.unblocker_lib=_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_24___default();E.be_info=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_25__["default"];E.pac_engine=_bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_35___default();E.be_rule=_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_18__.Z;E.be_premium=_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_19__["default"];E.be_mode=_bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_28__.Z;E.be_trial=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_21__["default"];E.be_ab_test=_bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_37__.Z;E.be_tpopup=_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_29__.Z;E.be_util.rmt=E;function get_post_install_url(qs_add){const qs=Object.assign(qs_add||{},{ext_ver:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().version(),uuid:E.get("uuid")});return _util_escape_js__WEBPACK_IMPORTED_MODULE_8___default().uri(_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_15__.Z.hola_url()+"/access/install",qs)}const set_aff_id=val=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){if(!val)return;E.set("aff_id",val);yield persist_param("aff_id",val)}));const get_active_test_from_cookies=ui_testing=>{try{ui_testing=JSON.parse(decodeURIComponent(ui_testing))}catch(e){ui_testing={}}const tests_ids=Object.keys(ui_testing);let active_test,active_test_name,active_value;tests_ids.forEach((test=>{if(/_conf$/.test(test)){const cfg=ui_testing[test];const value=typeof cfg=="object"?cfg.on:cfg;if(value>0&&value<1){active_test=test.replace("_conf","");active_test_name=typeof cfg=="object"&&cfg.name||active_test;active_value=ui_testing[active_test]}}}));return{active_test,active_value,active_test_name}};const send_install_perr=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*_send_install_perr(){if(!E.install_ts||!E.get("agree_ts")||E.install_perr_ts||!_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_19__["default"].get("updated")){return}const now=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].now();let info={};const cookies=yield _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26___default().get_hola_cookies(["ui_testing","post_install","be_usage","aff_id","ext_ref","install_src"]);const ui_test=get_active_test_from_cookies(cookies.ui_testing);const{post_install,aff_id,ext_ref,install_src}=cookies;if(post_install){try{_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_29__.Z.set("post_install_redirect",JSON.parse(decodeURIComponent(post_install)).redirect_url)}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_post_install_parse_err",{post_install},{err:e})}}E.install_perr_ts=now;if(!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().browser_guess.hola_browser){let ref_ab_test=_bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_37__.Z.get_ab_tests().join("_");const url=get_post_install_url(ref_ab_test?{ref:ref_ab_test}:{});_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().notice("open post insall page %s",url);_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].open_hola_tab({url,force_active:true})}if(_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().get(chrome,"runtime.getManifest"))info=_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().pick(chrome.runtime.getManifest(),"permissions");_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().if_set(new_uuid,info,"new_uuid");if(cookies.be_usage){try{info.be_usage=JSON.parse(decodeURIComponent(cookies.be_usage))}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_usage_parse_err",{},{err:e})}}yield set_aff_id(aff_id);const build={};if(ui_test)build[ui_test.active_test_name]=ui_test.active_value;const perr_opt=assign({aff_id,install_src,ext_ref},info);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("install",perr_opt,{build});_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set("install_perr_ts",now)}));E.t={get_post_install_url,send_install_perr};function on_update(prev){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("update",prev+" > "+_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().version());let ts=self.hola.t.l_start;persist_param("update_ts",ts);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("update_ts",ts)}function on_up(){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("up");if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().is_bg_reinited())_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_bg_reinit")}function ccgi_init(){_bext_vpn_bg_ccgi_js__WEBPACK_IMPORTED_MODULE_22__.Z.init(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default());chrome.tabs.query({url:conf__WEBPACK_IMPORTED_MODULE_30__.hola_match},(tabs=>underscore__WEBPACK_IMPORTED_MODULE_0___default().each(tabs,(tab=>{try{if(v3){chrome.scripting.executeScript({target:{tabId:tab.id},files:["/js/bext/vpn/bg/cs_hola.js"]})}else{chrome.tabs.executeScript(tab.id,{file:"/js/bext/vpn/bg/cs_hola.js",runAt:"document_start"})}}catch(e){}}))))}function get_uuid(){return _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({name:"get_uuid",cancel:true},(function*(){try{const ret=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().all({allow_fail:true},{local:_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].storage_local_get("uuid"),localStorage:_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*get_uuid_local_storage_(){return v3?null:yield localStorage.getItem("uuid")})),cookie:_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){return yield cookie__WEBPACK_IMPORTED_MODULE_33___default().get("uuid")})),ccgi:_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().cb_apply(!_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().is_mocha()&&chrome.cookies,".get",[{url:conf__WEBPACK_IMPORTED_MODULE_30__.url_ccgi,name:"uuid"}])});get_uuid.last_error=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].collect_errors(ret);const uuid=_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().get(ret,"local.uuid")||ret.localStorage||ret.cookie||_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().get(ret,"ccgi.value");if(!uuid)return;_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26___default().assert(typeof uuid=="string"&&uuid.length>=8,new Error("invalid_uuid"));return uuid}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("unreachable","get_uuid",{err:e})}}))}E.gen_uuid=()=>{var buf=new Uint8Array(16),uuid="";self.crypto.getRandomValues(buf);for(var i=0;i<buf.length;i++)uuid+=(buf[i]<=15?"0":"")+buf[i].toString(16);return uuid};function ensure_uuid(){let uuid;return _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({name:"ensure_uuid",cancel:true},(function*ensure_uuid_(){let _uuid=yield get_uuid();if(_uuid){E.sp.spawn(persist_param("uuid",_uuid,true));return this.return(_uuid)}new_uuid=true;_uuid=yield E.gen_uuid();_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().assert(_uuid,"gen_uuid() returned: "+_uuid);const ret=yield persist_param("uuid",uuid=_uuid,true);if(ret){uuid="t."+uuid.substr(2);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("init_tmp_uuid",{uuid},{err:true});return this.return(uuid)}_uuid=yield get_uuid();if(uuid!=_uuid)_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("uuid_storage_set_err",{uuid,_uuid});return uuid}))}const handle_install=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*handle_install_(){try{if(!E.get("install_reason"))yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().sleep(1e3);const reason=E.get("install_reason");_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().notice("bg_main startup "+reason);if(new_uuid&&reason!="install")_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("switch_uuid_err",{reason});if(["install","update"].includes(reason)){E.trigger(reason,_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get("ver"));_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set("ver",_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().version())}if(reason!="install")_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].fixup_install_data()}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("handle_install_err",{},{err:e})}}));E.set_rule_use=rule=>{var name=rule.name||rule.host,now=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].now();var d=now-uninstall_url_cb.ts;let last_use=state.get("last_use");var update=!last_use||last_use&&last_use.name!=name||d>15*_util_date_js__WEBPACK_IMPORTED_MODULE_12___default().ms.MIN;state.set("last_use",{name,ts:now});if(update||d>_util_date_js__WEBPACK_IMPORTED_MODULE_12___default().ms.HOUR)uninstall_url_cb()};const uninstall_url_cb=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){if(!_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().get(chrome,"runtime.setUninstallURL"))return;let ui_testing=yield _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26___default().get_hola_cookie("ui_testing");let ui_test=get_active_test_from_cookies(ui_testing);let now=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].now();uninstall_url_cb.ts=now;let qs={perr:1,uuid:E.get("uuid"),browser,version:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().version()};let last_use=state.get("last_use");if(last_use&&now-last_use.ts<15*_util_date_js__WEBPACK_IMPORTED_MODULE_12___default().ms.MIN){qs.last=btoa(last_use.name);if(last_use.is_mitm)qs.mitm=1}let force_login_ts=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("force_login_ts");if(force_login_ts&&now-force_login_ts<5*_util_date_js__WEBPACK_IMPORTED_MODULE_12___default().ms.MIN){qs.f_l=1;_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26___default().set_timeout(uninstall_url_cb,5*_util_date_js__WEBPACK_IMPORTED_MODULE_12___default().ms.MIN)}let ms;if(ms=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().get_install_ms())qs.inst_ms=ms;if(ms=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().get_ua_update_ms())qs.ua_ms=ms;if(ui_test.active_test_name){qs.u_t_n=ui_test.active_test_name;qs.u_t=ui_test.active_value}let ab_test=_bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_37__.Z.get_ab_test_str();if(ab_test)qs.ab=ab_test;let url=_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_15__.Z.get_selected_url({name:"ccgi",url:conf__WEBPACK_IMPORTED_MODULE_30__.url_ccgi})+"/uninstall?"+_util_escape_js__WEBPACK_IMPORTED_MODULE_8___default().qs(qs);let max_length=255;let b=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().browser_guess;if(b.browser=="chrome"&&b.version>=115||b.browser=="firefox"&&b.version>=116){max_length=1023}if(url.length>max_length){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_uninstall_url_max_length_exceeded",{url,max_length});url=url.substr(0,max_length)}try{yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().cb_apply(chrome.runtime,".setUninstallURL",[url])}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_uninstall_url_error",{url,max_length},{err:e});url=url.substr(0,255);yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().cb_apply(chrome.runtime,".setUninstallURL",[url])}}));const get_agree_ts=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){if(!conf__WEBPACK_IMPORTED_MODULE_30__.check_agree_ts)return 1;return yield get_param("agree_ts")}));E.set_agree_ts=val=>{E.set("agree_ts",val);persist_param("agree_ts",val)};E.debug_set_install_ts=val=>{_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("install_ts",val);persist_param("install_ts",val,true)};E.debug_set_install_ver=val=>{_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("install_version",val);persist_param("install_version",val,true)};function set_upgrade_ext_interval(){_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26___default().clear_interval(set_upgrade_ext_interval.interval);_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].upgrade_ext();set_upgrade_ext_interval.interval=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26___default().set_interval(_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].upgrade_ext,24*_util_date_js__WEBPACK_IMPORTED_MODULE_12___default().ms.HOUR,{sp:E.sp})}function ajax_do_op(o){var op=_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().get(o,"op");if(!op)return;switch(op){case"reload_ext":_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().notice("do_op_reload_ext "+_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().json(o));_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_reload_ext_ajax_op");_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26___default().set_timeout((()=>_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().reload_ext_native()),500);break;case"upgrade_ext":_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().notice("do_op_upgrade_ext "+_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().json(o));_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].upgrade_ext();break;default:_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default()("unknown op "+_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().json(o));break}}function dev_mode_cb(){const level=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("dev_mode")?"NOTICE":"WARN";_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].set_dbg_conf("debug.zerr",{level});_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().set_level(level)}function debug_cb(){_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().set_level(_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().get(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("debug.zerr"),"level"))}const check_user_agent=()=>{let prev_ua=_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get("ua"),ua=navigator.userAgent;if(prev_ua==ua)return;_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set("ua",ua);if(!prev_ua)return;_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set("ua_update_ts",_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].now());_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_user_agent_update",{prev_ua,ua})};const check_permissions=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){if(!chrome.permissions||!chrome.permissions.contains||(yield _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().check_permission())){return}_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_no_permission");_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("no_permission",true)}));const all_urls=v3?"*://*/*":"<all_urls>";const on_permission_added=data=>{_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_permission_added",data);if(data&&data.origins&&data.origins.includes(all_urls)){_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("no_permission",false);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().reload_ext_native()}};const on_permission_removed=data=>{_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_permission_removed",data);if(data&&data.origins&&data.origins.includes(all_urls))_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("no_permission",true)};const on_agree_ts=()=>{active_cb();_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26___default().set_timeout(send_install_perr,2e3)};const init_sync=()=>{chrome.permissions.onAdded.addListener(on_permission_added);chrome.permissions.onRemoved.addListener(on_permission_removed)};const get_initial_config=()=>{let last_conf=_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get_json("bext_config_last");return last_conf&&last_conf.stamp>(_bext_vpn_bg_bext_config_js__WEBPACK_IMPORTED_MODULE_31___default().build_ts||0)?last_conf:_bext_vpn_bg_bext_config_js__WEBPACK_IMPORTED_MODULE_31___default()};let keep_alive_interval;const enable_keep_alive=enable=>{const t=20*_util_date_js__WEBPACK_IMPORTED_MODULE_12___default().ms.SEC;if(enable&&!keep_alive_interval){if(performance.now()>t)chrome.runtime.getPlatformInfo();keep_alive_interval=setInterval(chrome.runtime.getPlatformInfo,t);return}if(!enable&&keep_alive_interval)keep_alive_interval=void clearInterval(keep_alive_interval)};const on_config_change=()=>{if(v3&&_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().browser_guess.version>109)enable_keep_alive(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().CG("v3_keep_alive"))};E.init=opt=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){opt=opt||{};if(E.inited)return;if(!_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().is_mocha())yield _util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().init();state=new _pub_state_js__WEBPACK_IMPORTED_MODULE_38__["default"]("bg_main_state",{last_use:null,bg_init_info:null},{persistent:false});yield state.load();E.sp=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26___default().new_etask("be_bg_main");const uuid=yield ensure_uuid();_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().notice("uuid: "+uuid);E.set("uuid",uuid);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("uuid",uuid);assert_no_listeners();E.inited=(E.inited||0)+1;_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26___default().set_conf(conf__WEBPACK_IMPORTED_MODULE_30__);_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_23__.Z.set_bext_config(get_initial_config());_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().set_bext_config_cb((()=>_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("bext_config")));_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().set_now_cb((()=>_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].now()));_util_ajax_js__WEBPACK_IMPORTED_MODULE_10__["default"].do_op=ajax_do_op;_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_7___default().init();_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default().init(_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_32___default());_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().init();ccgi_init();yield _bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_37__.Z.load_state();yield _bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_19__["default"].init(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_18__.Z);yield _bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_21__["default"].init(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_18__.Z,_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_29__.Z,_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_32___default());_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_20__["default"].init();_bext_vpn_bg_ui_api_js__WEBPACK_IMPORTED_MODULE_34__.Z.init(E);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().set_hola_org_cookie("ext_ver",_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().version());_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().clr("ajax_timeout");_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().clr("be_ajax_simulator");E.on("change:inited",inited_cb);if(_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().get(chrome,"runtime.setUninstallURL")){E.on_init("change:uuid change:cid",uninstall_url_cb);E.listen_to(_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_15__.Z,"change:ccgi_selected",uninstall_url_cb);E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default(),"ab_test_change",uninstall_url_cb);E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default(),"change:force_login_ts",uninstall_url_cb)}E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default(),"change:session_key change:enabled "+"change:ext.conflict change:uuid",active_cb);E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default(),"change:ext.suspended",suspend_cb);E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default(),"change:debug.zerr",debug_cb);E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default(),"change:dev_mode",dev_mode_cb);E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default(),"change:bext_config",on_config_change);if(!v3)_bext_vpn_bg_start_worker_js__WEBPACK_IMPORTED_MODULE_36__.Z.start_monitor_worker();check_user_agent();check_permissions();if(!v3&&chrome.permissions&&chrome.permissions.onAdded)chrome.permissions.onAdded.addListener(on_permission_added);if(!v3&&chrome.permissions&&chrome.permissions.onRemoved)chrome.permissions.onRemoved.addListener(on_permission_removed);const install_reason=_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().get(opt,"install_details.reason","");if(install_reason)E.set("install_reason",install_reason);E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*init_(){try{_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_23__.Z.set_user_message(get_initial_config());_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("last_install_ts",+(yield get_param("last_install_ts")));_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("install_ts",+(yield get_param("install_ts",true)));_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("install_version",yield get_param("install_version",true));E.set("agree_ts",yield get_agree_ts());E.set("aff_id",yield get_param("aff_id"));E.on("change:agree_ts",on_agree_ts);E.sp.spawn(handle_install());E.trigger("up");E.set("inited",true)}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("init_err",{},{err:e})}finally{const get=get_uuid.last_error||[];const set=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].persist_param_errors.uuid||[];if(get.length||set.length)_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("uuid_storage_err",_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().json({get,set}))}})));set_upgrade_ext_interval();if(_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_19__["default"].get("updated"))send_install_perr();else E.listen_to(_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_19__["default"],"change:updated",send_install_perr)}));E.uninit=function(){if(!E.inited)return;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("bg_main_uninit",{stack:new Error("bg_uninit").stack,reload_ext:_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get_json("reload_ext")});_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("bg_main_uninit_log",{stack:new Error("bg_uninit").stack,reload_ext:_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get_json("reload_ext")},{with_log:true});E.sp.return();E.off();E.stopListening();_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().del_hola_org_cookie("ext_ver");set_upgrade_ext_interval.interval=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_26___default().clear_interval(set_upgrade_ext_interval.interval);if(monitor_active.sp)monitor_active.sp.return();if(monitor_suspended.sp)monitor_suspended.sp.return();if(chrome.permissions&&chrome.permissions.onAdded)chrome.permissions.onAdded.removeListener(on_permission_added);if(chrome.permissions&&chrome.permissions.onRemoved)chrome.permissions.onRemoved.removeListener(on_permission_removed);if(_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().is_mocha()){_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_23__.Z.uninit();_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_19__["default"].uninit();_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_21__["default"].uninit();_bext_vpn_bg_icon_js__WEBPACK_IMPORTED_MODULE_16__.Z.uninit();_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_15__.Z.uninit();_bext_vpn_bg_ccgi_js__WEBPACK_IMPORTED_MODULE_22__.Z.uninit();_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().uninit();_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default().uninit();_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_20__["default"].uninit();_bext_vpn_bg_ui_api_js__WEBPACK_IMPORTED_MODULE_34__.Z.uninit();_bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_37__.Z.uninit();_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_7___default().uninit()}else{_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_23__.Z._destroy();_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_19__["default"]._destroy();_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_21__["default"]._destroy();_bext_vpn_bg_icon_js__WEBPACK_IMPORTED_MODULE_16__.Z._destroy();_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_15__.Z._destroy();_bext_vpn_bg_ccgi_js__WEBPACK_IMPORTED_MODULE_22__.Z._destroy();_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default()._destroy();_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default()._destroy();_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_20__["default"]._destroy();_bext_vpn_bg_ui_api_js__WEBPACK_IMPORTED_MODULE_34__.Z._destroy();_bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_37__.Z._destroy();_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_7___default()._destroy()}E.inited=false;E.clear();assert_no_listeners()};function assert_no_listeners(){_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_23__.Z.assert_no_listeners();_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_19__["default"].assert_no_listeners();_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_21__["default"].assert_no_listeners();_bext_vpn_bg_icon_js__WEBPACK_IMPORTED_MODULE_16__.Z.assert_no_listeners();_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_15__.Z.assert_no_listeners();_bext_vpn_bg_ccgi_js__WEBPACK_IMPORTED_MODULE_22__.Z.assert_no_listeners();_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().assert_no_listeners();_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default().assert_no_listeners();_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_20__["default"].assert_no_listeners();_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_18__.Z.assert_no_listeners();_bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_37__.Z.assert_no_listeners()}function inited_cb(){if(!E.get("inited"))return;E.off("change:inited",inited_cb);_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*inited_cb_(){try{const ext_state=yield _util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get("ext_state");E.set("enabled",ext_state!="disabled");_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("enabled",ext_state!="disabled");_bext_vpn_bg_icon_js__WEBPACK_IMPORTED_MODULE_16__.Z.init();yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_15__.Z.init(_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_32___default());E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default(),"change:uuid change:session_key",background_init);E.on("recover",(()=>background_init(true)));if(yield _util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get("suspended_ext_ts"))_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("ext.suspended",true)}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_bg_main_init_err",{},{err:e})}}))}const monitor_active=()=>{E.sp.spawn(monitor_active.sp=_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({cancel:true},(function*monitor_active_(){this.finally((()=>delete monitor_active.sp));yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().sleep(mem_leak_period);let prev_ps=_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().ps()||"";let a=_util_string_js__WEBPACK_IMPORTED_MODULE_13___default().split_nl(prev_ps).length;yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().sleep(mem_leak_period);let ps=_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().ps(),b=_util_string_js__WEBPACK_IMPORTED_MODULE_13___default().split_nl(ps).length;if(b>a){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_ext_off_leak",{before_n:a,after_n:b,reason:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("ext.conflict")?"conflict":"disable"},{rate_limit:{count:1},filehead:"before: "+prev_ps+"\nafter: "+ps})}})))};function active_cb(){let uuid=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("uuid");let active=!!(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("enabled")&&!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("ext.conflict")&&!(conf__WEBPACK_IMPORTED_MODULE_30__.check_agree_ts&&!E.get("agree_ts"))&&uuid&&_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("session_key"));_bext_vpn_util_no_log_js__WEBPACK_IMPORTED_MODULE_27__["default"].set_uuid(uuid);let prev=!!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("ext.active");_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().safe_set({"ext.active":active});if(prev==active)return;if(active){if(monitor_active.sp)monitor_active.sp=void monitor_active.sp.return();_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_19__["default"].init(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_18__.Z)}else{if(!monitor_active.sp)monitor_active();_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_19__["default"].uninit({keep_user:true})}}E.suspend_client=permanent=>{if(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("ext.suspended")){if(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("ext.suspended").permanent!=permanent)_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("ext.suspended",{permanent});return}_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("suspend_client");_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set("suspended_ext_ts",_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].now());_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("ext.suspended",{permanent});_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_19__["default"].refresh_user();let url=_util_url_js__WEBPACK_IMPORTED_MODULE_6___default().qs_add(_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_15__.Z.hola_url()+"/signin",{force_signin:1,signin_redirect:true,next:"/cp"});_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].open_hola_tab({url,force_active:true})};E.check_suspend_status=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*_check_suspend_status(){if(!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("ext.suspended"))return;try{let location=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_25__["default"].get("location");let qs=assign({ip:location&&location.ip},_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().auth());let res=yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_15__.Z.ccgi_ajax({url:conf__WEBPACK_IMPORTED_MODULE_30__.url_ccgi+"/user_status",qs});if(res&&res.active){_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().clr("suspended_ext_ts");_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("ext.suspended",false);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("suspend_restore");background_init(true)}if(res&&res.blocked)_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("ext.suspended",{permanent:res.permanent})}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("suspend_status_check_fail",{},{err:e,rate_limit:{count:2}})}}));const monitor_suspended=()=>{E.sp.spawn(monitor_suspended.sp=_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*_monitor_suspended(){let check_rl=underscore__WEBPACK_IMPORTED_MODULE_0___default().throttle(E.check_suspend_status,2*_util_date_js__WEBPACK_IMPORTED_MODULE_12___default().ms.SEC);this.finally((()=>{delete monitor_suspended.sp;E.stopListening(_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_19__["default"],"user_updated",check_rl);E.stopListening(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default(),"change:uuid change:session_key",check_rl)}));E.listen_to(_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_19__["default"],"user_updated",check_rl);E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default(),"change:uuid change:session_key",check_rl);yield this.wait()})))};let suspend_cb=()=>{if(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("ext.suspended")){if(!monitor_suspended.sp)monitor_suspended()}else{if(monitor_suspended.sp)monitor_suspended.sp=void monitor_suspended.sp.return()}};E.set_enabled=on=>{if(!!E.get("enabled")==!!on)return;return _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*set_enabled_(){try{E.set("enabled",!!on);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("enabled",!!on);return yield _util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set("ext_state",on?"enabled":"disabled")}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_bg_main_set_enable_err",{},{err:e})}}))};const background_init_ajax=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*_background_init_ajax(){let req={retry:1,method:"POST",json:1,data:{login:1,ver:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().version()},qs:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().qs_ajax({uuid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("uuid")}),url:conf__WEBPACK_IMPORTED_MODULE_30__.url_ccgi+"/background_init",with_credentials:true};let err,retries=5;for(let i=0;i<retries;i++){try{let res=yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_15__.Z.ccgi_ajax(req);if(res)return res;err="empty res";_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_background_init_empty",{req},{with_log:true})}catch(e){err=e}}_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_background_init_ccgi_failed",{req,retries},{err});req.url="https://client.zspeed-cdn.com/client_cgi/background_init";try{return yield(0,_util_ajax_js__WEBPACK_IMPORTED_MODULE_10__["default"])(req)}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_background_init_zspeed_cdn_failed",{req},{err:e})}req.url="https://perr.hola.org/background_init";try{return yield(0,_util_ajax_js__WEBPACK_IMPORTED_MODULE_10__["default"])(req)}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_background_init_perr_init_failed",{req},{err:e})}req.method="GET";req.url=conf__WEBPACK_IMPORTED_MODULE_30__.url_ccgi+"/background_init";try{return yield(0,_util_ajax_js__WEBPACK_IMPORTED_MODULE_10__["default"])(req)}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_background_init_get_ccgi_failed",{req},{err:e})}req.url="https://client.zspeed-cdn.com/client_cgi/background_init";try{return yield(0,_util_ajax_js__WEBPACK_IMPORTED_MODULE_10__["default"])(req)}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_background_init_get_zspeed_cdn_failed",{req},{err:e})}req.url="https://perr.hola.org/background_init";try{return yield(0,_util_ajax_js__WEBPACK_IMPORTED_MODULE_10__["default"])(req)}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_background_init_get_perr_init_failed",{req},{err:e})}if(!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().CG("disable_background_init_agent_test")){req={url:"http://208.68.38.214:22222/myip"};try{let res=yield(0,_util_ajax_js__WEBPACK_IMPORTED_MODULE_10__["default"])(req);if(res.ip)_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_background_init_agent_ok")}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_background_init_agent_err",{req},{err:e})}}throw new Error("background_init_ajax failed")}));const background_init=force=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*_background_init(){try{_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().notice("background_init called %s",E.get("status"));if(["busy","ready"].includes(E.get("status")))return;if(!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().get("uuid"))return void _util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().notice("background_init no uuid");E.set("status","busy");let info;if(!force)info=state.get("bg_init_info");if(!info){info=yield background_init_ajax();state.set("bg_init_info",info)}let t=self.hola.t;if(info.blocked){E.suspend_client(info.permanent);throw new Error("background_init_ajax blocked")}E.stopListening(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default(),"change:uuid change:session_key",background_init);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_17___default().set("session_key",info.key);yield _bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_23__.Z.init();_bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_37__.Z.init();E.set("status","ready");t.r_init=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_4__["default"].now();let start=t.new_ver||t.l_start,diff=t.r_init-start;_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default()[diff>2e3?"err":"notice"](diff>2e4?"rmt_init_slow":"background_init %sms",diff);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_background_init_ok",{diff});if(_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get("reload_ext_ts")){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_recover_ok",{ts:_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get("reload_ext_ts")});_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().clr("reload_ext_ts")}}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_background_init_err",{},{err:e,with_log:true});E.set("status","error");if(_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get("reload_ext_ts")){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("be_recover_failed",{ts:_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get("reload_ext_ts")},{err:e});_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().clr("reload_ext_ts")}_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_23__.Z.uninit()}}));let dumped_errors={};E.dump_errors=(tab_id,errors)=>dumped_errors[tab_id]=errors;E.get_dumped_errors=tab_id=>dumped_errors[tab_id];E.set_bug_id=bug_id=>{_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().warn("VPN BUG REPORT: http://web.hola.org/vpn_debug?id="+bug_id)};if(v3)init_sync();const __WEBPACK_DEFAULT_EXPORT__=E},39:(module,exports,__webpack_require__)=>{"use strict";var __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_RESULT__=function(){return{exclude_user_countries:{whitelist:{uuids:[],hola_uids:[]},blacklist:{uuids:["1cc658c3090fdd8327fd77b2404f430e"],hola_uids:[],url:"https://hola.org/blog/article/slug/important-information-regarding-country-availability-on-hola"},countries:[{country:"cu",url:"https://hola.org/blog/article/slug/important-information-regarding-country-availability-on-hola"},{country:"in",url:"https://hola.org/blog/article/slug/india-and-vpns-an-uneasy-relationship"},{country:"iq",url:"https://hola.org/blog/article/slug/important-information-regarding-country-availability-on-hola"},{country:"ir",url:"https://hola.org/blog/article/slug/important-information-regarding-country-availability-on-hola"},{country:"kp",url:"https://hola.org/blog/article/slug/important-information-regarding-country-availability-on-hola"},{country:"lb",url:"https://hola.org/blog/article/slug/important-information-regarding-country-availability-on-hola"},{country:"ps",url:"https://hola.org/blog/article/slug/important-information-regarding-country-availability-on-hola"},{country:"sd",url:"https://hola.org/blog/article/slug/important-information-regarding-country-availability-on-hola"},{country:"sy",url:"https://hola.org/blog/article/slug/important-information-regarding-country-availability-on-hola"}],affected_services:{proxy:true,vpn:true,dnsvpn:true,dnsvpn_lum:true}},version:45,reset_trial:{min_conf_ver:18,reset_on_period_change:false},debug_hooks:true,bump:1,bw_perr:[{id:"bbc",url:["**.bbc.co.uk","**.bbci.co.uk","**.bbc.com","**.bbcfmt.hs","**.bbcdotcom.2cnt.net","**.bbcfmt.hs.llnwd.net"],error_code:[403]},{id:"netflix",url:["**.nflxvideo.net"],error_code:[420]},{id:"youtube",url:["**.googlevideo.com"],error_code:[403]},{id:"cbs",url:["**.cbsaavideo.com"],error_code:[403]}],load_perr:[{id:"netflix",domain:"netflix.com",paths:["login","signin","clearcookies","search","browse","watch"]},{id:"youtube",domain:"youtube.com",paths:["results","watch"]},{id:"pornhub",domain:"pornhub.com",paths:["view_video.php","video"]},{id:"chaturbate",domain:"chaturbate.com",paths:[""]},{id:"xvideos",domain:"xvideos.com",paths:[""]},{id:"vk",domain:"vk.com",paths:[""]},{id:"steampowered",domain:"steampowered.com",paths:[""]},{id:"truepeoplesearch",domain:"truepeoplesearch.com",paths:[""]},{id:"google",domain:"google.com",paths:[""]}],force_premium:{rules:[{id:"bbc",domain:"bbc.co.uk"},{id:"bbc_com",domain:"bbc.com"},{id:"netflix",domain:"netflix.com"},{id:"hulu",domain:"hulu.com"},{id:"itv",domain:"itv.com"},{id:"vueling_com",domain:"vueling.com"}]},trial_timeline:{disable:false,disable_perr_state:false},skip_trial_must_wait_error:true,stub_rule_on_hola_site:false,show_top_sites_on_hola:true,ab_test:{min_ver:"9.210.577",ver:40,name:"test_new_ui",value:[[0,.5,"off"],[.5,1,"on"]],ref_prefix:true},ab_tests:{test_rebranding:{ver:3,min_ver:"1.217.263",value:[[0,.9999,"off"],[.9999,1,"on"]],www_tests:["test_new_hp_design","test_new_hp_design_mac"],filter:{browser:"chrome"},ref_prefix:true},test_rebranding_ext:{ver:3,min_ver:"1.217.263",min_install_ts:1700634559e3,filter:{browser:"chrome",install_ts_lt:17015889e5},value:[[0,.5,"off"],[.5,1,"on"]],ref_prefix:true},test_rebranding_ext_all:{ver:1,min_ver:"1.217.263",min_install_ts:17015889e5,filter:{browser:"chrome"},value:[[0,5e-324,"off"],[5e-324,1,"on"]]},test_rebranding_ext_new:{ver:1,min_ver:"1.218.793",filter:{browser:"chrome",last_install_ts_gt:17015889e5},value:[[0,5e-324,"off"],[5e-324,1,"on"]]},test_rebranding_ext_edge:{ver:1,min_ver:"1.220.286",filter:{browser:"edge",last_install_ts_gt:1707309453e3},value:[[0,5e-324,"off"],[5e-324,1,"on"]]},test_plan_w1m1y111:{ver:4,min_ver:"9.225.903",value:[[0,.5,"off"],[.5,1,"on"]],filter:{browser:"chrome",since_install_ts_gt:36e5},ref_prefix:true},test_plan_w1m1y222:{ver:3,min_ver:"1.225.903",value:[[0,.5,"off"],[.5,1,"on"]],filter:{browser:"chrome",since_install_ts_gt:36e5},ref_prefix:true},test_plan_erf:{ver:2,min_ver:"9.221.101",value:[[0,.5,"off"],[.5,1,"on"]],ref_prefix:true},test_ten_min_trial_popup5:{ver:1,min_install_ts:1712646817189,min_ver:"9.222.540",value:[[0,.5,"off"],[.5,1,"on"]],filter:{browser:"chrome"},ref_prefix:true},test_footer_upgrade_link4:{ver:1,min_ver:"9.222.540",value:[[0,.5,"off"],[.5,1,"on"]],filter:{since_install_ts_gt:36e5,browser:"chrome",is_premium:false},ref_prefix:true},test_premium_countries:{ver:2,min_ver:"9.224.24",min_install_ts:17146347e5,value:[[0,.8,"off"],[.8,1,"on"]],filter:{browser:"chrome",src_country_neq:"RU"},ref_prefix:true},test_5minutes_left3:{ver:2,min_ver:"9.224.697",min_install_ts:1716786820794,value:[[0,.5,"off"],[.5,1,"on"]],filter:{browser:"chrome"},ref_prefix:true},test_personalized_trial_end:{ver:2,min_ver:"9.225.491",value:[[0,.7,"off"],[.7,1,"on"]],filter:{browser:"chrome",since_install_ts_gt:36e5},ref_prefix:true},test_hover_banner_4:{ver:2,min_ver:"9.225.903",value:[[0,.5,"off"],[.5,1,"on"]],filter:{browser:"chrome"},ref_prefix:true},test_clean_cookie:{ver:1,min_ver:"9.225.903",value:[[0,.5,"off"],[.5,1,"on"]],filter:{browser:"chrome"},ref_prefix:true},test_btn_position:{ver:1,min_ver:"9.225.903",value:[[0,.5,"off"],[.5,1,"on"]],filter:{browser:"chrome"},ref_prefix:true},test_aa_ext_2024:{ver:2,min_ver:"9.222.903",value:[[0,.5,"off"],[.5,1,"on"]],filter:{browser:"chrome"},ref_prefix:true},test_prices_per_week:{ver:1,min_ver:"9.225.903",value:[[0,.5,"off"],[.5,1,"on"]],filter:{browser:"chrome"},ref_prefix:true,ext_tests:["test_plan_w1m1y222_on"]}},user_message:[],trial_rules:[{conf:{key:"all_sites",new_trial:{autostart:true,wait:0},new_cycle:{autostart:true,wait:5e3},grace_time:864e9,server_grace_time:36e5,client_grace_time:18e5,server_block_after_popup_abuse:true,wait:5e3,skip_signin:true,timer_type:"cycle_timer",trial_ready_dialog:true,hide_watermark_progress_dots:false,hide_timer:false,allow_tmp_watermark_hide:true,can_close_watermark:true,progress_type:"trial",start_dlg:{buttons:["free","pay"]},wait_dlg:{buttons:["free","pay"]},end_dlg:{buttons:["free","pay"]},timer_dlg:{buttons:["free","pay"]},close_watermark_dlg:{buttons:["free","pay"]},more_dlg:{buttons:["free","pay"]},watermark:{banner:{type:"all_plans"}},intervals:[{dur:12e5,conf:{wait:15e3,autostart_after_wait:true}},{dur:6e5,conf:{wait:6e4,autostart_after_wait:true}},{dur:27e5,conf:{wait:45e3,autostart_after_wait:true}},{dur:18e5,conf:{wait:6e5}},{dur:9e5,conf:{wait:12e4,autostart_after_wait:true}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}}],cycle:864e5,autostart_after_wait:false,suggested_countries:["us","gb","de","fr","ca","br","it","ar"]}},{filter:{since_install_ts_gt:72e5,since_install_ts_lt:864e5},conf:{intervals:[{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}},{dur:6e5,conf:{wait:6e4}},{dur:6e5,conf:{wait:3e5}},{dur:6e5,conf:{wait:18e5}}]}},{filter:{since_install_ts_gt:864e5},conf:{intervals:[{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}}]}},{filter:{since_closed_watermark_ts_gt:3e5},conf:{can_close_watermark:false}},{filter:{since_first_start_ts_lt:6e5},conf:{small_watermark:true}},{filter:{ab_test:"test_footer_upgrade_link4_on"},conf:{big_footer_proposal:true}},{filter:{ab_test:"test_hover_banner_4_on"},conf:{payment:{price_hover_banner:true}}},{filter:{ab_test:"test_clean_cookie_on"},conf:{no_clean_cookie:true}},{filter:{ab_test:"test_btn_position_on"},conf:{test_btn_position:true}},{filter:{ab_test:"test_plan_w1m1y222_on"},conf:{payment:{replace_plans_from:"test_plan_w1m1y222",choose_plan_anual_full_price:false,starting_from_price:"$6.99",starting_from_price_per_week:"$1.75",starting_from_period:"/month",starting_from_bold:false,sorting_ext:["wb1y1","wb1m1","wb1w1"],sorting_watermark:["wb1w1","wb1m1","wb1y1"],best_label:"wb1y1"}}},{filter:{ab_test:"test_ten_min_trial_popup5_on"},conf:{intervals:[{dur:15e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}},{dur:18e5,conf:{wait:18e5}}]}},{filter:{ab_test:"test_ten_min_trial_popup5_on",since_first_start_ts_lt:12e5},conf:{is_watermark_hidden:true}},{filter:{ab_test:"test_ten_min_trial_popup5_on",since_first_start_ts_gt:6e5},conf:{ten_min_trial_popup:true,ten_min_trial_popup_slide:"slide1"}},{filter:{ab_test:"test_ten_min_trial_popup5_on",since_first_start_ts_gt:12e5},conf:{ten_min_trial_popup:true,ten_min_trial_popup_slide:"slide2",is_watermark_hidden:false}},{filter:{since_install_ts_gt:864e5,since_interval_start_ts_gt:12e5,since_interval_start_ts_lt:15e5},conf:{popcorn_watermark:true}},{filter:{tmp_watermark_hide_ts_gt:0,since_tmp_watermark_hide_ts_lt:3e5},conf:{is_watermark_hidden:true}},{filter:{tmp_watermark_hide_ts_gt:0},conf:{allow_tmp_watermark_hide:false}},{filter:{premium_site:true},conf:{skip_signin:false,signin_opt:{type:"force"}}},{filter:{since_install_ts_lt:864e5,cycle_n:1,interval_n:1,since_interval_start_ts_gt:6e5,since_interval_start_ts_lt:9e5},conf:{watermark:{bonus_watermark:true},popcorn_watermark:false}},{filter:{since_install_ts_lt:864e5,cycle_n:1,interval_n:1,since_interval_start_ts_gt:6e5,since_interval_start_ts_lt:62e4},conf:{watermark:{open_bonus_tooltip:true},popcorn_watermark:false}},{filter:{since_install_ts_lt:864e5,cycle_n:1,interval_n:1,since_interval_start_ts_gt:9e5,since_interval_start_ts_lt:18e5},conf:{watermark:{bonus_logo:true},popcorn_watermark:false}},{filter:{since_install_ts_lt:864e5,cycle_n:1,interval_n:1,since_interval_start_ts_gt:18e5,since_interval_start_ts_lt:21e5},conf:{watermark:{bonus_watermark:true},popcorn_watermark:false}},{filter:{since_install_ts_lt:864e5,cycle_n:1,interval_n:1,since_interval_start_ts_gt:18e5,since_interval_start_ts_lt:182e4},conf:{watermark:{open_bonus_tooltip:true},popcorn_watermark:false}},{filter:{since_install_ts_lt:864e5,cycle_n:1,interval_n:1,since_interval_start_ts_gt:21e5,since_interval_start_ts_lt:36e5},conf:{watermark:{bonus_logo:true},popcorn_watermark:false}},{filter:{since_first_start_ts_gt:2592e6,since_first_start_ts_lt:7776e6,interval_n:0,since_interval_start_ts_gt:6e5,since_interval_start_ts_lt:9e5},conf:{watermark:{bonus_watermark:true},popcorn_watermark:false}},{filter:{since_first_start_ts_gt:2592e6,since_first_start_ts_lt:7776e6,interval_n:0,since_interval_start_ts_gt:6e5,since_interval_start_ts_lt:62e4},conf:{watermark:{open_bonus_tooltip:true},popcorn_watermark:false}},{filter:{since_first_start_ts_gt:2592e6,since_first_start_ts_lt:7776e6,interval_n:0,since_interval_start_ts_gt:9e5,since_interval_start_ts_lt:18e5},conf:{watermark:{bonus_logo:true},popcorn_watermark:false}},{filter:{since_first_start_ts_gt:2592e6,since_first_start_ts_lt:7776e6,interval_n:0,since_interval_start_ts_gt:18e5,since_interval_start_ts_lt:21e5},conf:{watermark:{bonus_watermark:true},popcorn_watermark:false}},{filter:{since_first_start_ts_gt:2592e6,since_first_start_ts_lt:7776e6,interval_n:0,since_interval_start_ts_gt:18e5,since_interval_start_ts_lt:182e4},conf:{watermark:{open_bonus_tooltip:true},popcorn_watermark:false}},{filter:{since_first_start_ts_gt:2592e6,since_first_start_ts_lt:7776e6,interval_n:0,since_interval_start_ts_gt:21e5,since_interval_start_ts_lt:36e5},conf:{watermark:{bonus_logo:true},popcorn_watermark:false}},{filter:{src_country_in:["RU"]},conf:{skip_trial:true}},{filter:{ab_test_in:["test_rebranding_on","test_rebranding_ext_on","test_rebranding_ext_all_on","test_rebranding_ext_new_on","test_rebranding_ext_edge_on"]},conf:{rebranding:true,wm_rebranding:true}},{filter:{ab_test_in:["test_rebranding_off","test_rebranding_ext_off","test_rebranding_ext_all_off","test_rebranding_ext_new_off","test_rebranding_ext_edge_off"]},conf:{offer_rebranding:"force",show_ui_tour:true,show_wm_tour:true}},{filter:{browser:"chrome",install_ts_lt:1700634559e3},conf:{offer_rebranding:"force",show_ui_tour:true,show_wm_tour:true}},{filter:{browser:"edge",last_install_ts_lt:1707309453e3},conf:{offer_rebranding:"force",show_ui_tour:true,show_wm_tour:true}},{filter:{browser:"opera"},conf:{offer_rebranding:"force",show_ui_tour:true,show_wm_tour:true}},{filter:{uuid_md5_in:["5c3265a6eed1b51922bff173effe714d","41df0af1934f978d041e7d51a3aa8114","41ca7545e6cc0531d70e32b3b3af90dd","5142fa47ac3f82985cff69b1a98ab78f","19f972fd0b275974dbf30ba3977c9222","921b6329c86e8e2c023e5c9c410dab6f","196edf22182fcb8cffc1f305ac848e3a","4244434f35ba5a1656ff2e754e42975a","3a6a6927bef553c38f3910f570a82b12","3ea879523c2ec3ba9fe7c67bcaf43b5c","954244c8feb7a940bff4b50105107b0f","912e8bb4d20ae3110af2249bb38a2dfa","f542472e29cf9d783bd0c9ea9460003e","31f551ed835ca9cb5c959e6f62938562","e84d278ba221be50b93790b3890c44f1","58e873cfd88e2ae349d355e5fd309a04","a0f63562b49eef69cc9d3ba560678633","863085bf45eb29016bed9604853c71e5","d5c067bff05c51509529a188753569d8","c0467191ca08cd5ca67bee2af5cbe6b3","ad3642f5eca5281317092a49e19efbcd","ba4264be3e53b15858fd0f15c8a44969","38fba2d94e2d2eb95fc30b06689dc293","16b4f37d102ab7642a7beaec3a12fb75"]},conf:{watermark:{banner:{type:"all_plans"},top_banner:{enabled:false,type:"dunning",show_delay:6e4}}}},{filter:{ext_ver_gte:"1.210.914"},conf:{new_ui:true}},{filter:{since_install_ts_lt:36e5},conf:{rate_us_wm:{enabled:true,delay:15e3}}},{filter:{install_ts_gt:17077398e5},conf:{splash_anim:true,google_stub_tooltip:true}},{filter:{ab_test:"test_premium_countries_on"},conf:{premium_countries2:["us","gb","de","ar","fr","jp","ca","es","it"]}},{filter:{ab_test:"test_5minutes_left3_on"},conf:{banner_5minutes_left:true,banner_5minutes_left_timeout:true}},{filter:{ab_test:"test_personalized_trial_end_on"},conf:{personalized_trial_end:true}},{filter:{uuid_md5_in:["8d63890f5394cbaf0ca4a03679fd07b6"]},conf:{intervals:[{dur:12e4,conf:{wait:12e4}},{dur:15e4,conf:{wait:12e4}},{dur:18e4,conf:{wait:12e4}},{dur:21e4,conf:{wait:12e4}},{dur:24e4,conf:{wait:12e4}}],cycle:36e5}},{filter:{ab_test:"test_prices_per_week_on"},conf:{prices_per_week:true}}],sites_default:{min_ver:"1.174.223",install_min_ver:"1.1.1",require_plus:false},sites:{itv_com:{require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},min_ver:"1.136.635",root_url:["itv.com"],suggestion_popup:{GB:null,"*":{proxy:["GB"]}},verify:{gb:[{url:"https://mediaplayer.itv.com/flash/playlists/ukonly/itv1.xml",ret:{status:403,client_only:true}},{url:"*://*.itv.com/playlist/*",ret:{status:403,client_only:true}}]}},hulu_com:{require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},min_ver:"1.136.635",root_url:["hulu.com"],suggestion_popup:{US:null,"*":{proxy:["US"]}},verify:{us:[{url:"*://play.hulu.com/*/playlist",ret:{status:403,client_only:true}}]}},france_tv:{require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},min_ver:"1.136.635",root_url:["france.tv"],suggestion_popup:{FR:null,"*":{proxy:["FR"]}}},channel4_com:{min_ver:"1.145.764",root_url:["channel4.com"],suggestion_popup:{GB:null,"*":{proxy:["GB"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},tz_spoof:-60},vk_com:{min_ver:"1.145.764",root_url:["vk.com"],tz_spoof:-180,keep_cookies:true},tvnz_co_nz:{min_ver:"1.145.764",root_url:["tvnz.co.nz"],tz_spoof:-780},roblox_com:{min_ver:"1.145.764",root_url:["roblox.com"],tz_spoof:300},hbogo_pl:{min_ver:"1.158.502",root_url:["hbogo.pl"],site_storage:{"go-geostate":""}},vod_pl:{min_ver:"1.158.502",root_url:["vod.pl"],site_storage:{insiderTimeOnSiteData:"",insUserPermissionGranted:""}},hbogo_ro:{min_ver:"1.158.502",root_url:["hbogo.ro"],site_storage:{"go-geostate":""}},investopedia_com:{min_ver:"1.158.502",root_url:["investopedia.com"],site_storage:{tg_accessDeny_timeStamp:"",tg_accessDeny:"",tg_redirectURLremembered:"",tg_reaction:"",tg_redirectURL:"",tg_accessEntry:"",tg_ipInfosArray:""}},espn_com_co:{min_ver:"1.160.842",root_url:["espn.com.co"],site_storage:{geo:""}},ome_tv:{min_ver:"1.160.842",root_url:["ome.tv"],site_storage:{selected_country:""}},joyn_de:{min_ver:"1.160.842",root_url:["joyn.de"],site_storage:{token:""}},espn_com:{min_ver:"1.160.842",root_url:["espn.com"],suggestion_popup:{US:null,"*":{proxy:["US"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},site_storage:{__btm__web_userLocation:""}},orf_at:{min_ver:"1.160.842",root_url:["orf.at"],site_storage:{"oonmedia-geoprotection":""},headers_conf:[{url:"*://*/playlist.m3u8",name:"Cache-Control",value:"no-cache"}]},rsi_ch:{min_ver:"1.160.842",root_url:["rsi.ch"],headers_conf:[{url:"*://*.rsi.ch/*",type:["xmlhttprequest"],name:"Cache-Control",value:"no-cache"},{url:"*://*.srgssr.ch/*",name:"Cache-Control",value:"no-cache"}]},rts_ch:{min_ver:"1.160.842",root_url:["rts.ch"],headers_conf:[{url:"*://*.rts.ch/*",type:["xmlhttprequest"],name:"Cache-Control",value:"no-cache"},{url:"*://*.srgssr.ch/*",name:"Cache-Control",value:"no-cache"}]},srf_ch:{min_ver:"1.160.842",root_url:["srf.ch"],headers_conf:[{url:"*://*.srf.ch/*",type:["xmlhttprequest"],name:"Cache-Control",value:"no-cache"},{url:"*://*.srgssr.ch/*",name:"Cache-Control",value:"no-cache"}]},bigbrothercanada_ca:{min_ver:"1.160.842",root_url:["bigbrothercanada.ca"],headers_conf:[{url:"*://*.livestream.com/*",name:"Cache-Control",value:"no-cache"}]},hbogo_com:{min_ver:"1.136.635",root_url:["hbogo.com","loginprodx.att.net"]},cablevisionflow_com_ar:{min_ver:"1.136.635",root_url:["cablevisionflow.com.ar","flow.com.ar"]},bandainamcoentstore_com:{min_ver:"1.136.635",root_url:["bandainamcoentstore.com","bandainamcoent.eu"]},vueling_com:{min_ver:"0.0.0",root_url:["vueling.com"]},cwtv_com:{min_ver:"1.136.635",root_url:["cwtv.com"],suggestion_popup:{US:null,"*":{proxy:["US"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},verify:{us:[{url:"https://www.cwtv.com/",ret:{status:403,client_only:true}}]}},netflix_com:{require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},min_ver:"1.136.635",root_url:["netflix.com"],suggestion_popup:{US:{proxy:["US","GB","CA","NL","FR","DE","SE","ES","IE","BE","PL","IT","RU","JP","HK","BR","AR","KR","SK","IS","CH","GR","HU","MX","RO","IL","SG","IN","UA"]},GB:{proxy:["US","GB","CA","NL","FR","DE","SE","ES","IE","BE","PL","IT","RU","JP","HK","BR","AR","KR","SK","IS","CH","GR","HU","MX","RO","IL","SG","IN","UA"]},"*":{proxy:["US","GB","CA","NL","FR","DE","SE","ES","IE","BE","PL","IT","RU","JP","HK","BR","AR","KR","SK","IS","CH","GR","HU","MX","RO","IL","SG","IN","UA"]}},keep_cookies:true,verify:{ca:[{url:"https://www.netflix.com",ret:{headers:{location:{}},client_only:true}},{url:"*://*.nflxvideo.net/*",ret:{status:420,client_only:true}},{url:"*://*.nflxso.net/*.bif",ret:{status:420,client_only:true},sid:"thumbnail"}],it:[{url:"https://www.netflix.com",ret:{headers:{location:{}},client_only:true}},{url:"*://*.nflxso.net/*.bif",ret:{status:420,client_only:true},sid:"thumbnail"}],us:[{url:"https://www.netflix.com",ret:{headers:{location:null},client_only:true}},{url:"*://*.nflxso.net/*.bif",ret:{status:420,client_only:true},sid:"thumbnail"}],gb:[{url:"https://www.netflix.com",ret:{headers:{location:{}},client_only:true}},{url:"*://*.nflxvideo.net/*",ret:{status:420,client_only:true}},{url:"*://*.nflxso.net/*.bif",ret:{status:420,client_only:true},sid:"thumbnail"}],"*":[{url:"*://*.nflxvideo.net/*",ret:{status:420,client_only:true}},{url:"*://*.nflxso.net/*.bif",ret:{status:420,client_only:true},sid:"thumbnail"}]},watermark:{pos:{default:"bottom_right",fullscreen:"top_right","/watch/**":"top_right"}},web_worker_proxy:true,redirect:[{url:"https://www.netflix.com/watch/0?origId=",action:"change_agent"}]},bbc:{require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},min_ver:"1.144.716",root_url:["bbc.com","bbc.co.uk"],verify:{gb:[{url:"**.bbc.co.uk",ret:{status:403,client_only:true}},{url:"**.bbci.co.uk",ret:{status:403,client_only:true}},{url:"**.bbc.com",ret:{status:403,client_only:true}},{url:"**.bbcfmt.hs",ret:{status:403,client_only:true}},{url:"**.bbcdotcom.2cnt.net",ret:{status:403,client_only:true}},{url:"**.bbcfmt.hs.llnwd.net",ret:{status:403,client_only:true}}]},suggestion_popup:{GB:null,"*":{proxy:["GB"]}},watermark:{pos:{default:"bottom_right",fullscreen:"top_right"}},headers_conf:[{url:"*://*/*wor*/*i*/1*.js",name:"Cache-Control",value:"no-cache"},{url:"*://*/*wor*/*i*/2*.js*",name:"Cache-Control",value:"no-cache"},{url:"*://www.bbc.co.uk/userinfo",name:"Cache-Control",value:"no-cache"},{url:"*://www.bbc.com/userinfo",name:"Cache-Control",value:"no-cache"},{url:"*://open.live.bbc.co.uk/*callbacks*",name:"Cache-Control",value:"no-cache"}]},southparkstudios_nu:{min_ver:"1.158.502",root_url:["southparkstudios.nu","southparkstudios.com"],headers_conf:[{url:"*://www.southparkstudios.nu",type:["main_frame"],name:"Cache-Control",value:"no-cache"},{url:"*://www.southparkstudios.com",type:["main_frame"],name:"Cache-Control",value:"no-cache"}],trial:{trial_redirect:"https://www.southparkstudios.nu/"}},skaitv_gr:{min_ver:"1.158.502",root_url:["skaitv.gr"],headers_conf:[{url:"*://extreme-ip-lookup.com",name:"Cache-Control",value:"no-cache"}]},mitele_es:{min_ver:"1.158.502",root_url:["mitele.es"],headers_conf:[{url:"*://cerbero.pro.*.es",name:"Cache-Control",value:"no-cache"}]},telecinco_es:{min_ver:"1.158.502",root_url:["telecinco.es"],headers_conf:[{url:"*://cerbero.pro.*.es",name:"Cache-Control",value:"no-cache"}]},energytv_es:{min_ver:"1.158.502",root_url:["energytv.es"],headers_conf:[{url:"*://cerbero.pro.*.es",name:"Cache-Control",value:"no-cache"}]},ertflix_gr:{min_ver:"1.158.502",root_url:["ertflix.gr"],headers_conf:[{url:"*/geo.json",name:"Cache-Control",value:"no-cache"}]},unidragon_eu:{min_ver:"1.158.502",root_url:["unidragon.eu","unidragon.com"],headers_conf:[{url:"*://cozycountryredirect.addons.business",name:"Cache-Control",value:"no-cache"}]},google_com:{min_ver:"1.158.502",root_url:["google.com"],keep_cookies:true},facebook_com:{min_ver:"1.158.502",root_url:["facebook.com"],keep_cookies:true},youtube_com:{min_ver:"1.158.502",root_url:["youtube.com"],verify:{"*":[{url:"**.googlevideo.com",ret:{status:403,client_only:true}}]},keep_cookies:true,redirect:[{url:"https://www.google.com/sorry/",action:"change_agent"}]},reddit_com:{min_ver:"1.158.502",root_url:["reddit.com"],keep_cookies:true},disney_com:{min_ver:"1.144.716",root_url:["disney.com","go.com","disneyinternational.com","disney.co.za","disney.com.cn","disney.com.hk","disney.id","disney.co.jp","disney.co.kr","disney.my","disney.ph","disney.sg","disney.com.tw","disney.co.th","disney.com.au","disney.be","disney.bg","disney.cz","disney.dk","disney.de","disney.es","disney.gr","disney.it","disney.hu","disney.nl","disney.no","disney.pl","disney.pt","disney.ro","disney.ch","disney.fi","disney.se","disneyturkiye.com.tr","disney.co.uk","disney.in","disney.com.br","disneylatino.com","disneyme.com","disney.co.il","disney.ca","disney.ru"],trial:{trial_redirect:"https://disney.com/"}},cbs_com:{min_ver:"1.144.716",root_url:["cbs.com"],suggestion_popup:{US:null,"*":{proxy:["US"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},verify:{"*":[{url:"**.cbsaavideo.com",ret:{status:403,client_only:true}}]},skip_fix_req_err:["net::ERR_CONNECTION_CLOSED"],headers_conf:[{url:"*://*.cbsaavideo.com/*",name:"Cache-Control",value:"no-cache"},{url:"*://*.cbsivideo.com/*",name:"Cache-Control",value:"no-cache"}]},mtv_ca:{min_ver:"1.144.716",root_url:["mtv.ca"],skip_fix_req_err:["net::ERR_CONNECTION_CLOSED"]},_13tv_co_il:{min_ver:"1.144.716",root_url:["13tv.co.il"],skip_fix_req_err:["net::ERR_CONNECTION_CLOSED"],watermark:{pos:{default:"bottom_right",fullscreen:"top_right"}}},pornhub_com:{min_ver:"1.144.716",root_url:["pornhub.com","pornhubpremium.com"],verify:{"*":[{url:"**.phncdn.com/videos",ret:{status:403,client_only:true}},{url:"**.phncdn.com/hls/videos",ret:{status:403,client_only:true}}]}},xvideos_com:{min_ver:"1.144.716",root_url:["xvideos.com"]},line_me:{min_ver:"1.144.716",root_url:["line.me","linetv.tw"]},footpatrol_com:{min_ver:"1.144.716",root_url:["footpatrol.com","footpatrol.co.uk"]},tenplay_com_au:{min_ver:"1.144.716",root_url:["tenplay.com.au","10play.com.au"]},globaltv_com:{min_ver:"1.144.716",root_url:["globaltv.com"],suggestion_popup:{CA:null,"*":{proxy:["CA"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},verify:{ca:[{url:"https://www.globaltv.com/favicon.ico",ret:{status:403,client_only:true}}]}},noovo_ca:{min_ver:"1.144.716",root_url:["noovo.ca"],verify:{ca:[{url:"https://edge.api.brightcove.com/playback/*",ret:{status:403,client_only:true}},{url:"https://edge.api.brightcove.com/playback/v1/accounts/618566855001/videos/6096502206001",ret:{data:{}}}]}},ondemandkorea_com:{min_ver:"1.158.340",root_url:["ondemandkorea.com"],verify:{us:[{url:"https://www.ondemandkorea.com/",ret:{status:403,client_only:true}}]}},sprint_com:{min_ver:"1.158.340",root_url:["sprint.com"],verify:{us:[{url:"https://www.sprint.com/",ret:{status:403,client_only:true}}]}},fastpeoplesearch_com:{min_ver:"1.158.340",root_url:["fastpeoplesearch.com"]},bet365_com:{min_ver:"1.158.340",root_url:["bet365.com"],verify:{gb:[{url:"https://www.bet365.com/defaultapi/sports-configuration",ret:{status:302,client_only:true}}]}},disneyplus_com:{require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},min_ver:"1.157.668",root_url:["disneyplus.com"],suggestion_popup:{US:null,"*":{proxy:["US","GB","CA","NL","AU","NZ","PR","AT","DE","IE","IT","ES","CH","FR"]}},watermark:{pos:{default:"bottom_right",fullscreen:"top_right"}}},hbonow_com:{require_plus:true,premium_site:true,trial:{trial_redirect:"https://play.hbonow.com/"},min_ver:"1.157.668",root_url:["hbonow.com"],suggestion_popup:{US:null,"*":{proxy:["US"]}}},criteo_com:{require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},min_ver:"1.157.668",root_url:["criteo.com"],suggestion_popup:{US:null,"*":{proxy:["US"]}}},vseinstrumenti_ru:{require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},min_ver:"1.163.892",root_url:["vseinstrumenti.ru"],suggestion_popup:{RU:null,"*":{proxy:["RU"]}}},twitch_tv:{require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},min_ver:"1.163.892",root_url:["twitch.tv"],suggestion_popup:{US:{proxy:["GB"]},"*":{proxy:["US"]}}},hotstar_com:{require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},min_ver:"1.163.892",root_url:["hotstar.com"],suggestion_popup:{IN:null,"*":{proxy:["IN"]}},verify:{in:[{url:"**.akamaized.net",ret:{status:403,client_only:true}},{url:"**.akamaihd.net",ret:{status:403,client_only:true}}]}},pandora_com:{min_ver:"0.0.0",root_url:["pandora.com"],watermark:{pos:{default:"bottom_left"}}},player_pl:{min_ver:"1.163.892",root_url:["player.pl"],suggestion_popup:{PL:null,"*":{proxy:["PL"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},cc_com:{min_ver:"1.163.892",root_url:["cc.com"],suggestion_popup:{US:null,"*":{proxy:["US"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},watermark:{pos:{default:"bottom_right",fullscreen:"top_right"}}},globo_com:{min_ver:"1.145.764",root_url:["globo.com"],suggestion_popup:{BR:null,"*":{proxy:["BR"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},geo_spoof:{latitude:{from:-14.2400732,to:-15.2400732},longitude:{from:-53.1805017,to:-54.1805017}}},locast_org:{min_ver:"1.145.764",root_url:["locast.org"],geo_spoof:{latitude:{from:38.883333,to:38.883333},longitude:{from:-77,to:-77}}},tv4play_se:{min_ver:"1.163.892",root_url:["tv4play.se"],suggestion_popup:{SE:null,"*":{proxy:["SE"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},crunchyroll_com:{min_ver:"1.163.892",root_url:["crunchyroll.com"],suggestion_popup:{US:null,"*":{proxy:["US"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},mediaset_it:{min_ver:"1.163.892",root_url:["mediaset.it"],suggestion_popup:{IT:null,"*":{proxy:["IT"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},site_storage:{"aws.cognito.identity-id.*":null}},raiplay_it:{min_ver:"1.144.716",root_url:["raiplay.it"],suggestion_popup:{IT:null,"*":{proxy:["IT"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},verify:{it:[{url:"**.akamaized.net",ret:{status:302,client_only:true}}]}},nrk_no:{min_ver:"1.163.892",root_url:["nrk.no"],suggestion_popup:{NO:null,"*":{proxy:["NO"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},indavideo_hu:{min_ver:"1.163.892",root_url:["indavideo.hu"],suggestion_popup:{HU:null,"*":{proxy:["HU"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},tv2_hu:{min_ver:"1.163.892",root_url:["tv2.hu"],suggestion_popup:{HU:null,"*":{proxy:["HU"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},rtlmost_hu:{min_ver:"1.163.892",root_url:["rtlmost.hu"],suggestion_popup:{HU:null,"*":{proxy:["HU"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},dmdamedia_hu:{min_ver:"1.163.892",root_url:["dmdamedia.hu"],suggestion_popup:{HU:null,"*":{proxy:["HU"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},filmorias_com:{min_ver:"1.163.892",root_url:["filmorias.com"],suggestion_popup:{HU:null,"*":{proxy:["HU"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},dark_ro_com:{min_ver:"1.163.892",root_url:["dark-ro.com"],suggestion_popup:{HU:null,"*":{proxy:["HU"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},tv2_no:{min_ver:"1.163.892",root_url:["tv2.no"],suggestion_popup:{NO:null,"*":{proxy:["NO"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},rte_ie:{min_ver:"1.163.892",root_url:["rte.ie"],suggestion_popup:{IE:null,"*":{proxy:["IE"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},svtplay_se:{min_ver:"1.163.892",root_url:["svtplay.se"],suggestion_popup:{SE:null,"*":{proxy:["SE"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},livestream_com:{min_ver:"1.163.892",root_url:["livestream.com"],suggestion_popup:{DE:{proxy:["US","*"]},"*":{proxy:["DE","US","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},textnow_com:{min_ver:"1.163.892",root_url:["textnow.com"],suggestion_popup:{US:null,"*":{proxy:["US"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},scor_dk:{min_ver:"1.163.892",root_url:["scor.dk"],suggestion_popup:{DK:null,"*":{proxy:["DK"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},iwant_ph:{min_ver:"1.170.680",root_url:["iwant.ph"],web_worker_proxy:true},tvnow_de:{min_ver:"1.170.680",root_url:["tvnow.de"],web_worker_proxy:true},voot_com:{min_ver:"1.170.680",root_url:["voot.com"],web_worker_proxy:true},sonyliv_com:{min_ver:"1.170.680",root_url:["sonyliv.com"],web_worker_proxy:true},tinder_com:{min_ver:"1.170.680",root_url:["tinder.com"],web_worker_proxy:true},primevideo_com:{min_ver:"1.170.680",root_url:["primevideo.com"],web_worker_proxy:true},tsn_ca:{min_ver:"1.163.892",root_url:["tsn.ca"],suggestion_popup:{CA:null,"*":{proxy:["CA","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},sportsnet_ca:{min_ver:"1.163.892",root_url:["sportsnet.ca"],suggestion_popup:{CA:null,"*":{proxy:["CA","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},nba_com:{min_ver:"1.163.892",root_url:["nba.com"],suggestion_popup:{US:null,"*":{proxy:["US","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},atttvnow_com:{min_ver:"1.163.892",root_url:["atttvnow.com"],suggestion_popup:{US:null,"*":{proxy:["US","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},bleacherreport_com:{min_ver:"1.163.892",root_url:["bleacherreport.com"],suggestion_popup:{US:null,"*":{proxy:["US","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false},headers_conf:[{url:"https://live.bleacherreport.com/",type:["main_frame"],name:"Cache-Control",value:"no-cache"}]},tvplayer_com:{min_ver:"1.163.892",root_url:["tvplayer.com"],suggestion_popup:{US:null,"*":{proxy:["US","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},flobikes_com:{min_ver:"1.163.892",root_url:["flobikes.com"],suggestion_popup:{CA:null,"*":{proxy:["CA","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},nbcsports:{min_ver:"1.163.892",root_url:["nbcsports.com"],suggestion_popup:{US:null,"*":{proxy:["US","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},fubo_tv:{min_ver:"1.163.892",root_url:["fubo.tv"],suggestion_popup:{US:null,"*":{proxy:["US","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},"9now_com_au":{min_ver:"1.163.892",root_url:["9now.com.au"],suggestion_popup:{AU:null,"*":{proxy:["AU","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},sling_com:{min_ver:"1.163.892",root_url:["sling.com"],suggestion_popup:{US:null,"*":{proxy:["US","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},tennistv_com:{min_ver:"1.163.892",root_url:["tennistv.com"],suggestion_popup:{US:null,"*":{proxy:["US","GB","IT","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},willow_tv:{min_ver:"1.163.892",root_url:["willow.tv"],suggestion_popup:{US:null,"*":{proxy:["US","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}},skysports_com:{min_ver:"1.163.892",root_url:["skysports.com"],suggestion_popup:{GB:null,"*":{proxy:["GB","*"]}},require_plus:true,premium_site:true,trial:{period:36e5,wait2:5e3,grace_time:6048e5,limits:{count:24,period:864e5},skip_signin:false}}},pool:{min_ver:"1.149.460"},debug_logs:{enabled_perc:100,domains:["bbc.co.uk","bbc.com","cbs.com","channel4.com","espn.com","facebook.com","globo.com","hotstar.com","hulu.com","mitele.es","mtv.ca","netflix.com","tvp.pl","vk.com","yahoo.com","itv.com","disneyplus.com","pornhub.com","pornhubpremium.com"],all_domains_perc:20,screenshot_conflict_rate:0},mitm:{disable:false,discovery:"auto",manual:{min_ver:"1.130.62",trigger:true,disable:false},auto:{disable:true,min_ver:"1.136.280",trigger:true,error:{trigger:true,disable:false},fake_resp:{min_ver:"1.138.399",trigger:true,disable:false},redirect:{min_ver:"1.138.399",trigger:true,disable:false}},min_version:"1.129.426",enable_ext_ui:1,popup:{enable:true,min_version:"1.131.310"},site_blacklist:["twitter.com","adpop.club","google.com","youtube.com"],send_dbg_log:10,log:{random:10,countries:["us"],uuids:["c07b61feb81ecc8a857c57874b166756"]},redirect_filter:[{domain:"accounts.google.com"},{domain:"www.google.com"},{domain:"login.live.com"},{domain:"login.microsoftonline.com"},{domain:"outlook.live.com"},{domain:"www.facebook.com"},{domain:"www.bing.com"}],response_filter:[{statusCode:503,server:"cloudflare","cache-control":"no-cache"}]},mitm2:{min_ver:"1.178.829",rule_min_ts:16073856e5,trace:{print_to_logs:true,add_to_perr:true},rules:[{conf:{exclude_sites:["google.com","youtube.com"],retry_after:36e5,inside_popup:false,reasons:{invalid_cert:{enable:true,mode:"auto"}}}},{filter:{root_url_in:["facebook.com"],src_country_in:["RU"]},conf:{reasons:{invalid_cert:{enable:true,mode:"auto"},redirect:{enable:true,mode:"auto"},conn_error:{enable:true,mode:"auto"}}}},{filter:{uuid_md5_in:["5c3265a6eed1b51922bff173effe714d","41df0af1934f978d041e7d51a3aa8114","41ca7545e6cc0531d70e32b3b3af90dd","5142fa47ac3f82985cff69b1a98ab78f","19f972fd0b275974dbf30ba3977c9222","921b6329c86e8e2c023e5c9c410dab6f","196edf22182fcb8cffc1f305ac848e3a","4244434f35ba5a1656ff2e754e42975a","3a6a6927bef553c38f3910f570a82b12","3ea879523c2ec3ba9fe7c67bcaf43b5c","954244c8feb7a940bff4b50105107b0f","912e8bb4d20ae3110af2249bb38a2dfa","f542472e29cf9d783bd0c9ea9460003e","31f551ed835ca9cb5c959e6f62938562","e84d278ba221be50b93790b3890c44f1","58e873cfd88e2ae349d355e5fd309a04","a0f63562b49eef69cc9d3ba560678633","863085bf45eb29016bed9604853c71e5","d5c067bff05c51509529a188753569d8","c0467191ca08cd5ca67bee2af5cbe6b3","ad3642f5eca5281317092a49e19efbcd","ba4264be3e53b15858fd0f15c8a44969","38fba2d94e2d2eb95fc30b06689dc293","16b4f37d102ab7642a7beaec3a12fb75"]},conf:{reasons:{redirect:{enable:true,mode:"auto"},timeout:{enable:true,mode:"manual"}}}}]},protect_ui2:{enable:true,enable_ratio:1,protect_browser:true,protect_pc_min_ver:"1.134.588",tooltips:true,test_name:"test_protect_ui2"},geo_popup:{watermark:{position:"bottom_right",position_fullscreen:"top_right",allow_hide:false,banner:{min_ver:"1.166.473",type:"upgrade"}}},dunning:{reasons:{insufficient:{steps:["init","reminder","cancel"]},expired:{steps:["init","reminder","cancel"]},bank_issue:{steps:["init","cancel"]}},since:{init:6e5,reminder:864e5,cancel:2592e5,stop:6048e5},min_ver:"1.222.84"},dunning_popup:{reasons:{insufficient:{steps:["init","reminder","cancel"]},expired:{steps:["init","reminder","cancel"]},bank_issue:{steps:["init","cancel"]}},since:{init:6e5,reminder:864e5,cancel:2592e5,stop:6048e5},min_ver:"1.222.84"},popup:{disable:false,disable_max_ver:"1.130.481",dont_show_def_period:"30d"},perr_sample:{be_verify_proxy_ok:.01,be_bext_config_success:.01,be_mitm_ignore:.01,be_new_unblocker_api_init:.01,be_debug_no_agents:.01},media_failure:{disable:false,disable_set_err:false,new_media_fix:true,types:["xmlhttprequest","media"],extensions:["mp4","m3u8","ts","mpd","dash","m4s","m4v"],rules:[{domain:"bbc.com",set_err:true,max_retry:3},{domain:"bbc.co.uk",set_err:true,max_retry:3},{domain:"hulu.com",urls:["*://play.hulu.com/*/playlist"],set_err:true},{domain:"itv.com",urls:["*://*.itv.com/playlist/*"]},{domain:"netflix.com",urls:["*://*.nflxvideo.net/*"],set_err:true}],set_err_rate_limit:{ms:36e5,count:10}},browse_failure:{disable:false,types:["main_frame"],rules:[{domain:"netflix.com",urls:["*://*.netflix.com/login*","*://*.netflix.com/browse*"]}]},request_errors:{handle:["net::ERR_PROXY_CONNECTION_FAILED","net::ERR_CONNECTION_CLOSED","net::ERR_CONNECTION_RESET","net::ERR_TIMED_OUT","net:ERR_CONNECTION_TIMED_OUT"],retry:{disable_media_failure:false,sporadic_perc:5,max:5}},bg_ajax:{on:1,min_version:"1.167.61",disable_perr:0,client_uri:"/client_cgi/conn_test",disable_slow_perr:true,disable_agent_domain_fallback:true,enable_agent_domain_fallback_min_ver:"1.201.706",persistent_state_min_ver:"1.208.177",parallel:true,agent_domain_fallback_rules:["zagent${n}.su89-cdn.net","zagent${n}.c6gj-static.net","zagent${n}.kbz0pwvxmv.com","zagent${n}.yg5sjx5kzy.com","zagent${n}.x-cdn-static.com"],hola_mirrors:["su89-cdn.net","c6gj-static.net","zspeed-cdn.com","yg5sjx5kzy.com","x-cdn-static.com"],cloud_agents:[{url:"https://www.dropbox.com/s/jemizcvpmf2qb9v/cloud_failover.conf?dl=1",rand:.5},{url:"https://vdkd6nz8qr.s3.amazonaws.com/cloud_failover.conf",rand:.5}]},payment:{all_plans:[],watermark_plan_ids:["josh_3y","y12005","m12005"],trial_plan_ids:["josh_3y","y12005","m12005"],bonus_plan_id:"y12005d",mm_plan_ids:["josh_3y","y12005","m12005f1"],plan_ids:["josh_3y","y12005","m12005"],wm_popup_plan_ids:["m12005","y12005","josh_3y"],starting_from_price:"$2.99",starting_from_price_per_week:"$0.75",starting_from_period:"/month"},verify_period_ms:864e5,verify_proxy:{min_ver:"1.156.341",period_ms:864e5,disable_verify:false,verify_err:{period:864e5,count:1e4}},proxy_error_ui:{min_ver:"9.999.999",icon:true,popup:true,dialog:false},reauth:{period:9e5},upgrade_link:{enabled:true,position:"right"},ip_check_min_ver:"1.160.558",is_zgettunnels_post2:0,is_zgettunnels_post3:1,is_zgettunnels_post4:1,rate_us:{urls:[{url:"https://www.trustpilot.com/evaluate/hola.org",rand:.1,countries:["AT","BE","CZ","FR","DE","IE","LI","LU","MC","NL","CH","GB","US","CA"]},{url:"store",rand:1}],show_every_nth_click:3},no_log_for_plus:false,no_log_for_uid:{},no_log_perrs:["be_install","be_update","be_vpn_ok","be_ui_vpn_click_no_fix_it","be_ui_vpn_click_no_fix_it_multi","be_report_problem","be_issue_report","be_etask_typeerror_known","be_etask_typeerror_unknown"],tpopup_window_min_ver:"1.168.477",disable_slow_load_monitor:true,popular_sites:{siteicon_url:"https://cdn4.hola.org/access/siteicon/${root_url}/${size}",sitepic_url:"https://hola-sitepic.b-cdn.net/${root_url}.png"},new_design_min_ver:"1.169.230",new_wm_design_min_ver:"1.169.696",new_plans_design_min_ver:"9.999.999",tpopup:{allow_youtube_min_ver:"1.173.107",allow_google_min_ver:"9.999.999",allow_rule_rating_youtube_min_ver:"9.999.999",allow_rule_rating_google_min_ver:"9.999.999"},use_server_ts_min_ver:"1.216.281",force_server_ts_update_threshold:0,trustpilot_rating:4.5,dialogs:{trial_running:{free_text:"<a><b>Stay Free</b></a><br/>and keep using the Free VPN for %%root_url%%",plus_text:"<a><b>Upgrade to Premium</b></a><br/>and enjoy unlimited time",free_btn:"Continue Free",plus_btn:"Go Premium",free_content:"",plus_content:'<div style="text-align: center;"><div style="font-size: 12px;">Start from</div><div style="font-size: 24px; line-height: 40px">$2.99</div><div style="font-size: 12px;">/ month</div></div>',plus_template:'<div style="text-align: center;"><div style="font-size: 12px;">Start from</div><div style="font-size: 24px; line-height: 40px">%%price%%</div><div style="font-size: 12px;">/ %%every%%</div></div>',bonus_text:"",bonus_btn:"",bonus_obj:"",buttons:["free","plus"]},trial_end_wait:{free_text:"<a><b>Stay Free</b></a><br/>Time until your next free hour:",plus_text:"<a><b>Upgrade to Premium</b></a><br/>and enjoy unlimited time",free_btn:"Continue Free",plus_btn:"Go Premium",free_content:"",plus_content:'<div style="text-align: center;"><div style="font-size: 12px;">Start from</div><div style="font-size: 24px; line-height: 40px">$2.99</div><div style="font-size: 12px;">/ month</div></div>',plus_template:'<div style="text-align: center;"><div style="font-size: 12px;">Start from</div><div style="font-size: 24px; line-height: 40px">%%price%%</div><div style="font-size: 12px;">/ %%every%%</div></div>',bonus_text:"",bonus_btn:"",bonus_obj:"",buttons:["free","plus"]},trial_end:{free_text:"<a><b>Stay Free</b></a><br/>get more Free VPN time",plus_text:"<a><b>Upgrade to Premium</b></a><br/>and enjoy unlimited time",free_btn:"Continue Free",plus_btn:"Go Premium",free_content:'<div style="text-align: center;"><div style="font-size: 24px; line-height: 40px">Free</div><div style="font-size: 12px">time</div></div>',plus_content:'<div style="text-align: center;"><div style="font-size: 12px;">Start from</div><div style="font-size: 24px; line-height: 40px">$2.99</div><div style="font-size: 12px;">/ month</div></div>',plus_template:'<div style="text-align: center;"><div style="font-size: 12px;">Start from</div><div style="font-size: 24px; line-height: 40px">%%price%%</div><div style="font-size: 12px;">/ %%every%%</div></div>',bonus_text:"",bonus_btn:"",bonus_obj:"",buttons:["free","plus"]},trial_end_long:{free_btn:"Load more time"},trial_waiting:{free_text:"<a><b>Stay Free</b></a><br/>Loading free time...",plus_text:"<a><b>Upgrade to Premium</b></a><br/>and enjoy unlimited time",free_btn:"Continue for free",plus_btn:"Watch now",free_content:"",plus_content:'<div style="text-align: center;"><div style="font-size: 12px;">Start from</div><div style="font-size: 24px; line-height: 40px">$2.99</div><div style="font-size: 12px;">/ month</div></div>',plus_template:'<div style="text-align: center;"><div style="font-size: 12px;">Start from</div><div style="font-size: 24px; line-height: 40px">%%price%%</div><div style="font-size: 12px;">/ %%every%%</div></div>',bonus_text:"",bonus_btn:"",bonus_obj:"",buttons:["free","plus"]},trial_waiting_long:{free_t2:"You will get more free time in..."},trial_start:{free_text:"<a><b>Stay Free</b></a><br/>Enjoy free VPN time",plus_text:"<a><b>Upgrade to Premium</b></a><br/>and enjoy unlimited time",free_btn:"Start Now",plus_btn:"Upgrade to Premium",free_content:'<div style="text-align: center;"><div style="font-size: 24px; line-height: 40px">Free</div><div style="font-size: 12px">time</div></div>',plus_content:'<div style="text-align: center;"><div style="font-size: 12px;">Start from</div><div style="font-size: 24px; line-height: 40px">$2.99</div><div style="font-size: 12px;">/ month</div></div>',plus_template:'<div style="text-align: center;"><div style="font-size: 12px;">Start from</div><div style="font-size: 24px; line-height: 40px">%%price%%</div><div style="font-size: 12px;">/ %%every%%</div></div>',bonus_text:"",bonus_btn:"",bonus_obj:"",buttons:["free","plus"]},trial_ready:{free_btn:"Continue watching"},ext_trial_end:{free_title:"Stay Free",free_subtitle:"Enjoy limited VPN time",plus_title:"Upgrade to Premium",plus_subtitle:"Enjoy unlimited usage",moneyback:"100% money-back guarantee policy",free_btn:""},ext_trial_end_long:{free_btn:"Load more time"},ext_trial_end_wait:{free_title:"Stay Free",free_subtitle:"Wait for more free VPN time",plus_title:"Upgrade to Premium",plus_subtitle:"Enjoy unlimited usage",moneyback:"100% money-back guarantee policy",free_btn:""},ext_trial_waiting:{free_title:"Stay Free",free_subtitle:"Enjoy limited VPN time",plus_title:"Upgrade to Premium",plus_subtitle:"Enjoy unlimited usage",moneyback:"100% money-back guarantee policy",free_btn:"Loading free VPN time of %%root_url%%"},ext_trial_start:{free_title:"Stay Free",free_subtitle:"Enjoy limited VPN time",plus_title:"Upgrade to Premium",plus_subtitle:"Enjoy unlimited usage",moneyback:"100% money-back guarantee policy",free_btn:""},ext_trial_ready:{free_btn:"Continue watching"},ext_plans:{title:"Upgrade to Premium",subtitle:"Enjoy unlimited usage",moneyback:"100% money-back guarantee policy"},wm_mm_banner_march_madness:{title:"<span>Save Money</span> with Hola's March Madness deal!",subtitle:"Buy 1 month Hola Premium and get <span>1 month free!</span>"},wm_mm_banner_april_fool:{title:"Don't be an April Fool!",subtitle:"Save money with Hola! Get 1 month of Hola Premium and get another <span>month for free</span>, on us!"},wm_mm_banner_fall_special:{title:"Fall Special!",subtitle:"To celebrate, how about a <span>month of Hola Premium for free</span> when you buy a month's subscription?"}},redirect:[{url:"https://www.google.com/sorry/",action:"change_agent"}],headers_conf2:[{type:["main_frame"],name:"Cache-Control",value:"no-cache"}],show_plans_on_footer_click:true,main_frame_errors_only:true,ext_trial_dialog_min_ver:"1.175.169",ext_trial_watch_time_min_ver:"1.183.308",svc:{use_new_monitor2:true},signup_bonus_menu:{min_ver:"9.999.999",install_ts_gt:12096e5},disable_bext_config_etag_usage:true,disable_hola_hostname_fallback:false,rating_popup:{min_ver:"9.999.999"},exclude_countries:["cu","iq","ir","kp","lb","ps","sd","sy"],premium_countries:[],collect_proxied_hosts:{enabled:true,interval:6e4,threshold:6e5},login_methods:["google","email","apple"],perr_rate_limit:{be_ui_vpn_click_no_fix_it:100,be_trial_next_ts:1},menu_survey:{id:"s1",title:"Help us make Hola better!",debug:true},ui_events:{ui_show:{enabled:true,rate_limit:{count:100}},ui_click:{enabled:true,rate_limit:{count:100}},ui_hover:{enabled:true,rate_limit:{count:100}}},blocked_by_av:{show_popup:true,link:{ru:"https://support.kaspersky.com/KESWin/12.5/ru-RU/175124.htm#:~:text=%D0%9D%D0%B5%20%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D1%8F%D1%82%D1%8C%20%D0%B7%D0%B0%D1%89%D0%B8%D1%89%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20%D1%81%D0%BE%D0%B5%D0%B4%D0%B8%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F",default:"https://support.kaspersky.com/KESWin/12.5/en-US/175124.htm#:~:text=Do%20not%20scan%20encrypted%20connections"}},v3_per_tab_min_ver:"1.224.584",v3_full_browser_fallback:false,v3_keep_alive:true,stamp:0,build_ts:1725525179367,proxy_rules:{exceptions:{dynamic:["netflix.com","hulu.com","hulu.jp","itv.com","channel4.com","rte.ie"],peer:["netflix.com","hulu.com","hulu.jp","itv.com","channel4.com","rte.ie"],pairs:[["bbc.com","bbc.co.uk"]],limited:[]},blacklist:{"equinix.com":true,"digitalocean.com":true,"oceanconservancy.org":true,"mail.yahoo.com":true,"mail.yahoo.co.jp":true,"mail.aol.com":true,"mail.aol.fr":true,"mail.com":true,"gmx.com":true,"couponcabin.com":true,"outlook.live.com":true,"hotmail.live.com":true,"outlook.com":true,"mailto.space":true,"e.mail.ru":true,"login.sso.bluewin.ch":true,"secure.centurylink.net":true,"secureserver.net":true,"webmail.usfamily.net":true,"webmail.skymesh.net.au":true,"hanmail.net":true,"mail.rambler.ru":true,"freeola.co.uk":true,"webmail-04.datacenter.cha.cantv.net":true,"linustechtips.com":true,"3capp-mailcom-lxa01.server.lan":true,"noiholiday.com":true,"hostedemail.com":true,"heyholla.com":true,"hellixeducation.com":true,"unisalento.it":true,"secrel.com.br":true,"mailorama.fr":true,"kiwiirc.com":true,"derpibooru.org":true,"trixiebooru.org":true,"derpiboo.ru":true,"derpicdn.net":true,"alice.it":true,"vcwebmail.ocn.ad.jp":true,"tentaciones18.com":true,"ocn.ad.jp":true,"ocn.ne.jp":true,"webmail.numericable.fr":true,"webmail.scarlet.be":true,"webmailer.de":true,"mail.uk.tiscali.com":true,"elisa.fi":true,"saunalahti.fi":true,"globalgiving.org":true,"knology.net":true,"netmail.pipex.net":true,"playstation.com":true,"playstation.net":true,"playstationnetwork.com":true,"sonymusic.com":true,"sonypictures.com":true,"sonyentertainmentnetwork.com":true,"perfora.net":true,"hmail.com":true,"gigablast.com":true,"126.com":true,"ono.com":true,"funded.today":true,"manenetheoffnewconne.ru":true,"dlfeed.com":true,"odbnfhbyagyz4.net":true,"pinformationbwarranties.ru":true,"musttthewithoutalsothas.ru":true,"bjkaolp4ds4z.com":true,"advseeking.com":true,"companolo.com":true,"mijnbankering-nl-server.com":true,"froekuge.com":true,"updateacces.org":true,"sophisticatiretaj.net":true,"soap4.me":true,"boriel.com":true,"ebb.mtn.co.za":true,"osbservices.vodacom.co.za":true,"apps.telkom.co.za":true,"holadebug.com":true,"fretebras.com.br":true,"megacupons.online":true,"vitacostapi.bbhosted.com":true,"mobilepayca.com":true,"mobilepayusa.org":true,"mobilepayusa.mobi":true,"mobilepayusa.net":true,"mobilepay-web.gaiareply.eu":true,"puffin.com":true,"miosmsclub.com":true,"gruponadir.es":true,"linkedin.com":true,"ticketsnow.com":true,"playerline.com":true,"ticketmaster.com":true,"ticketmaster.com.mx":true,"livenation.com":true,"stubhub.com":true,"tickets.com":true,"fastpeoplesearch.com":true,"btc4you.com":true,"elbitcoingratis.es":true,"btcmine.net":true,"virtualfaucet.net":true,"rawbitcoins.net":true,"freebitcoins4u.com":true,"canhasbitcoin.com":true,"bitcats.net":true,"faucetbtc.com":true,"bitcoins4free.me":true,"thefreebitcoins.net":true,"freebitcoins.me":true,"5mindoge.com":true,"freedoge.co.in":true,"moondoge.co.in":true,"moonbit.co.in":true,"bonusbitcoin.co":true,"bitcoinspace.net":true,"btc-faucet.co":true,"treebitcoin.com":true,"flatcoin.net":true,"baglitecoin.com":true,"moonliteco.in":true,"freebitco.in":true,"github.com":true,"smartadvices.com":true,"generictadalafilusa.com":true,"getitllc.com":true,"createyourownteeshirtonline.com":true,"mondino.it":true,"daum.net":true,"workbooks.com":true,"forum.qt.io":true,"radicalexploits.com":true,"craigslist.org":true,"craigslist.ca":true,"craigslist.co.uk":true,"bisaboard.de":true,"criusenergy.com":true,"arenagroup.com":true,"truqueira.com":true,"cratejoy.com":true,"gaynext.ca":true,"hispachan.org":true,"freenode.net":true,"sony.com":true,"exigent.com.au":true,"au.edu":true,"runsignup.com":true,"thegreekbookstore.com":true,"arriveonline.com.au":true,"reimageplus.com":true,"goso.info":true,"checkip.dyndns.org":true,"warezshare.org":true,"blocklist.de":true,"twiki.org":true,"intherooms.com":true,"globalinnovationexchange.org":true,"portal.webgods.de":true,"postfinance.ch":true,"synacor.com":true,"gvtc.com":true,"cantv.net":true,"homepage-baukasten.de":true,"paginawebgratis.es":true,"own-free-website.com":true,"sitowebfaidate.it":true,"ma-page.fr":true,"homepage-konstruktor.ru":true,"bedava-sitem.com":true,"stronygratis.pl":true,"news.ycombinator.com":true,"tdchosting.dk":true,"infusionsoft.com":true,"puregaming.es":true,"blogalizate.com":true,"teftv.com":true,"porticolegal.com":true,"physicalmed.es":true,"htcmania.com":true,"tebeosfera.com":true,"grupopuntacana.rubypanel.com":true,"fansdeapple.com":true,"cerebriti.com":true,"educaciontrespuntocero.com":true,"pymescomercial.com":true,"creativat.com":true,"financiacionparaempresas.net":true,"moon.rightdns.com":true,"uptodate.com":true,"judoprincast.com":true,"office365.com":true,"primalforce.net":true,"maszynykrzak.pl":true,"resdrob.com":true,"yumeiho.com":true,"bb.com.br":true,"esnb.org.uk":true,"claimantcommitments.org.uk":true,"comcloud.xyz":true,"nearsales.in":true,"frysztak.pl":true,"hostgator.com":true,"tpc-017.mach3builders.nl":true,"it-svbuero.de":true,"musicapassionata.com":true,"1nyecta.com":true,"10-4media.com":true,"10000dogturds.com":true,"innowee.eu":true,"trckswrm.com":true,"stripe.com":true,"netweak.com":true,"typhoonadvertising.com":true,"dry-bag.nl":true,"hamoptiek.nl":true,"de-verkleedkist.nl":true,"mulderoptiek.nl":true,"emagineoptical.com":true,"mail3.emagineoptical.com":true,"panel.dreamhost.com":true,"muncievoice.com":true},enable:true,stamp:0,unblocker_plus:{ads:{cmds:[{hosts:["google-analytics.com","analytics.twitter.com","googleadservices.com","p.adsymptotic.com","googletagmanager.com","bat.bing.com","adservice.google.com","doubleclick.net","gstatic.com","googlesyndication.com","2mdn.net","q.quora.com","analytics.edgekey.net","amazon-adsystem.com","users.quantumgraph.com","images-na.ssl-images-amazon.com","bh.contextweb.com","pixel-sync.sitescout.com","ads-twitter.com","googletagservices.com","scorecardresearch.com","outbrain.com","cdnjs.cloudflare.com","adservice.google.com.pk","adservice.google.com.ph","adroll.com","analytics.yahoo.com","spl.zeotap.com","a-ads.com"],then:"PROXY XX",if:[]}]},proxy_from_agent:{cmds:[{hosts:["api.waxsweden.org","userstorage.mega.co.nz"],then:"PROXY XX",if:[]}]},facebook:{proxy_country:["AR","AT","AU","BE","BG","BR","CA","CH","CL","CO","CZ","DE","DK","ES","FI","FR","GB","GR","HK","HR","HU","ID","IE","IL","IN","IT","IS","JP","KR","MX","NL","NO","NZ","PL","RO","RU","SE","SG","SK","TR","US"],cmds:[{hosts:["facebook.com","facebook.net"],then:"PROXY XX",if:[]}]},google:{match:{root_urls:["google.com"],rules:[{cmds:[{hosts:["google.com","google.co.in","googleapis.com","ampproject.org","www.google.com","mtalk.google.com","clients4.google.com","play.google.com","maps.googleapis.com","accounts.google.com","safebrowsing.googleapis.com","history.google.com","optimizationguide-pa.googleapis.com","clients2.google.com","safebrowsing.google.com","fonts.googleapis.com","apis.google.com","content-autofill.googleapis.com"],then:"PROXY XX",if:[]}]}]}},daycoval_com_br:{match:{root_urls:["daycoval.com.br"],rules:[{proxy_country:["BR"],cmds:[{hosts:["www.daycoval.com.br"],then:"PROXY BR.PEER",if:[]}]}]},cmds:[{hosts:["www.daycoval.com.br"],then:"PROXY BR.PEER",if:[]}]},salto_fr:{match:{root_urls:["salto.fr"],rules:[{proxy_country:["FR"],cmds:[{hosts:["geo.salto.fr","android.middleware.salto.fr","layout.salto.fr","front-auth.salto.fr","youboranqs01.com","youboranqs02.com","youboranqs03.com"],then:"PROXY FR.PEER",if:[]}]}]},cmds:[{hosts:["geo.salto.fr","android.middleware.salto.fr","layout.salto.fr","front-auth.salto.fr","youboranqs01.com","youboranqs02.com","youboranqs03.com"],then:"PROXY FR.PEER",if:[]}]},laligaplus_laliga_com:{match:{root_urls:["laligaplus.laliga.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["liga-llstv-subscriptions.llt-services.com","liga-llstv-backend.llt-services.com","liga-llstv-backend.llt-services.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["liga-llstv-subscriptions.llt-services.com","liga-llstv-backend.llt-services.com","liga-llstv-backend.llt-services.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},hibbett_com:{match:{root_urls:["hibbett.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["hibbett.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["hibbett.com"],then:"PROXY US.PEER",if:[]}]},nowonline_com_br:{match:{root_urls:["nowonline.com.br"],rules:[{proxy_country:["BR"],cmds:[{hosts:["www.nowonline.com.br"],then:"PROXY BR.PEER",if:[]}]}]},cmds:[{hosts:["www.nowonline.com.br"],then:"PROXY BR.PEER",if:[]}]},nrk_no:{match:{root_urls:["nrk.no"],rules:[{proxy_country:["NO"],cmds:[{hosts:["nrk.no","dna.ip-only.net","nrk-od-00.akamaized.net","nrk-od-01.akamaized.net","nrk-od-02.akamaized.net","nrk-od-03.akamaized.net","nrk-od-04.akamaized.net","nrk-od-05.akamaized.net","nrk-od-06.akamaized.net","nrk-od-07.akamaized.net","nrk-od-08.akamaized.net","nrk-od-09.akamaized.net","nrk-od-10.akamaized.net","nrk-od-11.akamaized.net","nrk-od-12.akamaized.net","nrk-od-13.akamaized.net","nrk-od-14.akamaized.net","nrk-od-15.akamaized.net","nrk-od-16.akamaized.net","nrk-od-17.akamaized.net","nrk-od-18.akamaized.net","nrk-od-19.akamaized.net","nrk-od-20.akamaized.net","nrk-od-21.akamaized.net","nrk-od-22.akamaized.net","nrk-od-23.akamaized.net","nrk-od-24.akamaized.net","nrk-od-25.akamaized.net","nrk-od-26.akamaized.net","nrk-od-27.akamaized.net","nrk-od-28.akamaized.net","nrk-od-29.akamaized.net","nrk-od-30.akamaized.net","nrk-od-31.akamaized.net","nrk-od-32.akamaized.net","nrk-od-33.akamaized.net","nrk-od-34.akamaized.net","nrk-od-35.akamaized.net","nrk-od-36.akamaized.net","nrk-od-37.akamaized.net","nrk-od-38.akamaized.net","nrk-od-39.akamaized.net","nrk-od-40.akamaized.net","nrk-od-41.akamaized.net","nrk-od-42.akamaized.net","nrk-od-43.akamaized.net","nrk-od-44.akamaized.net","nrk-od-45.akamaized.net","nrk-od-46.akamaized.net","nrk-od-47.akamaized.net","nrk-od-48.akamaized.net","nrk-od-49.akamaized.net","nrk-od-50.akamaized.net","nrk-od-51.akamaized.net","nrk-od-52.akamaized.net","nrk-od-53.akamaized.net","nrk-od-54.akamaized.net","nrk-od-55.akamaized.net","nrk-od-56.akamaized.net","nrk-od-57.akamaized.net","nrk-od-58.akamaized.net","nrk-od-59.akamaized.net","nrk-od-60.akamaized.net","nrk-od-61.akamaized.net","nrk-od-62.akamaized.net","nrk-od-63.akamaized.net","nrk-od-64.akamaized.net","nrk-od-65.akamaized.net","nrk-od-66.akamaized.net","nrk-od-67.akamaized.net","nrk-od-68.akamaized.net","nrk-od-69.akamaized.net","nrk-od-70.akamaized.net","nrk-od-71.akamaized.net","nrk-od-72.akamaized.net","nrk-od-73.akamaized.net","nrk-od-74.akamaized.net","nrk-od-75.akamaized.net","nrk-od-76.akamaized.net","nrk-od-77.akamaized.net","nrk-od-78.akamaized.net","nrk-od-79.akamaized.net","nrk-od-80.akamaized.net","nrk-od-81.akamaized.net","nrk-od-82.akamaized.net","nrk-od-83.akamaized.net","nrk-od-84.akamaized.net","nrk-od-85.akamaized.net","nrk-od-86.akamaized.net","nrk-od-87.akamaized.net","nrk-od-88.akamaized.net","nrk-od-89.akamaized.net","nrk-od-90.akamaized.net","nrk-od-91.akamaized.net","nrk-od-92.akamaized.net","nrk-od-93.akamaized.net","nrk-od-94.akamaized.net","nrk-od-95.akamaized.net","nrk-od-96.akamaized.net","nrk-od-97.akamaized.net","nrk-od-98.akamaized.net","nrk-od-99.akamaized.net"],then:"PROXY NO.PEER",if:[]}]}]},cmds:[{hosts:["nrk.no","dna.ip-only.net","nrk-od-00.akamaized.net","nrk-od-01.akamaized.net","nrk-od-02.akamaized.net","nrk-od-03.akamaized.net","nrk-od-04.akamaized.net","nrk-od-05.akamaized.net","nrk-od-06.akamaized.net","nrk-od-07.akamaized.net","nrk-od-08.akamaized.net","nrk-od-09.akamaized.net","nrk-od-10.akamaized.net","nrk-od-11.akamaized.net","nrk-od-12.akamaized.net","nrk-od-13.akamaized.net","nrk-od-14.akamaized.net","nrk-od-15.akamaized.net","nrk-od-16.akamaized.net","nrk-od-17.akamaized.net","nrk-od-18.akamaized.net","nrk-od-19.akamaized.net","nrk-od-20.akamaized.net","nrk-od-21.akamaized.net","nrk-od-22.akamaized.net","nrk-od-23.akamaized.net","nrk-od-24.akamaized.net","nrk-od-25.akamaized.net","nrk-od-26.akamaized.net","nrk-od-27.akamaized.net","nrk-od-28.akamaized.net","nrk-od-29.akamaized.net","nrk-od-30.akamaized.net","nrk-od-31.akamaized.net","nrk-od-32.akamaized.net","nrk-od-33.akamaized.net","nrk-od-34.akamaized.net","nrk-od-35.akamaized.net","nrk-od-36.akamaized.net","nrk-od-37.akamaized.net","nrk-od-38.akamaized.net","nrk-od-39.akamaized.net","nrk-od-40.akamaized.net","nrk-od-41.akamaized.net","nrk-od-42.akamaized.net","nrk-od-43.akamaized.net","nrk-od-44.akamaized.net","nrk-od-45.akamaized.net","nrk-od-46.akamaized.net","nrk-od-47.akamaized.net","nrk-od-48.akamaized.net","nrk-od-49.akamaized.net","nrk-od-50.akamaized.net","nrk-od-51.akamaized.net","nrk-od-52.akamaized.net","nrk-od-53.akamaized.net","nrk-od-54.akamaized.net","nrk-od-55.akamaized.net","nrk-od-56.akamaized.net","nrk-od-57.akamaized.net","nrk-od-58.akamaized.net","nrk-od-59.akamaized.net","nrk-od-60.akamaized.net","nrk-od-61.akamaized.net","nrk-od-62.akamaized.net","nrk-od-63.akamaized.net","nrk-od-64.akamaized.net","nrk-od-65.akamaized.net","nrk-od-66.akamaized.net","nrk-od-67.akamaized.net","nrk-od-68.akamaized.net","nrk-od-69.akamaized.net","nrk-od-70.akamaized.net","nrk-od-71.akamaized.net","nrk-od-72.akamaized.net","nrk-od-73.akamaized.net","nrk-od-74.akamaized.net","nrk-od-75.akamaized.net","nrk-od-76.akamaized.net","nrk-od-77.akamaized.net","nrk-od-78.akamaized.net","nrk-od-79.akamaized.net","nrk-od-80.akamaized.net","nrk-od-81.akamaized.net","nrk-od-82.akamaized.net","nrk-od-83.akamaized.net","nrk-od-84.akamaized.net","nrk-od-85.akamaized.net","nrk-od-86.akamaized.net","nrk-od-87.akamaized.net","nrk-od-88.akamaized.net","nrk-od-89.akamaized.net","nrk-od-90.akamaized.net","nrk-od-91.akamaized.net","nrk-od-92.akamaized.net","nrk-od-93.akamaized.net","nrk-od-94.akamaized.net","nrk-od-95.akamaized.net","nrk-od-96.akamaized.net","nrk-od-97.akamaized.net","nrk-od-98.akamaized.net","nrk-od-99.akamaized.net"],then:"PROXY NO.PEER",if:[]}]},discoveryplus_in:{match:{root_urls:["discoveryplus.in"],rules:[{proxy_country:["IN"],cmds:[{root_urls:["discoveryplus.in"],then:"PROXY IN",if:[]},{hosts:["ap2-prod-direct.discoveryplus.in"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]}]},cmds:[{root_urls:["discoveryplus.in"],then:"PROXY IN",if:[]},{hosts:["ap2-prod-direct.discoveryplus.in"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},spotify_com:{match:{root_urls:["spotify.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["spclient.wg.spotify.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["spclient.wg.spotify.com"],then:"PROXY US.PEER",if:[]}]},ruv_is:{match:{root_urls:["ruv.is"],rules:[{proxy_country:["IS"],cmds:[{hosts:["ruv-vod-app-dcp-v4.secure.footprint.net"],then:"PROXY IS.PEER",if:[]}]}]},cmds:[{hosts:["ruv-vod-app-dcp-v4.secure.footprint.net"],then:"PROXY IS.PEER",if:[]}]},binge_com_au:{match:{root_urls:["binge.com.au"],rules:[{proxy_country:["AU"],cmds:[{hosts:["binge.com.au","billingapi.streamotion.com.au"],then:"PROXY AU.PEER",if:[]}]}]},cmds:[{hosts:["binge.com.au","billingapi.streamotion.com.au"],then:"PROXY AU.PEER",if:[]}]},tf1_fr:{match:{root_urls:["tf1.fr"],rules:[{proxy_country:["FR"],cmds:[{root_urls:["tf1.fr"],then:"PROXY FR.POOL_lum_fr_shared",if:[]},{hosts:["mediainfo.tf1.fr","strmt.tf1.fr","tf1-das-live-ssl.tf1.fr","compte.tf1.fr"],then:"PROXY FR.PEER",if:[]}]}]},cmds:[{root_urls:["tf1.fr"],then:"PROXY FR.POOL_lum_fr_shared",if:[]},{hosts:["mediainfo.tf1.fr","strmt.tf1.fr","tf1-das-live-ssl.tf1.fr","compte.tf1.fr"],then:"PROXY FR.PEER",if:[]}]},dmm_co_jp:{match:{root_urls:["dmm.co.jp"],rules:[{proxy_country:["JP"],cmds:[{hosts:["www.dmm.co.jp"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["www.dmm.co.jp"],then:"PROXY JP.PEER",if:[]}]},dmm_com:{match:{root_urls:["dmm.com"],rules:[{proxy_country:["JP"],cmds:[{hosts:["www.dmm.com","tv.dmm.com","str.dmm.com"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["www.dmm.com","tv.dmm.com","str.dmm.com"],then:"PROXY JP.PEER",if:[]}]},prefettura_it:{match:{root_urls:["prefettura.it"],rules:[{proxy_country:["IT"],cmds:[{hosts:["prefettura.it"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]}]},cmds:[{hosts:["prefettura.it"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},my_alldata_com:{match:{root_urls:["my.alldata.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["my.alldata.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["my.alldata.com"],then:"PROXY US.PEER",if:[]}]},realauction_com:{match:{root_urls:["realauction.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["realauction.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["realauction.com"],then:"PROXY US.PEER",if:[]}]},adams_sheriffsaleauction_ohio_gov:{match:{root_urls:["adams.sheriffsaleauction.ohio.gov"],rules:[{proxy_country:["US"],cmds:[{hosts:["adams.sheriffsaleauction.ohio.gov"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["adams.sheriffsaleauction.ohio.gov"],then:"PROXY US.PEER",if:[]}]},realforeclose_com:{match:{root_urls:["realforeclose.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["realforeclose.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["realforeclose.com"],then:"PROXY US.PEER",if:[]}]},safer_fmcsa_dot_gov:{match:{root_urls:["safer.fmcsa.dot.gov"],rules:[{proxy_country:["US"],cmds:[{hosts:["safer.fmcsa.dot.gov"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["safer.fmcsa.dot.gov"],then:"PROXY US.PEER",if:[]}]},p_bandai_jp:{match:{root_urls:["p-bandai.jp"],rules:[{proxy_country:["JP"],cmds:[{hosts:["p-bandai.jp"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["p-bandai.jp"],then:"PROXY JP.PEER",if:[]}]},lemino_docomo_ne_jp:{match:{root_urls:["lemino.docomo.ne.jp"],rules:[{proxy_country:["JP"],cmds:[{hosts:["lemino.docomo.ne.jp"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["lemino.docomo.ne.jp"],then:"PROXY JP.PEER",if:[]}]},gapcanada_ca:{match:{root_urls:["gapcanada.ca"],rules:[{proxy_country:["CA"],cmds:[{hosts:["gapcanada.ca"],then:"PROXY CA.PEER",if:[]}]}]},cmds:[{hosts:["gapcanada.ca"],then:"PROXY CA.PEER",if:[]}]},chzzk_naver_com:{match:{root_urls:["chzzk.naver.com"],rules:[{proxy_country:["KR"],cmds:[{hosts:["chzzk.naver.com","livecloud.pstatic.net"],then:"PROXY KR.PEER",if:[]}]}]},cmds:[{hosts:["chzzk.naver.com","livecloud.pstatic.net"],then:"PROXY KR.PEER",if:[]}]},petsmart_com:{match:{root_urls:["petsmart.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["petsmart.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["petsmart.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},novasports_gr:{match:{root_urls:["novasports.gr"],rules:[{proxy_country:["GR"],cmds:[{hosts:["online.novasports.gr"],then:"PROXY GR.PEER",if:[]}]}]},cmds:[{hosts:["online.novasports.gr"],then:"PROXY GR.PEER",if:[]}]},albumartexchange_com:{match:{root_urls:["albumartexchange.com"],rules:[{proxy_country:["JP","ES","GB"],cmds:[{hosts:["albumartexchange.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["albumartexchange.com"],then:"PROXY XX.PEER",if:[]}]},cablevisionflow_com_ar:{match:{root_urls:["cablevisionflow.com.ar"],rules:[{proxy_country:["AR"],cmds:[{hosts:["cablevisionflow.com.ar"],then:"PROXY AR.PEER",if:[]}]}]},cmds:[{hosts:["cablevisionflow.com.ar"],then:"PROXY AR.PEER",if:[]}]},flow_com_ar:{match:{root_urls:["flow.com.ar"],rules:[{proxy_country:["AR"],cmds:[{hosts:["flow.com.ar"],then:"PROXY AR.PEER",if:[]}]}]},cmds:[{hosts:["flow.com.ar"],then:"PROXY AR.PEER",if:[]}]},outback_sylt_de:{match:{root_urls:["outback-sylt.de","outbacksylt.com"],rules:[{proxy_country:["DE"],cmds:[{hosts:["outbacksylt.com"],then:"PROXY DE.PEER",if:[]}]}]},cmds:[{hosts:["outbacksylt.com"],then:"PROXY DE.PEER",if:[]}]},tjx_com:{match:{root_urls:["tjx.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["tjx.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["tjx.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},qvc_com:{match:{root_urls:["qvc.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["qvc.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["qvc.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},gapfactory_com:{match:{root_urls:["gapfactory.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["gapfactory.com","api.gap.com","assets-gap.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["gapfactory.com","api.gap.com","assets-gap.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},rsi_ch:{match:{root_urls:["rsi.ch"],rules:[{proxy_country:["CH"],cmds:[{hosts:["srg.live.ott.irdeto.com"],then:"PROXY CH.PEER",if:[]}]}]},cmds:[{hosts:["srg.live.ott.irdeto.com"],then:"PROXY CH.PEER",if:[]}]},rts_ch:{match:{root_urls:["rts.ch"],rules:[{proxy_country:["CH"],cmds:[{hosts:["srg.live.ott.irdeto.com"],then:"PROXY CH.PEER",if:[]}]}]},cmds:[{hosts:["srg.live.ott.irdeto.com"],then:"PROXY CH.PEER",if:[]}]},srf_ch:{match:{root_urls:["srf.ch"],rules:[{proxy_country:["CH"],cmds:[{hosts:["srg.live.ott.irdeto.com"],then:"PROXY CH.PEER",if:[]}]}]},cmds:[{hosts:["srg.live.ott.irdeto.com"],then:"PROXY CH.PEER",if:[]}]},premierplayer_tv:{match:{root_urls:["premierplayer.tv"],rules:[{proxy_country:["GB"],cmds:[{hosts:["www.premierplayer.tv","live.247cdn.net","b.247cdn.net","ondemand.247cdn.net"],then:"PROXY GB.PEER",if:[]},{root_urls:["premierplayer.tv"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{hosts:["www.premierplayer.tv","live.247cdn.net","b.247cdn.net","ondemand.247cdn.net"],then:"PROXY GB.PEER",if:[]},{root_urls:["premierplayer.tv"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},mtv_ca:{match:{root_urls:["mtv.ca"],rules:[{proxy_country:["CA"],cmds:[{root_urls:["mtv.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["capi.9c9media.com"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]}]},cmds:[{root_urls:["mtv.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["capi.9c9media.com"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]},radiko_jp:{match:{root_urls:["radiko.jp"],rules:[{proxy_country:["JP"],cmds:[{hosts:["radiko.jp"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["radiko.jp"],then:"PROXY JP.PEER",if:[]}]},tver_jp:{match:{root_urls:["tver.jp"],rules:[{proxy_country:["JP"],cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY JP"}],then:"PROXY JP.PEER"}]}]},cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY JP"}],then:"PROXY JP.PEER"}]},allotalk_com:{match:{root_urls:["allotalk.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["allotalk.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["allotalk.com"],then:"PROXY US.PEER",if:[]}]},williamhill_com:{match:{root_urls:["williamhill.com"],rules:[{proxy_country:["GB"],cmds:[{hosts:["williamhill.com"],then:"PROXY GB.PEER",if:[]}]}]},cmds:[{hosts:["williamhill.com"],then:"PROXY GB.PEER",if:[]}]},joyn_de:{match:{root_urls:["joyn.de"],rules:[{proxy_country:["DE"],cmds:[{hosts:["api.joyn.de","auth.joyn.de"],then:"PROXY DE.PEER",if:[]}]}]},cmds:[{hosts:["api.joyn.de","auth.joyn.de"],then:"PROXY DE.PEER",if:[]}]},_13tv_co_il:{match:{root_urls:["13tv.co.il"],rules:[{proxy_country:["IL"],cmds:[{hosts:["log.advsnx.net","banners.advsnx.net","pagead2.googlesyndication.com","www.google-analytics.com","securepubads.g.doubleclick.net","taboola.com","secure.adnx.com","adnxs.com"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["log.advsnx.net","banners.advsnx.net","pagead2.googlesyndication.com","www.google-analytics.com","securepubads.g.doubleclick.net","taboola.com","secure.adnx.com","adnxs.com"],then:"DIRECT",if:[]}]},abema_tv:{match:{root_urls:["abema.tv"],rules:[{proxy_country:["JP"],cmds:[{hosts:["abema.tv"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["abema.tv"],then:"PROXY JP.PEER",if:[]}]},canal_plus_com:{match:{root_urls:["canal-plus.com"],rules:[{proxy_country:["FR"],cmds:[{root_urls:["canal-plus.com"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]}]},cmds:[{root_urls:["canal-plus.com"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]},zalando_fr:{match:{root_urls:["zalando.fr"],rules:[{proxy_country:["FR"],cmds:[{root_urls:["zalando.fr"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]}]},cmds:[{root_urls:["zalando.fr"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]},mewatch_sg:{match:{root_urls:["mewatch.sg"],rules:[{proxy_country:["SG"],cmds:[{hosts:["tvpapi-as.ott.kaltura.com","www.mewatch.sg","player-mc.sgp2.ott.kaltura.com","cdn.mewatch.sg"],then:"PROXY SG.PEER",if:[]}]}]},cmds:[{hosts:["tvpapi-as.ott.kaltura.com","www.mewatch.sg","player-mc.sgp2.ott.kaltura.com","cdn.mewatch.sg"],then:"PROXY SG.PEER",if:[]}]},_007song_co_kr:{match:{root_urls:["007song.co.kr"],rules:[{proxy_country:["KR"],cmds:[{hosts:["007song.co.kr"],then:"PROXY KR.PEER",if:[]}]}]},cmds:[{hosts:["007song.co.kr"],then:"PROXY KR.PEER",if:[]}]},yahoo_co_jp:{match:{root_urls:["yahoo.co.jp"],rules:[{proxy_country:["JP"],cmds:[{root_urls:["yahoo.co.jp"],then:"PROXY JP",if:[]},{hosts:["gyao.yahoo.co.jp"],if:[{url:".*gyao\\.yahoo\\.co\\.jp\\/apis\\/playback\\/graphql",type:"!~",then:"PROXY JP.PEER"}],then:"PROXY JP.PEER"}]}]},cmds:[{root_urls:["yahoo.co.jp"],then:"PROXY JP",if:[]},{hosts:["gyao.yahoo.co.jp"],if:[{url:".*gyao\\.yahoo\\.co\\.jp\\/apis\\/playback\\/graphql",type:"!~",then:"PROXY JP.PEER"}],then:"PROXY JP.PEER"}]},peacocktv_com:{match:{root_urls:["peacocktv.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["peacocktv.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{hosts:["ovp.peacocktv.com","geolocation.onetrust.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{root_urls:["peacocktv.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{hosts:["ovp.peacocktv.com","geolocation.onetrust.com"],then:"PROXY US.PEER",if:[]}]},snipesusa_com:{match:{root_urls:["snipesusa.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["snipesusa.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{root_urls:["snipesusa.com"],then:"PROXY US.PEER",if:[]}]},vtmgo_be:{match:{root_urls:["vtmgo.be"],rules:[{proxy_country:["BE"],cmds:[{hosts:["videoplayer-service.dpgmedia.net"],then:"PROXY BE.PEER",if:[]}]}]},cmds:[{hosts:["videoplayer-service.dpgmedia.net"],then:"PROXY BE.PEER",if:[]}]},nordstromrack_com:{match:{root_urls:["nordstromrack.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["nordstromrack.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["nordstromrack.com"],then:"PROXY US.PEER",if:[]}]},nowtv_com:{match:{root_urls:["nowtv.com"],rules:[{proxy_country:["GB"],cmds:[{hosts:["nowtv.com","ottsas.sky.com","persona-store.sky.com","agg.oogwayintl.sky.com","auth.client.ott.sky.com","p.sky.com","cdn.skycdp.com"],then:"PROXY GB.PEER",if:[]}]}]},cmds:[{hosts:["nowtv.com","ottsas.sky.com","persona-store.sky.com","agg.oogwayintl.sky.com","auth.client.ott.sky.com","p.sky.com","cdn.skycdp.com"],then:"PROXY GB.PEER",if:[]}]},ehealthinsurance_com:{match:{root_urls:["ehealthinsurance.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["ehealthinsurance.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["ehealthinsurance.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},swansonvitamins_com:{match:{root_urls:["swansonvitamins.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["swansonvitamins.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["swansonvitamins.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},walgreens_com:{match:{root_urls:["walgreens.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["walgreens.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["walgreens.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},qmee_com:{match:{root_urls:["qmee.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["qmee.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["qmee.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},ctv_ca:{match:{root_urls:["ctv.ca"],rules:[{proxy_country:["CA"],cmds:[{root_urls:["ctv.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["capi.9c9media.com"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["account.bellmedia.ca"],then:"PROXY CA.PEER",if:[]}]}]},cmds:[{root_urls:["ctv.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["capi.9c9media.com"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["account.bellmedia.ca"],then:"PROXY CA.PEER",if:[]}]},foodnetwork_ca:{match:{root_urls:["foodnetwork.ca"],rules:[{proxy_country:["CA"],cmds:[{root_urls:["foodnetwork.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]}]},cmds:[{root_urls:["foodnetwork.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]},b2byellowpages_com:{match:{root_urls:["b2byellowpages.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["b2byellowpages.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{root_urls:["b2byellowpages.com"],then:"PROXY US.PEER",if:[]}]},engclip_com:{match:{root_urls:["engclip.com"],rules:[{proxy_country:["IN"],cmds:[{root_urls:["engclip.com"],then:"PROXY IN",if:[]},{hosts:["proxy-32.sg1.dailymotion.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]}]},cmds:[{root_urls:["engclip.com"],then:"PROXY IN",if:[]},{hosts:["proxy-32.sg1.dailymotion.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},footpatrol_co_uk:{match:{root_urls:["footpatrol.co.uk","footpatrol.com"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["footpatrol.co.uk","footpatrol.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["footpatrol.co.uk","footpatrol.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},jdsports_co_uk:{match:{root_urls:["jdsports.co.uk"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["jdsports.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["jdsports.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},size_co_uk:{match:{root_urls:["size.co.uk"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["size.co.uk"],then:"PROXY GB.PEER",if:[]}]}]},cmds:[{root_urls:["size.co.uk"],then:"PROXY GB.PEER",if:[]}]},tui_co_uk:{match:{root_urls:["tui.co.uk"],rules:[{proxy_country:["GB"],cmds:[{hosts:["tui.co.uk"],then:"PROXY GB.PEER",if:[]}]}]},cmds:[{hosts:["tui.co.uk"],then:"PROXY GB.PEER",if:[]}]},blutv_com:{match:{root_urls:["blutv.com"],rules:[{proxy_country:["TR"],cmds:[{hosts:["blutv.com"],then:"PROXY TR.PEER",if:[]}]}]},cmds:[{hosts:["blutv.com"],then:"PROXY TR.PEER",if:[]}]},garena_com:{match:{root_urls:["garena.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["garena.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["garena.com"],then:"PROXY US.PEER",if:[]}]},offerup_com:{match:{root_urls:["offerup.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["offerup.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["offerup.com"],then:"PROXY US.PEER",if:[]}]},mugenarchive_com:{match:{root_urls:["mugenarchive.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["mugenarchive.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["mugenarchive.com"],then:"PROXY US.PEER",if:[]}]},lostfilm_tv:{match:{root_urls:["lostfilm.tv"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY BR.POOL_lum_br_shared"}]}]},cmds:[{root_urls:["lostfilm.tv"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},prende_tv:{match:{root_urls:["lostfilm.tv"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY BR.POOL_lum_br_shared"}]}]},cmds:[{root_urls:["lostfilm.tv"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},realtaxdeed_com:{match:{root_urls:["realtaxdeed.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["realtaxdeed.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["realtaxdeed.com"],then:"PROXY US.PEER",if:[]}]},homify_com:{match:{root_urls:["homify.com"],rules:[{cmds:[{hosts:["homify.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["homify.com"],then:"PROXY XX.PEER",if:[]}]},country_rule:{client_only:true,match:{min_ver:"1.170.260",root_urls:[""],rules:[{proxy_country:["KR"],cmds:[{proxy_country:["KR"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]}]},cmds:[{proxy_country:["KR"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]},sotostore_com:{match:{root_urls:["sotostore.com"],rules:[{proxy_country:["DE"],cmds:[{hosts:["www.sotostore.com"],then:"PROXY DE.PEER",if:[]}]}]},cmds:[{hosts:["www.sotostore.com"],then:"PROXY DE.PEER",if:[]}]},foxtel_com_au:{match:{root_urls:["foxtel.com.au"],rules:[{proxy_country:["AU"],cmds:[{hosts:["foxtel.com.au"],then:"PROXY AU.PEER",if:[]}]}]},cmds:[{hosts:["foxtel.com.au"],then:"PROXY AU.PEER",if:[]}]},indavideo_hu:{match:{root_urls:["indavideo.hu"],rules:[{proxy_country:["HU"],cmds:[{hosts:["embed.indavideo.hu"],then:"PROXY HU.PEER",if:[]}]}]},cmds:[{hosts:["embed.indavideo.hu"],then:"PROXY HU.PEER",if:[]}]},vroom_com:{match:{root_urls:["vroom.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["vroom.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["vroom.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},pontofrio_com_br:{match:{root_urls:["pontofrio.com.br"],rules:[{proxy_country:["BR"],cmds:[{root_urls:["pontofrio.com.br"],then:"PROXY BR.POOL_lum_br_shared",if:[]},{hosts:["imgs.ponto.com.br","imgs.pontofrio.com.br","pontofrio-imagens.com.br"],then:"PROXY BR.PEER",if:[]}]}]},cmds:[{root_urls:["pontofrio.com.br"],then:"PROXY BR.POOL_lum_br_shared",if:[]},{hosts:["imgs.ponto.com.br","imgs.pontofrio.com.br","pontofrio-imagens.com.br"],then:"PROXY BR.PEER",if:[]}]},marshalls_com:{match:{root_urls:["marshalls.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["marshalls.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["marshalls.com"],then:"PROXY US.PEER",if:[]}]},dplay_co_uk:{match:{root_urls:["dplay.co.uk"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["dplay.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["dplay.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},atresplayer_com:{match:{root_urls:["atresplayer.com"],rules:[{proxy_country:["ES"],cmds:[{root_urls:["atresplayer.com"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["api.atresplayer.com","directo.atresmedia.com","atres-live.atresmedia.com"],then:"PROXY ES.PEER",if:[]}]}]},cmds:[{root_urls:["atresplayer.com"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["api.atresplayer.com","directo.atresmedia.com","atres-live.atresmedia.com"],then:"PROXY ES.PEER",if:[]}]},footlocker_co_uk:{match:{root_urls:["footlocker.co.uk"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["footlocker.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["footlocker.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},pxg_co_kr:{match:{root_urls:["pxg.co.kr"],rules:[{proxy_country:["US"],cmds:[{root_urls:["pxg.co.kr"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["pxg.co.kr"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},udemy_com:{match:{root_urls:["udemy.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["stripe.com"],then:"DIRECT",if:[]},{root_urls:["udemy.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},{proxy_country:["AR"],cmds:[{hosts:["stripe.com"],then:"DIRECT"}]},{proxy_country:["DE"],cmds:[{hosts:["stripe.com"],then:"DIRECT"}]}]},cmds:[{hosts:["stripe.com"],then:"DIRECT",if:[]},{root_urls:["udemy.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},gamovideo_com:{match:{root_urls:["gamovideo.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["gamovideo.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["gamovideo.com"],then:"PROXY US.PEER",if:[]}]},yellowpages_com:{match:{root_urls:["yellowpages.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["yellowpages.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["yellowpages.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},lawyers_com:{match:{root_urls:["lawyers.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["lawyers.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["lawyers.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},filmizlesene_pro:{match:{root_urls:["filmizlesene.pro"],rules:[{proxy_country:["TR"],cmds:[{hosts:["filmizlesene.pro","film.popcornvakti.net","molystream.net","94194215.xyz","32933054.xyz","92792817.xyz","50250338.xyz","15815990.xyz","20620748.xyz","73773887.xyz","86186297.xyz","21121243.xyz","54754838.xyz","34034151.xyz","78378442.xyz","13113291.xyz","87187299.xyz","22422544.xyz","29229392.xyz","76476541.xyz","74975080.xyz","34334451.xyz","13113292.xyz","42742864.xyz","60360478.xyz","29329494.xyz","71071180.xyz","59059178.xyz","51251338.xyz","56056176.xyz","10410597.xyz","64864974.xyz","74074187.xyz","30330450.xyz","27827995.xyz","14414593.xyz","72672785.xyz","40941062.xyz","30230352.xyz","25425592.xyz","52852931.xyz","76376440.xyz","20020192.xyz","58658770.xyz","26226395.xyz","10310490.xyz","41041165.xyz","20120240.xyz","18718897.xyz","77677745.xyz","41041161.xyz","76476542.xyz","79479542.xyz"],then:"PROXY TR.PEER",if:[]}]}]},cmds:[{hosts:["filmizlesene.pro","film.popcornvakti.net","molystream.net","94194215.xyz","32933054.xyz","92792817.xyz","50250338.xyz","15815990.xyz","20620748.xyz","73773887.xyz","86186297.xyz","21121243.xyz","54754838.xyz","34034151.xyz","78378442.xyz","13113291.xyz","87187299.xyz","22422544.xyz","29229392.xyz","76476541.xyz","74975080.xyz","34334451.xyz","13113292.xyz","42742864.xyz","60360478.xyz","29329494.xyz","71071180.xyz","59059178.xyz","51251338.xyz","56056176.xyz","10410597.xyz","64864974.xyz","74074187.xyz","30330450.xyz","27827995.xyz","14414593.xyz","72672785.xyz","40941062.xyz","30230352.xyz","25425592.xyz","52852931.xyz","76376440.xyz","20020192.xyz","58658770.xyz","26226395.xyz","10310490.xyz","41041165.xyz","20120240.xyz","18718897.xyz","77677745.xyz","41041161.xyz","76476542.xyz","79479542.xyz"],then:"PROXY TR.PEER",if:[]}]},dizibox_pw:{match:{root_urls:["dizibox.pw"],rules:[{proxy_country:["US"],cmds:[{hosts:["dizibox.pw"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["dizibox.pw"],then:"PROXY US.PEER",if:[]}]},skynews_com_au:{match:{root_urls:["skynews.com.au"],rules:[{proxy_country:["AU"],cmds:[{hosts:["www.skynews.com.au"],then:"PROXY AU.PEER",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY AU"}],then:"PROXY AU.PEER"}]}]},cmds:[{hosts:["www.skynews.com.au"],then:"PROXY AU.PEER",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY AU"}],then:"PROXY AU.PEER"}]},sbt_com_br:{match:{root_urls:["sbt.com.br"],rules:[{proxy_country:["BR"],cmds:[{hosts:["sbt.com.br"],then:"PROXY BR.PEER",if:[]}]}]},cmds:[{hosts:["sbt.com.br"],then:"PROXY BR.PEER",if:[]}]},bfi_org_uk:{match:{root_urls:["bfi.org.uk"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["bfi.org.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["bfi.org.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},ocs_fr:{match:{root_urls:["ocs.fr"],rules:[{proxy_country:["FR"],cmds:[{root_urls:["ocs.fr"],then:"PROXY FR.PEER",if:[]},{hosts:["www.ocs.fr","statics.ocs.fr","api.ocs.fr"],then:"PROXY FR.PEER",if:[]}]}]},cmds:[{root_urls:["ocs.fr"],then:"PROXY FR.PEER",if:[]},{hosts:["www.ocs.fr","statics.ocs.fr","api.ocs.fr"],then:"PROXY FR.PEER",if:[]}]},line_me:{match:{root_urls:["line.me"],rules:[{cmds:[{proxy_country:["TW"],hosts:["line.me"],then:"PROXY TW.PEER",if:[]}]}]},cmds:[{proxy_country:["TW"],hosts:["line.me"],then:"PROXY TW.PEER",if:[]}]},cbc_ca:{match:{root_urls:["cbc.ca"],rules:[{proxy_country:["CA"],cmds:[{root_urls:["cbc.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]}]},cmds:[{root_urls:["cbc.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]},tving_com:{match:{root_urls:["tving.com"],rules:[{proxy_country:["KR"],cmds:[{root_urls:["tving.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]},{hosts:["api.tving.com"],then:"PROXY KR.PEER",if:[]}]}]},cmds:[{root_urls:["tving.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]},{hosts:["api.tving.com"],then:"PROXY KR.PEER",if:[]}]},afreecatv_com:{match:{root_urls:["afreecatv.com"],rules:[{proxy_country:["KR"],cmds:[{hosts:["pc-web.stream.afreecatv.com"],then:"PROXY KR.PEER",if:[]},{hosts:["afreecatv.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]}]},cmds:[{hosts:["pc-web.stream.afreecatv.com"],then:"PROXY KR.PEER",if:[]},{hosts:["afreecatv.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]},vlive_tv:{match:{root_urls:["vlive.tv"],rules:[{proxy_country:["KR"],cmds:[{root_urls:["vlive.tv"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]}]},cmds:[{root_urls:["vlive.tv"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]},viki_com:{match:{root_urls:["viki.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["viki.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["1.viki.io"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["viki.com"],then:"PROXY CA.POOL_lum_ca_shared"},{hosts:["1.viki.io"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["viki.com"],then:"PROXY GB.POOL_lum_gb_shared"},{hosts:["1.viki.io"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["viki.com"],then:"PROXY NL.POOL_lum_nl_shared"},{hosts:["1.viki.io"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["viki.com"],then:"PROXY FR.POOL_lum_fr_shared"},{hosts:["1.viki.io"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["viki.com"],then:"PROXY ES.POOL_lum_es_shared"},{hosts:["1.viki.io"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["viki.com"],then:"PROXY US.POOL_lum_us_shared"},{hosts:["1.viki.io"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["viki.com"],then:"PROXY KR.POOL_lum_kr_shared"},{hosts:["1.viki.io"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["viki.com"],then:"PROXY BR.POOL_lum_br_shared"},{hosts:["1.viki.io"],then:"PROXY BR.POOL_lum_br_shared"}]}]},cmds:[{root_urls:["viki.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["1.viki.io"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},ruliweb_com:{match:{root_urls:["ruliweb.com"],rules:[{proxy_country:["KR"],cmds:[{root_urls:["ruliweb.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]}]},cmds:[{root_urls:["ruliweb.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]},nexon_com:{match:{root_urls:["nexon.com"],rules:[{proxy_country:["KR"],cmds:[{root_urls:["nexon.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]}]},cmds:[{root_urls:["nexon.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]},dcinside_com:{match:{root_urls:["dcinside.com"],rules:[{proxy_country:["KR"],cmds:[{root_urls:["dcinside.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]}]},cmds:[{root_urls:["dcinside.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]},licindia_in:{match:{root_urls:["licindia.in"],rules:[{proxy_country:["IN"],cmds:[{root_urls:["licindia_in"],then:"PROXY IN",if:[]}]}]},cmds:[{root_urls:["licindia_in"],then:"PROXY IN",if:[]}]},yupptv_com:{match:{root_urls:["yupptv.com"],rules:[{proxy_country:["IN"],cmds:[{hosts:["www.yupptv.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]}]},cmds:[{hosts:["www.yupptv.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},lenskart_com:{match:{root_urls:["lenskart.com"],rules:[{proxy_country:["IN"],cmds:[{hosts:["lenskart.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]}]},cmds:[{hosts:["lenskart.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},sunnxt_com:{match:{root_urls:["sunnxt.com"],rules:[{proxy_country:["IN"],cmds:[{root_urls:["sunnxt.com"],then:"PROXY IN",if:[]}]}]},cmds:[{root_urls:["sunnxt.com"],then:"PROXY IN",if:[]}]},primevideo_com:{match:{root_urls:["primevideo.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["primevideo.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["GB"],cmds:[{root_urls:["primevideo.com"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["primevideo.com"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["primevideo.com"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["primevideo.com"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["primevideo.com"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["primevideo.com"],then:"PROXY BR.POOL_lum_br_shared"}]},{proxy_country:["IN"],cmds:[{root_urls:["primevideo.com"],then:"PROXY IN.POOL_lum_in_shared"}]},{proxy_country:["AR","AT","AU","BE","BG","CA","CH","CL","CO","CZ","DE","DK","ES","FI","GR","HK","HR","HU","ID","IE","IL","IS","JP","MX","NO","NZ","PL","RO","RU","SE","SG","SK","TR","NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA"],cmds:[{hosts:["atv-ps-eu.primevideo.com","primevideo.com","api.eu-west-1.aiv-delivery.net"],then:"PROXY XX.PEER"}]}]},cmds:[{root_urls:["primevideo.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},zee5_com:{match:{root_urls:["zee5.com"],rules:[{proxy_country:["IN"],cmds:[{hosts:["zee5.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]}]},cmds:[{hosts:["zee5.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},voot_com:{match:{root_urls:["voot.com"],rules:[{proxy_country:["IN"],cmds:[{root_urls:["voot.com"],if:[{host:"(?:google-analytics\\.com|analytics\\.twitter\\.com|googleadservices\\.com|p\\.adsymptotic\\.com|googletagmanager\\.com|bat\\.bing\\.com|adservice\\.google\\.com|doubleclick\\.net|gstatic\\.com|googlesyndication\\.com|2mdn\\.net|q\\.quora\\.com|analytics\\.edgekey\\.net|amazon-adsystem\\.com|users\\.quantumgraph\\.com|images-na\\.ssl-images-amazon\\.com|bh\\.contextweb\\.com|pixel-sync\\.sitescout\\.com|ads-twitter\\.com|googletagservices\\.com|scorecardresearch\\.com|outbrain\\.com|cdnjs\\.cloudflare\\.com|adservice\\.google\\.com\\.pk|adservice\\.google\\.com\\.ph|adroll\\.com|analytics\\.yahoo\\.com|spl\\.zeotap\\.com|a-ads\\.com|google\\.com|google\\.co\\.in|facebook\\.com|facebook\\.net|t\\.co|rubiconproject\\.com|google\\.com\\.bd|mixpanel\\.com|go-mpulse\\.net|google\\.com\\.au|googleapis\\.com)$",type:"=~",then:"PROXY XX"}],then:"PROXY IN.POOL_lum_in_shared"}]}]},cmds:[{root_urls:["voot.com"],if:[{host:"(?:google-analytics\\.com|analytics\\.twitter\\.com|googleadservices\\.com|p\\.adsymptotic\\.com|googletagmanager\\.com|bat\\.bing\\.com|adservice\\.google\\.com|doubleclick\\.net|gstatic\\.com|googlesyndication\\.com|2mdn\\.net|q\\.quora\\.com|analytics\\.edgekey\\.net|amazon-adsystem\\.com|users\\.quantumgraph\\.com|images-na\\.ssl-images-amazon\\.com|bh\\.contextweb\\.com|pixel-sync\\.sitescout\\.com|ads-twitter\\.com|googletagservices\\.com|scorecardresearch\\.com|outbrain\\.com|cdnjs\\.cloudflare\\.com|adservice\\.google\\.com\\.pk|adservice\\.google\\.com\\.ph|adroll\\.com|analytics\\.yahoo\\.com|spl\\.zeotap\\.com|a-ads\\.com|google\\.com|google\\.co\\.in|facebook\\.com|facebook\\.net|t\\.co|rubiconproject\\.com|google\\.com\\.bd|mixpanel\\.com|go-mpulse\\.net|google\\.com\\.au|googleapis\\.com)$",type:"=~",then:"PROXY XX"}],then:"PROXY IN.POOL_lum_in_shared"}]},mxplayer_in:{match:{root_urls:["mxplayer.in"],rules:[{proxy_country:["IN"],cmds:[{root_urls:["mxplayer.in"],if:[{host:"(?:google-analytics\\.com|analytics\\.twitter\\.com|googleadservices\\.com|p\\.adsymptotic\\.com|googletagmanager\\.com|bat\\.bing\\.com|adservice\\.google\\.com|doubleclick\\.net|gstatic\\.com|googlesyndication\\.com|2mdn\\.net|q\\.quora\\.com|analytics\\.edgekey\\.net|amazon-adsystem\\.com|users\\.quantumgraph\\.com|images-na\\.ssl-images-amazon\\.com|bh\\.contextweb\\.com|pixel-sync\\.sitescout\\.com|ads-twitter\\.com|googletagservices\\.com|scorecardresearch\\.com|outbrain\\.com|cdnjs\\.cloudflare\\.com|adservice\\.google\\.com\\.pk|adservice\\.google\\.com\\.ph|adroll\\.com|analytics\\.yahoo\\.com|spl\\.zeotap\\.com|a-ads\\.com|google\\.com|google\\.co\\.in|facebook\\.com|facebook\\.net|t\\.co|rubiconproject\\.com|google\\.com\\.bd|mixpanel\\.com|go-mpulse\\.net|google\\.com\\.au|googleapis\\.com)$",type:"=~",then:"PROXY XX"}],then:"PROXY IN.POOL_lum_in_shared"}]}]},cmds:[{root_urls:["mxplayer.in"],if:[{host:"(?:google-analytics\\.com|analytics\\.twitter\\.com|googleadservices\\.com|p\\.adsymptotic\\.com|googletagmanager\\.com|bat\\.bing\\.com|adservice\\.google\\.com|doubleclick\\.net|gstatic\\.com|googlesyndication\\.com|2mdn\\.net|q\\.quora\\.com|analytics\\.edgekey\\.net|amazon-adsystem\\.com|users\\.quantumgraph\\.com|images-na\\.ssl-images-amazon\\.com|bh\\.contextweb\\.com|pixel-sync\\.sitescout\\.com|ads-twitter\\.com|googletagservices\\.com|scorecardresearch\\.com|outbrain\\.com|cdnjs\\.cloudflare\\.com|adservice\\.google\\.com\\.pk|adservice\\.google\\.com\\.ph|adroll\\.com|analytics\\.yahoo\\.com|spl\\.zeotap\\.com|a-ads\\.com|google\\.com|google\\.co\\.in|facebook\\.com|facebook\\.net|t\\.co|rubiconproject\\.com|google\\.com\\.bd|mixpanel\\.com|go-mpulse\\.net|google\\.com\\.au|googleapis\\.com)$",type:"=~",then:"PROXY XX"}],then:"PROXY IN.POOL_lum_in_shared"}]},huurwoningen_nl:{match:{root_urls:["huurwoningen.nl"],rules:[{proxy_country:["NL"],cmds:[{root_urls:["huurwoningen.nl"],then:"PROXY NL.POOL_lum_nl_shared",if:[]}]}]},cmds:[{root_urls:["huurwoningen.nl"],then:"PROXY NL.POOL_lum_nl_shared",if:[]}]},videoland_com:{match:{root_urls:["videoland.com","v2.videoland.com"],rules:[{proxy_country:["NL"],cmds:[{hosts:["videoland.bedrock.tech","videoland.com"],then:"PROXY NL.PEER",if:[]}]}]},cmds:[{hosts:["videoland.bedrock.tech","videoland.com"],then:"PROXY NL.PEER",if:[]}]},nos_nl:{match:{root_urls:["nos.nl"],rules:[{proxy_country:["NL"],cmds:[{root_urls:["nos.nl"],then:"PROXY NL.POOL_lum_nl_shared",if:[]},{hosts:["resolver.streaming.api.nos.nl","cdn.streamgate.nl"],then:"PROXY NL.PEER",if:[]},{hosts:["npo.nl","npostreaming.nl"],then:"PROXY NL.POOL_lum_nl_shared",if:[]}]}]},cmds:[{root_urls:["nos.nl"],then:"PROXY NL.POOL_lum_nl_shared",if:[]},{hosts:["resolver.streaming.api.nos.nl","cdn.streamgate.nl"],then:"PROXY NL.PEER",if:[]},{hosts:["npo.nl","npostreaming.nl"],then:"PROXY NL.POOL_lum_nl_shared",if:[]}]},kakao_com:{match:{root_urls:["kakao.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["kakao.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["kakao.com"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["kakao.com"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["kakao.com"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["kakao.com"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["kakao.com"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["kakao.com"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["kakao.com"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["kakao.com"],then:"PROXY BR.POOL_lum_br_shared"}]}]},cmds:[{root_urls:["kakao.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},npostart_nl:{match:{root_urls:["npostart.nl","npo.nl"],rules:[{proxy_country:["NL"],cmds:[{hosts:["npostart.nl","cdn.streamgate.nl","nepworldwide.nl","npo.prd.cdn.bcms.kpn.com","atconnect.npo.nl","start-player.npo.nl","tellerapi.npo.nl","prod.npoplayer.nl"],then:"PROXY NL.PEER",if:[]}]}]},cmds:[{hosts:["npostart.nl","cdn.streamgate.nl","nepworldwide.nl","npo.prd.cdn.bcms.kpn.com","atconnect.npo.nl","start-player.npo.nl","tellerapi.npo.nl","prod.npoplayer.nl"],then:"PROXY NL.PEER",if:[]}]},steampowered_com:{match:{root_urls:["steampowered.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["steampowered.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["steampowered.com"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["steampowered.com"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["steampowered.com"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["steampowered.com"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["steampowered.com"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["steampowered.com"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["steampowered.com"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["steampowered.com"],then:"PROXY BR.POOL_lum_br_shared"}]},{proxy_country:["NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA"],cmds:[{hosts:["steampowered.com","store.steampowered.com"],then:"PROXY XX.PEER"}]}]},cmds:[{root_urls:["steampowered.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},wormate_io:{match:{root_urls:["wormate.io"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["wormate.io"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["wormate.io"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["wormate.io"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["wormate.io"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["wormate.io"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["wormate.io"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["wormate.io"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["wormate.io"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["wormate.io"],then:"PROXY BR.POOL_lum_br_shared"}]}]},cmds:[{root_urls:["wormate.io"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},uol_com_br:{match:{root_urls:["uol.com.br"],rules:[{proxy_country:["BR"],cmds:[{root_urls:["uol.com.br"],then:"PROXY BR.POOL_lum_br_shared",if:[]}]}]},cmds:[{root_urls:["uol.com.br"],then:"PROXY BR.POOL_lum_br_shared",if:[]}]},metamask_io:{match:{root_urls:["metamask.io"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["metamask.io"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["metamask.io"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["metamask.io"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["metamask.io"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["metamask.io"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["metamask.io"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["metamask.io"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["metamask.io"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["metamask.io"],then:"PROXY BR.POOL_lum_br_shared"}]}]},cmds:[{root_urls:["metamask.io"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},globo_com:{match:{root_urls:["globo.com"],rules:[{proxy_country:["BR"],cmds:[{root_urls:["globo.com"],then:"PROXY BR.POOL_lum_br_shared",if:[]},{hosts:["video.globo.com"],then:"PROXY BR.PEER",if:[]}]}]},cmds:[{root_urls:["globo.com"],then:"PROXY BR.POOL_lum_br_shared",if:[]},{hosts:["video.globo.com"],then:"PROXY BR.PEER",if:[]}]},borderlands_com:{match:{root_urls:["borderlands.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["borderlands.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["borderlands.com"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["borderlands.com"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["borderlands.com"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["borderlands.com"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["borderlands.com"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["borderlands.com"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["borderlands.com"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["borderlands.com"],then:"PROXY BR.POOL_lum_br_shared"}]}]},cmds:[{root_urls:["borderlands.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},bet365_com:{match:{root_urls:["bet365.com"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["bet365.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},{proxy_country:["US"],cmds:[{root_urls:["bet365.com"],then:"PROXY US.POOL_lum_us_shared"}]}]},cmds:[{root_urls:["bet365.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},totalwine_com:{match:{root_urls:["totalwine.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["www.totalwine.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["www.totalwine.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},lasestrellas_tv:{match:{root_urls:["lasestrellas_tv"],rules:[{proxy_country:["MX"],cmds:[{hosts:["onlymex-auth.televisa.com"],then:"PROXY MX.PEER",if:[]}]}]},cmds:[{hosts:["onlymex-auth.televisa.com"],then:"PROXY MX.PEER",if:[]}]},criteo_com:{match:{root_urls:["criteo.com"],rules:[{cmds:[{hosts:["criteo.com"],then:"PROXY XX",if:[]}]}]},cmds:[{hosts:["criteo.com"],then:"PROXY XX",if:[]}]},target_com:{match:{root_urls:["target.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["gsp.target.com","login.target.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["gsp.target.com","login.target.com"],then:"PROXY US.PEER",if:[]}]},atv_at:{match:{root_urls:["atv.at"],rules:[{proxy_country:["AT"],cmds:[{hosts:["blocked-multiscreen.atv.cdn.tvnext.tv"],then:"PROXY AT.PEER",if:[]}]}]},cmds:[{hosts:["blocked-multiscreen.atv.cdn.tvnext.tv"],then:"PROXY AT.PEER",if:[]}]},williams_sonoma_com:{match:{root_urls:["williams-sonoma.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["williams-sonoma.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["williams-sonoma.com"],then:"PROXY US.PEER",if:[]}]},player_pl:{match:{root_urls:["player.pl"],rules:[{proxy_country:["PL"],cmds:[{hosts:["player.pl"],if:[{url:"\\/playerapi\\/product\\/.*\\/player\\/configuration.*",type:"!~",then:"PROXY PL"}],then:"PROXY PL.PEER"}]}]},cmds:[{hosts:["player.pl"],if:[{url:"\\/playerapi\\/product\\/.*\\/player\\/configuration.*",type:"!~",then:"PROXY PL"}],then:"PROXY PL.PEER"}]},bigbrothercanada_ca:{match:{root_urls:["bigbrothercanada.ca"],rules:[{proxy_country:["CA"],cmds:[{hosts:["livestream.com","playback.akamaized.net","playback2.akamaized.net","global.corusappservices.com","bigbrothercanada.ca"],then:"PROXY CA.PEER",if:[]}]}]},cmds:[{hosts:["livestream.com","playback.akamaized.net","playback2.akamaized.net","global.corusappservices.com","bigbrothercanada.ca"],then:"PROXY CA.PEER",if:[]}]},backcountry_com:{match:{root_urls:["backcountry.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["backcountry.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["backcountry.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},eclinicalweb_com:{match:{root_urls:["eclinicalweb.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["eclinicalweb.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{root_urls:["eclinicalweb.com"],then:"PROXY US.PEER",if:[]}]},sweetgreen_com:{match:{root_urls:["sweetgreen.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["sweetgreen.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["sweetgreen.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},carvana_com:{proxy_country:["US"],cmds:[{root_urls:["carvana.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},investopedia_com:{match:{root_urls:["investopedia.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["trafficguardapp.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["trafficguardapp.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},on_orf_at:{match:{root_urls:["orf.at","on.orf.at"],rules:[{proxy_country:["AT"],cmds:[{hosts:["sf.apa.at","mdn.ors.at","orf.at","bitmovin.com"],then:"PROXY AT.PEER",if:[]}]}]},cmds:[{hosts:["sf.apa.at","mdn.ors.at","orf.at","bitmovin.com"],then:"PROXY AT.PEER",if:[]}]},servustv_com:{match:{root_urls:["servustv.com"],rules:[{proxy_country:["AT"],cmds:[{hosts:["stv-live.akamaized.net","rbmn-live.akamaized.net"],then:"PROXY AT.PEER",if:[]}]}]},cmds:[{hosts:["stv-live.akamaized.net","rbmn-live.akamaized.net"],then:"PROXY AT.PEER",if:[]}]},mol_gov_sa:{match:{root_urls:["mol.gov.sa"],rules:[{proxy_country:["SA"],cmds:[{hosts:["mol.gov.sa"],then:"PROXY SA.PEER",if:[]}]}]},cmds:[{hosts:["mol.gov.sa"],then:"PROXY SA.PEER",if:[]}]},lsm_lv:{match:{root_urls:["lsm.lv"],rules:[{proxy_country:["LV"],cmds:[{hosts:["ltv.lsm.lv","embed.cloudycdn.services","ltv1060.cloudycdn.services","ltv2060.cloudycdn.services"],then:"PROXY LV.PEER",if:[]}]}]},cmds:[{hosts:["ltv.lsm.lv","embed.cloudycdn.services","ltv1060.cloudycdn.services","ltv2060.cloudycdn.services"],then:"PROXY LV.PEER",if:[]}]},eidf_co_kr:{match:{root_urls:["eidf.co.kr"],rules:[{proxy_country:["KR"],cmds:[{hosts:["www.eidf.co.kr"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]}]},cmds:[{hosts:["www.eidf.co.kr"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]},abercrombie_com:{proxy_country:["US"],cmds:[{root_urls:["abercrombie.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},amazon_com:{match:{root_urls:["amazon.com"],rules:[{proxy_country:["AU","CO","IT","CA","NL","FR","ES","US","KR","BR"],cmds:[{root_urls:["amazon.com"],if:[{host:"d2y5sgsy8bbmb8.cloudfront.net",type:"==",then:"PROXY US.PEER"},{host:"cloudfront\\.net$",type:"=~",then:"PROXY XX"}],then:"PROXY XX.PEER"},{hosts:["amazon-adsystem.com","images-na.ssl-images-amazon.com"],then:"PROXY XX",if:[]},{hosts:["amazon.com","api.amazonvideo.com","atv-ps.amazon.com","media-amazon.com","api.eu-west-1.aiv-delivery.net","a41avoddashs3ww-a.akamaihd.net","d2y5sgsy8bbmb8.cloudfront.net","api.us-east-1.aiv-delivery.net","merch.amazon.com","www.amazon.com"],then:"PROXY XX.PEER",if:[]}]}]}},amazon_co_uk:{match:{root_urls:["amazon.co.uk"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["amazon.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["amazon.com","api.amazonvideo.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["amazon.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["amazon.com","api.amazonvideo.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},amazon_de:{match:{root_urls:["amazon.de"],rules:[{proxy_country:["DE"],cmds:[{hosts:["www.amazon.de","atv-ps-eu.amazon.de"],then:"PROXY DE.PEER",if:[]}]}]},cmds:[{hosts:["www.amazon.de","atv-ps-eu.amazon.de"],then:"PROXY DE.PEER",if:[]}]},amazon_co_jp:{match:{root_urls:["amazon.co.jp"],rules:[{proxy_country:["JP"],cmds:[{hosts:["www.amazon.co.jp","atv-ps-fe.amazon.co.jp"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["www.amazon.co.jp","atv-ps-fe.amazon.co.jp"],then:"PROXY JP.PEER",if:[]}]},amazon_in:{match:{root_urls:["amazon.in"],rules:[{proxy_country:["IN"],cmds:[{hosts:["www.amazon.in"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]}]},cmds:[{hosts:["www.amazon.in"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},ondemandkorea_com:{proxy_country:["US"],cmds:[{root_urls:["ondemandkorea.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},champssports_com:{match:{root_urls:["champssports.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["champssports.com","captcha-delivery.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["champssports.com","captcha-delivery.com"],then:"PROXY US.PEER",if:[]}]},origin_com:{proxy_country:["US"],cmds:[{root_urls:["origin.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},disneyplus_com:{match:{root_urls:["disneyplus.com"],rules:[{proxy_country:["IT"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY IT.PEER",if:[]},{root_urls:["disneyplus.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY CA.PEER"},{root_urls:["disneyplus.com"],then:"PROXY CA.POOL_lum_ca_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY GB.PEER"},{root_urls:["disneyplus.com"],then:"PROXY GB.POOL_lum_gb_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY NL.PEER"},{root_urls:["disneyplus.com"],then:"PROXY NL.POOL_lum_nl_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY FR.PEER"},{root_urls:["disneyplus.com"],then:"PROXY FR.POOL_lum_fr_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY ES.PEER"},{root_urls:["disneyplus.com"],then:"PROXY ES.POOL_lum_es_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY US.PEER"},{root_urls:["disneyplus.com"],then:"PROXY US.POOL_lum_us_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["HK"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY HK.PEER"},{root_urls:["disneyplus.com"],then:"PROXY HK.PEER"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY HK.PEER"}]},{proxy_country:["KR"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY KR.PEER"},{root_urls:["disneyplus.com"],then:"PROXY KR.POOL_lum_kr_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY BR.PEER"},{root_urls:["disneyplus.com"],then:"PROXY BR.POOL_lum_br_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY BR.POOL_lum_br_shared"}]},{proxy_country:["JP"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY JP.PEER"},{root_urls:["disneyplus.com"],then:"PROXY JP.PEER"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY JP.PEER"}]},{proxy_country:["IN"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY IN.PEER"},{root_urls:["disneyplus.com"],then:"PROXY IN.POOL_lum_in_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY IN.POOL_lum_in_shared"}]},{proxy_country:["AU"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY AU.PEER"},{root_urls:["disneyplus.com"],then:"PROXY AU.POOL_lum_au_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY AU.POOL_lum_au_shared"}]},{proxy_country:["BO"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY BO.PEER"},{root_urls:["disneyplus.com"],then:"PROXY BO.PEER"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY BO.PEER"}]},{proxy_country:["NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY XX.PEER"},{root_urls:["disneyplus.com"],then:"PROXY XX.PEER"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY XX.PEER"}]}]}},hbonow_com:{match:{root_urls:["hbonow.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["comet.api.hbo.com","play.hbonow.com"],then:"PROXY US.PEER",if:[]},{root_urls:["hbonow.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]}},hbomax_com:{match:{root_urls:["hbomax.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]},{root_urls:["hbomax.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},{proxy_country:["BR"],cmds:[{root_urls:["hbomax.com"],then:"PROXY BR.POOL_lum_br_shared"}]},{proxy_country:["AR","AT","AU","BE","BG","BR","CA","CH","CL","CO","CZ","DE","DK","ES","FI","FR","GB","GR","HK","HR","HU","ID","IE","IL","IN","IT","IS","JP","KR","MX","NL","NO","NZ","PL","RO","RU","SE","SG","SK","TR","US","NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA"],cmds:[{hosts:["gateway.api.hbo.com","comet.api.hbo.com","play.hbonow.com","oauth.api.hbo.com","oauth-emea.api.hbo.com","oauth-us.api.hbo.com","gateway-latam.api.hbo.com","telegraph.api.hbo.com","sessions.api.hbo.com","comet-latam.api.hbo.com","api.hbo.com","drm-us.api.hbo.com","manifests.api.hbo.com","user-comet.api.hbo.com"],then:"PROXY XX.PEER"}]}]}},cbs_com:{match:{root_urls:["cbs.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["cbsivideo.com","cbsaavideo.com","link.theplatform.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{root_urls:["cbs.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["cbsivideo.com","cbsaavideo.com","link.theplatform.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{root_urls:["cbs.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},canalplus_com:{proxy_country:["FR"],cmds:[{root_urls:["canalplus.com","hodor.canalplus.pro"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]},liverugby_net:{proxy_country:["GB"],cmds:[{root_urls:["liverugby.net"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},zagonka_tv:{proxy_country:["GB"],cmds:[{root_urls:["zagonka.tv"],then:"PROXY GB.PEER",if:[]}]},areena_yle_fi:{match:{root_urls:["areena.yle.fi"],rules:[{proxy_country:["FI"],cmds:[{hosts:["locations.api.yle.fi","cdnapi-legacy.kaltura.com"],then:"PROXY FI.PEER",if:[]}]}]},cmds:[{hosts:["locations.api.yle.fi","cdnapi-legacy.kaltura.com"],then:"PROXY FI.PEER",if:[]}]},bbc_co_uk:{match:{root_urls:["bbc.co.uk","bbc.com"],rules:[{proxy_country:["GB"],cmds:[{hosts:["fig.bbc.co.uk","open.live.bbc.co.uk"],then:"PROXY GB.PEER",if:[]},{hosts:["bbc.co.uk","bbc.com"],then:"PROXY GB.PEER",if:[]},{hosts:["bbci.co.uk","live.cf.md.bbci.co.uk","files.bbci.co.uk","account.bbc.com","api.bbc.co.uk","ssl.bbc.co.uk","vod-dash-uk-live.bbcfmt.hs.llnwd.net","vod-thumb-uk-live.bbcfmt.hs.llnwd.net","vs-dash-uk-live.bbcfmt.hs.llnwd.net","vod-sub-uk-live.bbcfmt.hs.llnwd.net","bbcfmt.hs.llnwd.net","bbcfmt.s.llnwi.net","s.loris.llnwd.net","vod-thumb-uk-live.akamaized.net","vs-dash-uk-live.akamaized.net","aod-dash-uk-live.akamaized.net","cf.md.bbci.co.uk","www.bbc.co.uk","vod-dash-uk-live.akamaized.net","as-dash-uk-live.akamaized.net","bidi.bbc.co.uk","bidi.live.bbc.co.uk","live.bidi.net.uk","urbanairship.com","as-hls-ww-live.akamaized.net"],then:"PROXY GB.PEER",if:[]}],error_codes:[403]}]},cmds:[{hosts:["fig.bbc.co.uk","open.live.bbc.co.uk"],then:"PROXY GB.PEER",if:[]},{hosts:["bbc.co.uk","bbc.com"],then:"PROXY GB.PEER",if:[]},{hosts:["bbci.co.uk","live.cf.md.bbci.co.uk","files.bbci.co.uk","account.bbc.com","api.bbc.co.uk","ssl.bbc.co.uk","vod-dash-uk-live.bbcfmt.hs.llnwd.net","vod-thumb-uk-live.bbcfmt.hs.llnwd.net","vs-dash-uk-live.bbcfmt.hs.llnwd.net","vod-sub-uk-live.bbcfmt.hs.llnwd.net","bbcfmt.hs.llnwd.net","bbcfmt.s.llnwi.net","s.loris.llnwd.net","vod-thumb-uk-live.akamaized.net","vs-dash-uk-live.akamaized.net","aod-dash-uk-live.akamaized.net","cf.md.bbci.co.uk","www.bbc.co.uk","vod-dash-uk-live.akamaized.net","as-dash-uk-live.akamaized.net","bidi.bbc.co.uk","bidi.live.bbc.co.uk","live.bidi.net.uk","urbanairship.com","as-hls-ww-live.akamaized.net"],then:"PROXY GB.PEER",if:[]}]},bergdorfgoodman_com:{proxy_country:["US"],cmds:[{root_urls:["bergdorfgoodman.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},channel4_com:{match:{root_urls:["channel4.com"],rules:[{proxy_country:["GB"],cmds:[{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]},{root_urls:["channel4.com"],if:[{url:".*check-email",type:"=~",then:"DIRECT"}],then:"PROXY GB.PEER"},{hosts:["ais.channel4.com"],then:"PROXY GB.PEER",if:[]}]}]},cmds:[{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]},{root_urls:["channel4.com"],if:[{url:".*check-email",type:"=~",then:"DIRECT"}],then:"PROXY GB.PEER"},{hosts:["ais.channel4.com"],then:"PROXY GB.PEER",if:[]}]},criterionchannel_com:{proxy_country:["US"],cmds:[{root_urls:["criterionchannel.com"],then:"PROXY US.PEER",if:[]}]},textnow_com:{match:{root_urls:["textnow.com"],rules:[{proxy_country:["US","CA"],cmds:[{hosts:["textnow.com","client.px-cloud.net","captcha.px-cdn.net","collector-pxk56wkc4o.px-cloud.net","textnow-static.s3-website-us-east-1.amazonaws.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["textnow.com","client.px-cloud.net","captcha.px-cdn.net","collector-pxk56wkc4o.px-cloud.net","textnow-static.s3-website-us-east-1.amazonaws.com"],then:"PROXY XX.PEER",if:[]}]},mangago_me:{match:{root_urls:["mangago.me"],rules:[{proxy_country:["US"],cmds:[{hosts:["mangago.me"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["mangago.me"],then:"PROXY US.PEER",if:[]}]},javhd_pro:{match:{root_urls:["javhd.pro"],rules:[{proxy_country:["US"],cmds:[{hosts:["javhd.pro"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["javhd.pro"],then:"PROXY US.PEER",if:[]}]},ustvgo_tv:{match:{root_urls:["ustvgo.tv"],rules:[{proxy_country:["IL"],cmds:[{hosts:["ustvgo.tv"],then:"PROXY IL.PEER",if:[]},{hosts:["useast.quantumdex.io","ustv24h.live"],then:"PROXY IL.PEER",if:[]}]}]},cmds:[{hosts:["ustvgo.tv"],then:"PROXY IL.PEER",if:[]},{hosts:["useast.quantumdex.io","ustv24h.live"],then:"PROXY IL.PEER",if:[]}]},hpjav_tv:{match:{root_urls:["hpjav.tv"],rules:[{proxy_country:["US"],cmds:[{hosts:["hpjav.tv"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["hpjav.tv"],then:"PROXY US.PEER",if:[]}]},anybunny_tv:{match:{root_urls:["anybunny.tv"],rules:[{proxy_country:["US"],cmds:[{hosts:["anybunny.tv","mov.anybunny.tv","ahcdn.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["anybunny.tv","mov.anybunny.tv","ahcdn.com"],then:"PROXY US.PEER",if:[]}]},warning_or_kr:{match:{root_urls:["warning.or.kr"],rules:[{proxy_country:["KR"],cmds:[{hosts:["warning.or.kr"],then:"PROXY KR.PEER",if:[]}]}]},cmds:[{hosts:["warning.or.kr"],then:"PROXY KR.PEER",if:[]}]},crunchyroll_com:{match:{root_urls:["crunchyroll.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["crunchyroll.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["crunchyroll.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},dazn_com:{match:{root_urls:["dazn.com"],rules:[{cmds:[{hosts:["isl.dazn.com","isl-ca.dazn.com","isl-eu.dazn.com","isl-jp.dazn.com","isl-us.dazn.com","indazn.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["isl.dazn.com","isl-ca.dazn.com","isl-eu.dazn.com","isl-jp.dazn.com","isl-us.dazn.com","indazn.com"],then:"PROXY XX.PEER",if:[]}]},identity_homedepot_com:{match:{root_urls:["identity.homedepot.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["identity.homedepot.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},{proxy_country:["CA"],cmds:[{hosts:["identity.homedepot.com"],then:"PROXY CA.POOL_lum_ca_shared"}]}]},cmds:[{hosts:["identity.homedepot.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},dr_dk:{match:{root_urls:["dr.dk","drtv.dk","tv2.dk"],rules:[{proxy_country:["DK"],cmds:[{hosts:["www.dr.dk"],then:"PROXY DK.PEER",if:[]},{hosts:["drlive01hls.akamaized.net","drlive02hls.akamaized.net","drlive03hls.akamaized.net"],then:"PROXY DK.PEER",if:[]}]}]},cmds:[{hosts:["www.dr.dk"],then:"PROXY DK.PEER",if:[]},{hosts:["drlive01hls.akamaized.net","drlive02hls.akamaized.net","drlive03hls.akamaized.net"],then:"PROXY DK.PEER",if:[]}]},eversource_com:{match:{root_urls:["eversource.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["eversource.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{hosts:["i-doxs.net"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["eversource.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{hosts:["i-doxs.net"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},espn_com_co:{match:{root_urls:["espn.com.co"],rules:[{proxy_country:["CO"],cmds:[{hosts:["tredir.espn.com"],then:"PROXY CO.POOL",if:[]},{root_urls:["espn.com.co"],then:"PROXY CO.POOL",if:[]}]}]},cmds:[{hosts:["tredir.espn.com"],then:"PROXY CO.POOL",if:[]},{root_urls:["espn.com.co"],then:"PROXY CO.POOL",if:[]}]},espn_com:{match:{root_urls:["espn.com"],rules:[{proxy_country:["ES"],cmds:[{hosts:["us.edge.bamgrid.com"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{root_urls:["espn.com"],then:"PROXY ES.POOL_lum_es_shared",if:[]}]}]},cmds:[{hosts:["us.edge.bamgrid.com"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{root_urls:["espn.com"],then:"PROXY ES.POOL_lum_es_shared",if:[]}]},fastpeoplesearch_com:{match:{root_urls:["fastpeoplesearch.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["fastpeoplesearch.com","www.fastpeoplesearch.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["fastpeoplesearch.com","www.fastpeoplesearch.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]},searchpeoplefree_com:{match:{root_urls:["searchpeoplefree.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["searchpeoplefree.com","www.searchpeoplefree.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["searchpeoplefree.com","www.searchpeoplefree.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]},peoplesearchnow_com:{match:{root_urls:["peoplesearchnow.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["peoplesearchnow.com","www.peoplesearchnow.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["peoplesearchnow.com","www.peoplesearchnow.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]},truepeoplesearch_com:{match:{root_urls:["truepeoplesearch.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["truepeoplesearch.com","www.truepeoplesearch.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["truepeoplesearch.com","www.truepeoplesearch.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]},usphonebook_com:{match:{root_urls:["usphonebook.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["usphonebook.com","www.usphonebook.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["usphonebook.com","www.usphonebook.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]},ffsng_com:{match:{root_urls:["ffsng.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["ffsng.com"],if:[{url:"ffsng\\.com\\/ajax\\.php",type:"!~",then:"PROXY US"}],then:"PROXY US.PEER"}]}]},cmds:[{hosts:["ffsng.com"],if:[{url:"ffsng\\.com\\/ajax\\.php",type:"!~",then:"PROXY US"}],then:"PROXY US.PEER"}]},finishline_com:{match:{root_urls:["finishline.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["finishline.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["finishline.com"],then:"PROXY US.PEER",if:[]}]},footlocker_com:{proxy_country:["US"],cmds:[{root_urls:["footlocker.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},ulta_com:{proxy_country:["US"],cmds:[{root_urls:["ulta.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},jsnx_net:{match:{root_urls:["jsnx.net"],rules:[{proxy_country:["US"],cmds:[{hosts:["jsnx.net"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["jsnx.net"],then:"PROXY US.PEER",if:[]}]},cwtv_com:{match:{root_urls:["cwtv.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["cwtv.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{hosts:["cwtv-amd-akamai.akamaized.net"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{root_urls:["cwtv.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{hosts:["cwtv-amd-akamai.akamaized.net"],then:"PROXY US.PEER",if:[]}]},france_tv:{proxy_country:["FR"],cmds:[{hosts:["cloudreplay.ftven.fr","hdfauth.ftven.fr"],then:"PROXY FR.PEER",if:[]}]},francetvinfo_fr:{proxy_country:["FR"],cmds:[{root_urls:["francetvinfo.fr"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]},gamestop_com:{proxy_country:["US"],cmds:[{root_urls:["gamestop.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},globaltv_ca:{proxy_country:["CA"],cmds:[{root_urls:["globaltv.com"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["global.corusappservices.com"],then:"PROXY CA.PEER",if:[]}]},bell_ca:{proxy_country:["CA"],cmds:[{root_urls:["bell.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]},go_com:{match:{root_urls:["go.com"],rules:[{cmds:[{hosts:["go.com","prod.gatekeeper.us-abc.symphony.edgedatg.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["go.com","prod.gatekeeper.us-abc.symphony.edgedatg.com"],then:"PROXY XX.PEER",if:[]}]},go_us:{proxy_country:["US"],cmds:[{hosts:["prod.gatekeeper.us-abc.symphony.edgedatg.go.com","prod.gatekeeper.us-abc.symphony.edgedatg.com"],then:"PROXY US.PEER",if:[]}]},starz_com:{match:{root_urls:["starz.com"],rules:[{cmds:[{hosts:["auth.starz.com","msrem.starz.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["auth.starz.com","msrem.starz.com"],then:"PROXY XX.PEER",if:[]}]},cf_sites:{match:{root_urls:["rutracker.org","ashleymadison.com","myshopify.com","visa.com","uakino.club","tvoj-onlajn.ru","gleam.io","exelab.ru","king368.com"],rules:[{cmds:[{hosts:["rutracker.org","ashleymadison.com","myshopify.com","visa.com","uakino.club","tvoj-onlajn.ru","gleam.io","exelab.ru","king368.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["rutracker.org","ashleymadison.com","myshopify.com","visa.com","uakino.club","tvoj-onlajn.ru","gleam.io","exelab.ru","king368.com"],then:"PROXY XX.PEER",if:[]}]},hbogo:{match:{root_urls:["hbogo.pl","hbogo.ro"],rules:[{cmds:[{hosts:["api.ugw.hbogo.eu"],if:[{url:"api\\.ugw\\.hbogo\\.eu\\/v3\\.0\\/(GeoCheck|Authentication\\/(POL|ROU))\\/(json|JSON).*",type:"!~",then:"PROXY XX"}],then:"PROXY XX.PEER"}]}]},cmds:[{hosts:["api.ugw.hbogo.eu"],if:[{url:"api\\.ugw\\.hbogo\\.eu\\/v3\\.0\\/(GeoCheck|Authentication\\/(POL|ROU))\\/(json|JSON).*",type:"!~",then:"PROXY XX"}],then:"PROXY XX.PEER"}]},hbogola_com:{match:{root_urls:["hbogola.com"],rules:[{proxy_country:["MX","PE","CO"],cmds:[{hosts:["globalapi.hbogola.com","ais.directvla.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["globalapi.hbogola.com","ais.directvla.com"],then:"PROXY XX.PEER",if:[]}]},hbogo_com_br:{match:{root_urls:["hbogo.com.br"],rules:[{proxy_country:["BR"],cmds:[{hosts:["globalapi.hbogola.com"],then:"PROXY BR.PEER",if:[]}]}]},cmds:[{hosts:["globalapi.hbogola.com"],then:"PROXY BR.PEER",if:[]}]},movistarplay_com_pe:{match:{root_urls:["movistarplay.com.pe"],rules:[{proxy_country:["PE"],cmds:[{hosts:["movistarplay.com.pe","wvcypherdrm.gvp.telefonica.com"],then:"PROXY PE.PEER",if:[]}]}]},cmds:[{hosts:["movistarplay.com.pe","wvcypherdrm.gvp.telefonica.com"],then:"PROXY PE.PEER",if:[]}]},directvgo_com:{match:{root_urls:["directvgo.com"],rules:[{proxy_country:["PE"],cmds:[{hosts:["directvgo.com"],then:"PROXY PE.PEER",if:[]}]}]},cmds:[{hosts:["directvgo.com"],then:"PROXY PE.PEER",if:[]}]},elevensports_pt:{match:{root_urls:["elevensports.pt"],rules:[{proxy_country:["PT"],cmds:[{hosts:["elevensports.pt","dce-frontoffice.imggaming.com"],then:"PROXY PT.PEER",if:[]}]}]},cmds:[{hosts:["elevensports.pt","dce-frontoffice.imggaming.com"],then:"PROXY PT.PEER",if:[]}]},hollisterco_com:{proxy_country:["US"],cmds:[{root_urls:["hollisterco.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},hotstar_com:{match:{root_urls:["hotstar.com"],rules:[{proxy_country:["IN","GB"],cmds:[{if:[{host:"(?:google-analytics\\.com|analytics\\.twitter\\.com|googleadservices\\.com|p\\.adsymptotic\\.com|googletagmanager\\.com|bat\\.bing\\.com|adservice\\.google\\.com|doubleclick\\.net|gstatic\\.com|googlesyndication\\.com|2mdn\\.net|q\\.quora\\.com|analytics\\.edgekey\\.net|amazon-adsystem\\.com|users\\.quantumgraph\\.com|images-na\\.ssl-images-amazon\\.com|bh\\.contextweb\\.com|pixel-sync\\.sitescout\\.com|ads-twitter\\.com|googletagservices\\.com|scorecardresearch\\.com|outbrain\\.com|cdnjs\\.cloudflare\\.com|adservice\\.google\\.com\\.pk|adservice\\.google\\.com\\.ph|adroll\\.com|analytics\\.yahoo\\.com|spl\\.zeotap\\.com|a-ads\\.com|google\\.com|google\\.co\\.in|facebook\\.com|facebook\\.net|t\\.co|rubiconproject\\.com|google\\.com\\.bd|mixpanel\\.com|go-mpulse\\.net|google\\.com\\.au|googleapis\\.com)$",type:"=~",then:"DIRECT"}],then:"PROXY IN.POOL_lum_in_shared"},{hosts:["www.hotstar.com","services.hotstar.com","segment.hotstar.com","api.hotstar.com","geoip.hotstar.com","e6858.dsce9.akamaiedge.net","ma312-r.analytics.edgesuite.net","service.hotstar.com","persona.hotstar.com","secure-media.hotstar.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["hses1.akamaized.net","hses.akamaized.net","hses2.akamaized.net","ds-aksb-a.akamaihd.net","hesads.akamaized.net","hsdesinova.akamaized.net","hses3.akamaized.net","hses4.akamaized.net","staragvod-vh.akamaihd.net","hsdesinova.akamaized.net","hsprepack.akamaized.net","staragvod1-vh.akamaihd.net","staragvod2-vh.akamaihd.net","staragvod3-vh.akamaihd.net","staragdash.akamaized.net","hssportsprepack.akamaized.net","live11.akt.hotstar-cdn.net","live15p.hotstar.com","hses4.hotstar.com","hotstar.com","hsdashgec1.akamaized.net","hsdashgec2.akamaized.net","hsnewsprepack.akamaized.net","live13p.hotstar.com","webos.hotstar.com","tizen.hotstar.com","live14p.hotstar.com","live09p.hotstar.com","live12p.hotstar.com","live11p.akt.hotstar-cdn.net","live12p.akt.hotstar-cdn.net","live11p.hotstar.com","tailor.akt.hotstar-cdn.net"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["in-star.videoplaza.tv","hotstar.worldgravity.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},{proxy_country:["CA"],cmds:[{if:[{host:"(?:google-analytics\\.com|analytics\\.twitter\\.com|googleadservices\\.com|p\\.adsymptotic\\.com|googletagmanager\\.com|bat\\.bing\\.com|adservice\\.google\\.com|doubleclick\\.net|gstatic\\.com|googlesyndication\\.com|2mdn\\.net|q\\.quora\\.com|analytics\\.edgekey\\.net|amazon-adsystem\\.com|users\\.quantumgraph\\.com|images-na\\.ssl-images-amazon\\.com|bh\\.contextweb\\.com|pixel-sync\\.sitescout\\.com|ads-twitter\\.com|googletagservices\\.com|scorecardresearch\\.com|outbrain\\.com|cdnjs\\.cloudflare\\.com|adservice\\.google\\.com\\.pk|adservice\\.google\\.com\\.ph|adroll\\.com|analytics\\.yahoo\\.com|spl\\.zeotap\\.com|a-ads\\.com|google\\.com|google\\.co\\.in|facebook\\.com|facebook\\.net|t\\.co|rubiconproject\\.com|google\\.com\\.bd|mixpanel\\.com|go-mpulse\\.net|google\\.com\\.au|googleapis\\.com)$",type:"=~",then:"DIRECT"}],then:"PROXY CA.POOL_lum_ca_shared"},{hosts:["www.hotstar.com","services.hotstar.com","segment.hotstar.com","api.hotstar.com","geoip.hotstar.com","e6858.dsce9.akamaiedge.net","ma312-r.analytics.edgesuite.net","service.hotstar.com","persona.hotstar.com","secure-media.hotstar.com"],then:"PROXY CA.PEER"},{hosts:["hses1.akamaized.net","hses.akamaized.net","hses2.akamaized.net","ds-aksb-a.akamaihd.net","hesads.akamaized.net","hsdesinova.akamaized.net","hses3.akamaized.net","hses4.akamaized.net","staragvod-vh.akamaihd.net","hsdesinova.akamaized.net","hsprepack.akamaized.net","staragvod1-vh.akamaihd.net","staragvod2-vh.akamaihd.net","staragvod3-vh.akamaihd.net","staragdash.akamaized.net","hssportsprepack.akamaized.net","live11.akt.hotstar-cdn.net","live15p.hotstar.com","hses4.hotstar.com","hotstar.com","hsdashgec1.akamaized.net","hsdashgec2.akamaized.net","hsnewsprepack.akamaized.net"],then:"PROXY CA.POOL_lum_ca_shared"},{hosts:["ca-star.videoplaza.tv","hotstar.worldgravity.com"],then:"PROXY CA.POOL_lum_ca_shared"}]}]},cmds:[{if:[{host:"(?:google-analytics\\.com|analytics\\.twitter\\.com|googleadservices\\.com|p\\.adsymptotic\\.com|googletagmanager\\.com|bat\\.bing\\.com|adservice\\.google\\.com|doubleclick\\.net|gstatic\\.com|googlesyndication\\.com|2mdn\\.net|q\\.quora\\.com|analytics\\.edgekey\\.net|amazon-adsystem\\.com|users\\.quantumgraph\\.com|images-na\\.ssl-images-amazon\\.com|bh\\.contextweb\\.com|pixel-sync\\.sitescout\\.com|ads-twitter\\.com|googletagservices\\.com|scorecardresearch\\.com|outbrain\\.com|cdnjs\\.cloudflare\\.com|adservice\\.google\\.com\\.pk|adservice\\.google\\.com\\.ph|adroll\\.com|analytics\\.yahoo\\.com|spl\\.zeotap\\.com|a-ads\\.com|google\\.com|google\\.co\\.in|facebook\\.com|facebook\\.net|t\\.co|rubiconproject\\.com|google\\.com\\.bd|mixpanel\\.com|go-mpulse\\.net|google\\.com\\.au|googleapis\\.com)$",type:"=~",then:"DIRECT"}],then:"PROXY IN.POOL_lum_in_shared"},{hosts:["www.hotstar.com","services.hotstar.com","segment.hotstar.com","api.hotstar.com","geoip.hotstar.com","e6858.dsce9.akamaiedge.net","ma312-r.analytics.edgesuite.net","service.hotstar.com","persona.hotstar.com","secure-media.hotstar.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["hses1.akamaized.net","hses.akamaized.net","hses2.akamaized.net","ds-aksb-a.akamaihd.net","hesads.akamaized.net","hsdesinova.akamaized.net","hses3.akamaized.net","hses4.akamaized.net","staragvod-vh.akamaihd.net","hsdesinova.akamaized.net","hsprepack.akamaized.net","staragvod1-vh.akamaihd.net","staragvod2-vh.akamaihd.net","staragvod3-vh.akamaihd.net","staragdash.akamaized.net","hssportsprepack.akamaized.net","live11.akt.hotstar-cdn.net","live15p.hotstar.com","hses4.hotstar.com","hotstar.com","hsdashgec1.akamaized.net","hsdashgec2.akamaized.net","hsnewsprepack.akamaized.net","live13p.hotstar.com","webos.hotstar.com","tizen.hotstar.com","live14p.hotstar.com","live09p.hotstar.com","live12p.hotstar.com","live11p.akt.hotstar-cdn.net","live12p.akt.hotstar-cdn.net","live11p.hotstar.com","tailor.akt.hotstar-cdn.net"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["in-star.videoplaza.tv","hotstar.worldgravity.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},sevenplus_com_au:{match:{root_urls:["7plus.com.au"],rules:[{proxy_country:["AU"],cmds:[{hosts:["sevennetwork.akamaized.net","live-sevennetwork.akamaized.net","7plus-sevennetwork.akamaized.net","npc-live-sevennetwork.akamaized.net"],then:"PROXY AU.PEER",if:[]},{root_urls:["7plus.com.au"],then:"PROXY AU.POOL",if:[]}]}]},cmds:[{hosts:["sevennetwork.akamaized.net","live-sevennetwork.akamaized.net","7plus-sevennetwork.akamaized.net","npc-live-sevennetwork.akamaized.net"],then:"PROXY AU.PEER",if:[]},{root_urls:["7plus.com.au"],then:"PROXY AU.POOL",if:[]}]},hulu_com:{match:{root_urls:["hulu.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["play.hulu.com"],if:[{url:".*(\\.)?play\\.hulu\\.com\\/.*\\/playlist",type:"!~",then:"PROXY US.POOL_lum_us_shared"}],then:"PROXY US.PEER"},{hosts:["discover.hulu.com"],if:[{url:"discover\\.hulu\\.com\\/content\\/",type:"!~",then:"PROXY US.POOL_lum_us_shared"}],then:"PROXY US.PEER"},{hosts:["secure.hulu.com","auth.hulu.com"],then:"PROXY US.PEER",if:[]},{hosts:["hulu-lr.hb-api.omtrdc.net","cws-hulu.conviva.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{root_urls:["hulu.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["play.hulu.com"],if:[{url:".*(\\.)?play\\.hulu\\.com\\/.*\\/playlist",type:"!~",then:"PROXY US.POOL_lum_us_shared"}],then:"PROXY US.PEER"},{hosts:["discover.hulu.com"],if:[{url:"discover\\.hulu\\.com\\/content\\/",type:"!~",then:"PROXY US.POOL_lum_us_shared"}],then:"PROXY US.PEER"},{hosts:["secure.hulu.com","auth.hulu.com"],then:"PROXY US.PEER",if:[]},{hosts:["hulu-lr.hb-api.omtrdc.net","cws-hulu.conviva.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{root_urls:["hulu.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},hulu_jp:{match:{root_urls:["hulu.jp"],rules:[{proxy_country:["JP"],cmds:[{hosts:["api.happyon.jp"],if:[{url:"api\\.happyon\\.jp\\/v1\\/(auth\\/token|playback\\/video)",type:"!~",then:"PROXY JP"}],then:"PROXY JP.PEER"},{hosts:["hulu.jp"],if:[{url:"hulu\\.jp\\/(account|signup).*",type:"!~",then:"PROXY JP"}],then:"PROXY JP.PEER"},{hosts:["papi.prod.hjholdings.tv"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["api.happyon.jp"],if:[{url:"api\\.happyon\\.jp\\/v1\\/(auth\\/token|playback\\/video)",type:"!~",then:"PROXY JP"}],then:"PROXY JP.PEER"},{hosts:["hulu.jp"],if:[{url:"hulu\\.jp\\/(account|signup).*",type:"!~",then:"PROXY JP"}],then:"PROXY JP.PEER"},{hosts:["papi.prod.hjholdings.tv"],then:"PROXY JP.PEER",if:[]}]},itv_com:{proxy_country:["GB"],cmds:[{hosts:["itv.com"],then:"PROXY GB.PEER",if:[]},{hosts:["magni.itv.com","edge.api.brightcove.com"],then:"PROXY GB.PEER",if:[]},{hosts:["itv.com","itvpnp.live.ott.irdeto.com","itvstatic.com","itvpnpdotcom-a.akamaihd.net","ssl-itvdotcom.2cnt.net","play.dar.itv.com","csm-e-itv-eb.play.dar.itv.com","itvpnpdotcom.cdn1.content.itv.com"],then:"PROXY GB.PEER",if:[]}],error_codes:[403]},iqiyi_com:{match:{root_urls:["iqiyi.com"],rules:[{proxy_country:["CN"],cmds:[{hosts:["cache.video.iqiyi.com"],if:[{url:".*cache\\.video\\.iqiyi\\.com\\/dash.*",type:"!~",then:"PROXY CN"}],then:"PROXY CN.PEER"}]}]},cmds:[{hosts:["cache.video.iqiyi.com"],if:[{url:".*cache\\.video\\.iqiyi\\.com\\/dash.*",type:"!~",then:"PROXY CN"}],then:"PROXY CN.PEER"}]},iview_abc_net_au:{match:{root_urls:["abc.net.au","iview.abc.net.au"],rules:[{cmds:[{hosts:["api.iview.abc.net.au"],if:[{url:"api\\.iview\\.abc\\.net\\.au\\/v2\\/(video|token\\/drm)\\/.*",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"},{hosts:["abc-iview-mediapackagestreams-1.akamaized.net"],if:[{url:"abc-iview-mediapackagestreams-1\\.akamaized\\.net\\/out\\/v1\\/\\w+\\/index\\.mpd",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"},{hosts:["iview-vod.akamaized.net"],if:[{url:"iview-vod\\.akamaized\\.net\\/prod\\/ck1\\/\\w+\\/\\w+\\/mpegdash\\/master\\.mpd",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"}]}]},cmds:[{hosts:["api.iview.abc.net.au"],if:[{url:"api\\.iview\\.abc\\.net\\.au\\/v2\\/(video|token\\/drm)\\/.*",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"},{hosts:["abc-iview-mediapackagestreams-1.akamaized.net"],if:[{url:"abc-iview-mediapackagestreams-1\\.akamaized\\.net\\/out\\/v1\\/\\w+\\/index\\.mpd",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"},{hosts:["iview-vod.akamaized.net"],if:[{url:"iview-vod\\.akamaized\\.net\\/prod\\/ck1\\/\\w+\\/\\w+\\/mpegdash\\/master\\.mpd",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"}]},kaltura_com:{proxy_country:["FI"],cmds:[{hosts:["cdnapisec.kaltura.com","cdnsecakmi.kaltura.com"],then:"PROXY FI.PEER",if:[]}]},kbs_co_kr:{proxy_country:["KR"],cmds:[{root_urls:["kbs.co.kr"],then:"PROXY KR.POOL_lum_kr_shared",if:[]},{hosts:["onair.kbs.co.kr","vod.kbs.co.kr"],then:"PROXY KR.PEER",if:[]}]},manga_line_me:{match:{root_urls:["line.me"],rules:[{proxy_country:["JP"],cmds:[{hosts:["manga.line.me"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["manga.line.me"],then:"PROXY JP.PEER",if:[]}]},marcus_com:{proxy_country:["US"],cmds:[{root_urls:["marcus.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},meiliboxi_fi:{match:{root_urls:["meiliboxi.fi"],rules:[{proxy_country:["FI"],cmds:[{hosts:["meiliboxi.fi"],then:"PROXY FI.PEER",if:[]}]}]},cmds:[{hosts:["meiliboxi.fi"],then:"PROXY FI.PEER",if:[]}]},mitele_es:{match:{root_urls:["mitele.es"],rules:[{proxy_country:["ES"],cmds:[{root_urls:["mitele.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["vod.mitele.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["miteleooyala-vh.akamaihd.net","livehlsdai-i.akamaihd.net","cerbero.pro.3d99a4cb092e6d20ff56d80b9efd9a8f8802ec81.es","live.mitele.es","directos.mitele.es","cerbero.mediaset.es"],then:"PROXY ES.PEER",if:[]}]}]},cmds:[{root_urls:["mitele.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["vod.mitele.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["miteleooyala-vh.akamaihd.net","livehlsdai-i.akamaihd.net","cerbero.pro.3d99a4cb092e6d20ff56d80b9efd9a8f8802ec81.es","live.mitele.es","directos.mitele.es","cerbero.mediaset.es"],then:"PROXY ES.PEER",if:[]}]},my5_tv:{match:{root_urls:["my5.tv"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["my5.tv"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["cassie.channel5.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["my5.tv"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["cassie.channel5.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},britbox_co_uk:{match:{root_urls:["britbox.co.uk"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["my5.tv"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["dotcomcontent.britbox.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["my5.tv"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["dotcomcontent.britbox.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},naver_com:{match:{root_urls:["naver.com"],rules:[{proxy_country:["KR"],cmds:[{root_urls:["naver.com"],if:[{url:"(smartmediarep.com|pstatic.net|vrixon.com).*\\.(mp4|m3u8|ts)",type:"=~",then:"DIRECT"}],then:"PROXY XX"},{hosts:["apis.naver.com","api-gw.sports.naver.com"],then:"PROXY KR.PEER",if:[]}]}]},cmds:[{root_urls:["naver.com"],if:[{url:"(smartmediarep.com|pstatic.net|vrixon.com).*\\.(mp4|m3u8|ts)",type:"=~",then:"DIRECT"}],then:"PROXY XX"},{hosts:["apis.naver.com","api-gw.sports.naver.com"],then:"PROXY KR.PEER",if:[]}]},netflix_com:{match:{min_ver:"1.155.76",root_urls:["netflix.com"],rules:[{proxy_country:[],cmds:[{hosts:["netflixparty.com"],then:"DIRECT",if:[]},{root_urls:["netflix.com"],if:[],then:"PROXY XX.POOL"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY XX.POOL",if:[]}]},{proxy_country:["NL"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY NL.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY NL.PEER"}]},{proxy_country:["CA"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY CA.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY CA.PEER"}]},{proxy_country:["GB"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY GB.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY GB.PEER"}]},{proxy_country:["FR"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY FR.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY FR.PEER"}]},{proxy_country:["IT"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY IT.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY IT.PEER"}]},{proxy_country:["ES"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY ES.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY ES.PEER"}]},{proxy_country:["US"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY US.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY US.PEER"}]},{proxy_country:["KR"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY KR.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY KR.PEER"}]},{proxy_country:["HK"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY HK.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY HK.PEER"}]},{proxy_country:["JP"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY JP.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY JP.PEER"}]},{proxy_country:["BR"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY BR.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY BR.PEER"}]},{proxy_country:["IN"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY IN.POOL_lum_in_shared"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY IN.POOL_lum_in_shared"}]},{proxy_country:["NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA","CO","AU"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY XX.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY XX.PEER"}]}]},error_codes:[420]},ome_tv:{match:{root_urls:["ome.tv"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["ome.tv"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["roulette.apps-host.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["ome.tv"],then:"PROXY CA.POOL_lum_ca_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["ome.tv"],then:"PROXY GB.POOL_lum_gb_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["ome.tv"],then:"PROXY NL.POOL_lum_nl_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["ome.tv"],then:"PROXY FR.POOL_lum_fr_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["ome.tv"],then:"PROXY ES.POOL_lum_es_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["ome.tv"],then:"PROXY US.POOL_lum_us_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["ome.tv"],then:"PROXY KR.POOL_lum_kr_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["ome.tv"],then:"PROXY BR.POOL_lum_br_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY BR.POOL_lum_br_shared"}]},{proxy_country:["NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA"],cmds:[{hosts:["roulette.apps-host.com"],then:"PROXY XX.PEER"}]}]},cmds:[{root_urls:["ome.tv"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["roulette.apps-host.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},raiplay_it:{match:{min_ver:"1.155.77",root_urls:["raiplay.it"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["rai.it"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["msvdn.net","mediapolisvod.rai.it","mediapolis.rai.it","mediapolisgs.rai.it","8e7439fdb1694c8da3a0fd63e4dda518.msvdn.net","raitre1-live.akamaized.net","raitre2-live.akamaized.net","raitre3-live.akamaized.net","raitre4-live.akamaized.net","raitre5-live.akamaized.net","raitre6-live.akamaized.net","raitre7-live.akamaized.net","raitre8-live.akamaized.net","raitre9-live.akamaized.net","raiuno1-live.akamaized.net","raiuno2-live.akamaized.net","raiuno3-live.akamaized.net","raiuno4-live.akamaized.net","raiuno5-live.akamaized.net","raiuno6-live.akamaized.net","raiuno7-live.akamaized.net","raiuno8-live.akamaized.net","raiuno9-live.akamaized.net","raidue1-live.akamaized.net","raidue2-live.akamaized.net","raidue3-live.akamaized.net","raidue4-live.akamaized.net","raidue5-live.akamaized.net","raidue6-live.akamaized.net","raidue7-live.akamaized.net","raidue8-live.akamaized.net","raidue9-live.akamaized.net","raipremium1-live.akamaized.net","raipremium2-live.akamaized.net","raipremium3-live.akamaized.net","raipremium4-live.akamaized.net","raipremium5-live.akamaized.net","raipremium6-live.akamaized.net","raipremium7-live.akamaized.net","raipremium8-live.akamaized.net","raipremium9-live.akamaized.net","raicinque1-live.akamaized.net","raicinque2-live.akamaized.net","raicinque3-live.akamaized.net","raicinque4-live.akamaized.net","raicinque5-live.akamaized.net","raicinque6-live.akamaized.net","raicinque7-live.akamaized.net","raicinque8-live.akamaized.net","raicinque9-live.akamaized.net","raimovie1-live.akamaized.net","raimovie2-live.akamaized.net","raimovie3-live.akamaized.net","raimovie4-live.akamaized.net","raimovie5-live.akamaized.net","raimovie6-live.akamaized.net","raimovie7-live.akamaized.net","raimovie8-live.akamaized.net","raimovie9-live.akamaized.net","raiyoyo1-live.akamaized.net","raiyoyo2-live.akamaized.net","raiyoyo3-live.akamaized.net","raiyoyo4-live.akamaized.net","raiyoyo5-live.akamaized.net","raiyoyo6-live.akamaized.net","raiyoyo7-live.akamaized.net","raiyoyo8-live.akamaized.net","raiyoyo9-live.akamaized.net","raigulp1-live.akamaized.net","raigulp2-live.akamaized.net","raigulp3-live.akamaized.net","raigulp4-live.akamaized.net","raigulp5-live.akamaized.net","raigulp6-live.akamaized.net","raigulp7-live.akamaized.net","raigulp8-live.akamaized.net","raigulp9-live.akamaized.net","rainews1-live.akamaized.net","rainews2-live.akamaized.net","rainews3-live.akamaized.net","rainews4-live.akamaized.net","rainews5-live.akamaized.net","rainews6-live.akamaized.net","rainews7-live.akamaized.net","rainews8-live.akamaized.net","rainews9-live.akamaized.net","raiscuola1-live.akamaized.net","raiscuola2-live.akamaized.net","raiscuola3-live.akamaized.net","raiscuola4-live.akamaized.net","raiscuola5-live.akamaized.net","raiscuola6-live.akamaized.net","raiscuola7-live.akamaized.net","raiscuola8-live.akamaized.net","raiscuola9-live.akamaized.net","raievent1-live.akamaized.net","raievent2-live.akamaized.net","raievent3-live.akamaized.net","raievent4-live.akamaized.net","raievent5-live.akamaized.net","raievent6-live.akamaized.net","raievent7-live.akamaized.net","raievent8-live.akamaized.net","raievent9-live.akamaized.net","raiquattro1-live.akamaized.net","raiquattro2-live.akamaized.net","raiquattro3-live.akamaized.net","raiquattro4-live.akamaized.net","raiquattro5-live.akamaized.net","raiquattro6-live.akamaized.net","raiquattro7-live.akamaized.net","raiquattro8-live.akamaized.net","raiquattro9-live.akamaized.net","raisportuno1-live.akamaized.net","raisportuno2-live.akamaized.net","raisportuno3-live.akamaized.net","raisportuno4-live.akamaized.net","raisportuno5-live.akamaized.net","raisportuno6-live.akamaized.net","raisportuno7-live.akamaized.net","raisportuno8-live.akamaized.net","raisportuno9-live.akamaized.net","raistoria1-live.akamaized.net","raistoria2-live.akamaized.net","raistoria3-live.akamaized.net","raistoria4-live.akamaized.net","raistoria5-live.akamaized.net","raistoria6-live.akamaized.net","raistoria7-live.akamaized.net","raistoria8-live.akamaized.net","raistoria9-live.akamaized.net","raisportdue1-live.akamaized.net","raisportdue2-live.akamaized.net","raisportdue3-live.akamaized.net","raisportdue4-live.akamaized.net","raisportdue5-live.akamaized.net","raisportdue6-live.akamaized.net","raisportdue7-live.akamaized.net","raisportdue8-live.akamaized.net","raisportdue9-live.akamaized.net"],then:"PROXY IT.PEER",if:[]}]}]}},rai_it:{match:{min_ver:"1.155.77",root_urls:["rai.it"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["rai.it"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]}]},cmds:[{root_urls:["rai.it"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},rte_ie:{match:{root_urls:["rte.ie"],rules:[{proxy_country:["IE"],cmds:[{hosts:["rte.ie"],then:"PROXY IE.PEER",if:[]},{hosts:["link.eu.theplatform.com"],then:"PROXY IE.PEER",if:[]}]}]},cmds:[{hosts:["rte.ie"],then:"PROXY IE.PEER",if:[]},{hosts:["link.eu.theplatform.com"],then:"PROXY IE.PEER",if:[]}]},virginmediatelevision_ie:{match:{root_urls:["virginmediatelevision.ie"],rules:[{proxy_country:["IE"],cmds:[{hosts:["www.virginmediatelevision.ie","vmtvprod.akamaized.net"],then:"PROXY IE.PEER",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/\\d+",type:"!~",then:"PROXY IE.POOL"}],then:"PROXY IE.PEER"}]}]},cmds:[{hosts:["www.virginmediatelevision.ie","vmtvprod.akamaized.net"],then:"PROXY IE.PEER",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/\\d+",type:"!~",then:"PROXY IE.POOL"}],then:"PROXY IE.PEER"}]},vier_be:{match:{root_urls:["vier.be"],rules:[{proxy_country:["BE"],cmds:[{hosts:["stream1-vod.cdn1.sbs.prd.telenet-ops.be","stream2-vod.cdn1.sbs.prd.telenet-ops.be"],then:"PROXY BE.PEER",if:[]}]}]},cmds:[{hosts:["stream1-vod.cdn1.sbs.prd.telenet-ops.be","stream2-vod.cdn1.sbs.prd.telenet-ops.be"],then:"PROXY BE.PEER",if:[]}]},orange_fr:{match:{root_urls:["orange.fr"],rules:[{proxy_country:["FR"],cmds:[{hosts:["nec-ms.apigw.orange.fr","replay.orange.fr","mediation-tv.orange.fr","login.orange.fr"],then:"PROXY FR.PEER",if:[]}]}]},cmds:[{hosts:["nec-ms.apigw.orange.fr","replay.orange.fr","mediation-tv.orange.fr","login.orange.fr"],then:"PROXY FR.PEER",if:[]}]},sonyliv_com:{match:{root_urls:["sonyliv.com"],rules:[{proxy_country:["IN"],cmds:[{hosts:["sonyliv.com","apiv2.sonyliv.com","sony247channels.akamaized.net"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY IN.POOL_lum_in_shared"}],then:"PROXY IN.POOL_lum_in_shared"}]}]},cmds:[{hosts:["sonyliv.com","apiv2.sonyliv.com","sony247channels.akamaized.net"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY IN.POOL_lum_in_shared"}],then:"PROXY IN.POOL_lum_in_shared"}]},sprint_com:{match:{root_urls:["sprint.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["sprint.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["sprint.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},stan_com_au:{match:{root_urls:["stan.com.au"],rules:[{cmds:[{hosts:["api.stan.com.au"],then:"PROXY AU.PEER",if:[]}]}]},cmds:[{hosts:["api.stan.com.au"],then:"PROXY AU.PEER",if:[]}]},tenplay_com_au:{match:{root_urls:["tenplay.com.au","10play.com.au"],rules:[{proxy_country:["AU"],cmds:[{root_urls:["tenplay.com.au","10play.com.au"],then:"PROXY AU.POOL",if:[]},{hosts:["10play.com.au","manifest.prod.boltdns.net","bcboltnet10tp.akamaized.net","global.ssl.fastly.net","10play-vod.global.ssl.fastly.net","10-selector.global.ssl.fastly.net","10-cms-feed.global.ssl.fastly.net","secure.widget.cloud.opta.net","s.yimg.com","edv021asd.global.ssl.fastly.net","geolocation.onetrust.com"],then:"PROXY AU.POOL",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"},{hosts:["imrworldwide.com"],if:[{url:".*\\.imrworldwide\\.com\\.*",type:"=~",then:"PROXY AU.POOL"}],then:"PROXY AU.POOL"}]}]},cmds:[{root_urls:["tenplay.com.au","10play.com.au"],then:"PROXY AU.POOL",if:[]},{hosts:["10play.com.au","manifest.prod.boltdns.net","bcboltnet10tp.akamaized.net","global.ssl.fastly.net","10play-vod.global.ssl.fastly.net","10-selector.global.ssl.fastly.net","10-cms-feed.global.ssl.fastly.net","secure.widget.cloud.opta.net","s.yimg.com","edv021asd.global.ssl.fastly.net","geolocation.onetrust.com"],then:"PROXY AU.POOL",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"},{hosts:["imrworldwide.com"],if:[{url:".*\\.imrworldwide\\.com\\.*",type:"=~",then:"PROXY AU.POOL"}],then:"PROXY AU.POOL"}]},ninenow_com_au:{match:{root_urls:["9now.com.au"],rules:[{proxy_country:["AU"],cmds:[{hosts:["www.9now.com.au"],then:"PROXY AU.PEER",if:[]}]}]},cmds:[{hosts:["www.9now.com.au"],then:"PROXY AU.PEER",if:[]}]},unidragon_eu:{match:{root_urls:["unidragon.eu","unidragon.com"],rules:[{proxy_country:["DE","US"],cmds:[{hosts:["cozycountryredirect.addons.business"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["cozycountryredirect.addons.business"],then:"PROXY XX.PEER",if:[]}]},bfmtv_com:{match:{root_urls:["bfmtv.com"],rules:[{proxy_country:["FR"],cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY FR"}],then:"PROXY FR.PEER"}]}]},cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY FR"}],then:"PROXY FR.PEER"}]},tvbanywherena_com:{match:{root_urls:["tvbanywherena.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY US"}],then:"PROXY US.PEER"}]}]},cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY US"}],then:"PROXY US.PEER"}]},tvnz_co_nz:{match:{root_urls:["tvnz.co.nz"],rules:[{proxy_country:["NZ"],cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY NZ"}],then:"PROXY NZ.PEER"},{hosts:["bcbolttvnz3-a.akamaihd.net","tvnz-prod-01.brightcovecdn.com","apis-edge-prod.tech.tvnz.co.nz","playback.brightcovecdn.com"],then:"PROXY NZ.PEER",if:[]}]}]},cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY NZ"}],then:"PROXY NZ.PEER"},{hosts:["bcbolttvnz3-a.akamaihd.net","tvnz-prod-01.brightcovecdn.com","apis-edge-prod.tech.tvnz.co.nz","playback.brightcovecdn.com"],then:"PROXY NZ.PEER",if:[]}]},toggle_sg:{match:{root_urls:["toggle.sg"],rules:[{proxy_country:["SG"],cmds:[{hosts:["player-as.ott.kaltura.com"],if:[{url:".*player-as\\.ott\\.kaltura\\.com\\/.*\\/mwEmbed\\/mwEmbedFrame\\.php.*",type:"!~",then:"PROXY SG"}],then:"PROXY SG.PEER"}]}]},cmds:[{hosts:["player-as.ott.kaltura.com"],if:[{url:".*player-as\\.ott\\.kaltura\\.com\\/.*\\/mwEmbed\\/mwEmbedFrame\\.php.*",type:"!~",then:"PROXY SG"}],then:"PROXY SG.PEER"}]},tv4play_se:{match:{root_urls:["tv4play.se"],rules:[{proxy_country:["SE"],cmds:[{hosts:["playback-api.b17g.net","playback2.a2d.tv","tv4-segments.a2d.tv","swe.account.a2d.tv","live.streaming.a2d.tv"],then:"PROXY SE.PEER",if:[]}]}]},cmds:[{hosts:["playback-api.b17g.net","playback2.a2d.tv","tv4-segments.a2d.tv","swe.account.a2d.tv","live.streaming.a2d.tv"],then:"PROXY SE.PEER",if:[]}]},viaplay_se:{match:{root_urls:["viaplay.se"],rules:[{proxy_country:["SE"],cmds:[{hosts:["play.viaplay.se"],then:"PROXY SE.PEER",if:[]}]}]},cmds:[{hosts:["play.viaplay.se"],then:"PROXY SE.PEER",if:[]}]},cmore_se:{match:{root_urls:["cmore.se"],rules:[{proxy_country:["SE"],cmds:[{hosts:["streaminggateway-cmore.clientapi-prod.live.tv.telia.net","logingateway.cmore.se"],then:"PROXY SE.PEER",if:[]}]}]},cmds:[{hosts:["streaminggateway-cmore.clientapi-prod.live.tv.telia.net","logingateway.cmore.se"],then:"PROXY SE.PEER",if:[]}]},telecinco_es:{match:{root_urls:["telecinco.es"],rules:[{proxy_country:["ES"],cmds:[{root_urls:["telecinco.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["mediaset.hb.omtrdc.net"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["gatekeeper.mediaset.es","livehlsdai-i.akamaihd.net","cerbero.pro.3d99a4cb092e6d20ff56d80b9efd9a8f8802ec81.es","telecinco1-vh.akamaihd.net","live.telecinco.es","cerbero.mediaset.es"],then:"PROXY ES.PEER",if:[]}]}]},cmds:[{root_urls:["telecinco.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["mediaset.hb.omtrdc.net"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["gatekeeper.mediaset.es","livehlsdai-i.akamaihd.net","cerbero.pro.3d99a4cb092e6d20ff56d80b9efd9a8f8802ec81.es","telecinco1-vh.akamaihd.net","live.telecinco.es","cerbero.mediaset.es"],then:"PROXY ES.PEER",if:[]}]},energytv_es:{match:{root_urls:["energytv.es"],rules:[{proxy_country:["ES"],cmds:[{root_urls:["energytv.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["mdslivehlsb-i.akamaihd.net","directos.energytv.es","cerbero.pro.3d99a4cb092e6d20ff56d80b9efd9a8f8802ec81.es"],then:"PROXY ES.PEER",if:[]}]}]},cmds:[{root_urls:["energytv.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["mdslivehlsb-i.akamaihd.net","directos.energytv.es","cerbero.pro.3d99a4cb092e6d20ff56d80b9efd9a8f8802ec81.es"],then:"PROXY ES.PEER",if:[]}]},mediaset_it:{match:{root_urls:["mediaset.it"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["mediaset.it"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["api-ott-prod-fe.mediaset.net","theplatform.eu","link.theplatform.eu","feed.entertainment.tv.theplatform.eu","api.mediaset.net","secure-it.imrworldwide.com","vod06.msf.cdn.mediaset.net","mediasetinfinity.mediaset.it"],then:"PROXY IT.PEER",if:[]}]}]},cmds:[{root_urls:["mediaset.it"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["api-ott-prod-fe.mediaset.net","theplatform.eu","link.theplatform.eu","feed.entertainment.tv.theplatform.eu","api.mediaset.net","secure-it.imrworldwide.com","vod06.msf.cdn.mediaset.net","mediasetinfinity.mediaset.it"],then:"PROXY IT.PEER",if:[]}]},tibia_com:{match:{root_urls:["tibia.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["tibia.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]}]},cmds:[{root_urls:["tibia.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},tenk_fr:{match:{root_urls:["tenk.fr"],rules:[{proxy_country:["FR"],cmds:[{root_urls:["tenk.fr"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]}]},cmds:[{root_urls:["tenk.fr"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]},tva_ca:{match:{root_urls:["tva.ca"],rules:[{proxy_country:["CA"],cmds:[{root_urls:["tva.ca","chainetvauls-lh.akamaihd.net"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["videos.tva.ca","video.tva.ca"],then:"PROXY CA.PEER",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY CA.POOL_lum_ca_shared"}],then:"PROXY CA.PEER"}]}]},cmds:[{root_urls:["tva.ca","chainetvauls-lh.akamaihd.net"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["videos.tva.ca","video.tva.ca"],then:"PROXY CA.PEER",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY CA.POOL_lum_ca_shared"}],then:"PROXY CA.PEER"}]},aptnlumi_ca:{match:{root_urls:["aptnlumi.ca"],rules:[{proxy_country:["CA"],cmds:[{root_urls:["aptnlumi.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["cdnapisec.kaltura.com","cdnsecakmi.kaltura.com","cfvod.kaltura.com","analytics.kaltura.com"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]}]},cmds:[{root_urls:["aptnlumi.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["cdnapisec.kaltura.com","cdnsecakmi.kaltura.com","cfvod.kaltura.com","analytics.kaltura.com"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]},noovo_ca:{match:{root_urls:["noovo.ca"],rules:[{proxy_country:["CA"],cmds:[{root_urls:["noovo.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY CA.POOL_lum_ca_shared"}],then:"PROXY CA.PEER"}]}]},cmds:[{root_urls:["noovo.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY CA.POOL_lum_ca_shared"}],then:"PROXY CA.PEER"}]},skysports_com:{match:{root_urls:["skysports.com","skyid.sky.com"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["skysports.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["edge-auth.api.brightcove.com","skyid.sky.com"],then:"PROXY GB.PEER",if:[]}]}]},cmds:[{root_urls:["skysports.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["edge-auth.api.brightcove.com","skyid.sky.com"],then:"PROXY GB.PEER",if:[]}]},tvnow_de:{match:{root_urls:["tvnow.de"],rules:[{proxy_country:["DE"],cmds:[{hosts:["widevine.tvnow.de"],if:[{url:".*widevine\\.tvnow\\.de\\/index\\/proxy",type:"!~",then:"PROXY DE"}],then:"PROXY DE.PEER"},{hosts:["bff.apigw.tvnow.de","entitlement.player.tvnow.de"],then:"PROXY DE.PEER",if:[]}]}]},cmds:[{hosts:["widevine.tvnow.de"],if:[{url:".*widevine\\.tvnow\\.de\\/index\\/proxy",type:"!~",then:"PROXY DE"}],then:"PROXY DE.PEER"},{hosts:["bff.apigw.tvnow.de","entitlement.player.tvnow.de"],then:"PROXY DE.PEER",if:[]}]},youtube_com:{match:{root_urls:["youtube.com"],rules:[{proxy_country:["CO"],cmds:[{root_urls:["youtube.com"],if:[{url:".*youtube\\.com\\/youtubei\\/v1\\/guide.*",type:"!~",then:"PROXY CO"}],then:"PROXY CO.PEER"},{hosts:["googlevideo.com"],then:"PROXY CO.PEER",if:[]}]},{proxy_country:["AR"],cmds:[{root_urls:["youtube.com"],if:[{url:".*youtube\\.com\\/premium.*",type:"!~",then:"PROXY AR"}],then:"PROXY AR.PEER"}]},{proxy_country:["FR","ES","KR","BR"],cmds:[{hosts:["s.ytimg.com","googlevideo.com"],then:"PROXY XX.PEER"}]},{proxy_country:["IT","CA","GB","NL","AU"],cmds:[{hosts:["s.ytimg.com","googlevideo.com"],then:"PROXY XX"}]},{proxy_country:["US"],cmds:[{hosts:["tv.youtube.com"],then:"PROXY US.PEER"},{hosts:["s.ytimg.com","googlevideo.com"],then:"PROXY US"}]}]},cmds:[{root_urls:["youtube.com"],if:[{url:".*youtube\\.com\\/youtubei\\/v1\\/guide.*",type:"!~",then:"PROXY CO"}],then:"PROXY CO.PEER"},{hosts:["googlevideo.com"],then:"PROXY CO.PEER",if:[]}]},cloudvideo_co:{proxy_country:["CO"],cmds:[{hosts:["rcnhd.cloudvideo.com.co"],if:[{url:"(/html5/.*/mwEmbedFrame.php/|playManifest|\\.m3u8)",type:"!~",then:"PROXY CO"}],then:"PROXY CO.PEER"}]},coomevaeps_com:{proxy_country:["CO"],cmds:[{hosts:["oficinavirtualeps.coomevaeps.com"],then:"PROXY CO.PEER",if:[]}]},tvp_pl:{proxy_country:["PL"],cmds:[{hosts:["vod.tvp.pl"],if:[{url:"\\/sess\\/tvplayer\\.php",type:"!~",then:"PROXY PL"}],then:"PROXY PL.PEER"}]},vod_pl:{match:{root_urls:["vod.pl"],rules:[{proxy_country:["PL"],cmds:[{hosts:["useinsider.com","player-api.dreamlab.pl"],then:"PROXY PL.PEER",if:[]}]}]},cmds:[{hosts:["useinsider.com","player-api.dreamlab.pl"],then:"PROXY PL.PEER",if:[]}]},tvp_info:{match:{root_urls:["tvp.info"],rules:[{proxy_country:["PL"],cmds:[{hosts:["www.tvp.info"],then:"PROXY PL.PEER",if:[]}]}]},cmds:[{hosts:["www.tvp.info"],then:"PROXY PL.PEER",if:[]}]},ipla_tv:{match:{root_urls:["ipla.tv"],rules:[{proxy_country:["PL"],cmds:[{hosts:["b2c-www.redefine.pl"],then:"PROXY PL.PEER",if:[]}]}]},cmds:[{hosts:["b2c-www.redefine.pl"],then:"PROXY PL.PEER",if:[]}]},starplus_com:{match:{root_urls:["starplus.com"],rules:[{proxy_country:["AR"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY AR.PEER",if:[]},{root_urls:["disneyplus.com"],then:"PROXY AR.PEER",if:[]},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY AR.PEER",if:[]}]}]},cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY AR.PEER",if:[]},{root_urls:["disneyplus.com"],then:"PROXY AR.PEER",if:[]},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY AR.PEER",if:[]}]},openai_com:{match:{root_urls:["openai.com","chatgpt.com"],rules:[{cmds:[{hosts:["openai.com"],then:"PROXY XX",if:[]}]},{cmds:[{hosts:["chat.openai.com","auth0.openai.com","platform.openai.com","challenges.cloudflare.com","api.openai.com","auth.openai.com","chatgpt.com"],then:"PROXY XX.PEER"}]}]},cmds:[{hosts:["openai.com"],then:"PROXY XX",if:[]}]},rtvs_sk:{match:{root_urls:["rtvs.sk"],rules:[{proxy_country:["SK"],cmds:[{hosts:["n0.stv.livebox.sk","n1.stv.livebox.sk","n2.stv.livebox.sk","n3.stv.livebox.sk","n4.stv.livebox.sk","n5.stv.livebox.sk","n6.stv.livebox.sk","n7.stv.livebox.sk","n8.stv.livebox.sk","n9.stv.livebox.sk","n10.stv.livebox.sk","n11.stv.livebox.sk","n12.stv.livebox.sk","n13.stv.livebox.sk","n14.stv.livebox.sk","n15.stv.livebox.sk","n16.stv.livebox.sk","n17.stv.livebox.sk","n18.stv.livebox.sk","n19.stv.livebox.sk","n20.stv.livebox.sk","n21.stv.livebox.sk","n22.stv.livebox.sk","n23.stv.livebox.sk","n24.stv.livebox.sk","n25.stv.livebox.sk","n26.stv.livebox.sk","n27.stv.livebox.sk","n28.stv.livebox.sk","n29.stv.livebox.sk","n30.stv.livebox.sk"],then:"PROXY SK.PEER",if:[]}]}]},cmds:[{hosts:["n0.stv.livebox.sk","n1.stv.livebox.sk","n2.stv.livebox.sk","n3.stv.livebox.sk","n4.stv.livebox.sk","n5.stv.livebox.sk","n6.stv.livebox.sk","n7.stv.livebox.sk","n8.stv.livebox.sk","n9.stv.livebox.sk","n10.stv.livebox.sk","n11.stv.livebox.sk","n12.stv.livebox.sk","n13.stv.livebox.sk","n14.stv.livebox.sk","n15.stv.livebox.sk","n16.stv.livebox.sk","n17.stv.livebox.sk","n18.stv.livebox.sk","n19.stv.livebox.sk","n20.stv.livebox.sk","n21.stv.livebox.sk","n22.stv.livebox.sk","n23.stv.livebox.sk","n24.stv.livebox.sk","n25.stv.livebox.sk","n26.stv.livebox.sk","n27.stv.livebox.sk","n28.stv.livebox.sk","n29.stv.livebox.sk","n30.stv.livebox.sk"],then:"PROXY SK.PEER",if:[]}]},latina_pe:{match:{root_urls:["latina.pe"],rules:[{proxy_country:["PE"],cmds:[{hosts:["mdstrm.com","vod-latina-mdstrm.secure.footprint.net"],then:"PROXY PE.PEER",if:[]}]}]},cmds:[{hosts:["mdstrm.com","vod-latina-mdstrm.secure.footprint.net"],then:"PROXY PE.PEER",if:[]}]},rtve_es:{match:{root_urls:["rtve.es"],rules:[{proxy_country:["ES"],cmds:[{hosts:["rtvelivestreamv1.akamaized.net","rtvelivestreamv2.akamaized.net","rtvelivestreamv3.akamaized.net","rtvelivestreamv4.akamaized.net","rtvelivestreamv5.akamaized.net","rtvelivestreamv6.akamaized.net","rtvelivestreamv7.akamaized.net","rtvelivestreamv8.akamaized.net","rtvelivestreamv9.akamaized.net","rtvelivestreamv10.akamaized.net"],then:"PROXY ES.PEER",if:[]}]}]},cmds:[{hosts:["rtvelivestreamv1.akamaized.net","rtvelivestreamv2.akamaized.net","rtvelivestreamv3.akamaized.net","rtvelivestreamv4.akamaized.net","rtvelivestreamv5.akamaized.net","rtvelivestreamv6.akamaized.net","rtvelivestreamv7.akamaized.net","rtvelivestreamv8.akamaized.net","rtvelivestreamv9.akamaized.net","rtvelivestreamv10.akamaized.net"],then:"PROXY ES.PEER",if:[]}]},iceland_co_uk:{proxy_country:["GB"],cmds:[{root_urls:["iceland.co.uk"],then:"PROXY GB.PEER",if:[]}]},play_rtl_hr:{match:{root_urls:["play.rtl.hr"],rules:[{proxy_country:["HR"],cmds:[{hosts:["geo.6play.fr"],then:"PROXY HR.PEER",if:[]}]}]},cmds:[{hosts:["geo.6play.fr"],then:"PROXY HR.PEER",if:[]}]},ticketmaster:{cmds:[{hosts:["ticketmaster.com","ticketmaster.pl","ticketmaster.ie","ticketmaster.es","ticketmaster.gr","ticketmaster.co.uk","ticketmaster.com.au","ticketmaster.at","ticketmaster.be","ticketmaster.com.br","ticketmaster.cl","ticketmaster.cy","ticketmaster.cz","ticketmaster.dk","ticketmaster.fi","ticketmaster.fr","ticketmaster.de","ticketmaster.it","ticketmaster.com.mx","ticketmaster.nl","ticketmaster.cp.nz","ticketmaster.no","ticketmaster.sg","ticketmaster.co.za","ticketmaster.se","ticketmaster.ch","ticketmaster.com.tr","ticketmaster.ae"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},zattoo_com:{match:{root_urls:["zattoo.com"],rules:[{proxy_country:["DE"],cmds:[{root_urls:["zahs.tv"],then:"PROXY DE.PEER",if:[]}]}]},cmds:[{root_urls:["zahs.tv"],then:"PROXY DE.PEER",if:[]}]},tv4_se:{match:{root_urls:["tv4.se"],rules:[{proxy_country:["SE"],cmds:[{hosts:["tv4.se","www.tv4.se","tv4se-graphql.a2d.tv"],then:"PROXY SE.PEER",if:[]}]}]},cmds:[{hosts:["tv4.se","www.tv4.se","tv4se-graphql.a2d.tv"],then:"PROXY SE.PEER",if:[]}]},picknsave_com:{match:{root_urls:["picknsave.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["picknsave.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["picknsave.com"],then:"PROXY US.PEER",if:[]}]},homegoods_com:{match:{root_urls:["homegoods.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["homegoods.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["homegoods.com"],then:"PROXY US.PEER",if:[]}]},tacobell_com:{match:{root_urls:["tacobell.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["tacobell.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["tacobell.com"],then:"PROXY US.PEER",if:[]}]},fkr_spb_ru:{match:{root_urls:["fkr-spb.ru"],rules:[{proxy_country:["RU"],cmds:[{hosts:["fkr-spb.ru"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{hosts:["fkr-spb.ru"],then:"PROXY RU.PEER",if:[]}]},avail_co:{match:{root_urls:["avail.co","avail.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["avail.co","avail.com","www.avail.co","www.avail.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["avail.co","avail.com","www.avail.co","www.avail.com"],then:"PROXY US.PEER",if:[]}]},fubo_tv:{match:{root_urls:["fubo.tv"],rules:[{cmds:[{hosts:["api.fubo.tv","gcs-streams-prod.fubo.tv"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["api.fubo.tv","gcs-streams-prod.fubo.tv"],then:"PROXY XX.PEER",if:[]}]},moviesanywhere_com:{match:{root_urls:["moviesanywhere.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["registration.moviesanywhere.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["registration.moviesanywhere.com"],then:"PROXY US.PEER",if:[]}]},threenow_co_nz:{match:{root_urls:["threenow.co.nz"],rules:[{proxy_country:["NZ"],cmds:[{hosts:["threenow.co.nz","fullscreen.nz"],then:"PROXY NZ.PEER",if:[]}]}]},cmds:[{hosts:["threenow.co.nz","fullscreen.nz"],then:"PROXY NZ.PEER",if:[]}]},tv_teleboy_ch:{match:{root_urls:["tv.teleboy.ch"],rules:[{proxy_country:["CH"],cmds:[{hosts:["teleboy.ch"],then:"PROXY CH.PEER",if:[]}]}]},cmds:[{hosts:["teleboy.ch"],then:"PROXY CH.PEER",if:[]}]},aha_video:{match:{root_urls:["aha.video"],rules:[{proxy_country:["IN"],cmds:[{hosts:["device-register-service.api.aha.firstlight.ai","geo-loc.api.aha.firstlight.ai","auth-platform.api.aha.firstlight.ai","static-assets-cdn.api.aha.firstlight.ai","config-service.api.aha.firstlight.ai","auth-gw.api.aha.firstlight.ai","streaming-vod-aha.akamaized.net"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["playback-auth-service.api.aha.firstlight.ai"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["device-register-service.api.aha.firstlight.ai","geo-loc.api.aha.firstlight.ai","auth-platform.api.aha.firstlight.ai","static-assets-cdn.api.aha.firstlight.ai","config-service.api.aha.firstlight.ai","auth-gw.api.aha.firstlight.ai","streaming-vod-aha.akamaized.net"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["playback-auth-service.api.aha.firstlight.ai"],then:"DIRECT",if:[]}]},ihg_com:{match:{root_urls:["ihg.com"],rules:[{cmds:[{hosts:["ihg.com"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["ihg.com"],then:"DIRECT",if:[]}]},digisport_ro:{match:{root_urls:["digisport.ro"],rules:[{proxy_country:["RO"],cmds:[{root_urls:["digisport.ro"],then:"PROXY RO.PEER",if:[]},{hosts:["api.cxense.com","balancer2.digi24.ro","cdn.ampproject.org","comcluster.cxense.com","scdn.cxense.com","ssl.p.jwpcdn.com","entitlements.jwplayer.com","rcs-rds.ro","gvt1.com","prd.jwpltx.com"],if:[{url:"/.*2mdn\\.net/",type:"=~",then:"PROXY RO.PEER"},{url:"/.*gvt1\\.com/",type:"=~",then:"PROXY RO.PEER"},{url:"/edge.*rcs-rds\\.ro/",type:"=~",then:"PROXY RO.PEER"}],then:"PROXY RO.PEER"}]}]},cmds:[{root_urls:["digisport.ro"],then:"PROXY RO.PEER",if:[]},{hosts:["api.cxense.com","balancer2.digi24.ro","cdn.ampproject.org","comcluster.cxense.com","scdn.cxense.com","ssl.p.jwpcdn.com","entitlements.jwplayer.com","rcs-rds.ro","gvt1.com","prd.jwpltx.com"],if:[{url:"/.*2mdn\\.net/",type:"=~",then:"PROXY RO.PEER"},{url:"/.*gvt1\\.com/",type:"=~",then:"PROXY RO.PEER"},{url:"/edge.*rcs-rds\\.ro/",type:"=~",then:"PROXY RO.PEER"}],then:"PROXY RO.PEER"}]},proxycheck_io:{cmds:[{client_only:true,hosts:["proxycheck.io"],then:"DIRECT",if:[]},{hosts:["proxycheck.io"],then:"PROXY XX.PEER",if:[]}]},svtplay_se:{match:{root_urls:["svtplay.se"],rules:[{proxy_country:["SE"],cmds:[{hosts:["svt-vod-secure-3a.akamaized.net"],then:"PROXY SE.PEER",if:[]}]}]},cmds:[{hosts:["svt-vod-secure-3a.akamaized.net"],then:"PROXY SE.PEER",if:[]}]},sixplay_group:{cmds:[{hosts:["6play.fr","m6web.fr","6cloud.fr"],then:"PROXY XX.PEER",if:[]}]},hpav_tv:{match:{root_urls:["hpav.tv"],rules:[{proxy_country:["JP"],cmds:[{root_urls:["hpav.tv"],then:"PROXY JP.PEER",if:[]},{hosts:["static.javhdhello.com","asianclub.tv"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{root_urls:["hpav.tv"],then:"PROXY JP.PEER",if:[]},{hosts:["static.javhdhello.com","asianclub.tv"],then:"PROXY JP.PEER",if:[]}]},jiocinema_com:{match:{root_urls:["jiocinema.com"],rules:[{proxy_country:["IN"],cmds:[{root_urls:["jiocinema.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["ak-mediavod.jiocinema.com","jiocinema.com","jiocinemaweb.cdn.jio.com","mercury.akamaized.net","apis-jiovoot.voot.com","jcstreamingdash.akamaized.net","auth-jiocinema.voot.com","apis-jiocinema.voot.com","engage.jiocinema.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]}]},cmds:[{root_urls:["jiocinema.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["ak-mediavod.jiocinema.com","jiocinema.com","jiocinemaweb.cdn.jio.com","mercury.akamaized.net","apis-jiovoot.voot.com","jcstreamingdash.akamaized.net","auth-jiocinema.voot.com","apis-jiocinema.voot.com","engage.jiocinema.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},sierra_com:{match:{root_urls:["sierra.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["sierra.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["sierra.com","stpost.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["sierra.com"],then:"PROXY CA.POOL_lum_ca_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["sierra.com"],then:"PROXY GB.POOL_lum_gb_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["sierra.com"],then:"PROXY NL.POOL_lum_nl_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["sierra.com"],then:"PROXY FR.POOL_lum_fr_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["sierra.com"],then:"PROXY ES.POOL_lum_es_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["sierra.com"],then:"PROXY US.POOL_lum_us_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["sierra.com"],then:"PROXY KR.POOL_lum_kr_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["sierra.com"],then:"PROXY BR.POOL_lum_br_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY BR.POOL_lum_br_shared"}]},{proxy_country:["AR","AT","AU","BE","BG","CH","CL","CO","CZ","DE","DK","FI","GR","HK","HR","HU","ID","IE","IL","IN","IS","JP","MX","NO","NZ","PL","RO","RU","SE","SG","SK","TR","NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA"],cmds:[{hosts:["sierra.com","stpost.com"],then:"PROXY XX.PEER"}]}]},cmds:[{root_urls:["sierra.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["sierra.com","stpost.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},meijer_com:{match:{root_urls:["meijer.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["meijer.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["meijer.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},instagram_com:{match:{root_urls:["instagram.com"],rules:[{proxy_country:["GB","NL"],cmds:[{hosts:["fbsbx.com","static.cdninstagram.com","instagram.com","scriptcdn.net"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["fbsbx.com","static.cdninstagram.com","instagram.com","scriptcdn.net"],then:"PROXY XX.PEER",if:[]}]},mos_ru:{match:{root_urls:["mos.ru"],rules:[{proxy_country:["RU"],cmds:[{hosts:["mos.ru"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{hosts:["mos.ru"],then:"PROXY RU.PEER",if:[]}]},gosuslugi_ru:{match:{root_urls:["gosuslugi.ru"],rules:[{proxy_country:["RU"],cmds:[{hosts:["gosuslugi.ru"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{hosts:["gosuslugi.ru"],then:"PROXY RU.PEER",if:[]}]},tgc1_ru:{match:{root_urls:["lk.tgc1.ru","tgc1.ru"],rules:[{proxy_country:["RU"],cmds:[{hosts:["lk.tgc1.ru","tgc1.ru"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{hosts:["lk.tgc1.ru","tgc1.ru"],then:"PROXY RU.PEER",if:[]}]},tyuiu_ru:{match:{root_urls:["tyuiu.ru"],rules:[{proxy_country:["RU"],cmds:[{hosts:["pk.tyuiu.ru","tyuiu.ru"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{hosts:["pk.tyuiu.ru","tyuiu.ru"],then:"PROXY RU.PEER",if:[]}]},adjarabet_com:{match:{root_urls:["adjarabet.com"],rules:[{proxy_country:["GE"],cmds:[{hosts:["adjarabet.com"],then:"PROXY GE.PEER",if:[]}]}]},cmds:[{hosts:["adjarabet.com"],then:"PROXY GE.PEER",if:[]}]},vfsglobal_com:{match:{root_urls:["vfsglobal.com"],rules:[{proxy_country:["RU"],cmds:[{hosts:["vfsglobal.com"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{hosts:["vfsglobal.com"],then:"PROXY RU.PEER",if:[]}]},blsportugal_com:{match:{root_urls:["russia.blsportugal.com"],rules:[{proxy_country:["RU"],cmds:[{hosts:["russia.blsportugal.com"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{hosts:["russia.blsportugal.com"],then:"PROXY RU.PEER",if:[]}]},tax_ohio_gov:{match:{root_urls:["tax.ohio.gov"],rules:[{proxy_country:["US"],cmds:[{hosts:["tax.ohio.gov"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["tax.ohio.gov"],then:"PROXY US.PEER",if:[]}]},kayosports_com_au:{match:{root_urls:["kayosports.com.au"],rules:[{proxy_country:["AU"],cmds:[{hosts:["kayosports.com.au","streamotion.com.au"],then:"PROXY AU.POOL_lum_au_shared",if:[]}]}]},cmds:[{hosts:["kayosports.com.au","streamotion.com.au"],then:"PROXY AU.POOL_lum_au_shared",if:[]}]},nalog_ru:{match:{root_urls:["nalog.gov.ru","nalog.ru"],rules:[{proxy_country:["RU"],cmds:[{root_urls:["nalog.gov.ru","nalog.ru"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{root_urls:["nalog.gov.ru","nalog.ru"],then:"PROXY RU.PEER",if:[]}]},latele_envivo_com:{match:{root_urls:["latele-envivo.com"],rules:[{proxy_country:["AR"],cmds:[{hosts:["latele-envivo.com","pealmeditate.com","pluto.tv"],then:"PROXY AR.PEER",if:[]}]}]},cmds:[{hosts:["latele-envivo.com","pealmeditate.com","pluto.tv"],then:"PROXY AR.PEER",if:[]}]},lrt_lt:{match:{root_urls:["lrt.lt"],rules:[{proxy_country:["LT"],cmds:[{hosts:["dlvr1.net"],then:"PROXY LT.PEER",if:[]}]}]},cmds:[{hosts:["dlvr1.net"],then:"PROXY LT.PEER",if:[]}]},colaboraread_com_br:{match:{root_urls:["colaboraread.com.br"],rules:[{proxy_country:["BR"],cmds:[{hosts:["colaboraread.com.br"],then:"PROXY BR.POOL_lum_br_shared",if:[]}]}]},cmds:[{hosts:["colaboraread.com.br"],then:"PROXY BR.POOL_lum_br_shared",if:[]}]},growtopiagame_com:{match:{root_urls:["growtopiagame.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["growtopiagame.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["growtopiagame.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["GB"],cmds:[{root_urls:["growtopiagame.com"],then:"PROXY GB.POOL_lum_gb_shared"},{hosts:["growtopiagame.com"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["growtopiagame.com"],then:"PROXY FR.POOL_lum_fr_shared"},{hosts:["growtopiagame.com"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["growtopiagame.com"],then:"PROXY KR.POOL_lum_kr_shared"},{hosts:["growtopiagame.com"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["growtopiagame.com"],then:"PROXY BR.POOL_lum_br_shared"},{hosts:["growtopiagame.com"],then:"PROXY BR.POOL_lum_br_shared"}]},{proxy_country:["AU"],cmds:[{root_urls:["growtopiagame.com"],then:"PROXY AU.POOL_lum_au_shared"},{hosts:["growtopiagame.com"],then:"PROXY AU.POOL_lum_au_shared"}]},{proxy_country:["AR","AT","BE","BG","CA","CH","CL","CO","CZ","DE","DK","ES","FI","GR","HK","HR","HU","ID","IE","IL","IN","IS","JP","MX","NL","NO","NZ","PL","RO","RU","SE","SG","SK","TR","US","NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA"],cmds:[{hosts:["growtopiagame.com"],then:"PROXY XX.PEER"}]}]},cmds:[{root_urls:["growtopiagame.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["growtopiagame.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},kimdesene_org:{match:{root_urls:["kimdesene.org"],rules:[{proxy_country:["RO"],cmds:[{hosts:["kimdesene.org","commentsmodule.com"],then:"PROXY RO.PEER",if:[]}]}]},cmds:[{hosts:["kimdesene.org","commentsmodule.com"],then:"PROXY RO.PEER",if:[]}]},megogo_net:{match:{root_urls:["megogo.net"],rules:[{proxy_country:["UA"],cmds:[{hosts:["megogo.net"],then:"PROXY UA.PEER",if:[]}]}]},cmds:[{hosts:["megogo.net"],then:"PROXY UA.PEER",if:[]}]},familytreenow_com:{match:{root_urls:["familytreenow.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["familytreenow.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["familytreenow.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},billerweb_com:{match:{root_urls:["secure3.billerweb.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["secure3.billerweb.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["secure3.billerweb.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},fisglobal_com:{match:{root_urls:["fisglobal.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["fisglobal.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["fisglobal.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},tv_nrk_no:{match:{root_urls:["tv.nrk.no"],rules:[{proxy_country:["NO"],cmds:[{hosts:["dna.contentdelivery.net","nrk-od-00.akamaized.net","nrk-od-01.akamaized.net","nrk-od-02.akamaized.net","nrk-od-03.akamaized.net","nrk-od-04.akamaized.net","nrk-od-05.akamaized.net","nrk-od-06.akamaized.net","nrk-od-07.akamaized.net","nrk-od-08.akamaized.net","nrk-od-09.akamaized.net","nrk-od-10.akamaized.net","nrk-od-11.akamaized.net","nrk-od-12.akamaized.net","nrk-od-13.akamaized.net","nrk-od-14.akamaized.net","nrk-od-15.akamaized.net","nrk-od-16.akamaized.net","nrk-od-17.akamaized.net","nrk-od-18.akamaized.net","nrk-od-19.akamaized.net","nrk-od-20.akamaized.net","nrk-od-21.akamaized.net","nrk-od-22.akamaized.net","nrk-od-23.akamaized.net","nrk-od-24.akamaized.net","nrk-od-25.akamaized.net","nrk-od-26.akamaized.net","nrk-od-27.akamaized.net","nrk-od-28.akamaized.net","nrk-od-29.akamaized.net","nrk-od-30.akamaized.net","nrk-od-31.akamaized.net","nrk-od-32.akamaized.net","nrk-od-33.akamaized.net","nrk-od-34.akamaized.net","nrk-od-35.akamaized.net","nrk-od-36.akamaized.net","nrk-od-37.akamaized.net","nrk-od-38.akamaized.net","nrk-od-39.akamaized.net","nrk-od-40.akamaized.net","nrk-od-41.akamaized.net","nrk-od-42.akamaized.net","nrk-od-43.akamaized.net","nrk-od-44.akamaized.net","nrk-od-45.akamaized.net","nrk-od-46.akamaized.net","nrk-od-47.akamaized.net","nrk-od-48.akamaized.net","nrk-od-49.akamaized.net","nrk-od-50.akamaized.net","nrk-od-51.akamaized.net","nrk-od-52.akamaized.net","nrk-od-53.akamaized.net","nrk-od-54.akamaized.net","nrk-od-55.akamaized.net","nrk-od-56.akamaized.net","nrk-od-57.akamaized.net","nrk-od-58.akamaized.net","nrk-od-59.akamaized.net","nrk-od-60.akamaized.net","nrk-od-61.akamaized.net","nrk-od-62.akamaized.net","nrk-od-63.akamaized.net","nrk-od-64.akamaized.net","nrk-od-65.akamaized.net","nrk-od-66.akamaized.net","nrk-od-67.akamaized.net","nrk-od-68.akamaized.net","nrk-od-69.akamaized.net","nrk-od-70.akamaized.net","nrk-od-71.akamaized.net","nrk-od-72.akamaized.net","nrk-od-73.akamaized.net","nrk-od-74.akamaized.net","nrk-od-75.akamaized.net","nrk-od-76.akamaized.net","nrk-od-77.akamaized.net","nrk-od-78.akamaized.net","nrk-od-79.akamaized.net","nrk-od-80.akamaized.net","nrk-od-81.akamaized.net","nrk-od-82.akamaized.net","nrk-od-83.akamaized.net","nrk-od-84.akamaized.net","nrk-od-85.akamaized.net","nrk-od-86.akamaized.net","nrk-od-87.akamaized.net","nrk-od-88.akamaized.net","nrk-od-89.akamaized.net","nrk-od-90.akamaized.net","nrk-od-91.akamaized.net","nrk-od-92.akamaized.net","nrk-od-93.akamaized.net","nrk-od-94.akamaized.net","nrk-od-95.akamaized.net","nrk-od-96.akamaized.net","nrk-od-97.akamaized.net","nrk-od-98.akamaized.net","nrk-od-99.akamaized.net"],then:"PROXY NO.PEER",if:[]}]}]},cmds:[{hosts:["dna.contentdelivery.net","nrk-od-00.akamaized.net","nrk-od-01.akamaized.net","nrk-od-02.akamaized.net","nrk-od-03.akamaized.net","nrk-od-04.akamaized.net","nrk-od-05.akamaized.net","nrk-od-06.akamaized.net","nrk-od-07.akamaized.net","nrk-od-08.akamaized.net","nrk-od-09.akamaized.net","nrk-od-10.akamaized.net","nrk-od-11.akamaized.net","nrk-od-12.akamaized.net","nrk-od-13.akamaized.net","nrk-od-14.akamaized.net","nrk-od-15.akamaized.net","nrk-od-16.akamaized.net","nrk-od-17.akamaized.net","nrk-od-18.akamaized.net","nrk-od-19.akamaized.net","nrk-od-20.akamaized.net","nrk-od-21.akamaized.net","nrk-od-22.akamaized.net","nrk-od-23.akamaized.net","nrk-od-24.akamaized.net","nrk-od-25.akamaized.net","nrk-od-26.akamaized.net","nrk-od-27.akamaized.net","nrk-od-28.akamaized.net","nrk-od-29.akamaized.net","nrk-od-30.akamaized.net","nrk-od-31.akamaized.net","nrk-od-32.akamaized.net","nrk-od-33.akamaized.net","nrk-od-34.akamaized.net","nrk-od-35.akamaized.net","nrk-od-36.akamaized.net","nrk-od-37.akamaized.net","nrk-od-38.akamaized.net","nrk-od-39.akamaized.net","nrk-od-40.akamaized.net","nrk-od-41.akamaized.net","nrk-od-42.akamaized.net","nrk-od-43.akamaized.net","nrk-od-44.akamaized.net","nrk-od-45.akamaized.net","nrk-od-46.akamaized.net","nrk-od-47.akamaized.net","nrk-od-48.akamaized.net","nrk-od-49.akamaized.net","nrk-od-50.akamaized.net","nrk-od-51.akamaized.net","nrk-od-52.akamaized.net","nrk-od-53.akamaized.net","nrk-od-54.akamaized.net","nrk-od-55.akamaized.net","nrk-od-56.akamaized.net","nrk-od-57.akamaized.net","nrk-od-58.akamaized.net","nrk-od-59.akamaized.net","nrk-od-60.akamaized.net","nrk-od-61.akamaized.net","nrk-od-62.akamaized.net","nrk-od-63.akamaized.net","nrk-od-64.akamaized.net","nrk-od-65.akamaized.net","nrk-od-66.akamaized.net","nrk-od-67.akamaized.net","nrk-od-68.akamaized.net","nrk-od-69.akamaized.net","nrk-od-70.akamaized.net","nrk-od-71.akamaized.net","nrk-od-72.akamaized.net","nrk-od-73.akamaized.net","nrk-od-74.akamaized.net","nrk-od-75.akamaized.net","nrk-od-76.akamaized.net","nrk-od-77.akamaized.net","nrk-od-78.akamaized.net","nrk-od-79.akamaized.net","nrk-od-80.akamaized.net","nrk-od-81.akamaized.net","nrk-od-82.akamaized.net","nrk-od-83.akamaized.net","nrk-od-84.akamaized.net","nrk-od-85.akamaized.net","nrk-od-86.akamaized.net","nrk-od-87.akamaized.net","nrk-od-88.akamaized.net","nrk-od-89.akamaized.net","nrk-od-90.akamaized.net","nrk-od-91.akamaized.net","nrk-od-92.akamaized.net","nrk-od-93.akamaized.net","nrk-od-94.akamaized.net","nrk-od-95.akamaized.net","nrk-od-96.akamaized.net","nrk-od-97.akamaized.net","nrk-od-98.akamaized.net","nrk-od-99.akamaized.net"],then:"PROXY NO.PEER",if:[]}]},google_hosts:{cmds:[{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]},youtube_hosts:{cmds:[{client_only:true,hosts:["youtube.com","www.youtube.com"],then:"DIRECT",if:[]}]},openai_hosts:{cmds:[{client_only:true,hosts:["openai.com","chatgpt.com"],then:"DIRECT",if:[]}]},vk:{cmds:[{client_only:true,hosts:["vk.com","vk.ru"],then:"DIRECT",if:[]},{root_urls:["vk.com","vk.ru"],then:"PROXY XX",if:[]}]},yandex:{cmds:[{client_only:true,hosts:["yandex.com","yandex.ru","ya.ru"],then:"DIRECT",if:[]},{root_urls:["yandex.com","yandex.ru","ya.ru"],then:"PROXY XX",if:[]}]},hola_browser_internal:{cmds:[{client_only:true,hosts:["___.com","___4.com","___5.com"],then:"DIRECT",if:[]}]},abc:{proxy_country:["US"],cmds:[{hosts:["edgedatg.com","edgedatg.go.com"],if:[{host:"[^.]\\.?edgedatg(\\.go)?\\.com",type:"!~",then:"PROXY XX"}],then:"PROXY US.PEER"}]},stb_ua:{country:{list:["UA"],type:"in"},cmds:[{hosts:["vcms-api2.starlight.digital","vcms-api.starlight.digital"],then:"PROXY UA.PEER",if:[]}]},mediaklikk:{proxy_country:["HU"],cmds:[{hosts:["connectmedia.hu"],if:[{url:".*cdn\\.connectmedia\\.hu\\/.*\\.m3u8",type:"=~",then:"PROXY XX"}],then:"PROXY XX"}]},zdf_de:{match:{root_urls:["zdf.de"],rules:[{cmds:[{hosts:["zdfvodde-vh.akamaihd.net"],if:[{url:".*zdfvodde-vh\\.akamaihd\\.net\\/i\\/zdf\\/.*\\.m3u8",type:"=~",then:"PROXY XX"}],then:"PROXY XX"}]}]},cmds:[{hosts:["zdfvodde-vh.akamaihd.net"],if:[{url:".*zdfvodde-vh\\.akamaihd\\.net\\/i\\/zdf\\/.*\\.m3u8",type:"=~",then:"PROXY XX"}],then:"PROXY XX"}]}},unblocker_globals:{ads:{cmds:[{hosts:["google-analytics.com","analytics.twitter.com","googleadservices.com","p.adsymptotic.com","googletagmanager.com","bat.bing.com","adservice.google.com","doubleclick.net","gstatic.com","googlesyndication.com","2mdn.net","q.quora.com","analytics.edgekey.net","amazon-adsystem.com","users.quantumgraph.com","images-na.ssl-images-amazon.com","bh.contextweb.com","pixel-sync.sitescout.com","ads-twitter.com","googletagservices.com","scorecardresearch.com","outbrain.com","cdnjs.cloudflare.com","adservice.google.com.pk","adservice.google.com.ph","adroll.com","analytics.yahoo.com","spl.zeotap.com","a-ads.com"],then:"PROXY XX",if:[]}]},proxy_from_agent:{cmds:[{hosts:["api.waxsweden.org","userstorage.mega.co.nz"],then:"PROXY XX",if:[]}]},facebook:{proxy_country:["AR","AT","AU","BE","BG","BR","CA","CH","CL","CO","CZ","DE","DK","ES","FI","FR","GB","GR","HK","HR","HU","ID","IE","IL","IN","IT","IS","JP","KR","MX","NL","NO","NZ","PL","RO","RU","SE","SG","SK","TR","US"],cmds:[{hosts:["facebook.com","facebook.net"],then:"PROXY XX",if:[]}]},google:{match:{root_urls:["google.com"],rules:[{cmds:[{hosts:["google.com","google.co.in","googleapis.com","ampproject.org","www.google.com","mtalk.google.com","clients4.google.com","play.google.com","maps.googleapis.com","accounts.google.com","safebrowsing.googleapis.com","history.google.com","optimizationguide-pa.googleapis.com","clients2.google.com","safebrowsing.google.com","fonts.googleapis.com","apis.google.com","content-autofill.googleapis.com"],then:"PROXY XX",if:[]}]}]}},daycoval_com_br:{match:{root_urls:["daycoval.com.br"],rules:[{proxy_country:["BR"],cmds:[{hosts:["www.daycoval.com.br"],then:"PROXY BR.PEER",if:[]}]}]},cmds:[{hosts:["www.daycoval.com.br"],then:"PROXY BR.PEER",if:[]}]},salto_fr:{match:{root_urls:["salto.fr"],rules:[{proxy_country:["FR"],cmds:[{hosts:["geo.salto.fr","android.middleware.salto.fr","layout.salto.fr","front-auth.salto.fr","youboranqs01.com","youboranqs02.com","youboranqs03.com"],then:"PROXY FR.PEER",if:[]}]}]},cmds:[{hosts:["geo.salto.fr","android.middleware.salto.fr","layout.salto.fr","front-auth.salto.fr","youboranqs01.com","youboranqs02.com","youboranqs03.com"],then:"PROXY FR.PEER",if:[]}]},laligaplus_laliga_com:{match:{root_urls:["laligaplus.laliga.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["liga-llstv-subscriptions.llt-services.com","liga-llstv-backend.llt-services.com","liga-llstv-backend.llt-services.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["liga-llstv-subscriptions.llt-services.com","liga-llstv-backend.llt-services.com","liga-llstv-backend.llt-services.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},hibbett_com:{match:{root_urls:["hibbett.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["hibbett.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["hibbett.com"],then:"PROXY US.PEER",if:[]}]},nowonline_com_br:{match:{root_urls:["nowonline.com.br"],rules:[{proxy_country:["BR"],cmds:[{hosts:["www.nowonline.com.br"],then:"PROXY BR.PEER",if:[]}]}]},cmds:[{hosts:["www.nowonline.com.br"],then:"PROXY BR.PEER",if:[]}]},nrk_no:{match:{root_urls:["nrk.no"],rules:[{proxy_country:["NO"],cmds:[{hosts:["nrk.no","dna.ip-only.net","nrk-od-00.akamaized.net","nrk-od-01.akamaized.net","nrk-od-02.akamaized.net","nrk-od-03.akamaized.net","nrk-od-04.akamaized.net","nrk-od-05.akamaized.net","nrk-od-06.akamaized.net","nrk-od-07.akamaized.net","nrk-od-08.akamaized.net","nrk-od-09.akamaized.net","nrk-od-10.akamaized.net","nrk-od-11.akamaized.net","nrk-od-12.akamaized.net","nrk-od-13.akamaized.net","nrk-od-14.akamaized.net","nrk-od-15.akamaized.net","nrk-od-16.akamaized.net","nrk-od-17.akamaized.net","nrk-od-18.akamaized.net","nrk-od-19.akamaized.net","nrk-od-20.akamaized.net","nrk-od-21.akamaized.net","nrk-od-22.akamaized.net","nrk-od-23.akamaized.net","nrk-od-24.akamaized.net","nrk-od-25.akamaized.net","nrk-od-26.akamaized.net","nrk-od-27.akamaized.net","nrk-od-28.akamaized.net","nrk-od-29.akamaized.net","nrk-od-30.akamaized.net","nrk-od-31.akamaized.net","nrk-od-32.akamaized.net","nrk-od-33.akamaized.net","nrk-od-34.akamaized.net","nrk-od-35.akamaized.net","nrk-od-36.akamaized.net","nrk-od-37.akamaized.net","nrk-od-38.akamaized.net","nrk-od-39.akamaized.net","nrk-od-40.akamaized.net","nrk-od-41.akamaized.net","nrk-od-42.akamaized.net","nrk-od-43.akamaized.net","nrk-od-44.akamaized.net","nrk-od-45.akamaized.net","nrk-od-46.akamaized.net","nrk-od-47.akamaized.net","nrk-od-48.akamaized.net","nrk-od-49.akamaized.net","nrk-od-50.akamaized.net","nrk-od-51.akamaized.net","nrk-od-52.akamaized.net","nrk-od-53.akamaized.net","nrk-od-54.akamaized.net","nrk-od-55.akamaized.net","nrk-od-56.akamaized.net","nrk-od-57.akamaized.net","nrk-od-58.akamaized.net","nrk-od-59.akamaized.net","nrk-od-60.akamaized.net","nrk-od-61.akamaized.net","nrk-od-62.akamaized.net","nrk-od-63.akamaized.net","nrk-od-64.akamaized.net","nrk-od-65.akamaized.net","nrk-od-66.akamaized.net","nrk-od-67.akamaized.net","nrk-od-68.akamaized.net","nrk-od-69.akamaized.net","nrk-od-70.akamaized.net","nrk-od-71.akamaized.net","nrk-od-72.akamaized.net","nrk-od-73.akamaized.net","nrk-od-74.akamaized.net","nrk-od-75.akamaized.net","nrk-od-76.akamaized.net","nrk-od-77.akamaized.net","nrk-od-78.akamaized.net","nrk-od-79.akamaized.net","nrk-od-80.akamaized.net","nrk-od-81.akamaized.net","nrk-od-82.akamaized.net","nrk-od-83.akamaized.net","nrk-od-84.akamaized.net","nrk-od-85.akamaized.net","nrk-od-86.akamaized.net","nrk-od-87.akamaized.net","nrk-od-88.akamaized.net","nrk-od-89.akamaized.net","nrk-od-90.akamaized.net","nrk-od-91.akamaized.net","nrk-od-92.akamaized.net","nrk-od-93.akamaized.net","nrk-od-94.akamaized.net","nrk-od-95.akamaized.net","nrk-od-96.akamaized.net","nrk-od-97.akamaized.net","nrk-od-98.akamaized.net","nrk-od-99.akamaized.net"],then:"PROXY NO.PEER",if:[]}]}]},cmds:[{hosts:["nrk.no","dna.ip-only.net","nrk-od-00.akamaized.net","nrk-od-01.akamaized.net","nrk-od-02.akamaized.net","nrk-od-03.akamaized.net","nrk-od-04.akamaized.net","nrk-od-05.akamaized.net","nrk-od-06.akamaized.net","nrk-od-07.akamaized.net","nrk-od-08.akamaized.net","nrk-od-09.akamaized.net","nrk-od-10.akamaized.net","nrk-od-11.akamaized.net","nrk-od-12.akamaized.net","nrk-od-13.akamaized.net","nrk-od-14.akamaized.net","nrk-od-15.akamaized.net","nrk-od-16.akamaized.net","nrk-od-17.akamaized.net","nrk-od-18.akamaized.net","nrk-od-19.akamaized.net","nrk-od-20.akamaized.net","nrk-od-21.akamaized.net","nrk-od-22.akamaized.net","nrk-od-23.akamaized.net","nrk-od-24.akamaized.net","nrk-od-25.akamaized.net","nrk-od-26.akamaized.net","nrk-od-27.akamaized.net","nrk-od-28.akamaized.net","nrk-od-29.akamaized.net","nrk-od-30.akamaized.net","nrk-od-31.akamaized.net","nrk-od-32.akamaized.net","nrk-od-33.akamaized.net","nrk-od-34.akamaized.net","nrk-od-35.akamaized.net","nrk-od-36.akamaized.net","nrk-od-37.akamaized.net","nrk-od-38.akamaized.net","nrk-od-39.akamaized.net","nrk-od-40.akamaized.net","nrk-od-41.akamaized.net","nrk-od-42.akamaized.net","nrk-od-43.akamaized.net","nrk-od-44.akamaized.net","nrk-od-45.akamaized.net","nrk-od-46.akamaized.net","nrk-od-47.akamaized.net","nrk-od-48.akamaized.net","nrk-od-49.akamaized.net","nrk-od-50.akamaized.net","nrk-od-51.akamaized.net","nrk-od-52.akamaized.net","nrk-od-53.akamaized.net","nrk-od-54.akamaized.net","nrk-od-55.akamaized.net","nrk-od-56.akamaized.net","nrk-od-57.akamaized.net","nrk-od-58.akamaized.net","nrk-od-59.akamaized.net","nrk-od-60.akamaized.net","nrk-od-61.akamaized.net","nrk-od-62.akamaized.net","nrk-od-63.akamaized.net","nrk-od-64.akamaized.net","nrk-od-65.akamaized.net","nrk-od-66.akamaized.net","nrk-od-67.akamaized.net","nrk-od-68.akamaized.net","nrk-od-69.akamaized.net","nrk-od-70.akamaized.net","nrk-od-71.akamaized.net","nrk-od-72.akamaized.net","nrk-od-73.akamaized.net","nrk-od-74.akamaized.net","nrk-od-75.akamaized.net","nrk-od-76.akamaized.net","nrk-od-77.akamaized.net","nrk-od-78.akamaized.net","nrk-od-79.akamaized.net","nrk-od-80.akamaized.net","nrk-od-81.akamaized.net","nrk-od-82.akamaized.net","nrk-od-83.akamaized.net","nrk-od-84.akamaized.net","nrk-od-85.akamaized.net","nrk-od-86.akamaized.net","nrk-od-87.akamaized.net","nrk-od-88.akamaized.net","nrk-od-89.akamaized.net","nrk-od-90.akamaized.net","nrk-od-91.akamaized.net","nrk-od-92.akamaized.net","nrk-od-93.akamaized.net","nrk-od-94.akamaized.net","nrk-od-95.akamaized.net","nrk-od-96.akamaized.net","nrk-od-97.akamaized.net","nrk-od-98.akamaized.net","nrk-od-99.akamaized.net"],then:"PROXY NO.PEER",if:[]}]},discoveryplus_in:{match:{root_urls:["discoveryplus.in"],rules:[{proxy_country:["IN"],cmds:[{root_urls:["discoveryplus.in"],then:"PROXY IN",if:[]},{hosts:["ap2-prod-direct.discoveryplus.in"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]}]},cmds:[{root_urls:["discoveryplus.in"],then:"PROXY IN",if:[]},{hosts:["ap2-prod-direct.discoveryplus.in"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},spotify_com:{match:{root_urls:["spotify.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["spclient.wg.spotify.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["spclient.wg.spotify.com"],then:"PROXY US.PEER",if:[]}]},ruv_is:{match:{root_urls:["ruv.is"],rules:[{proxy_country:["IS"],cmds:[{hosts:["ruv-vod-app-dcp-v4.secure.footprint.net"],then:"PROXY IS.PEER",if:[]}]}]},cmds:[{hosts:["ruv-vod-app-dcp-v4.secure.footprint.net"],then:"PROXY IS.PEER",if:[]}]},binge_com_au:{match:{root_urls:["binge.com.au"],rules:[{proxy_country:["AU"],cmds:[{hosts:["binge.com.au","billingapi.streamotion.com.au"],then:"PROXY AU.PEER",if:[]}]}]},cmds:[{hosts:["binge.com.au","billingapi.streamotion.com.au"],then:"PROXY AU.PEER",if:[]}]},tf1_fr:{match:{root_urls:["tf1.fr"],rules:[{proxy_country:["FR"],cmds:[{root_urls:["tf1.fr"],then:"PROXY FR.POOL_lum_fr_shared",if:[]},{hosts:["mediainfo.tf1.fr","strmt.tf1.fr","tf1-das-live-ssl.tf1.fr","compte.tf1.fr"],then:"PROXY FR.PEER",if:[]}]}]},cmds:[{root_urls:["tf1.fr"],then:"PROXY FR.POOL_lum_fr_shared",if:[]},{hosts:["mediainfo.tf1.fr","strmt.tf1.fr","tf1-das-live-ssl.tf1.fr","compte.tf1.fr"],then:"PROXY FR.PEER",if:[]}]},dmm_co_jp:{match:{root_urls:["dmm.co.jp"],rules:[{proxy_country:["JP"],cmds:[{hosts:["www.dmm.co.jp"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["www.dmm.co.jp"],then:"PROXY JP.PEER",if:[]}]},dmm_com:{match:{root_urls:["dmm.com"],rules:[{proxy_country:["JP"],cmds:[{hosts:["www.dmm.com","tv.dmm.com","str.dmm.com"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["www.dmm.com","tv.dmm.com","str.dmm.com"],then:"PROXY JP.PEER",if:[]}]},prefettura_it:{match:{root_urls:["prefettura.it"],rules:[{proxy_country:["IT"],cmds:[{hosts:["prefettura.it"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]}]},cmds:[{hosts:["prefettura.it"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},my_alldata_com:{match:{root_urls:["my.alldata.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["my.alldata.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["my.alldata.com"],then:"PROXY US.PEER",if:[]}]},realauction_com:{match:{root_urls:["realauction.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["realauction.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["realauction.com"],then:"PROXY US.PEER",if:[]}]},adams_sheriffsaleauction_ohio_gov:{match:{root_urls:["adams.sheriffsaleauction.ohio.gov"],rules:[{proxy_country:["US"],cmds:[{hosts:["adams.sheriffsaleauction.ohio.gov"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["adams.sheriffsaleauction.ohio.gov"],then:"PROXY US.PEER",if:[]}]},realforeclose_com:{match:{root_urls:["realforeclose.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["realforeclose.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["realforeclose.com"],then:"PROXY US.PEER",if:[]}]},safer_fmcsa_dot_gov:{match:{root_urls:["safer.fmcsa.dot.gov"],rules:[{proxy_country:["US"],cmds:[{hosts:["safer.fmcsa.dot.gov"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["safer.fmcsa.dot.gov"],then:"PROXY US.PEER",if:[]}]},p_bandai_jp:{match:{root_urls:["p-bandai.jp"],rules:[{proxy_country:["JP"],cmds:[{hosts:["p-bandai.jp"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["p-bandai.jp"],then:"PROXY JP.PEER",if:[]}]},lemino_docomo_ne_jp:{match:{root_urls:["lemino.docomo.ne.jp"],rules:[{proxy_country:["JP"],cmds:[{hosts:["lemino.docomo.ne.jp"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["lemino.docomo.ne.jp"],then:"PROXY JP.PEER",if:[]}]},gapcanada_ca:{match:{root_urls:["gapcanada.ca"],rules:[{proxy_country:["CA"],cmds:[{hosts:["gapcanada.ca"],then:"PROXY CA.PEER",if:[]}]}]},cmds:[{hosts:["gapcanada.ca"],then:"PROXY CA.PEER",if:[]}]},chzzk_naver_com:{match:{root_urls:["chzzk.naver.com"],rules:[{proxy_country:["KR"],cmds:[{hosts:["chzzk.naver.com","livecloud.pstatic.net"],then:"PROXY KR.PEER",if:[]}]}]},cmds:[{hosts:["chzzk.naver.com","livecloud.pstatic.net"],then:"PROXY KR.PEER",if:[]}]},petsmart_com:{match:{root_urls:["petsmart.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["petsmart.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["petsmart.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},novasports_gr:{match:{root_urls:["novasports.gr"],rules:[{proxy_country:["GR"],cmds:[{hosts:["online.novasports.gr"],then:"PROXY GR.PEER",if:[]}]}]},cmds:[{hosts:["online.novasports.gr"],then:"PROXY GR.PEER",if:[]}]},albumartexchange_com:{match:{root_urls:["albumartexchange.com"],rules:[{proxy_country:["JP","ES","GB"],cmds:[{hosts:["albumartexchange.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["albumartexchange.com"],then:"PROXY XX.PEER",if:[]}]},cablevisionflow_com_ar:{match:{root_urls:["cablevisionflow.com.ar"],rules:[{proxy_country:["AR"],cmds:[{hosts:["cablevisionflow.com.ar"],then:"PROXY AR.PEER",if:[]}]}]},cmds:[{hosts:["cablevisionflow.com.ar"],then:"PROXY AR.PEER",if:[]}]},flow_com_ar:{match:{root_urls:["flow.com.ar"],rules:[{proxy_country:["AR"],cmds:[{hosts:["flow.com.ar"],then:"PROXY AR.PEER",if:[]}]}]},cmds:[{hosts:["flow.com.ar"],then:"PROXY AR.PEER",if:[]}]},outback_sylt_de:{match:{root_urls:["outback-sylt.de","outbacksylt.com"],rules:[{proxy_country:["DE"],cmds:[{hosts:["outbacksylt.com"],then:"PROXY DE.PEER",if:[]}]}]},cmds:[{hosts:["outbacksylt.com"],then:"PROXY DE.PEER",if:[]}]},tjx_com:{match:{root_urls:["tjx.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["tjx.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["tjx.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},qvc_com:{match:{root_urls:["qvc.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["qvc.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["qvc.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},gapfactory_com:{match:{root_urls:["gapfactory.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["gapfactory.com","api.gap.com","assets-gap.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["gapfactory.com","api.gap.com","assets-gap.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},rsi_ch:{match:{root_urls:["rsi.ch"],rules:[{proxy_country:["CH"],cmds:[{hosts:["srg.live.ott.irdeto.com"],then:"PROXY CH.PEER",if:[]}]}]},cmds:[{hosts:["srg.live.ott.irdeto.com"],then:"PROXY CH.PEER",if:[]}]},rts_ch:{match:{root_urls:["rts.ch"],rules:[{proxy_country:["CH"],cmds:[{hosts:["srg.live.ott.irdeto.com"],then:"PROXY CH.PEER",if:[]}]}]},cmds:[{hosts:["srg.live.ott.irdeto.com"],then:"PROXY CH.PEER",if:[]}]},srf_ch:{match:{root_urls:["srf.ch"],rules:[{proxy_country:["CH"],cmds:[{hosts:["srg.live.ott.irdeto.com"],then:"PROXY CH.PEER",if:[]}]}]},cmds:[{hosts:["srg.live.ott.irdeto.com"],then:"PROXY CH.PEER",if:[]}]},premierplayer_tv:{match:{root_urls:["premierplayer.tv"],rules:[{proxy_country:["GB"],cmds:[{hosts:["www.premierplayer.tv","live.247cdn.net","b.247cdn.net","ondemand.247cdn.net"],then:"PROXY GB.PEER",if:[]},{root_urls:["premierplayer.tv"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{hosts:["www.premierplayer.tv","live.247cdn.net","b.247cdn.net","ondemand.247cdn.net"],then:"PROXY GB.PEER",if:[]},{root_urls:["premierplayer.tv"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},mtv_ca:{match:{root_urls:["mtv.ca"],rules:[{proxy_country:["CA"],cmds:[{root_urls:["mtv.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["capi.9c9media.com"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]}]},cmds:[{root_urls:["mtv.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["capi.9c9media.com"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]},radiko_jp:{match:{root_urls:["radiko.jp"],rules:[{proxy_country:["JP"],cmds:[{hosts:["radiko.jp"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["radiko.jp"],then:"PROXY JP.PEER",if:[]}]},tver_jp:{match:{root_urls:["tver.jp"],rules:[{proxy_country:["JP"],cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY JP"}],then:"PROXY JP.PEER"}]}]},cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY JP"}],then:"PROXY JP.PEER"}]},allotalk_com:{match:{root_urls:["allotalk.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["allotalk.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["allotalk.com"],then:"PROXY US.PEER",if:[]}]},williamhill_com:{match:{root_urls:["williamhill.com"],rules:[{proxy_country:["GB"],cmds:[{hosts:["williamhill.com"],then:"PROXY GB.PEER",if:[]}]}]},cmds:[{hosts:["williamhill.com"],then:"PROXY GB.PEER",if:[]}]},joyn_de:{match:{root_urls:["joyn.de"],rules:[{proxy_country:["DE"],cmds:[{hosts:["api.joyn.de","auth.joyn.de"],then:"PROXY DE.PEER",if:[]}]}]},cmds:[{hosts:["api.joyn.de","auth.joyn.de"],then:"PROXY DE.PEER",if:[]}]},_13tv_co_il:{match:{root_urls:["13tv.co.il"],rules:[{proxy_country:["IL"],cmds:[{hosts:["log.advsnx.net","banners.advsnx.net","pagead2.googlesyndication.com","www.google-analytics.com","securepubads.g.doubleclick.net","taboola.com","secure.adnx.com","adnxs.com"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["log.advsnx.net","banners.advsnx.net","pagead2.googlesyndication.com","www.google-analytics.com","securepubads.g.doubleclick.net","taboola.com","secure.adnx.com","adnxs.com"],then:"DIRECT",if:[]}]},abema_tv:{match:{root_urls:["abema.tv"],rules:[{proxy_country:["JP"],cmds:[{hosts:["abema.tv"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["abema.tv"],then:"PROXY JP.PEER",if:[]}]},canal_plus_com:{match:{root_urls:["canal-plus.com"],rules:[{proxy_country:["FR"],cmds:[{root_urls:["canal-plus.com"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]}]},cmds:[{root_urls:["canal-plus.com"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]},zalando_fr:{match:{root_urls:["zalando.fr"],rules:[{proxy_country:["FR"],cmds:[{root_urls:["zalando.fr"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]}]},cmds:[{root_urls:["zalando.fr"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]},mewatch_sg:{match:{root_urls:["mewatch.sg"],rules:[{proxy_country:["SG"],cmds:[{hosts:["tvpapi-as.ott.kaltura.com","www.mewatch.sg","player-mc.sgp2.ott.kaltura.com","cdn.mewatch.sg"],then:"PROXY SG.PEER",if:[]}]}]},cmds:[{hosts:["tvpapi-as.ott.kaltura.com","www.mewatch.sg","player-mc.sgp2.ott.kaltura.com","cdn.mewatch.sg"],then:"PROXY SG.PEER",if:[]}]},_007song_co_kr:{match:{root_urls:["007song.co.kr"],rules:[{proxy_country:["KR"],cmds:[{hosts:["007song.co.kr"],then:"PROXY KR.PEER",if:[]}]}]},cmds:[{hosts:["007song.co.kr"],then:"PROXY KR.PEER",if:[]}]},yahoo_co_jp:{match:{root_urls:["yahoo.co.jp"],rules:[{proxy_country:["JP"],cmds:[{root_urls:["yahoo.co.jp"],then:"PROXY JP",if:[]},{hosts:["gyao.yahoo.co.jp"],if:[{url:".*gyao\\.yahoo\\.co\\.jp\\/apis\\/playback\\/graphql",type:"!~",then:"PROXY JP.PEER"}],then:"PROXY JP.PEER"}]}]},cmds:[{root_urls:["yahoo.co.jp"],then:"PROXY JP",if:[]},{hosts:["gyao.yahoo.co.jp"],if:[{url:".*gyao\\.yahoo\\.co\\.jp\\/apis\\/playback\\/graphql",type:"!~",then:"PROXY JP.PEER"}],then:"PROXY JP.PEER"}]},peacocktv_com:{match:{root_urls:["peacocktv.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["peacocktv.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{hosts:["ovp.peacocktv.com","geolocation.onetrust.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{root_urls:["peacocktv.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{hosts:["ovp.peacocktv.com","geolocation.onetrust.com"],then:"PROXY US.PEER",if:[]}]},snipesusa_com:{match:{root_urls:["snipesusa.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["snipesusa.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{root_urls:["snipesusa.com"],then:"PROXY US.PEER",if:[]}]},vtmgo_be:{match:{root_urls:["vtmgo.be"],rules:[{proxy_country:["BE"],cmds:[{hosts:["videoplayer-service.dpgmedia.net"],then:"PROXY BE.PEER",if:[]}]}]},cmds:[{hosts:["videoplayer-service.dpgmedia.net"],then:"PROXY BE.PEER",if:[]}]},nordstromrack_com:{match:{root_urls:["nordstromrack.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["nordstromrack.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["nordstromrack.com"],then:"PROXY US.PEER",if:[]}]},nowtv_com:{match:{root_urls:["nowtv.com"],rules:[{proxy_country:["GB"],cmds:[{hosts:["nowtv.com","ottsas.sky.com","persona-store.sky.com","agg.oogwayintl.sky.com","auth.client.ott.sky.com","p.sky.com","cdn.skycdp.com"],then:"PROXY GB.PEER",if:[]}]}]},cmds:[{hosts:["nowtv.com","ottsas.sky.com","persona-store.sky.com","agg.oogwayintl.sky.com","auth.client.ott.sky.com","p.sky.com","cdn.skycdp.com"],then:"PROXY GB.PEER",if:[]}]},ehealthinsurance_com:{match:{root_urls:["ehealthinsurance.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["ehealthinsurance.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["ehealthinsurance.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},swansonvitamins_com:{match:{root_urls:["swansonvitamins.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["swansonvitamins.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["swansonvitamins.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},walgreens_com:{match:{root_urls:["walgreens.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["walgreens.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["walgreens.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},qmee_com:{match:{root_urls:["qmee.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["qmee.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["qmee.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},ctv_ca:{match:{root_urls:["ctv.ca"],rules:[{proxy_country:["CA"],cmds:[{root_urls:["ctv.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["capi.9c9media.com"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["account.bellmedia.ca"],then:"PROXY CA.PEER",if:[]}]}]},cmds:[{root_urls:["ctv.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["capi.9c9media.com"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["account.bellmedia.ca"],then:"PROXY CA.PEER",if:[]}]},foodnetwork_ca:{match:{root_urls:["foodnetwork.ca"],rules:[{proxy_country:["CA"],cmds:[{root_urls:["foodnetwork.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]}]},cmds:[{root_urls:["foodnetwork.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]},b2byellowpages_com:{match:{root_urls:["b2byellowpages.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["b2byellowpages.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{root_urls:["b2byellowpages.com"],then:"PROXY US.PEER",if:[]}]},engclip_com:{match:{root_urls:["engclip.com"],rules:[{proxy_country:["IN"],cmds:[{root_urls:["engclip.com"],then:"PROXY IN",if:[]},{hosts:["proxy-32.sg1.dailymotion.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]}]},cmds:[{root_urls:["engclip.com"],then:"PROXY IN",if:[]},{hosts:["proxy-32.sg1.dailymotion.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},footpatrol_co_uk:{match:{root_urls:["footpatrol.co.uk","footpatrol.com"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["footpatrol.co.uk","footpatrol.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["footpatrol.co.uk","footpatrol.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},jdsports_co_uk:{match:{root_urls:["jdsports.co.uk"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["jdsports.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["jdsports.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},size_co_uk:{match:{root_urls:["size.co.uk"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["size.co.uk"],then:"PROXY GB.PEER",if:[]}]}]},cmds:[{root_urls:["size.co.uk"],then:"PROXY GB.PEER",if:[]}]},tui_co_uk:{match:{root_urls:["tui.co.uk"],rules:[{proxy_country:["GB"],cmds:[{hosts:["tui.co.uk"],then:"PROXY GB.PEER",if:[]}]}]},cmds:[{hosts:["tui.co.uk"],then:"PROXY GB.PEER",if:[]}]},blutv_com:{match:{root_urls:["blutv.com"],rules:[{proxy_country:["TR"],cmds:[{hosts:["blutv.com"],then:"PROXY TR.PEER",if:[]}]}]},cmds:[{hosts:["blutv.com"],then:"PROXY TR.PEER",if:[]}]},garena_com:{match:{root_urls:["garena.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["garena.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["garena.com"],then:"PROXY US.PEER",if:[]}]},offerup_com:{match:{root_urls:["offerup.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["offerup.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["offerup.com"],then:"PROXY US.PEER",if:[]}]},mugenarchive_com:{match:{root_urls:["mugenarchive.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["mugenarchive.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["mugenarchive.com"],then:"PROXY US.PEER",if:[]}]},lostfilm_tv:{match:{root_urls:["lostfilm.tv"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY BR.POOL_lum_br_shared"}]}]},cmds:[{root_urls:["lostfilm.tv"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},prende_tv:{match:{root_urls:["lostfilm.tv"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["lostfilm.tv"],then:"PROXY BR.POOL_lum_br_shared"}]}]},cmds:[{root_urls:["lostfilm.tv"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},realtaxdeed_com:{match:{root_urls:["realtaxdeed.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["realtaxdeed.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["realtaxdeed.com"],then:"PROXY US.PEER",if:[]}]},homify_com:{match:{root_urls:["homify.com"],rules:[{cmds:[{hosts:["homify.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["homify.com"],then:"PROXY XX.PEER",if:[]}]},country_rule:{client_only:true,match:{min_ver:"1.170.260",root_urls:[""],rules:[{proxy_country:["KR"],cmds:[{proxy_country:["KR"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]}]},cmds:[{proxy_country:["KR"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]},sotostore_com:{match:{root_urls:["sotostore.com"],rules:[{proxy_country:["DE"],cmds:[{hosts:["www.sotostore.com"],then:"PROXY DE.PEER",if:[]}]}]},cmds:[{hosts:["www.sotostore.com"],then:"PROXY DE.PEER",if:[]}]},foxtel_com_au:{match:{root_urls:["foxtel.com.au"],rules:[{proxy_country:["AU"],cmds:[{hosts:["foxtel.com.au"],then:"PROXY AU.PEER",if:[]}]}]},cmds:[{hosts:["foxtel.com.au"],then:"PROXY AU.PEER",if:[]}]},indavideo_hu:{match:{root_urls:["indavideo.hu"],rules:[{proxy_country:["HU"],cmds:[{hosts:["embed.indavideo.hu"],then:"PROXY HU.PEER",if:[]}]}]},cmds:[{hosts:["embed.indavideo.hu"],then:"PROXY HU.PEER",if:[]}]},vroom_com:{match:{root_urls:["vroom.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["vroom.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["vroom.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},pontofrio_com_br:{match:{root_urls:["pontofrio.com.br"],rules:[{proxy_country:["BR"],cmds:[{root_urls:["pontofrio.com.br"],then:"PROXY BR.POOL_lum_br_shared",if:[]},{hosts:["imgs.ponto.com.br","imgs.pontofrio.com.br","pontofrio-imagens.com.br"],then:"PROXY BR.PEER",if:[]}]}]},cmds:[{root_urls:["pontofrio.com.br"],then:"PROXY BR.POOL_lum_br_shared",if:[]},{hosts:["imgs.ponto.com.br","imgs.pontofrio.com.br","pontofrio-imagens.com.br"],then:"PROXY BR.PEER",if:[]}]},marshalls_com:{match:{root_urls:["marshalls.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["marshalls.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["marshalls.com"],then:"PROXY US.PEER",if:[]}]},dplay_co_uk:{match:{root_urls:["dplay.co.uk"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["dplay.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["dplay.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},atresplayer_com:{match:{root_urls:["atresplayer.com"],rules:[{proxy_country:["ES"],cmds:[{root_urls:["atresplayer.com"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["api.atresplayer.com","directo.atresmedia.com","atres-live.atresmedia.com"],then:"PROXY ES.PEER",if:[]}]}]},cmds:[{root_urls:["atresplayer.com"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["api.atresplayer.com","directo.atresmedia.com","atres-live.atresmedia.com"],then:"PROXY ES.PEER",if:[]}]},footlocker_co_uk:{match:{root_urls:["footlocker.co.uk"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["footlocker.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["footlocker.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},pxg_co_kr:{match:{root_urls:["pxg.co.kr"],rules:[{proxy_country:["US"],cmds:[{root_urls:["pxg.co.kr"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["pxg.co.kr"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},udemy_com:{match:{root_urls:["udemy.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["stripe.com"],then:"DIRECT",if:[]},{root_urls:["udemy.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},{proxy_country:["AR"],cmds:[{hosts:["stripe.com"],then:"DIRECT"}]},{proxy_country:["DE"],cmds:[{hosts:["stripe.com"],then:"DIRECT"}]}]},cmds:[{hosts:["stripe.com"],then:"DIRECT",if:[]},{root_urls:["udemy.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},gamovideo_com:{match:{root_urls:["gamovideo.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["gamovideo.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["gamovideo.com"],then:"PROXY US.PEER",if:[]}]},yellowpages_com:{match:{root_urls:["yellowpages.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["yellowpages.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["yellowpages.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},lawyers_com:{match:{root_urls:["lawyers.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["lawyers.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["lawyers.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},filmizlesene_pro:{match:{root_urls:["filmizlesene.pro"],rules:[{proxy_country:["TR"],cmds:[{hosts:["filmizlesene.pro","film.popcornvakti.net","molystream.net","94194215.xyz","32933054.xyz","92792817.xyz","50250338.xyz","15815990.xyz","20620748.xyz","73773887.xyz","86186297.xyz","21121243.xyz","54754838.xyz","34034151.xyz","78378442.xyz","13113291.xyz","87187299.xyz","22422544.xyz","29229392.xyz","76476541.xyz","74975080.xyz","34334451.xyz","13113292.xyz","42742864.xyz","60360478.xyz","29329494.xyz","71071180.xyz","59059178.xyz","51251338.xyz","56056176.xyz","10410597.xyz","64864974.xyz","74074187.xyz","30330450.xyz","27827995.xyz","14414593.xyz","72672785.xyz","40941062.xyz","30230352.xyz","25425592.xyz","52852931.xyz","76376440.xyz","20020192.xyz","58658770.xyz","26226395.xyz","10310490.xyz","41041165.xyz","20120240.xyz","18718897.xyz","77677745.xyz","41041161.xyz","76476542.xyz","79479542.xyz"],then:"PROXY TR.PEER",if:[]}]}]},cmds:[{hosts:["filmizlesene.pro","film.popcornvakti.net","molystream.net","94194215.xyz","32933054.xyz","92792817.xyz","50250338.xyz","15815990.xyz","20620748.xyz","73773887.xyz","86186297.xyz","21121243.xyz","54754838.xyz","34034151.xyz","78378442.xyz","13113291.xyz","87187299.xyz","22422544.xyz","29229392.xyz","76476541.xyz","74975080.xyz","34334451.xyz","13113292.xyz","42742864.xyz","60360478.xyz","29329494.xyz","71071180.xyz","59059178.xyz","51251338.xyz","56056176.xyz","10410597.xyz","64864974.xyz","74074187.xyz","30330450.xyz","27827995.xyz","14414593.xyz","72672785.xyz","40941062.xyz","30230352.xyz","25425592.xyz","52852931.xyz","76376440.xyz","20020192.xyz","58658770.xyz","26226395.xyz","10310490.xyz","41041165.xyz","20120240.xyz","18718897.xyz","77677745.xyz","41041161.xyz","76476542.xyz","79479542.xyz"],then:"PROXY TR.PEER",if:[]}]},dizibox_pw:{match:{root_urls:["dizibox.pw"],rules:[{proxy_country:["US"],cmds:[{hosts:["dizibox.pw"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["dizibox.pw"],then:"PROXY US.PEER",if:[]}]},skynews_com_au:{match:{root_urls:["skynews.com.au"],rules:[{proxy_country:["AU"],cmds:[{hosts:["www.skynews.com.au"],then:"PROXY AU.PEER",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY AU"}],then:"PROXY AU.PEER"}]}]},cmds:[{hosts:["www.skynews.com.au"],then:"PROXY AU.PEER",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY AU"}],then:"PROXY AU.PEER"}]},sbt_com_br:{match:{root_urls:["sbt.com.br"],rules:[{proxy_country:["BR"],cmds:[{hosts:["sbt.com.br"],then:"PROXY BR.PEER",if:[]}]}]},cmds:[{hosts:["sbt.com.br"],then:"PROXY BR.PEER",if:[]}]},bfi_org_uk:{match:{root_urls:["bfi.org.uk"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["bfi.org.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["bfi.org.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},ocs_fr:{match:{root_urls:["ocs.fr"],rules:[{proxy_country:["FR"],cmds:[{root_urls:["ocs.fr"],then:"PROXY FR.PEER",if:[]},{hosts:["www.ocs.fr","statics.ocs.fr","api.ocs.fr"],then:"PROXY FR.PEER",if:[]}]}]},cmds:[{root_urls:["ocs.fr"],then:"PROXY FR.PEER",if:[]},{hosts:["www.ocs.fr","statics.ocs.fr","api.ocs.fr"],then:"PROXY FR.PEER",if:[]}]},line_me:{match:{root_urls:["line.me"],rules:[{cmds:[{proxy_country:["TW"],hosts:["line.me"],then:"PROXY TW.PEER",if:[]}]}]},cmds:[{proxy_country:["TW"],hosts:["line.me"],then:"PROXY TW.PEER",if:[]}]},cbc_ca:{match:{root_urls:["cbc.ca"],rules:[{proxy_country:["CA"],cmds:[{root_urls:["cbc.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]}]},cmds:[{root_urls:["cbc.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]},tving_com:{match:{root_urls:["tving.com"],rules:[{proxy_country:["KR"],cmds:[{root_urls:["tving.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]},{hosts:["api.tving.com"],then:"PROXY KR.PEER",if:[]}]}]},cmds:[{root_urls:["tving.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]},{hosts:["api.tving.com"],then:"PROXY KR.PEER",if:[]}]},afreecatv_com:{match:{root_urls:["afreecatv.com"],rules:[{proxy_country:["KR"],cmds:[{hosts:["pc-web.stream.afreecatv.com"],then:"PROXY KR.PEER",if:[]},{hosts:["afreecatv.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]}]},cmds:[{hosts:["pc-web.stream.afreecatv.com"],then:"PROXY KR.PEER",if:[]},{hosts:["afreecatv.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]},vlive_tv:{match:{root_urls:["vlive.tv"],rules:[{proxy_country:["KR"],cmds:[{root_urls:["vlive.tv"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]}]},cmds:[{root_urls:["vlive.tv"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]},viki_com:{match:{root_urls:["viki.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["viki.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["1.viki.io"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["viki.com"],then:"PROXY CA.POOL_lum_ca_shared"},{hosts:["1.viki.io"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["viki.com"],then:"PROXY GB.POOL_lum_gb_shared"},{hosts:["1.viki.io"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["viki.com"],then:"PROXY NL.POOL_lum_nl_shared"},{hosts:["1.viki.io"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["viki.com"],then:"PROXY FR.POOL_lum_fr_shared"},{hosts:["1.viki.io"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["viki.com"],then:"PROXY ES.POOL_lum_es_shared"},{hosts:["1.viki.io"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["viki.com"],then:"PROXY US.POOL_lum_us_shared"},{hosts:["1.viki.io"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["viki.com"],then:"PROXY KR.POOL_lum_kr_shared"},{hosts:["1.viki.io"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["viki.com"],then:"PROXY BR.POOL_lum_br_shared"},{hosts:["1.viki.io"],then:"PROXY BR.POOL_lum_br_shared"}]}]},cmds:[{root_urls:["viki.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["1.viki.io"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},ruliweb_com:{match:{root_urls:["ruliweb.com"],rules:[{proxy_country:["KR"],cmds:[{root_urls:["ruliweb.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]}]},cmds:[{root_urls:["ruliweb.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]},nexon_com:{match:{root_urls:["nexon.com"],rules:[{proxy_country:["KR"],cmds:[{root_urls:["nexon.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]}]},cmds:[{root_urls:["nexon.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]},dcinside_com:{match:{root_urls:["dcinside.com"],rules:[{proxy_country:["KR"],cmds:[{root_urls:["dcinside.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]}]},cmds:[{root_urls:["dcinside.com"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]},licindia_in:{match:{root_urls:["licindia.in"],rules:[{proxy_country:["IN"],cmds:[{root_urls:["licindia_in"],then:"PROXY IN",if:[]}]}]},cmds:[{root_urls:["licindia_in"],then:"PROXY IN",if:[]}]},yupptv_com:{match:{root_urls:["yupptv.com"],rules:[{proxy_country:["IN"],cmds:[{hosts:["www.yupptv.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]}]},cmds:[{hosts:["www.yupptv.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},lenskart_com:{match:{root_urls:["lenskart.com"],rules:[{proxy_country:["IN"],cmds:[{hosts:["lenskart.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]}]},cmds:[{hosts:["lenskart.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},sunnxt_com:{match:{root_urls:["sunnxt.com"],rules:[{proxy_country:["IN"],cmds:[{root_urls:["sunnxt.com"],then:"PROXY IN",if:[]}]}]},cmds:[{root_urls:["sunnxt.com"],then:"PROXY IN",if:[]}]},primevideo_com:{match:{root_urls:["primevideo.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["primevideo.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["GB"],cmds:[{root_urls:["primevideo.com"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["primevideo.com"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["primevideo.com"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["primevideo.com"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["primevideo.com"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["primevideo.com"],then:"PROXY BR.POOL_lum_br_shared"}]},{proxy_country:["IN"],cmds:[{root_urls:["primevideo.com"],then:"PROXY IN.POOL_lum_in_shared"}]},{proxy_country:["AR","AT","AU","BE","BG","CA","CH","CL","CO","CZ","DE","DK","ES","FI","GR","HK","HR","HU","ID","IE","IL","IS","JP","MX","NO","NZ","PL","RO","RU","SE","SG","SK","TR","NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA"],cmds:[{hosts:["atv-ps-eu.primevideo.com","primevideo.com","api.eu-west-1.aiv-delivery.net"],then:"PROXY XX.PEER"}]}]},cmds:[{root_urls:["primevideo.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},zee5_com:{match:{root_urls:["zee5.com"],rules:[{proxy_country:["IN"],cmds:[{hosts:["zee5.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]}]},cmds:[{hosts:["zee5.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},voot_com:{match:{root_urls:["voot.com"],rules:[{proxy_country:["IN"],cmds:[{root_urls:["voot.com"],if:[{host:"(?:google-analytics\\.com|analytics\\.twitter\\.com|googleadservices\\.com|p\\.adsymptotic\\.com|googletagmanager\\.com|bat\\.bing\\.com|adservice\\.google\\.com|doubleclick\\.net|gstatic\\.com|googlesyndication\\.com|2mdn\\.net|q\\.quora\\.com|analytics\\.edgekey\\.net|amazon-adsystem\\.com|users\\.quantumgraph\\.com|images-na\\.ssl-images-amazon\\.com|bh\\.contextweb\\.com|pixel-sync\\.sitescout\\.com|ads-twitter\\.com|googletagservices\\.com|scorecardresearch\\.com|outbrain\\.com|cdnjs\\.cloudflare\\.com|adservice\\.google\\.com\\.pk|adservice\\.google\\.com\\.ph|adroll\\.com|analytics\\.yahoo\\.com|spl\\.zeotap\\.com|a-ads\\.com|google\\.com|google\\.co\\.in|facebook\\.com|facebook\\.net|t\\.co|rubiconproject\\.com|google\\.com\\.bd|mixpanel\\.com|go-mpulse\\.net|google\\.com\\.au|googleapis\\.com)$",type:"=~",then:"PROXY XX"}],then:"PROXY IN.POOL_lum_in_shared"}]}]},cmds:[{root_urls:["voot.com"],if:[{host:"(?:google-analytics\\.com|analytics\\.twitter\\.com|googleadservices\\.com|p\\.adsymptotic\\.com|googletagmanager\\.com|bat\\.bing\\.com|adservice\\.google\\.com|doubleclick\\.net|gstatic\\.com|googlesyndication\\.com|2mdn\\.net|q\\.quora\\.com|analytics\\.edgekey\\.net|amazon-adsystem\\.com|users\\.quantumgraph\\.com|images-na\\.ssl-images-amazon\\.com|bh\\.contextweb\\.com|pixel-sync\\.sitescout\\.com|ads-twitter\\.com|googletagservices\\.com|scorecardresearch\\.com|outbrain\\.com|cdnjs\\.cloudflare\\.com|adservice\\.google\\.com\\.pk|adservice\\.google\\.com\\.ph|adroll\\.com|analytics\\.yahoo\\.com|spl\\.zeotap\\.com|a-ads\\.com|google\\.com|google\\.co\\.in|facebook\\.com|facebook\\.net|t\\.co|rubiconproject\\.com|google\\.com\\.bd|mixpanel\\.com|go-mpulse\\.net|google\\.com\\.au|googleapis\\.com)$",type:"=~",then:"PROXY XX"}],then:"PROXY IN.POOL_lum_in_shared"}]},mxplayer_in:{match:{root_urls:["mxplayer.in"],rules:[{proxy_country:["IN"],cmds:[{root_urls:["mxplayer.in"],if:[{host:"(?:google-analytics\\.com|analytics\\.twitter\\.com|googleadservices\\.com|p\\.adsymptotic\\.com|googletagmanager\\.com|bat\\.bing\\.com|adservice\\.google\\.com|doubleclick\\.net|gstatic\\.com|googlesyndication\\.com|2mdn\\.net|q\\.quora\\.com|analytics\\.edgekey\\.net|amazon-adsystem\\.com|users\\.quantumgraph\\.com|images-na\\.ssl-images-amazon\\.com|bh\\.contextweb\\.com|pixel-sync\\.sitescout\\.com|ads-twitter\\.com|googletagservices\\.com|scorecardresearch\\.com|outbrain\\.com|cdnjs\\.cloudflare\\.com|adservice\\.google\\.com\\.pk|adservice\\.google\\.com\\.ph|adroll\\.com|analytics\\.yahoo\\.com|spl\\.zeotap\\.com|a-ads\\.com|google\\.com|google\\.co\\.in|facebook\\.com|facebook\\.net|t\\.co|rubiconproject\\.com|google\\.com\\.bd|mixpanel\\.com|go-mpulse\\.net|google\\.com\\.au|googleapis\\.com)$",type:"=~",then:"PROXY XX"}],then:"PROXY IN.POOL_lum_in_shared"}]}]},cmds:[{root_urls:["mxplayer.in"],if:[{host:"(?:google-analytics\\.com|analytics\\.twitter\\.com|googleadservices\\.com|p\\.adsymptotic\\.com|googletagmanager\\.com|bat\\.bing\\.com|adservice\\.google\\.com|doubleclick\\.net|gstatic\\.com|googlesyndication\\.com|2mdn\\.net|q\\.quora\\.com|analytics\\.edgekey\\.net|amazon-adsystem\\.com|users\\.quantumgraph\\.com|images-na\\.ssl-images-amazon\\.com|bh\\.contextweb\\.com|pixel-sync\\.sitescout\\.com|ads-twitter\\.com|googletagservices\\.com|scorecardresearch\\.com|outbrain\\.com|cdnjs\\.cloudflare\\.com|adservice\\.google\\.com\\.pk|adservice\\.google\\.com\\.ph|adroll\\.com|analytics\\.yahoo\\.com|spl\\.zeotap\\.com|a-ads\\.com|google\\.com|google\\.co\\.in|facebook\\.com|facebook\\.net|t\\.co|rubiconproject\\.com|google\\.com\\.bd|mixpanel\\.com|go-mpulse\\.net|google\\.com\\.au|googleapis\\.com)$",type:"=~",then:"PROXY XX"}],then:"PROXY IN.POOL_lum_in_shared"}]},huurwoningen_nl:{match:{root_urls:["huurwoningen.nl"],rules:[{proxy_country:["NL"],cmds:[{root_urls:["huurwoningen.nl"],then:"PROXY NL.POOL_lum_nl_shared",if:[]}]}]},cmds:[{root_urls:["huurwoningen.nl"],then:"PROXY NL.POOL_lum_nl_shared",if:[]}]},videoland_com:{match:{root_urls:["videoland.com","v2.videoland.com"],rules:[{proxy_country:["NL"],cmds:[{hosts:["videoland.bedrock.tech","videoland.com"],then:"PROXY NL.PEER",if:[]}]}]},cmds:[{hosts:["videoland.bedrock.tech","videoland.com"],then:"PROXY NL.PEER",if:[]}]},nos_nl:{match:{root_urls:["nos.nl"],rules:[{proxy_country:["NL"],cmds:[{root_urls:["nos.nl"],then:"PROXY NL.POOL_lum_nl_shared",if:[]},{hosts:["resolver.streaming.api.nos.nl","cdn.streamgate.nl"],then:"PROXY NL.PEER",if:[]},{hosts:["npo.nl","npostreaming.nl"],then:"PROXY NL.POOL_lum_nl_shared",if:[]}]}]},cmds:[{root_urls:["nos.nl"],then:"PROXY NL.POOL_lum_nl_shared",if:[]},{hosts:["resolver.streaming.api.nos.nl","cdn.streamgate.nl"],then:"PROXY NL.PEER",if:[]},{hosts:["npo.nl","npostreaming.nl"],then:"PROXY NL.POOL_lum_nl_shared",if:[]}]},kakao_com:{match:{root_urls:["kakao.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["kakao.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["kakao.com"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["kakao.com"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["kakao.com"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["kakao.com"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["kakao.com"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["kakao.com"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["kakao.com"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["kakao.com"],then:"PROXY BR.POOL_lum_br_shared"}]}]},cmds:[{root_urls:["kakao.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},npostart_nl:{match:{root_urls:["npostart.nl","npo.nl"],rules:[{proxy_country:["NL"],cmds:[{hosts:["npostart.nl","cdn.streamgate.nl","nepworldwide.nl","npo.prd.cdn.bcms.kpn.com","atconnect.npo.nl","start-player.npo.nl","tellerapi.npo.nl","prod.npoplayer.nl"],then:"PROXY NL.PEER",if:[]}]}]},cmds:[{hosts:["npostart.nl","cdn.streamgate.nl","nepworldwide.nl","npo.prd.cdn.bcms.kpn.com","atconnect.npo.nl","start-player.npo.nl","tellerapi.npo.nl","prod.npoplayer.nl"],then:"PROXY NL.PEER",if:[]}]},steampowered_com:{match:{root_urls:["steampowered.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["steampowered.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["steampowered.com"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["steampowered.com"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["steampowered.com"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["steampowered.com"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["steampowered.com"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["steampowered.com"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["steampowered.com"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["steampowered.com"],then:"PROXY BR.POOL_lum_br_shared"}]},{proxy_country:["NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA"],cmds:[{hosts:["steampowered.com","store.steampowered.com"],then:"PROXY XX.PEER"}]}]},cmds:[{root_urls:["steampowered.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},wormate_io:{match:{root_urls:["wormate.io"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["wormate.io"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["wormate.io"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["wormate.io"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["wormate.io"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["wormate.io"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["wormate.io"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["wormate.io"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["wormate.io"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["wormate.io"],then:"PROXY BR.POOL_lum_br_shared"}]}]},cmds:[{root_urls:["wormate.io"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},uol_com_br:{match:{root_urls:["uol.com.br"],rules:[{proxy_country:["BR"],cmds:[{root_urls:["uol.com.br"],then:"PROXY BR.POOL_lum_br_shared",if:[]}]}]},cmds:[{root_urls:["uol.com.br"],then:"PROXY BR.POOL_lum_br_shared",if:[]}]},metamask_io:{match:{root_urls:["metamask.io"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["metamask.io"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["metamask.io"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["metamask.io"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["metamask.io"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["metamask.io"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["metamask.io"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["metamask.io"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["metamask.io"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["metamask.io"],then:"PROXY BR.POOL_lum_br_shared"}]}]},cmds:[{root_urls:["metamask.io"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},globo_com:{match:{root_urls:["globo.com"],rules:[{proxy_country:["BR"],cmds:[{root_urls:["globo.com"],then:"PROXY BR.POOL_lum_br_shared",if:[]},{hosts:["video.globo.com"],then:"PROXY BR.PEER",if:[]}]}]},cmds:[{root_urls:["globo.com"],then:"PROXY BR.POOL_lum_br_shared",if:[]},{hosts:["video.globo.com"],then:"PROXY BR.PEER",if:[]}]},borderlands_com:{match:{root_urls:["borderlands.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["borderlands.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["borderlands.com"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["borderlands.com"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["borderlands.com"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["borderlands.com"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["borderlands.com"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["borderlands.com"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["borderlands.com"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["borderlands.com"],then:"PROXY BR.POOL_lum_br_shared"}]}]},cmds:[{root_urls:["borderlands.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},bet365_com:{match:{root_urls:["bet365.com"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["bet365.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},{proxy_country:["US"],cmds:[{root_urls:["bet365.com"],then:"PROXY US.POOL_lum_us_shared"}]}]},cmds:[{root_urls:["bet365.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},totalwine_com:{match:{root_urls:["totalwine.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["www.totalwine.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["www.totalwine.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},lasestrellas_tv:{match:{root_urls:["lasestrellas_tv"],rules:[{proxy_country:["MX"],cmds:[{hosts:["onlymex-auth.televisa.com"],then:"PROXY MX.PEER",if:[]}]}]},cmds:[{hosts:["onlymex-auth.televisa.com"],then:"PROXY MX.PEER",if:[]}]},criteo_com:{match:{root_urls:["criteo.com"],rules:[{cmds:[{hosts:["criteo.com"],then:"PROXY XX",if:[]}]}]},cmds:[{hosts:["criteo.com"],then:"PROXY XX",if:[]}]},target_com:{match:{root_urls:["target.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["gsp.target.com","login.target.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["gsp.target.com","login.target.com"],then:"PROXY US.PEER",if:[]}]},atv_at:{match:{root_urls:["atv.at"],rules:[{proxy_country:["AT"],cmds:[{hosts:["blocked-multiscreen.atv.cdn.tvnext.tv"],then:"PROXY AT.PEER",if:[]}]}]},cmds:[{hosts:["blocked-multiscreen.atv.cdn.tvnext.tv"],then:"PROXY AT.PEER",if:[]}]},williams_sonoma_com:{match:{root_urls:["williams-sonoma.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["williams-sonoma.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["williams-sonoma.com"],then:"PROXY US.PEER",if:[]}]},player_pl:{match:{root_urls:["player.pl"],rules:[{proxy_country:["PL"],cmds:[{hosts:["player.pl"],if:[{url:"\\/playerapi\\/product\\/.*\\/player\\/configuration.*",type:"!~",then:"PROXY PL"}],then:"PROXY PL.PEER"}]}]},cmds:[{hosts:["player.pl"],if:[{url:"\\/playerapi\\/product\\/.*\\/player\\/configuration.*",type:"!~",then:"PROXY PL"}],then:"PROXY PL.PEER"}]},bigbrothercanada_ca:{match:{root_urls:["bigbrothercanada.ca"],rules:[{proxy_country:["CA"],cmds:[{hosts:["livestream.com","playback.akamaized.net","playback2.akamaized.net","global.corusappservices.com","bigbrothercanada.ca"],then:"PROXY CA.PEER",if:[]}]}]},cmds:[{hosts:["livestream.com","playback.akamaized.net","playback2.akamaized.net","global.corusappservices.com","bigbrothercanada.ca"],then:"PROXY CA.PEER",if:[]}]},backcountry_com:{match:{root_urls:["backcountry.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["backcountry.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["backcountry.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},eclinicalweb_com:{match:{root_urls:["eclinicalweb.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["eclinicalweb.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{root_urls:["eclinicalweb.com"],then:"PROXY US.PEER",if:[]}]},sweetgreen_com:{match:{root_urls:["sweetgreen.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["sweetgreen.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["sweetgreen.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},carvana_com:{proxy_country:["US"],cmds:[{root_urls:["carvana.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},investopedia_com:{match:{root_urls:["investopedia.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["trafficguardapp.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["trafficguardapp.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},on_orf_at:{match:{root_urls:["orf.at","on.orf.at"],rules:[{proxy_country:["AT"],cmds:[{hosts:["sf.apa.at","mdn.ors.at","orf.at","bitmovin.com"],then:"PROXY AT.PEER",if:[]}]}]},cmds:[{hosts:["sf.apa.at","mdn.ors.at","orf.at","bitmovin.com"],then:"PROXY AT.PEER",if:[]}]},servustv_com:{match:{root_urls:["servustv.com"],rules:[{proxy_country:["AT"],cmds:[{hosts:["stv-live.akamaized.net","rbmn-live.akamaized.net"],then:"PROXY AT.PEER",if:[]}]}]},cmds:[{hosts:["stv-live.akamaized.net","rbmn-live.akamaized.net"],then:"PROXY AT.PEER",if:[]}]},mol_gov_sa:{match:{root_urls:["mol.gov.sa"],rules:[{proxy_country:["SA"],cmds:[{hosts:["mol.gov.sa"],then:"PROXY SA.PEER",if:[]}]}]},cmds:[{hosts:["mol.gov.sa"],then:"PROXY SA.PEER",if:[]}]},lsm_lv:{match:{root_urls:["lsm.lv"],rules:[{proxy_country:["LV"],cmds:[{hosts:["ltv.lsm.lv","embed.cloudycdn.services","ltv1060.cloudycdn.services","ltv2060.cloudycdn.services"],then:"PROXY LV.PEER",if:[]}]}]},cmds:[{hosts:["ltv.lsm.lv","embed.cloudycdn.services","ltv1060.cloudycdn.services","ltv2060.cloudycdn.services"],then:"PROXY LV.PEER",if:[]}]},eidf_co_kr:{match:{root_urls:["eidf.co.kr"],rules:[{proxy_country:["KR"],cmds:[{hosts:["www.eidf.co.kr"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]}]},cmds:[{hosts:["www.eidf.co.kr"],then:"PROXY KR.POOL_lum_kr_shared",if:[]}]},abercrombie_com:{proxy_country:["US"],cmds:[{root_urls:["abercrombie.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},amazon_com:{match:{root_urls:["amazon.com"],rules:[{proxy_country:["AU","CO","IT","CA","NL","FR","ES","US","KR","BR"],cmds:[{root_urls:["amazon.com"],if:[{host:"d2y5sgsy8bbmb8.cloudfront.net",type:"==",then:"PROXY US.PEER"},{host:"cloudfront\\.net$",type:"=~",then:"PROXY XX"}],then:"PROXY XX.PEER"},{hosts:["amazon-adsystem.com","images-na.ssl-images-amazon.com"],then:"PROXY XX",if:[]},{hosts:["amazon.com","api.amazonvideo.com","atv-ps.amazon.com","media-amazon.com","api.eu-west-1.aiv-delivery.net","a41avoddashs3ww-a.akamaihd.net","d2y5sgsy8bbmb8.cloudfront.net","api.us-east-1.aiv-delivery.net","merch.amazon.com","www.amazon.com"],then:"PROXY XX.PEER",if:[]}]}]}},amazon_co_uk:{match:{root_urls:["amazon.co.uk"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["amazon.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["amazon.com","api.amazonvideo.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["amazon.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["amazon.com","api.amazonvideo.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},amazon_de:{match:{root_urls:["amazon.de"],rules:[{proxy_country:["DE"],cmds:[{hosts:["www.amazon.de","atv-ps-eu.amazon.de"],then:"PROXY DE.PEER",if:[]}]}]},cmds:[{hosts:["www.amazon.de","atv-ps-eu.amazon.de"],then:"PROXY DE.PEER",if:[]}]},amazon_co_jp:{match:{root_urls:["amazon.co.jp"],rules:[{proxy_country:["JP"],cmds:[{hosts:["www.amazon.co.jp","atv-ps-fe.amazon.co.jp"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["www.amazon.co.jp","atv-ps-fe.amazon.co.jp"],then:"PROXY JP.PEER",if:[]}]},amazon_in:{match:{root_urls:["amazon.in"],rules:[{proxy_country:["IN"],cmds:[{hosts:["www.amazon.in"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]}]},cmds:[{hosts:["www.amazon.in"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},ondemandkorea_com:{proxy_country:["US"],cmds:[{root_urls:["ondemandkorea.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},champssports_com:{match:{root_urls:["champssports.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["champssports.com","captcha-delivery.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["champssports.com","captcha-delivery.com"],then:"PROXY US.PEER",if:[]}]},origin_com:{proxy_country:["US"],cmds:[{root_urls:["origin.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},disneyplus_com:{match:{root_urls:["disneyplus.com"],rules:[{proxy_country:["IT"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY IT.PEER",if:[]},{root_urls:["disneyplus.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY CA.PEER"},{root_urls:["disneyplus.com"],then:"PROXY CA.POOL_lum_ca_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY GB.PEER"},{root_urls:["disneyplus.com"],then:"PROXY GB.POOL_lum_gb_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY NL.PEER"},{root_urls:["disneyplus.com"],then:"PROXY NL.POOL_lum_nl_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY FR.PEER"},{root_urls:["disneyplus.com"],then:"PROXY FR.POOL_lum_fr_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY ES.PEER"},{root_urls:["disneyplus.com"],then:"PROXY ES.POOL_lum_es_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY US.PEER"},{root_urls:["disneyplus.com"],then:"PROXY US.POOL_lum_us_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["HK"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY HK.PEER"},{root_urls:["disneyplus.com"],then:"PROXY HK.PEER"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY HK.PEER"}]},{proxy_country:["KR"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY KR.PEER"},{root_urls:["disneyplus.com"],then:"PROXY KR.POOL_lum_kr_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY BR.PEER"},{root_urls:["disneyplus.com"],then:"PROXY BR.POOL_lum_br_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY BR.POOL_lum_br_shared"}]},{proxy_country:["JP"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY JP.PEER"},{root_urls:["disneyplus.com"],then:"PROXY JP.PEER"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY JP.PEER"}]},{proxy_country:["IN"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY IN.PEER"},{root_urls:["disneyplus.com"],then:"PROXY IN.POOL_lum_in_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY IN.POOL_lum_in_shared"}]},{proxy_country:["AU"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY AU.PEER"},{root_urls:["disneyplus.com"],then:"PROXY AU.POOL_lum_au_shared"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY AU.POOL_lum_au_shared"}]},{proxy_country:["BO"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY BO.PEER"},{root_urls:["disneyplus.com"],then:"PROXY BO.PEER"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY BO.PEER"}]},{proxy_country:["NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY XX.PEER"},{root_urls:["disneyplus.com"],then:"PROXY XX.PEER"},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY XX.PEER"}]}]}},hbonow_com:{match:{root_urls:["hbonow.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["comet.api.hbo.com","play.hbonow.com"],then:"PROXY US.PEER",if:[]},{root_urls:["hbonow.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]}},hbomax_com:{match:{root_urls:["hbomax.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]},{root_urls:["hbomax.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},{proxy_country:["BR"],cmds:[{root_urls:["hbomax.com"],then:"PROXY BR.POOL_lum_br_shared"}]},{proxy_country:["AR","AT","AU","BE","BG","BR","CA","CH","CL","CO","CZ","DE","DK","ES","FI","FR","GB","GR","HK","HR","HU","ID","IE","IL","IN","IT","IS","JP","KR","MX","NL","NO","NZ","PL","RO","RU","SE","SG","SK","TR","US","NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA"],cmds:[{hosts:["gateway.api.hbo.com","comet.api.hbo.com","play.hbonow.com","oauth.api.hbo.com","oauth-emea.api.hbo.com","oauth-us.api.hbo.com","gateway-latam.api.hbo.com","telegraph.api.hbo.com","sessions.api.hbo.com","comet-latam.api.hbo.com","api.hbo.com","drm-us.api.hbo.com","manifests.api.hbo.com","user-comet.api.hbo.com"],then:"PROXY XX.PEER"}]}]}},cbs_com:{match:{root_urls:["cbs.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["cbsivideo.com","cbsaavideo.com","link.theplatform.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{root_urls:["cbs.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["cbsivideo.com","cbsaavideo.com","link.theplatform.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{root_urls:["cbs.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},canalplus_com:{proxy_country:["FR"],cmds:[{root_urls:["canalplus.com","hodor.canalplus.pro"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]},liverugby_net:{proxy_country:["GB"],cmds:[{root_urls:["liverugby.net"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},zagonka_tv:{proxy_country:["GB"],cmds:[{root_urls:["zagonka.tv"],then:"PROXY GB.PEER",if:[]}]},areena_yle_fi:{match:{root_urls:["areena.yle.fi"],rules:[{proxy_country:["FI"],cmds:[{hosts:["locations.api.yle.fi","cdnapi-legacy.kaltura.com"],then:"PROXY FI.PEER",if:[]}]}]},cmds:[{hosts:["locations.api.yle.fi","cdnapi-legacy.kaltura.com"],then:"PROXY FI.PEER",if:[]}]},bbc_co_uk:{match:{root_urls:["bbc.co.uk","bbc.com"],rules:[{proxy_country:["GB"],cmds:[{hosts:["fig.bbc.co.uk","open.live.bbc.co.uk"],then:"PROXY GB.PEER",if:[]},{hosts:["bbc.co.uk","bbc.com"],then:"PROXY GB.PEER",if:[]},{hosts:["bbci.co.uk","live.cf.md.bbci.co.uk","files.bbci.co.uk","account.bbc.com","api.bbc.co.uk","ssl.bbc.co.uk","vod-dash-uk-live.bbcfmt.hs.llnwd.net","vod-thumb-uk-live.bbcfmt.hs.llnwd.net","vs-dash-uk-live.bbcfmt.hs.llnwd.net","vod-sub-uk-live.bbcfmt.hs.llnwd.net","bbcfmt.hs.llnwd.net","bbcfmt.s.llnwi.net","s.loris.llnwd.net","vod-thumb-uk-live.akamaized.net","vs-dash-uk-live.akamaized.net","aod-dash-uk-live.akamaized.net","cf.md.bbci.co.uk","www.bbc.co.uk","vod-dash-uk-live.akamaized.net","as-dash-uk-live.akamaized.net","bidi.bbc.co.uk","bidi.live.bbc.co.uk","live.bidi.net.uk","urbanairship.com","as-hls-ww-live.akamaized.net"],then:"PROXY GB.PEER",if:[]}],error_codes:[403]}]},cmds:[{hosts:["fig.bbc.co.uk","open.live.bbc.co.uk"],then:"PROXY GB.PEER",if:[]},{hosts:["bbc.co.uk","bbc.com"],then:"PROXY GB.PEER",if:[]},{hosts:["bbci.co.uk","live.cf.md.bbci.co.uk","files.bbci.co.uk","account.bbc.com","api.bbc.co.uk","ssl.bbc.co.uk","vod-dash-uk-live.bbcfmt.hs.llnwd.net","vod-thumb-uk-live.bbcfmt.hs.llnwd.net","vs-dash-uk-live.bbcfmt.hs.llnwd.net","vod-sub-uk-live.bbcfmt.hs.llnwd.net","bbcfmt.hs.llnwd.net","bbcfmt.s.llnwi.net","s.loris.llnwd.net","vod-thumb-uk-live.akamaized.net","vs-dash-uk-live.akamaized.net","aod-dash-uk-live.akamaized.net","cf.md.bbci.co.uk","www.bbc.co.uk","vod-dash-uk-live.akamaized.net","as-dash-uk-live.akamaized.net","bidi.bbc.co.uk","bidi.live.bbc.co.uk","live.bidi.net.uk","urbanairship.com","as-hls-ww-live.akamaized.net"],then:"PROXY GB.PEER",if:[]}]},bergdorfgoodman_com:{proxy_country:["US"],cmds:[{root_urls:["bergdorfgoodman.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},channel4_com:{match:{root_urls:["channel4.com"],rules:[{proxy_country:["GB"],cmds:[{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]},{root_urls:["channel4.com"],if:[{url:".*check-email",type:"=~",then:"DIRECT"}],then:"PROXY GB.PEER"},{hosts:["ais.channel4.com"],then:"PROXY GB.PEER",if:[]}]}]},cmds:[{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]},{root_urls:["channel4.com"],if:[{url:".*check-email",type:"=~",then:"DIRECT"}],then:"PROXY GB.PEER"},{hosts:["ais.channel4.com"],then:"PROXY GB.PEER",if:[]}]},criterionchannel_com:{proxy_country:["US"],cmds:[{root_urls:["criterionchannel.com"],then:"PROXY US.PEER",if:[]}]},textnow_com:{match:{root_urls:["textnow.com"],rules:[{proxy_country:["US","CA"],cmds:[{hosts:["textnow.com","client.px-cloud.net","captcha.px-cdn.net","collector-pxk56wkc4o.px-cloud.net","textnow-static.s3-website-us-east-1.amazonaws.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["textnow.com","client.px-cloud.net","captcha.px-cdn.net","collector-pxk56wkc4o.px-cloud.net","textnow-static.s3-website-us-east-1.amazonaws.com"],then:"PROXY XX.PEER",if:[]}]},mangago_me:{match:{root_urls:["mangago.me"],rules:[{proxy_country:["US"],cmds:[{hosts:["mangago.me"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["mangago.me"],then:"PROXY US.PEER",if:[]}]},javhd_pro:{match:{root_urls:["javhd.pro"],rules:[{proxy_country:["US"],cmds:[{hosts:["javhd.pro"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["javhd.pro"],then:"PROXY US.PEER",if:[]}]},ustvgo_tv:{match:{root_urls:["ustvgo.tv"],rules:[{proxy_country:["IL"],cmds:[{hosts:["ustvgo.tv"],then:"PROXY IL.PEER",if:[]},{hosts:["useast.quantumdex.io","ustv24h.live"],then:"PROXY IL.PEER",if:[]}]}]},cmds:[{hosts:["ustvgo.tv"],then:"PROXY IL.PEER",if:[]},{hosts:["useast.quantumdex.io","ustv24h.live"],then:"PROXY IL.PEER",if:[]}]},hpjav_tv:{match:{root_urls:["hpjav.tv"],rules:[{proxy_country:["US"],cmds:[{hosts:["hpjav.tv"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["hpjav.tv"],then:"PROXY US.PEER",if:[]}]},anybunny_tv:{match:{root_urls:["anybunny.tv"],rules:[{proxy_country:["US"],cmds:[{hosts:["anybunny.tv","mov.anybunny.tv","ahcdn.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["anybunny.tv","mov.anybunny.tv","ahcdn.com"],then:"PROXY US.PEER",if:[]}]},warning_or_kr:{match:{root_urls:["warning.or.kr"],rules:[{proxy_country:["KR"],cmds:[{hosts:["warning.or.kr"],then:"PROXY KR.PEER",if:[]}]}]},cmds:[{hosts:["warning.or.kr"],then:"PROXY KR.PEER",if:[]}]},crunchyroll_com:{match:{root_urls:["crunchyroll.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["crunchyroll.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["crunchyroll.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},dazn_com:{match:{root_urls:["dazn.com"],rules:[{cmds:[{hosts:["isl.dazn.com","isl-ca.dazn.com","isl-eu.dazn.com","isl-jp.dazn.com","isl-us.dazn.com","indazn.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["isl.dazn.com","isl-ca.dazn.com","isl-eu.dazn.com","isl-jp.dazn.com","isl-us.dazn.com","indazn.com"],then:"PROXY XX.PEER",if:[]}]},identity_homedepot_com:{match:{root_urls:["identity.homedepot.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["identity.homedepot.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},{proxy_country:["CA"],cmds:[{hosts:["identity.homedepot.com"],then:"PROXY CA.POOL_lum_ca_shared"}]}]},cmds:[{hosts:["identity.homedepot.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},dr_dk:{match:{root_urls:["dr.dk","drtv.dk","tv2.dk"],rules:[{proxy_country:["DK"],cmds:[{hosts:["www.dr.dk"],then:"PROXY DK.PEER",if:[]},{hosts:["drlive01hls.akamaized.net","drlive02hls.akamaized.net","drlive03hls.akamaized.net"],then:"PROXY DK.PEER",if:[]}]}]},cmds:[{hosts:["www.dr.dk"],then:"PROXY DK.PEER",if:[]},{hosts:["drlive01hls.akamaized.net","drlive02hls.akamaized.net","drlive03hls.akamaized.net"],then:"PROXY DK.PEER",if:[]}]},eversource_com:{match:{root_urls:["eversource.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["eversource.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{hosts:["i-doxs.net"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{root_urls:["eversource.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{hosts:["i-doxs.net"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},espn_com_co:{match:{root_urls:["espn.com.co"],rules:[{proxy_country:["CO"],cmds:[{hosts:["tredir.espn.com"],then:"PROXY CO.POOL",if:[]},{root_urls:["espn.com.co"],then:"PROXY CO.POOL",if:[]}]}]},cmds:[{hosts:["tredir.espn.com"],then:"PROXY CO.POOL",if:[]},{root_urls:["espn.com.co"],then:"PROXY CO.POOL",if:[]}]},espn_com:{match:{root_urls:["espn.com"],rules:[{proxy_country:["ES"],cmds:[{hosts:["us.edge.bamgrid.com"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{root_urls:["espn.com"],then:"PROXY ES.POOL_lum_es_shared",if:[]}]}]},cmds:[{hosts:["us.edge.bamgrid.com"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{root_urls:["espn.com"],then:"PROXY ES.POOL_lum_es_shared",if:[]}]},fastpeoplesearch_com:{match:{root_urls:["fastpeoplesearch.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["fastpeoplesearch.com","www.fastpeoplesearch.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["fastpeoplesearch.com","www.fastpeoplesearch.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]},searchpeoplefree_com:{match:{root_urls:["searchpeoplefree.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["searchpeoplefree.com","www.searchpeoplefree.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["searchpeoplefree.com","www.searchpeoplefree.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]},peoplesearchnow_com:{match:{root_urls:["peoplesearchnow.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["peoplesearchnow.com","www.peoplesearchnow.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["peoplesearchnow.com","www.peoplesearchnow.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]},truepeoplesearch_com:{match:{root_urls:["truepeoplesearch.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["truepeoplesearch.com","www.truepeoplesearch.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["truepeoplesearch.com","www.truepeoplesearch.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]},usphonebook_com:{match:{root_urls:["usphonebook.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["usphonebook.com","www.usphonebook.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["usphonebook.com","www.usphonebook.com"],then:"PROXY US.PEER",if:[]},{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]},ffsng_com:{match:{root_urls:["ffsng.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["ffsng.com"],if:[{url:"ffsng\\.com\\/ajax\\.php",type:"!~",then:"PROXY US"}],then:"PROXY US.PEER"}]}]},cmds:[{hosts:["ffsng.com"],if:[{url:"ffsng\\.com\\/ajax\\.php",type:"!~",then:"PROXY US"}],then:"PROXY US.PEER"}]},finishline_com:{match:{root_urls:["finishline.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["finishline.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["finishline.com"],then:"PROXY US.PEER",if:[]}]},footlocker_com:{proxy_country:["US"],cmds:[{root_urls:["footlocker.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},ulta_com:{proxy_country:["US"],cmds:[{root_urls:["ulta.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},jsnx_net:{match:{root_urls:["jsnx.net"],rules:[{proxy_country:["US"],cmds:[{hosts:["jsnx.net"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["jsnx.net"],then:"PROXY US.PEER",if:[]}]},cwtv_com:{match:{root_urls:["cwtv.com"],rules:[{proxy_country:["US"],cmds:[{root_urls:["cwtv.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{hosts:["cwtv-amd-akamai.akamaized.net"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{root_urls:["cwtv.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{hosts:["cwtv-amd-akamai.akamaized.net"],then:"PROXY US.PEER",if:[]}]},france_tv:{proxy_country:["FR"],cmds:[{hosts:["cloudreplay.ftven.fr","hdfauth.ftven.fr"],then:"PROXY FR.PEER",if:[]}]},francetvinfo_fr:{proxy_country:["FR"],cmds:[{root_urls:["francetvinfo.fr"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]},gamestop_com:{proxy_country:["US"],cmds:[{root_urls:["gamestop.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},globaltv_ca:{proxy_country:["CA"],cmds:[{root_urls:["globaltv.com"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["global.corusappservices.com"],then:"PROXY CA.PEER",if:[]}]},bell_ca:{proxy_country:["CA"],cmds:[{root_urls:["bell.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]},go_com:{match:{root_urls:["go.com"],rules:[{cmds:[{hosts:["go.com","prod.gatekeeper.us-abc.symphony.edgedatg.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["go.com","prod.gatekeeper.us-abc.symphony.edgedatg.com"],then:"PROXY XX.PEER",if:[]}]},go_us:{proxy_country:["US"],cmds:[{hosts:["prod.gatekeeper.us-abc.symphony.edgedatg.go.com","prod.gatekeeper.us-abc.symphony.edgedatg.com"],then:"PROXY US.PEER",if:[]}]},starz_com:{match:{root_urls:["starz.com"],rules:[{cmds:[{hosts:["auth.starz.com","msrem.starz.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["auth.starz.com","msrem.starz.com"],then:"PROXY XX.PEER",if:[]}]},cf_sites:{match:{root_urls:["rutracker.org","ashleymadison.com","myshopify.com","visa.com","uakino.club","tvoj-onlajn.ru","gleam.io","exelab.ru","king368.com"],rules:[{cmds:[{hosts:["rutracker.org","ashleymadison.com","myshopify.com","visa.com","uakino.club","tvoj-onlajn.ru","gleam.io","exelab.ru","king368.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["rutracker.org","ashleymadison.com","myshopify.com","visa.com","uakino.club","tvoj-onlajn.ru","gleam.io","exelab.ru","king368.com"],then:"PROXY XX.PEER",if:[]}]},hbogo:{match:{root_urls:["hbogo.pl","hbogo.ro"],rules:[{cmds:[{hosts:["api.ugw.hbogo.eu"],if:[{url:"api\\.ugw\\.hbogo\\.eu\\/v3\\.0\\/(GeoCheck|Authentication\\/(POL|ROU))\\/(json|JSON).*",type:"!~",then:"PROXY XX"}],then:"PROXY XX.PEER"}]}]},cmds:[{hosts:["api.ugw.hbogo.eu"],if:[{url:"api\\.ugw\\.hbogo\\.eu\\/v3\\.0\\/(GeoCheck|Authentication\\/(POL|ROU))\\/(json|JSON).*",type:"!~",then:"PROXY XX"}],then:"PROXY XX.PEER"}]},hbogola_com:{match:{root_urls:["hbogola.com"],rules:[{proxy_country:["MX","PE","CO"],cmds:[{hosts:["globalapi.hbogola.com","ais.directvla.com"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["globalapi.hbogola.com","ais.directvla.com"],then:"PROXY XX.PEER",if:[]}]},hbogo_com_br:{match:{root_urls:["hbogo.com.br"],rules:[{proxy_country:["BR"],cmds:[{hosts:["globalapi.hbogola.com"],then:"PROXY BR.PEER",if:[]}]}]},cmds:[{hosts:["globalapi.hbogola.com"],then:"PROXY BR.PEER",if:[]}]},movistarplay_com_pe:{match:{root_urls:["movistarplay.com.pe"],rules:[{proxy_country:["PE"],cmds:[{hosts:["movistarplay.com.pe","wvcypherdrm.gvp.telefonica.com"],then:"PROXY PE.PEER",if:[]}]}]},cmds:[{hosts:["movistarplay.com.pe","wvcypherdrm.gvp.telefonica.com"],then:"PROXY PE.PEER",if:[]}]},directvgo_com:{match:{root_urls:["directvgo.com"],rules:[{proxy_country:["PE"],cmds:[{hosts:["directvgo.com"],then:"PROXY PE.PEER",if:[]}]}]},cmds:[{hosts:["directvgo.com"],then:"PROXY PE.PEER",if:[]}]},elevensports_pt:{match:{root_urls:["elevensports.pt"],rules:[{proxy_country:["PT"],cmds:[{hosts:["elevensports.pt","dce-frontoffice.imggaming.com"],then:"PROXY PT.PEER",if:[]}]}]},cmds:[{hosts:["elevensports.pt","dce-frontoffice.imggaming.com"],then:"PROXY PT.PEER",if:[]}]},hollisterco_com:{proxy_country:["US"],cmds:[{root_urls:["hollisterco.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},hotstar_com:{match:{root_urls:["hotstar.com"],rules:[{proxy_country:["IN","GB"],cmds:[{if:[{host:"(?:google-analytics\\.com|analytics\\.twitter\\.com|googleadservices\\.com|p\\.adsymptotic\\.com|googletagmanager\\.com|bat\\.bing\\.com|adservice\\.google\\.com|doubleclick\\.net|gstatic\\.com|googlesyndication\\.com|2mdn\\.net|q\\.quora\\.com|analytics\\.edgekey\\.net|amazon-adsystem\\.com|users\\.quantumgraph\\.com|images-na\\.ssl-images-amazon\\.com|bh\\.contextweb\\.com|pixel-sync\\.sitescout\\.com|ads-twitter\\.com|googletagservices\\.com|scorecardresearch\\.com|outbrain\\.com|cdnjs\\.cloudflare\\.com|adservice\\.google\\.com\\.pk|adservice\\.google\\.com\\.ph|adroll\\.com|analytics\\.yahoo\\.com|spl\\.zeotap\\.com|a-ads\\.com|google\\.com|google\\.co\\.in|facebook\\.com|facebook\\.net|t\\.co|rubiconproject\\.com|google\\.com\\.bd|mixpanel\\.com|go-mpulse\\.net|google\\.com\\.au|googleapis\\.com)$",type:"=~",then:"DIRECT"}],then:"PROXY IN.POOL_lum_in_shared"},{hosts:["www.hotstar.com","services.hotstar.com","segment.hotstar.com","api.hotstar.com","geoip.hotstar.com","e6858.dsce9.akamaiedge.net","ma312-r.analytics.edgesuite.net","service.hotstar.com","persona.hotstar.com","secure-media.hotstar.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["hses1.akamaized.net","hses.akamaized.net","hses2.akamaized.net","ds-aksb-a.akamaihd.net","hesads.akamaized.net","hsdesinova.akamaized.net","hses3.akamaized.net","hses4.akamaized.net","staragvod-vh.akamaihd.net","hsdesinova.akamaized.net","hsprepack.akamaized.net","staragvod1-vh.akamaihd.net","staragvod2-vh.akamaihd.net","staragvod3-vh.akamaihd.net","staragdash.akamaized.net","hssportsprepack.akamaized.net","live11.akt.hotstar-cdn.net","live15p.hotstar.com","hses4.hotstar.com","hotstar.com","hsdashgec1.akamaized.net","hsdashgec2.akamaized.net","hsnewsprepack.akamaized.net","live13p.hotstar.com","webos.hotstar.com","tizen.hotstar.com","live14p.hotstar.com","live09p.hotstar.com","live12p.hotstar.com","live11p.akt.hotstar-cdn.net","live12p.akt.hotstar-cdn.net","live11p.hotstar.com","tailor.akt.hotstar-cdn.net"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["in-star.videoplaza.tv","hotstar.worldgravity.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},{proxy_country:["CA"],cmds:[{if:[{host:"(?:google-analytics\\.com|analytics\\.twitter\\.com|googleadservices\\.com|p\\.adsymptotic\\.com|googletagmanager\\.com|bat\\.bing\\.com|adservice\\.google\\.com|doubleclick\\.net|gstatic\\.com|googlesyndication\\.com|2mdn\\.net|q\\.quora\\.com|analytics\\.edgekey\\.net|amazon-adsystem\\.com|users\\.quantumgraph\\.com|images-na\\.ssl-images-amazon\\.com|bh\\.contextweb\\.com|pixel-sync\\.sitescout\\.com|ads-twitter\\.com|googletagservices\\.com|scorecardresearch\\.com|outbrain\\.com|cdnjs\\.cloudflare\\.com|adservice\\.google\\.com\\.pk|adservice\\.google\\.com\\.ph|adroll\\.com|analytics\\.yahoo\\.com|spl\\.zeotap\\.com|a-ads\\.com|google\\.com|google\\.co\\.in|facebook\\.com|facebook\\.net|t\\.co|rubiconproject\\.com|google\\.com\\.bd|mixpanel\\.com|go-mpulse\\.net|google\\.com\\.au|googleapis\\.com)$",type:"=~",then:"DIRECT"}],then:"PROXY CA.POOL_lum_ca_shared"},{hosts:["www.hotstar.com","services.hotstar.com","segment.hotstar.com","api.hotstar.com","geoip.hotstar.com","e6858.dsce9.akamaiedge.net","ma312-r.analytics.edgesuite.net","service.hotstar.com","persona.hotstar.com","secure-media.hotstar.com"],then:"PROXY CA.PEER"},{hosts:["hses1.akamaized.net","hses.akamaized.net","hses2.akamaized.net","ds-aksb-a.akamaihd.net","hesads.akamaized.net","hsdesinova.akamaized.net","hses3.akamaized.net","hses4.akamaized.net","staragvod-vh.akamaihd.net","hsdesinova.akamaized.net","hsprepack.akamaized.net","staragvod1-vh.akamaihd.net","staragvod2-vh.akamaihd.net","staragvod3-vh.akamaihd.net","staragdash.akamaized.net","hssportsprepack.akamaized.net","live11.akt.hotstar-cdn.net","live15p.hotstar.com","hses4.hotstar.com","hotstar.com","hsdashgec1.akamaized.net","hsdashgec2.akamaized.net","hsnewsprepack.akamaized.net"],then:"PROXY CA.POOL_lum_ca_shared"},{hosts:["ca-star.videoplaza.tv","hotstar.worldgravity.com"],then:"PROXY CA.POOL_lum_ca_shared"}]}]},cmds:[{if:[{host:"(?:google-analytics\\.com|analytics\\.twitter\\.com|googleadservices\\.com|p\\.adsymptotic\\.com|googletagmanager\\.com|bat\\.bing\\.com|adservice\\.google\\.com|doubleclick\\.net|gstatic\\.com|googlesyndication\\.com|2mdn\\.net|q\\.quora\\.com|analytics\\.edgekey\\.net|amazon-adsystem\\.com|users\\.quantumgraph\\.com|images-na\\.ssl-images-amazon\\.com|bh\\.contextweb\\.com|pixel-sync\\.sitescout\\.com|ads-twitter\\.com|googletagservices\\.com|scorecardresearch\\.com|outbrain\\.com|cdnjs\\.cloudflare\\.com|adservice\\.google\\.com\\.pk|adservice\\.google\\.com\\.ph|adroll\\.com|analytics\\.yahoo\\.com|spl\\.zeotap\\.com|a-ads\\.com|google\\.com|google\\.co\\.in|facebook\\.com|facebook\\.net|t\\.co|rubiconproject\\.com|google\\.com\\.bd|mixpanel\\.com|go-mpulse\\.net|google\\.com\\.au|googleapis\\.com)$",type:"=~",then:"DIRECT"}],then:"PROXY IN.POOL_lum_in_shared"},{hosts:["www.hotstar.com","services.hotstar.com","segment.hotstar.com","api.hotstar.com","geoip.hotstar.com","e6858.dsce9.akamaiedge.net","ma312-r.analytics.edgesuite.net","service.hotstar.com","persona.hotstar.com","secure-media.hotstar.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["hses1.akamaized.net","hses.akamaized.net","hses2.akamaized.net","ds-aksb-a.akamaihd.net","hesads.akamaized.net","hsdesinova.akamaized.net","hses3.akamaized.net","hses4.akamaized.net","staragvod-vh.akamaihd.net","hsdesinova.akamaized.net","hsprepack.akamaized.net","staragvod1-vh.akamaihd.net","staragvod2-vh.akamaihd.net","staragvod3-vh.akamaihd.net","staragdash.akamaized.net","hssportsprepack.akamaized.net","live11.akt.hotstar-cdn.net","live15p.hotstar.com","hses4.hotstar.com","hotstar.com","hsdashgec1.akamaized.net","hsdashgec2.akamaized.net","hsnewsprepack.akamaized.net","live13p.hotstar.com","webos.hotstar.com","tizen.hotstar.com","live14p.hotstar.com","live09p.hotstar.com","live12p.hotstar.com","live11p.akt.hotstar-cdn.net","live12p.akt.hotstar-cdn.net","live11p.hotstar.com","tailor.akt.hotstar-cdn.net"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["in-star.videoplaza.tv","hotstar.worldgravity.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},sevenplus_com_au:{match:{root_urls:["7plus.com.au"],rules:[{proxy_country:["AU"],cmds:[{hosts:["sevennetwork.akamaized.net","live-sevennetwork.akamaized.net","7plus-sevennetwork.akamaized.net","npc-live-sevennetwork.akamaized.net"],then:"PROXY AU.PEER",if:[]},{root_urls:["7plus.com.au"],then:"PROXY AU.POOL",if:[]}]}]},cmds:[{hosts:["sevennetwork.akamaized.net","live-sevennetwork.akamaized.net","7plus-sevennetwork.akamaized.net","npc-live-sevennetwork.akamaized.net"],then:"PROXY AU.PEER",if:[]},{root_urls:["7plus.com.au"],then:"PROXY AU.POOL",if:[]}]},hulu_com:{match:{root_urls:["hulu.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["play.hulu.com"],if:[{url:".*(\\.)?play\\.hulu\\.com\\/.*\\/playlist",type:"!~",then:"PROXY US.POOL_lum_us_shared"}],then:"PROXY US.PEER"},{hosts:["discover.hulu.com"],if:[{url:"discover\\.hulu\\.com\\/content\\/",type:"!~",then:"PROXY US.POOL_lum_us_shared"}],then:"PROXY US.PEER"},{hosts:["secure.hulu.com","auth.hulu.com"],then:"PROXY US.PEER",if:[]},{hosts:["hulu-lr.hb-api.omtrdc.net","cws-hulu.conviva.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{root_urls:["hulu.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["play.hulu.com"],if:[{url:".*(\\.)?play\\.hulu\\.com\\/.*\\/playlist",type:"!~",then:"PROXY US.POOL_lum_us_shared"}],then:"PROXY US.PEER"},{hosts:["discover.hulu.com"],if:[{url:"discover\\.hulu\\.com\\/content\\/",type:"!~",then:"PROXY US.POOL_lum_us_shared"}],then:"PROXY US.PEER"},{hosts:["secure.hulu.com","auth.hulu.com"],then:"PROXY US.PEER",if:[]},{hosts:["hulu-lr.hb-api.omtrdc.net","cws-hulu.conviva.com"],then:"PROXY US.POOL_lum_us_shared",if:[]},{root_urls:["hulu.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},hulu_jp:{match:{root_urls:["hulu.jp"],rules:[{proxy_country:["JP"],cmds:[{hosts:["api.happyon.jp"],if:[{url:"api\\.happyon\\.jp\\/v1\\/(auth\\/token|playback\\/video)",type:"!~",then:"PROXY JP"}],then:"PROXY JP.PEER"},{hosts:["hulu.jp"],if:[{url:"hulu\\.jp\\/(account|signup).*",type:"!~",then:"PROXY JP"}],then:"PROXY JP.PEER"},{hosts:["papi.prod.hjholdings.tv"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["api.happyon.jp"],if:[{url:"api\\.happyon\\.jp\\/v1\\/(auth\\/token|playback\\/video)",type:"!~",then:"PROXY JP"}],then:"PROXY JP.PEER"},{hosts:["hulu.jp"],if:[{url:"hulu\\.jp\\/(account|signup).*",type:"!~",then:"PROXY JP"}],then:"PROXY JP.PEER"},{hosts:["papi.prod.hjholdings.tv"],then:"PROXY JP.PEER",if:[]}]},itv_com:{proxy_country:["GB"],cmds:[{hosts:["itv.com"],then:"PROXY GB.PEER",if:[]},{hosts:["magni.itv.com","edge.api.brightcove.com"],then:"PROXY GB.PEER",if:[]},{hosts:["itv.com","itvpnp.live.ott.irdeto.com","itvstatic.com","itvpnpdotcom-a.akamaihd.net","ssl-itvdotcom.2cnt.net","play.dar.itv.com","csm-e-itv-eb.play.dar.itv.com","itvpnpdotcom.cdn1.content.itv.com"],then:"PROXY GB.PEER",if:[]}],error_codes:[403]},iqiyi_com:{match:{root_urls:["iqiyi.com"],rules:[{proxy_country:["CN"],cmds:[{hosts:["cache.video.iqiyi.com"],if:[{url:".*cache\\.video\\.iqiyi\\.com\\/dash.*",type:"!~",then:"PROXY CN"}],then:"PROXY CN.PEER"}]}]},cmds:[{hosts:["cache.video.iqiyi.com"],if:[{url:".*cache\\.video\\.iqiyi\\.com\\/dash.*",type:"!~",then:"PROXY CN"}],then:"PROXY CN.PEER"}]},iview_abc_net_au:{match:{root_urls:["abc.net.au","iview.abc.net.au"],rules:[{cmds:[{hosts:["api.iview.abc.net.au"],if:[{url:"api\\.iview\\.abc\\.net\\.au\\/v2\\/(video|token\\/drm)\\/.*",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"},{hosts:["abc-iview-mediapackagestreams-1.akamaized.net"],if:[{url:"abc-iview-mediapackagestreams-1\\.akamaized\\.net\\/out\\/v1\\/\\w+\\/index\\.mpd",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"},{hosts:["iview-vod.akamaized.net"],if:[{url:"iview-vod\\.akamaized\\.net\\/prod\\/ck1\\/\\w+\\/\\w+\\/mpegdash\\/master\\.mpd",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"}]}]},cmds:[{hosts:["api.iview.abc.net.au"],if:[{url:"api\\.iview\\.abc\\.net\\.au\\/v2\\/(video|token\\/drm)\\/.*",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"},{hosts:["abc-iview-mediapackagestreams-1.akamaized.net"],if:[{url:"abc-iview-mediapackagestreams-1\\.akamaized\\.net\\/out\\/v1\\/\\w+\\/index\\.mpd",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"},{hosts:["iview-vod.akamaized.net"],if:[{url:"iview-vod\\.akamaized\\.net\\/prod\\/ck1\\/\\w+\\/\\w+\\/mpegdash\\/master\\.mpd",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"}]},kaltura_com:{proxy_country:["FI"],cmds:[{hosts:["cdnapisec.kaltura.com","cdnsecakmi.kaltura.com"],then:"PROXY FI.PEER",if:[]}]},kbs_co_kr:{proxy_country:["KR"],cmds:[{root_urls:["kbs.co.kr"],then:"PROXY KR.POOL_lum_kr_shared",if:[]},{hosts:["onair.kbs.co.kr","vod.kbs.co.kr"],then:"PROXY KR.PEER",if:[]}]},manga_line_me:{match:{root_urls:["line.me"],rules:[{proxy_country:["JP"],cmds:[{hosts:["manga.line.me"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{hosts:["manga.line.me"],then:"PROXY JP.PEER",if:[]}]},marcus_com:{proxy_country:["US"],cmds:[{root_urls:["marcus.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},meiliboxi_fi:{match:{root_urls:["meiliboxi.fi"],rules:[{proxy_country:["FI"],cmds:[{hosts:["meiliboxi.fi"],then:"PROXY FI.PEER",if:[]}]}]},cmds:[{hosts:["meiliboxi.fi"],then:"PROXY FI.PEER",if:[]}]},mitele_es:{match:{root_urls:["mitele.es"],rules:[{proxy_country:["ES"],cmds:[{root_urls:["mitele.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["vod.mitele.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["miteleooyala-vh.akamaihd.net","livehlsdai-i.akamaihd.net","cerbero.pro.3d99a4cb092e6d20ff56d80b9efd9a8f8802ec81.es","live.mitele.es","directos.mitele.es","cerbero.mediaset.es"],then:"PROXY ES.PEER",if:[]}]}]},cmds:[{root_urls:["mitele.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["vod.mitele.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["miteleooyala-vh.akamaihd.net","livehlsdai-i.akamaihd.net","cerbero.pro.3d99a4cb092e6d20ff56d80b9efd9a8f8802ec81.es","live.mitele.es","directos.mitele.es","cerbero.mediaset.es"],then:"PROXY ES.PEER",if:[]}]},my5_tv:{match:{root_urls:["my5.tv"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["my5.tv"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["cassie.channel5.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["my5.tv"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["cassie.channel5.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},britbox_co_uk:{match:{root_urls:["britbox.co.uk"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["my5.tv"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["dotcomcontent.britbox.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]}]},cmds:[{root_urls:["my5.tv"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["dotcomcontent.britbox.co.uk"],then:"PROXY GB.POOL_lum_gb_shared",if:[]}]},naver_com:{match:{root_urls:["naver.com"],rules:[{proxy_country:["KR"],cmds:[{root_urls:["naver.com"],if:[{url:"(smartmediarep.com|pstatic.net|vrixon.com).*\\.(mp4|m3u8|ts)",type:"=~",then:"DIRECT"}],then:"PROXY XX"},{hosts:["apis.naver.com","api-gw.sports.naver.com"],then:"PROXY KR.PEER",if:[]}]}]},cmds:[{root_urls:["naver.com"],if:[{url:"(smartmediarep.com|pstatic.net|vrixon.com).*\\.(mp4|m3u8|ts)",type:"=~",then:"DIRECT"}],then:"PROXY XX"},{hosts:["apis.naver.com","api-gw.sports.naver.com"],then:"PROXY KR.PEER",if:[]}]},netflix_com:{match:{min_ver:"1.155.76",root_urls:["netflix.com"],rules:[{proxy_country:[],cmds:[{hosts:["netflixparty.com"],then:"DIRECT",if:[]},{root_urls:["netflix.com"],if:[],then:"PROXY XX.POOL"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY XX.POOL",if:[]}]},{proxy_country:["NL"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY NL.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY NL.PEER"}]},{proxy_country:["CA"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY CA.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY CA.PEER"}]},{proxy_country:["GB"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY GB.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY GB.PEER"}]},{proxy_country:["FR"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY FR.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY FR.PEER"}]},{proxy_country:["IT"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY IT.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY IT.PEER"}]},{proxy_country:["ES"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY ES.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY ES.PEER"}]},{proxy_country:["US"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY US.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY US.PEER"}]},{proxy_country:["KR"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY KR.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY KR.PEER"}]},{proxy_country:["HK"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY HK.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY HK.PEER"}]},{proxy_country:["JP"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY JP.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY JP.PEER"}]},{proxy_country:["BR"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY BR.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY BR.PEER"}]},{proxy_country:["IN"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY IN.POOL_lum_in_shared"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY IN.POOL_lum_in_shared"}]},{proxy_country:["NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA","CO","AU"],cmds:[{hosts:["netflixparty.com"],then:"DIRECT"},{root_urls:["netflix.com"],if:[],then:"PROXY XX.PEER"},{hosts:["anycast.ftl.netflix.com","assets.nflxext.com","oca-api.netflix.com","push.prod.netflix.com","nflxvideo.net","nflxvideo.com","nflximg.com","nflximg.net","nflxso.com","nflxso.net","nflxext.com","nflxext.net","netflix.com","netflix.net"],then:"PROXY XX.PEER"}]}]},error_codes:[420]},ome_tv:{match:{root_urls:["ome.tv"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["ome.tv"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["roulette.apps-host.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["ome.tv"],then:"PROXY CA.POOL_lum_ca_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["ome.tv"],then:"PROXY GB.POOL_lum_gb_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["ome.tv"],then:"PROXY NL.POOL_lum_nl_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["ome.tv"],then:"PROXY FR.POOL_lum_fr_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["ome.tv"],then:"PROXY ES.POOL_lum_es_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["ome.tv"],then:"PROXY US.POOL_lum_us_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["ome.tv"],then:"PROXY KR.POOL_lum_kr_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["ome.tv"],then:"PROXY BR.POOL_lum_br_shared"},{hosts:["roulette.apps-host.com"],then:"PROXY BR.POOL_lum_br_shared"}]},{proxy_country:["NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA"],cmds:[{hosts:["roulette.apps-host.com"],then:"PROXY XX.PEER"}]}]},cmds:[{root_urls:["ome.tv"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["roulette.apps-host.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},raiplay_it:{match:{min_ver:"1.155.77",root_urls:["raiplay.it"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["rai.it"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["msvdn.net","mediapolisvod.rai.it","mediapolis.rai.it","mediapolisgs.rai.it","8e7439fdb1694c8da3a0fd63e4dda518.msvdn.net","raitre1-live.akamaized.net","raitre2-live.akamaized.net","raitre3-live.akamaized.net","raitre4-live.akamaized.net","raitre5-live.akamaized.net","raitre6-live.akamaized.net","raitre7-live.akamaized.net","raitre8-live.akamaized.net","raitre9-live.akamaized.net","raiuno1-live.akamaized.net","raiuno2-live.akamaized.net","raiuno3-live.akamaized.net","raiuno4-live.akamaized.net","raiuno5-live.akamaized.net","raiuno6-live.akamaized.net","raiuno7-live.akamaized.net","raiuno8-live.akamaized.net","raiuno9-live.akamaized.net","raidue1-live.akamaized.net","raidue2-live.akamaized.net","raidue3-live.akamaized.net","raidue4-live.akamaized.net","raidue5-live.akamaized.net","raidue6-live.akamaized.net","raidue7-live.akamaized.net","raidue8-live.akamaized.net","raidue9-live.akamaized.net","raipremium1-live.akamaized.net","raipremium2-live.akamaized.net","raipremium3-live.akamaized.net","raipremium4-live.akamaized.net","raipremium5-live.akamaized.net","raipremium6-live.akamaized.net","raipremium7-live.akamaized.net","raipremium8-live.akamaized.net","raipremium9-live.akamaized.net","raicinque1-live.akamaized.net","raicinque2-live.akamaized.net","raicinque3-live.akamaized.net","raicinque4-live.akamaized.net","raicinque5-live.akamaized.net","raicinque6-live.akamaized.net","raicinque7-live.akamaized.net","raicinque8-live.akamaized.net","raicinque9-live.akamaized.net","raimovie1-live.akamaized.net","raimovie2-live.akamaized.net","raimovie3-live.akamaized.net","raimovie4-live.akamaized.net","raimovie5-live.akamaized.net","raimovie6-live.akamaized.net","raimovie7-live.akamaized.net","raimovie8-live.akamaized.net","raimovie9-live.akamaized.net","raiyoyo1-live.akamaized.net","raiyoyo2-live.akamaized.net","raiyoyo3-live.akamaized.net","raiyoyo4-live.akamaized.net","raiyoyo5-live.akamaized.net","raiyoyo6-live.akamaized.net","raiyoyo7-live.akamaized.net","raiyoyo8-live.akamaized.net","raiyoyo9-live.akamaized.net","raigulp1-live.akamaized.net","raigulp2-live.akamaized.net","raigulp3-live.akamaized.net","raigulp4-live.akamaized.net","raigulp5-live.akamaized.net","raigulp6-live.akamaized.net","raigulp7-live.akamaized.net","raigulp8-live.akamaized.net","raigulp9-live.akamaized.net","rainews1-live.akamaized.net","rainews2-live.akamaized.net","rainews3-live.akamaized.net","rainews4-live.akamaized.net","rainews5-live.akamaized.net","rainews6-live.akamaized.net","rainews7-live.akamaized.net","rainews8-live.akamaized.net","rainews9-live.akamaized.net","raiscuola1-live.akamaized.net","raiscuola2-live.akamaized.net","raiscuola3-live.akamaized.net","raiscuola4-live.akamaized.net","raiscuola5-live.akamaized.net","raiscuola6-live.akamaized.net","raiscuola7-live.akamaized.net","raiscuola8-live.akamaized.net","raiscuola9-live.akamaized.net","raievent1-live.akamaized.net","raievent2-live.akamaized.net","raievent3-live.akamaized.net","raievent4-live.akamaized.net","raievent5-live.akamaized.net","raievent6-live.akamaized.net","raievent7-live.akamaized.net","raievent8-live.akamaized.net","raievent9-live.akamaized.net","raiquattro1-live.akamaized.net","raiquattro2-live.akamaized.net","raiquattro3-live.akamaized.net","raiquattro4-live.akamaized.net","raiquattro5-live.akamaized.net","raiquattro6-live.akamaized.net","raiquattro7-live.akamaized.net","raiquattro8-live.akamaized.net","raiquattro9-live.akamaized.net","raisportuno1-live.akamaized.net","raisportuno2-live.akamaized.net","raisportuno3-live.akamaized.net","raisportuno4-live.akamaized.net","raisportuno5-live.akamaized.net","raisportuno6-live.akamaized.net","raisportuno7-live.akamaized.net","raisportuno8-live.akamaized.net","raisportuno9-live.akamaized.net","raistoria1-live.akamaized.net","raistoria2-live.akamaized.net","raistoria3-live.akamaized.net","raistoria4-live.akamaized.net","raistoria5-live.akamaized.net","raistoria6-live.akamaized.net","raistoria7-live.akamaized.net","raistoria8-live.akamaized.net","raistoria9-live.akamaized.net","raisportdue1-live.akamaized.net","raisportdue2-live.akamaized.net","raisportdue3-live.akamaized.net","raisportdue4-live.akamaized.net","raisportdue5-live.akamaized.net","raisportdue6-live.akamaized.net","raisportdue7-live.akamaized.net","raisportdue8-live.akamaized.net","raisportdue9-live.akamaized.net"],then:"PROXY IT.PEER",if:[]}]}]}},rai_it:{match:{min_ver:"1.155.77",root_urls:["rai.it"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["rai.it"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]}]},cmds:[{root_urls:["rai.it"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},rte_ie:{match:{root_urls:["rte.ie"],rules:[{proxy_country:["IE"],cmds:[{hosts:["rte.ie"],then:"PROXY IE.PEER",if:[]},{hosts:["link.eu.theplatform.com"],then:"PROXY IE.PEER",if:[]}]}]},cmds:[{hosts:["rte.ie"],then:"PROXY IE.PEER",if:[]},{hosts:["link.eu.theplatform.com"],then:"PROXY IE.PEER",if:[]}]},virginmediatelevision_ie:{match:{root_urls:["virginmediatelevision.ie"],rules:[{proxy_country:["IE"],cmds:[{hosts:["www.virginmediatelevision.ie","vmtvprod.akamaized.net"],then:"PROXY IE.PEER",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/\\d+",type:"!~",then:"PROXY IE.POOL"}],then:"PROXY IE.PEER"}]}]},cmds:[{hosts:["www.virginmediatelevision.ie","vmtvprod.akamaized.net"],then:"PROXY IE.PEER",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/\\d+",type:"!~",then:"PROXY IE.POOL"}],then:"PROXY IE.PEER"}]},vier_be:{match:{root_urls:["vier.be"],rules:[{proxy_country:["BE"],cmds:[{hosts:["stream1-vod.cdn1.sbs.prd.telenet-ops.be","stream2-vod.cdn1.sbs.prd.telenet-ops.be"],then:"PROXY BE.PEER",if:[]}]}]},cmds:[{hosts:["stream1-vod.cdn1.sbs.prd.telenet-ops.be","stream2-vod.cdn1.sbs.prd.telenet-ops.be"],then:"PROXY BE.PEER",if:[]}]},orange_fr:{match:{root_urls:["orange.fr"],rules:[{proxy_country:["FR"],cmds:[{hosts:["nec-ms.apigw.orange.fr","replay.orange.fr","mediation-tv.orange.fr","login.orange.fr"],then:"PROXY FR.PEER",if:[]}]}]},cmds:[{hosts:["nec-ms.apigw.orange.fr","replay.orange.fr","mediation-tv.orange.fr","login.orange.fr"],then:"PROXY FR.PEER",if:[]}]},sonyliv_com:{match:{root_urls:["sonyliv.com"],rules:[{proxy_country:["IN"],cmds:[{hosts:["sonyliv.com","apiv2.sonyliv.com","sony247channels.akamaized.net"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY IN.POOL_lum_in_shared"}],then:"PROXY IN.POOL_lum_in_shared"}]}]},cmds:[{hosts:["sonyliv.com","apiv2.sonyliv.com","sony247channels.akamaized.net"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY IN.POOL_lum_in_shared"}],then:"PROXY IN.POOL_lum_in_shared"}]},sprint_com:{match:{root_urls:["sprint.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["sprint.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["sprint.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},stan_com_au:{match:{root_urls:["stan.com.au"],rules:[{cmds:[{hosts:["api.stan.com.au"],then:"PROXY AU.PEER",if:[]}]}]},cmds:[{hosts:["api.stan.com.au"],then:"PROXY AU.PEER",if:[]}]},tenplay_com_au:{match:{root_urls:["tenplay.com.au","10play.com.au"],rules:[{proxy_country:["AU"],cmds:[{root_urls:["tenplay.com.au","10play.com.au"],then:"PROXY AU.POOL",if:[]},{hosts:["10play.com.au","manifest.prod.boltdns.net","bcboltnet10tp.akamaized.net","global.ssl.fastly.net","10play-vod.global.ssl.fastly.net","10-selector.global.ssl.fastly.net","10-cms-feed.global.ssl.fastly.net","secure.widget.cloud.opta.net","s.yimg.com","edv021asd.global.ssl.fastly.net","geolocation.onetrust.com"],then:"PROXY AU.POOL",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"},{hosts:["imrworldwide.com"],if:[{url:".*\\.imrworldwide\\.com\\.*",type:"=~",then:"PROXY AU.POOL"}],then:"PROXY AU.POOL"}]}]},cmds:[{root_urls:["tenplay.com.au","10play.com.au"],then:"PROXY AU.POOL",if:[]},{hosts:["10play.com.au","manifest.prod.boltdns.net","bcboltnet10tp.akamaized.net","global.ssl.fastly.net","10play-vod.global.ssl.fastly.net","10-selector.global.ssl.fastly.net","10-cms-feed.global.ssl.fastly.net","secure.widget.cloud.opta.net","s.yimg.com","edv021asd.global.ssl.fastly.net","geolocation.onetrust.com"],then:"PROXY AU.POOL",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY AU.POOL"}],then:"PROXY AU.PEER"},{hosts:["imrworldwide.com"],if:[{url:".*\\.imrworldwide\\.com\\.*",type:"=~",then:"PROXY AU.POOL"}],then:"PROXY AU.POOL"}]},ninenow_com_au:{match:{root_urls:["9now.com.au"],rules:[{proxy_country:["AU"],cmds:[{hosts:["www.9now.com.au"],then:"PROXY AU.PEER",if:[]}]}]},cmds:[{hosts:["www.9now.com.au"],then:"PROXY AU.PEER",if:[]}]},unidragon_eu:{match:{root_urls:["unidragon.eu","unidragon.com"],rules:[{proxy_country:["DE","US"],cmds:[{hosts:["cozycountryredirect.addons.business"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["cozycountryredirect.addons.business"],then:"PROXY XX.PEER",if:[]}]},bfmtv_com:{match:{root_urls:["bfmtv.com"],rules:[{proxy_country:["FR"],cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY FR"}],then:"PROXY FR.PEER"}]}]},cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY FR"}],then:"PROXY FR.PEER"}]},tvbanywherena_com:{match:{root_urls:["tvbanywherena.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY US"}],then:"PROXY US.PEER"}]}]},cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY US"}],then:"PROXY US.PEER"}]},tvnz_co_nz:{match:{root_urls:["tvnz.co.nz"],rules:[{proxy_country:["NZ"],cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY NZ"}],then:"PROXY NZ.PEER"},{hosts:["bcbolttvnz3-a.akamaihd.net","tvnz-prod-01.brightcovecdn.com","apis-edge-prod.tech.tvnz.co.nz","playback.brightcovecdn.com"],then:"PROXY NZ.PEER",if:[]}]}]},cmds:[{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY NZ"}],then:"PROXY NZ.PEER"},{hosts:["bcbolttvnz3-a.akamaihd.net","tvnz-prod-01.brightcovecdn.com","apis-edge-prod.tech.tvnz.co.nz","playback.brightcovecdn.com"],then:"PROXY NZ.PEER",if:[]}]},toggle_sg:{match:{root_urls:["toggle.sg"],rules:[{proxy_country:["SG"],cmds:[{hosts:["player-as.ott.kaltura.com"],if:[{url:".*player-as\\.ott\\.kaltura\\.com\\/.*\\/mwEmbed\\/mwEmbedFrame\\.php.*",type:"!~",then:"PROXY SG"}],then:"PROXY SG.PEER"}]}]},cmds:[{hosts:["player-as.ott.kaltura.com"],if:[{url:".*player-as\\.ott\\.kaltura\\.com\\/.*\\/mwEmbed\\/mwEmbedFrame\\.php.*",type:"!~",then:"PROXY SG"}],then:"PROXY SG.PEER"}]},tv4play_se:{match:{root_urls:["tv4play.se"],rules:[{proxy_country:["SE"],cmds:[{hosts:["playback-api.b17g.net","playback2.a2d.tv","tv4-segments.a2d.tv","swe.account.a2d.tv","live.streaming.a2d.tv"],then:"PROXY SE.PEER",if:[]}]}]},cmds:[{hosts:["playback-api.b17g.net","playback2.a2d.tv","tv4-segments.a2d.tv","swe.account.a2d.tv","live.streaming.a2d.tv"],then:"PROXY SE.PEER",if:[]}]},viaplay_se:{match:{root_urls:["viaplay.se"],rules:[{proxy_country:["SE"],cmds:[{hosts:["play.viaplay.se"],then:"PROXY SE.PEER",if:[]}]}]},cmds:[{hosts:["play.viaplay.se"],then:"PROXY SE.PEER",if:[]}]},cmore_se:{match:{root_urls:["cmore.se"],rules:[{proxy_country:["SE"],cmds:[{hosts:["streaminggateway-cmore.clientapi-prod.live.tv.telia.net","logingateway.cmore.se"],then:"PROXY SE.PEER",if:[]}]}]},cmds:[{hosts:["streaminggateway-cmore.clientapi-prod.live.tv.telia.net","logingateway.cmore.se"],then:"PROXY SE.PEER",if:[]}]},telecinco_es:{match:{root_urls:["telecinco.es"],rules:[{proxy_country:["ES"],cmds:[{root_urls:["telecinco.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["mediaset.hb.omtrdc.net"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["gatekeeper.mediaset.es","livehlsdai-i.akamaihd.net","cerbero.pro.3d99a4cb092e6d20ff56d80b9efd9a8f8802ec81.es","telecinco1-vh.akamaihd.net","live.telecinco.es","cerbero.mediaset.es"],then:"PROXY ES.PEER",if:[]}]}]},cmds:[{root_urls:["telecinco.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["mediaset.hb.omtrdc.net"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["gatekeeper.mediaset.es","livehlsdai-i.akamaihd.net","cerbero.pro.3d99a4cb092e6d20ff56d80b9efd9a8f8802ec81.es","telecinco1-vh.akamaihd.net","live.telecinco.es","cerbero.mediaset.es"],then:"PROXY ES.PEER",if:[]}]},energytv_es:{match:{root_urls:["energytv.es"],rules:[{proxy_country:["ES"],cmds:[{root_urls:["energytv.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["mdslivehlsb-i.akamaihd.net","directos.energytv.es","cerbero.pro.3d99a4cb092e6d20ff56d80b9efd9a8f8802ec81.es"],then:"PROXY ES.PEER",if:[]}]}]},cmds:[{root_urls:["energytv.es"],then:"PROXY ES.POOL_lum_es_shared",if:[]},{hosts:["mdslivehlsb-i.akamaihd.net","directos.energytv.es","cerbero.pro.3d99a4cb092e6d20ff56d80b9efd9a8f8802ec81.es"],then:"PROXY ES.PEER",if:[]}]},mediaset_it:{match:{root_urls:["mediaset.it"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["mediaset.it"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["api-ott-prod-fe.mediaset.net","theplatform.eu","link.theplatform.eu","feed.entertainment.tv.theplatform.eu","api.mediaset.net","secure-it.imrworldwide.com","vod06.msf.cdn.mediaset.net","mediasetinfinity.mediaset.it"],then:"PROXY IT.PEER",if:[]}]}]},cmds:[{root_urls:["mediaset.it"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["api-ott-prod-fe.mediaset.net","theplatform.eu","link.theplatform.eu","feed.entertainment.tv.theplatform.eu","api.mediaset.net","secure-it.imrworldwide.com","vod06.msf.cdn.mediaset.net","mediasetinfinity.mediaset.it"],then:"PROXY IT.PEER",if:[]}]},tibia_com:{match:{root_urls:["tibia.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["tibia.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]}]},cmds:[{root_urls:["tibia.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},tenk_fr:{match:{root_urls:["tenk.fr"],rules:[{proxy_country:["FR"],cmds:[{root_urls:["tenk.fr"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]}]},cmds:[{root_urls:["tenk.fr"],then:"PROXY FR.POOL_lum_fr_shared",if:[]}]},tva_ca:{match:{root_urls:["tva.ca"],rules:[{proxy_country:["CA"],cmds:[{root_urls:["tva.ca","chainetvauls-lh.akamaihd.net"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["videos.tva.ca","video.tva.ca"],then:"PROXY CA.PEER",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY CA.POOL_lum_ca_shared"}],then:"PROXY CA.PEER"}]}]},cmds:[{root_urls:["tva.ca","chainetvauls-lh.akamaihd.net"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["videos.tva.ca","video.tva.ca"],then:"PROXY CA.PEER",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY CA.POOL_lum_ca_shared"}],then:"PROXY CA.PEER"}]},aptnlumi_ca:{match:{root_urls:["aptnlumi.ca"],rules:[{proxy_country:["CA"],cmds:[{root_urls:["aptnlumi.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["cdnapisec.kaltura.com","cdnsecakmi.kaltura.com","cfvod.kaltura.com","analytics.kaltura.com"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]}]},cmds:[{root_urls:["aptnlumi.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["cdnapisec.kaltura.com","cdnsecakmi.kaltura.com","cfvod.kaltura.com","analytics.kaltura.com"],then:"PROXY CA.POOL_lum_ca_shared",if:[]}]},noovo_ca:{match:{root_urls:["noovo.ca"],rules:[{proxy_country:["CA"],cmds:[{root_urls:["noovo.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY CA.POOL_lum_ca_shared"}],then:"PROXY CA.PEER"}]}]},cmds:[{root_urls:["noovo.ca"],then:"PROXY CA.POOL_lum_ca_shared",if:[]},{hosts:["edge.api.brightcove.com"],if:[{url:".*edge\\.api\\.brightcove\\.com\\/playback\\/v1\\/accounts\\/\\d+\\/videos\\/(ref:)?\\d+",type:"!~",then:"PROXY CA.POOL_lum_ca_shared"}],then:"PROXY CA.PEER"}]},skysports_com:{match:{root_urls:["skysports.com","skyid.sky.com"],rules:[{proxy_country:["GB"],cmds:[{root_urls:["skysports.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["edge-auth.api.brightcove.com","skyid.sky.com"],then:"PROXY GB.PEER",if:[]}]}]},cmds:[{root_urls:["skysports.com"],then:"PROXY GB.POOL_lum_gb_shared",if:[]},{hosts:["edge-auth.api.brightcove.com","skyid.sky.com"],then:"PROXY GB.PEER",if:[]}]},tvnow_de:{match:{root_urls:["tvnow.de"],rules:[{proxy_country:["DE"],cmds:[{hosts:["widevine.tvnow.de"],if:[{url:".*widevine\\.tvnow\\.de\\/index\\/proxy",type:"!~",then:"PROXY DE"}],then:"PROXY DE.PEER"},{hosts:["bff.apigw.tvnow.de","entitlement.player.tvnow.de"],then:"PROXY DE.PEER",if:[]}]}]},cmds:[{hosts:["widevine.tvnow.de"],if:[{url:".*widevine\\.tvnow\\.de\\/index\\/proxy",type:"!~",then:"PROXY DE"}],then:"PROXY DE.PEER"},{hosts:["bff.apigw.tvnow.de","entitlement.player.tvnow.de"],then:"PROXY DE.PEER",if:[]}]},youtube_com:{match:{root_urls:["youtube.com"],rules:[{proxy_country:["CO"],cmds:[{root_urls:["youtube.com"],if:[{url:".*youtube\\.com\\/youtubei\\/v1\\/guide.*",type:"!~",then:"PROXY CO"}],then:"PROXY CO.PEER"},{hosts:["googlevideo.com"],then:"PROXY CO.PEER",if:[]}]},{proxy_country:["AR"],cmds:[{root_urls:["youtube.com"],if:[{url:".*youtube\\.com\\/premium.*",type:"!~",then:"PROXY AR"}],then:"PROXY AR.PEER"}]},{proxy_country:["FR","ES","KR","BR"],cmds:[{hosts:["s.ytimg.com","googlevideo.com"],then:"PROXY XX.PEER"}]},{proxy_country:["IT","CA","GB","NL","AU"],cmds:[{hosts:["s.ytimg.com","googlevideo.com"],then:"PROXY XX"}]},{proxy_country:["US"],cmds:[{hosts:["tv.youtube.com"],then:"PROXY US.PEER"},{hosts:["s.ytimg.com","googlevideo.com"],then:"PROXY US"}]}]},cmds:[{root_urls:["youtube.com"],if:[{url:".*youtube\\.com\\/youtubei\\/v1\\/guide.*",type:"!~",then:"PROXY CO"}],then:"PROXY CO.PEER"},{hosts:["googlevideo.com"],then:"PROXY CO.PEER",if:[]}]},cloudvideo_co:{proxy_country:["CO"],cmds:[{hosts:["rcnhd.cloudvideo.com.co"],if:[{url:"(/html5/.*/mwEmbedFrame.php/|playManifest|\\.m3u8)",type:"!~",then:"PROXY CO"}],then:"PROXY CO.PEER"}]},coomevaeps_com:{proxy_country:["CO"],cmds:[{hosts:["oficinavirtualeps.coomevaeps.com"],then:"PROXY CO.PEER",if:[]}]},tvp_pl:{proxy_country:["PL"],cmds:[{hosts:["vod.tvp.pl"],if:[{url:"\\/sess\\/tvplayer\\.php",type:"!~",then:"PROXY PL"}],then:"PROXY PL.PEER"}]},vod_pl:{match:{root_urls:["vod.pl"],rules:[{proxy_country:["PL"],cmds:[{hosts:["useinsider.com","player-api.dreamlab.pl"],then:"PROXY PL.PEER",if:[]}]}]},cmds:[{hosts:["useinsider.com","player-api.dreamlab.pl"],then:"PROXY PL.PEER",if:[]}]},tvp_info:{match:{root_urls:["tvp.info"],rules:[{proxy_country:["PL"],cmds:[{hosts:["www.tvp.info"],then:"PROXY PL.PEER",if:[]}]}]},cmds:[{hosts:["www.tvp.info"],then:"PROXY PL.PEER",if:[]}]},ipla_tv:{match:{root_urls:["ipla.tv"],rules:[{proxy_country:["PL"],cmds:[{hosts:["b2c-www.redefine.pl"],then:"PROXY PL.PEER",if:[]}]}]},cmds:[{hosts:["b2c-www.redefine.pl"],then:"PROXY PL.PEER",if:[]}]},starplus_com:{match:{root_urls:["starplus.com"],rules:[{proxy_country:["AR"],cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY AR.PEER",if:[]},{root_urls:["disneyplus.com"],then:"PROXY AR.PEER",if:[]},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY AR.PEER",if:[]}]}]},cmds:[{hosts:["global.edge.bamgrid.com","sdk.iad-03.braze.com","disney.api.edge.bamgrid.com","dialacrum.iad-03.braze.com","disney.demdex.net","disney.connections.edge.bamgrid.com","disney.content.edge.bamgrid.com","disney.playback.edge.bamgrid.com","star.api.edge.bamgrid.com"],then:"PROXY AR.PEER",if:[]},{root_urls:["disneyplus.com"],then:"PROXY AR.PEER",if:[]},{hosts:["disneyplus.com","www.disneyplus.com","svcs.dssott.com","egisterdisney.go.com","disney-plus.net"],then:"PROXY AR.PEER",if:[]}]},openai_com:{match:{root_urls:["openai.com","chatgpt.com"],rules:[{cmds:[{hosts:["openai.com"],then:"PROXY XX",if:[]}]},{cmds:[{hosts:["chat.openai.com","auth0.openai.com","platform.openai.com","challenges.cloudflare.com","api.openai.com","auth.openai.com","chatgpt.com"],then:"PROXY XX.PEER"}]}]},cmds:[{hosts:["openai.com"],then:"PROXY XX",if:[]}]},rtvs_sk:{match:{root_urls:["rtvs.sk"],rules:[{proxy_country:["SK"],cmds:[{hosts:["n0.stv.livebox.sk","n1.stv.livebox.sk","n2.stv.livebox.sk","n3.stv.livebox.sk","n4.stv.livebox.sk","n5.stv.livebox.sk","n6.stv.livebox.sk","n7.stv.livebox.sk","n8.stv.livebox.sk","n9.stv.livebox.sk","n10.stv.livebox.sk","n11.stv.livebox.sk","n12.stv.livebox.sk","n13.stv.livebox.sk","n14.stv.livebox.sk","n15.stv.livebox.sk","n16.stv.livebox.sk","n17.stv.livebox.sk","n18.stv.livebox.sk","n19.stv.livebox.sk","n20.stv.livebox.sk","n21.stv.livebox.sk","n22.stv.livebox.sk","n23.stv.livebox.sk","n24.stv.livebox.sk","n25.stv.livebox.sk","n26.stv.livebox.sk","n27.stv.livebox.sk","n28.stv.livebox.sk","n29.stv.livebox.sk","n30.stv.livebox.sk"],then:"PROXY SK.PEER",if:[]}]}]},cmds:[{hosts:["n0.stv.livebox.sk","n1.stv.livebox.sk","n2.stv.livebox.sk","n3.stv.livebox.sk","n4.stv.livebox.sk","n5.stv.livebox.sk","n6.stv.livebox.sk","n7.stv.livebox.sk","n8.stv.livebox.sk","n9.stv.livebox.sk","n10.stv.livebox.sk","n11.stv.livebox.sk","n12.stv.livebox.sk","n13.stv.livebox.sk","n14.stv.livebox.sk","n15.stv.livebox.sk","n16.stv.livebox.sk","n17.stv.livebox.sk","n18.stv.livebox.sk","n19.stv.livebox.sk","n20.stv.livebox.sk","n21.stv.livebox.sk","n22.stv.livebox.sk","n23.stv.livebox.sk","n24.stv.livebox.sk","n25.stv.livebox.sk","n26.stv.livebox.sk","n27.stv.livebox.sk","n28.stv.livebox.sk","n29.stv.livebox.sk","n30.stv.livebox.sk"],then:"PROXY SK.PEER",if:[]}]},latina_pe:{match:{root_urls:["latina.pe"],rules:[{proxy_country:["PE"],cmds:[{hosts:["mdstrm.com","vod-latina-mdstrm.secure.footprint.net"],then:"PROXY PE.PEER",if:[]}]}]},cmds:[{hosts:["mdstrm.com","vod-latina-mdstrm.secure.footprint.net"],then:"PROXY PE.PEER",if:[]}]},rtve_es:{match:{root_urls:["rtve.es"],rules:[{proxy_country:["ES"],cmds:[{hosts:["rtvelivestreamv1.akamaized.net","rtvelivestreamv2.akamaized.net","rtvelivestreamv3.akamaized.net","rtvelivestreamv4.akamaized.net","rtvelivestreamv5.akamaized.net","rtvelivestreamv6.akamaized.net","rtvelivestreamv7.akamaized.net","rtvelivestreamv8.akamaized.net","rtvelivestreamv9.akamaized.net","rtvelivestreamv10.akamaized.net"],then:"PROXY ES.PEER",if:[]}]}]},cmds:[{hosts:["rtvelivestreamv1.akamaized.net","rtvelivestreamv2.akamaized.net","rtvelivestreamv3.akamaized.net","rtvelivestreamv4.akamaized.net","rtvelivestreamv5.akamaized.net","rtvelivestreamv6.akamaized.net","rtvelivestreamv7.akamaized.net","rtvelivestreamv8.akamaized.net","rtvelivestreamv9.akamaized.net","rtvelivestreamv10.akamaized.net"],then:"PROXY ES.PEER",if:[]}]},iceland_co_uk:{proxy_country:["GB"],cmds:[{root_urls:["iceland.co.uk"],then:"PROXY GB.PEER",if:[]}]},play_rtl_hr:{match:{root_urls:["play.rtl.hr"],rules:[{proxy_country:["HR"],cmds:[{hosts:["geo.6play.fr"],then:"PROXY HR.PEER",if:[]}]}]},cmds:[{hosts:["geo.6play.fr"],then:"PROXY HR.PEER",if:[]}]},ticketmaster:{cmds:[{hosts:["ticketmaster.com","ticketmaster.pl","ticketmaster.ie","ticketmaster.es","ticketmaster.gr","ticketmaster.co.uk","ticketmaster.com.au","ticketmaster.at","ticketmaster.be","ticketmaster.com.br","ticketmaster.cl","ticketmaster.cy","ticketmaster.cz","ticketmaster.dk","ticketmaster.fi","ticketmaster.fr","ticketmaster.de","ticketmaster.it","ticketmaster.com.mx","ticketmaster.nl","ticketmaster.cp.nz","ticketmaster.no","ticketmaster.sg","ticketmaster.co.za","ticketmaster.se","ticketmaster.ch","ticketmaster.com.tr","ticketmaster.ae"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},zattoo_com:{match:{root_urls:["zattoo.com"],rules:[{proxy_country:["DE"],cmds:[{root_urls:["zahs.tv"],then:"PROXY DE.PEER",if:[]}]}]},cmds:[{root_urls:["zahs.tv"],then:"PROXY DE.PEER",if:[]}]},tv4_se:{match:{root_urls:["tv4.se"],rules:[{proxy_country:["SE"],cmds:[{hosts:["tv4.se","www.tv4.se","tv4se-graphql.a2d.tv"],then:"PROXY SE.PEER",if:[]}]}]},cmds:[{hosts:["tv4.se","www.tv4.se","tv4se-graphql.a2d.tv"],then:"PROXY SE.PEER",if:[]}]},picknsave_com:{match:{root_urls:["picknsave.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["picknsave.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["picknsave.com"],then:"PROXY US.PEER",if:[]}]},homegoods_com:{match:{root_urls:["homegoods.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["homegoods.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["homegoods.com"],then:"PROXY US.PEER",if:[]}]},tacobell_com:{match:{root_urls:["tacobell.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["tacobell.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["tacobell.com"],then:"PROXY US.PEER",if:[]}]},fkr_spb_ru:{match:{root_urls:["fkr-spb.ru"],rules:[{proxy_country:["RU"],cmds:[{hosts:["fkr-spb.ru"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{hosts:["fkr-spb.ru"],then:"PROXY RU.PEER",if:[]}]},avail_co:{match:{root_urls:["avail.co","avail.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["avail.co","avail.com","www.avail.co","www.avail.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["avail.co","avail.com","www.avail.co","www.avail.com"],then:"PROXY US.PEER",if:[]}]},fubo_tv:{match:{root_urls:["fubo.tv"],rules:[{cmds:[{hosts:["api.fubo.tv","gcs-streams-prod.fubo.tv"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["api.fubo.tv","gcs-streams-prod.fubo.tv"],then:"PROXY XX.PEER",if:[]}]},moviesanywhere_com:{match:{root_urls:["moviesanywhere.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["registration.moviesanywhere.com"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["registration.moviesanywhere.com"],then:"PROXY US.PEER",if:[]}]},threenow_co_nz:{match:{root_urls:["threenow.co.nz"],rules:[{proxy_country:["NZ"],cmds:[{hosts:["threenow.co.nz","fullscreen.nz"],then:"PROXY NZ.PEER",if:[]}]}]},cmds:[{hosts:["threenow.co.nz","fullscreen.nz"],then:"PROXY NZ.PEER",if:[]}]},tv_teleboy_ch:{match:{root_urls:["tv.teleboy.ch"],rules:[{proxy_country:["CH"],cmds:[{hosts:["teleboy.ch"],then:"PROXY CH.PEER",if:[]}]}]},cmds:[{hosts:["teleboy.ch"],then:"PROXY CH.PEER",if:[]}]},aha_video:{match:{root_urls:["aha.video"],rules:[{proxy_country:["IN"],cmds:[{hosts:["device-register-service.api.aha.firstlight.ai","geo-loc.api.aha.firstlight.ai","auth-platform.api.aha.firstlight.ai","static-assets-cdn.api.aha.firstlight.ai","config-service.api.aha.firstlight.ai","auth-gw.api.aha.firstlight.ai","streaming-vod-aha.akamaized.net"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["playback-auth-service.api.aha.firstlight.ai"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["device-register-service.api.aha.firstlight.ai","geo-loc.api.aha.firstlight.ai","auth-platform.api.aha.firstlight.ai","static-assets-cdn.api.aha.firstlight.ai","config-service.api.aha.firstlight.ai","auth-gw.api.aha.firstlight.ai","streaming-vod-aha.akamaized.net"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["playback-auth-service.api.aha.firstlight.ai"],then:"DIRECT",if:[]}]},ihg_com:{match:{root_urls:["ihg.com"],rules:[{cmds:[{hosts:["ihg.com"],then:"DIRECT",if:[]}]}]},cmds:[{hosts:["ihg.com"],then:"DIRECT",if:[]}]},digisport_ro:{match:{root_urls:["digisport.ro"],rules:[{proxy_country:["RO"],cmds:[{root_urls:["digisport.ro"],then:"PROXY RO.PEER",if:[]},{hosts:["api.cxense.com","balancer2.digi24.ro","cdn.ampproject.org","comcluster.cxense.com","scdn.cxense.com","ssl.p.jwpcdn.com","entitlements.jwplayer.com","rcs-rds.ro","gvt1.com","prd.jwpltx.com"],if:[{url:"/.*2mdn\\.net/",type:"=~",then:"PROXY RO.PEER"},{url:"/.*gvt1\\.com/",type:"=~",then:"PROXY RO.PEER"},{url:"/edge.*rcs-rds\\.ro/",type:"=~",then:"PROXY RO.PEER"}],then:"PROXY RO.PEER"}]}]},cmds:[{root_urls:["digisport.ro"],then:"PROXY RO.PEER",if:[]},{hosts:["api.cxense.com","balancer2.digi24.ro","cdn.ampproject.org","comcluster.cxense.com","scdn.cxense.com","ssl.p.jwpcdn.com","entitlements.jwplayer.com","rcs-rds.ro","gvt1.com","prd.jwpltx.com"],if:[{url:"/.*2mdn\\.net/",type:"=~",then:"PROXY RO.PEER"},{url:"/.*gvt1\\.com/",type:"=~",then:"PROXY RO.PEER"},{url:"/edge.*rcs-rds\\.ro/",type:"=~",then:"PROXY RO.PEER"}],then:"PROXY RO.PEER"}]},proxycheck_io:{cmds:[{client_only:true,hosts:["proxycheck.io"],then:"DIRECT",if:[]},{hosts:["proxycheck.io"],then:"PROXY XX.PEER",if:[]}]},svtplay_se:{match:{root_urls:["svtplay.se"],rules:[{proxy_country:["SE"],cmds:[{hosts:["svt-vod-secure-3a.akamaized.net"],then:"PROXY SE.PEER",if:[]}]}]},cmds:[{hosts:["svt-vod-secure-3a.akamaized.net"],then:"PROXY SE.PEER",if:[]}]},sixplay_group:{cmds:[{hosts:["6play.fr","m6web.fr","6cloud.fr"],then:"PROXY XX.PEER",if:[]}]},hpav_tv:{match:{root_urls:["hpav.tv"],rules:[{proxy_country:["JP"],cmds:[{root_urls:["hpav.tv"],then:"PROXY JP.PEER",if:[]},{hosts:["static.javhdhello.com","asianclub.tv"],then:"PROXY JP.PEER",if:[]}]}]},cmds:[{root_urls:["hpav.tv"],then:"PROXY JP.PEER",if:[]},{hosts:["static.javhdhello.com","asianclub.tv"],then:"PROXY JP.PEER",if:[]}]},jiocinema_com:{match:{root_urls:["jiocinema.com"],rules:[{proxy_country:["IN"],cmds:[{root_urls:["jiocinema.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["ak-mediavod.jiocinema.com","jiocinema.com","jiocinemaweb.cdn.jio.com","mercury.akamaized.net","apis-jiovoot.voot.com","jcstreamingdash.akamaized.net","auth-jiocinema.voot.com","apis-jiocinema.voot.com","engage.jiocinema.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]}]},cmds:[{root_urls:["jiocinema.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]},{hosts:["ak-mediavod.jiocinema.com","jiocinema.com","jiocinemaweb.cdn.jio.com","mercury.akamaized.net","apis-jiovoot.voot.com","jcstreamingdash.akamaized.net","auth-jiocinema.voot.com","apis-jiocinema.voot.com","engage.jiocinema.com"],then:"PROXY IN.POOL_lum_in_shared",if:[]}]},sierra_com:{match:{root_urls:["sierra.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["sierra.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["sierra.com","stpost.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["CA"],cmds:[{root_urls:["sierra.com"],then:"PROXY CA.POOL_lum_ca_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY CA.POOL_lum_ca_shared"}]},{proxy_country:["GB"],cmds:[{root_urls:["sierra.com"],then:"PROXY GB.POOL_lum_gb_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["NL"],cmds:[{root_urls:["sierra.com"],then:"PROXY NL.POOL_lum_nl_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY NL.POOL_lum_nl_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["sierra.com"],then:"PROXY FR.POOL_lum_fr_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["ES"],cmds:[{root_urls:["sierra.com"],then:"PROXY ES.POOL_lum_es_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY ES.POOL_lum_es_shared"}]},{proxy_country:["US"],cmds:[{root_urls:["sierra.com"],then:"PROXY US.POOL_lum_us_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY US.POOL_lum_us_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["sierra.com"],then:"PROXY KR.POOL_lum_kr_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["sierra.com"],then:"PROXY BR.POOL_lum_br_shared"},{hosts:["sierra.com","stpost.com"],then:"PROXY BR.POOL_lum_br_shared"}]},{proxy_country:["AR","AT","AU","BE","BG","CH","CL","CO","CZ","DE","DK","FI","GR","HK","HR","HU","ID","IE","IL","IN","IS","JP","MX","NO","NZ","PL","RO","RU","SE","SG","SK","TR","NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA"],cmds:[{hosts:["sierra.com","stpost.com"],then:"PROXY XX.PEER"}]}]},cmds:[{root_urls:["sierra.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["sierra.com","stpost.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},meijer_com:{match:{root_urls:["meijer.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["meijer.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["meijer.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},instagram_com:{match:{root_urls:["instagram.com"],rules:[{proxy_country:["GB","NL"],cmds:[{hosts:["fbsbx.com","static.cdninstagram.com","instagram.com","scriptcdn.net"],then:"PROXY XX.PEER",if:[]}]}]},cmds:[{hosts:["fbsbx.com","static.cdninstagram.com","instagram.com","scriptcdn.net"],then:"PROXY XX.PEER",if:[]}]},mos_ru:{match:{root_urls:["mos.ru"],rules:[{proxy_country:["RU"],cmds:[{hosts:["mos.ru"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{hosts:["mos.ru"],then:"PROXY RU.PEER",if:[]}]},gosuslugi_ru:{match:{root_urls:["gosuslugi.ru"],rules:[{proxy_country:["RU"],cmds:[{hosts:["gosuslugi.ru"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{hosts:["gosuslugi.ru"],then:"PROXY RU.PEER",if:[]}]},tgc1_ru:{match:{root_urls:["lk.tgc1.ru","tgc1.ru"],rules:[{proxy_country:["RU"],cmds:[{hosts:["lk.tgc1.ru","tgc1.ru"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{hosts:["lk.tgc1.ru","tgc1.ru"],then:"PROXY RU.PEER",if:[]}]},tyuiu_ru:{match:{root_urls:["tyuiu.ru"],rules:[{proxy_country:["RU"],cmds:[{hosts:["pk.tyuiu.ru","tyuiu.ru"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{hosts:["pk.tyuiu.ru","tyuiu.ru"],then:"PROXY RU.PEER",if:[]}]},adjarabet_com:{match:{root_urls:["adjarabet.com"],rules:[{proxy_country:["GE"],cmds:[{hosts:["adjarabet.com"],then:"PROXY GE.PEER",if:[]}]}]},cmds:[{hosts:["adjarabet.com"],then:"PROXY GE.PEER",if:[]}]},vfsglobal_com:{match:{root_urls:["vfsglobal.com"],rules:[{proxy_country:["RU"],cmds:[{hosts:["vfsglobal.com"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{hosts:["vfsglobal.com"],then:"PROXY RU.PEER",if:[]}]},blsportugal_com:{match:{root_urls:["russia.blsportugal.com"],rules:[{proxy_country:["RU"],cmds:[{hosts:["russia.blsportugal.com"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{hosts:["russia.blsportugal.com"],then:"PROXY RU.PEER",if:[]}]},tax_ohio_gov:{match:{root_urls:["tax.ohio.gov"],rules:[{proxy_country:["US"],cmds:[{hosts:["tax.ohio.gov"],then:"PROXY US.PEER",if:[]}]}]},cmds:[{hosts:["tax.ohio.gov"],then:"PROXY US.PEER",if:[]}]},kayosports_com_au:{match:{root_urls:["kayosports.com.au"],rules:[{proxy_country:["AU"],cmds:[{hosts:["kayosports.com.au","streamotion.com.au"],then:"PROXY AU.POOL_lum_au_shared",if:[]}]}]},cmds:[{hosts:["kayosports.com.au","streamotion.com.au"],then:"PROXY AU.POOL_lum_au_shared",if:[]}]},nalog_ru:{match:{root_urls:["nalog.gov.ru","nalog.ru"],rules:[{proxy_country:["RU"],cmds:[{root_urls:["nalog.gov.ru","nalog.ru"],then:"PROXY RU.PEER",if:[]}]}]},cmds:[{root_urls:["nalog.gov.ru","nalog.ru"],then:"PROXY RU.PEER",if:[]}]},latele_envivo_com:{match:{root_urls:["latele-envivo.com"],rules:[{proxy_country:["AR"],cmds:[{hosts:["latele-envivo.com","pealmeditate.com","pluto.tv"],then:"PROXY AR.PEER",if:[]}]}]},cmds:[{hosts:["latele-envivo.com","pealmeditate.com","pluto.tv"],then:"PROXY AR.PEER",if:[]}]},lrt_lt:{match:{root_urls:["lrt.lt"],rules:[{proxy_country:["LT"],cmds:[{hosts:["dlvr1.net"],then:"PROXY LT.PEER",if:[]}]}]},cmds:[{hosts:["dlvr1.net"],then:"PROXY LT.PEER",if:[]}]},colaboraread_com_br:{match:{root_urls:["colaboraread.com.br"],rules:[{proxy_country:["BR"],cmds:[{hosts:["colaboraread.com.br"],then:"PROXY BR.POOL_lum_br_shared",if:[]}]}]},cmds:[{hosts:["colaboraread.com.br"],then:"PROXY BR.POOL_lum_br_shared",if:[]}]},growtopiagame_com:{match:{root_urls:["growtopiagame.com"],rules:[{proxy_country:["IT"],cmds:[{root_urls:["growtopiagame.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["growtopiagame.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},{proxy_country:["GB"],cmds:[{root_urls:["growtopiagame.com"],then:"PROXY GB.POOL_lum_gb_shared"},{hosts:["growtopiagame.com"],then:"PROXY GB.POOL_lum_gb_shared"}]},{proxy_country:["FR"],cmds:[{root_urls:["growtopiagame.com"],then:"PROXY FR.POOL_lum_fr_shared"},{hosts:["growtopiagame.com"],then:"PROXY FR.POOL_lum_fr_shared"}]},{proxy_country:["KR"],cmds:[{root_urls:["growtopiagame.com"],then:"PROXY KR.POOL_lum_kr_shared"},{hosts:["growtopiagame.com"],then:"PROXY KR.POOL_lum_kr_shared"}]},{proxy_country:["BR"],cmds:[{root_urls:["growtopiagame.com"],then:"PROXY BR.POOL_lum_br_shared"},{hosts:["growtopiagame.com"],then:"PROXY BR.POOL_lum_br_shared"}]},{proxy_country:["AU"],cmds:[{root_urls:["growtopiagame.com"],then:"PROXY AU.POOL_lum_au_shared"},{hosts:["growtopiagame.com"],then:"PROXY AU.POOL_lum_au_shared"}]},{proxy_country:["AR","AT","BE","BG","CA","CH","CL","CO","CZ","DE","DK","ES","FI","GR","HK","HR","HU","ID","IE","IL","IN","IS","JP","MX","NL","NO","NZ","PL","RO","RU","SE","SG","SK","TR","US","NO","GR","DE","DK","SE","CL","SG","CH","EG","RU","PL","IE","CN","IL","AR","HU","BE","FI","MX","HR","SI","SK","TR","TW","TH","JM","VN","PE","PH","ID","RO","ZA","BG","AT","NZ","CZ","IS","PT","BZ","UA"],cmds:[{hosts:["growtopiagame.com"],then:"PROXY XX.PEER"}]}]},cmds:[{root_urls:["growtopiagame.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]},{hosts:["growtopiagame.com"],then:"PROXY IT.POOL_lum_it_shared",if:[]}]},kimdesene_org:{match:{root_urls:["kimdesene.org"],rules:[{proxy_country:["RO"],cmds:[{hosts:["kimdesene.org","commentsmodule.com"],then:"PROXY RO.PEER",if:[]}]}]},cmds:[{hosts:["kimdesene.org","commentsmodule.com"],then:"PROXY RO.PEER",if:[]}]},megogo_net:{match:{root_urls:["megogo.net"],rules:[{proxy_country:["UA"],cmds:[{hosts:["megogo.net"],then:"PROXY UA.PEER",if:[]}]}]},cmds:[{hosts:["megogo.net"],then:"PROXY UA.PEER",if:[]}]},familytreenow_com:{match:{root_urls:["familytreenow.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["familytreenow.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["familytreenow.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},billerweb_com:{match:{root_urls:["secure3.billerweb.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["secure3.billerweb.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["secure3.billerweb.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},fisglobal_com:{match:{root_urls:["fisglobal.com"],rules:[{proxy_country:["US"],cmds:[{hosts:["fisglobal.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]}]},cmds:[{hosts:["fisglobal.com"],then:"PROXY US.POOL_lum_us_shared",if:[]}]},tv_nrk_no:{match:{root_urls:["tv.nrk.no"],rules:[{proxy_country:["NO"],cmds:[{hosts:["dna.contentdelivery.net","nrk-od-00.akamaized.net","nrk-od-01.akamaized.net","nrk-od-02.akamaized.net","nrk-od-03.akamaized.net","nrk-od-04.akamaized.net","nrk-od-05.akamaized.net","nrk-od-06.akamaized.net","nrk-od-07.akamaized.net","nrk-od-08.akamaized.net","nrk-od-09.akamaized.net","nrk-od-10.akamaized.net","nrk-od-11.akamaized.net","nrk-od-12.akamaized.net","nrk-od-13.akamaized.net","nrk-od-14.akamaized.net","nrk-od-15.akamaized.net","nrk-od-16.akamaized.net","nrk-od-17.akamaized.net","nrk-od-18.akamaized.net","nrk-od-19.akamaized.net","nrk-od-20.akamaized.net","nrk-od-21.akamaized.net","nrk-od-22.akamaized.net","nrk-od-23.akamaized.net","nrk-od-24.akamaized.net","nrk-od-25.akamaized.net","nrk-od-26.akamaized.net","nrk-od-27.akamaized.net","nrk-od-28.akamaized.net","nrk-od-29.akamaized.net","nrk-od-30.akamaized.net","nrk-od-31.akamaized.net","nrk-od-32.akamaized.net","nrk-od-33.akamaized.net","nrk-od-34.akamaized.net","nrk-od-35.akamaized.net","nrk-od-36.akamaized.net","nrk-od-37.akamaized.net","nrk-od-38.akamaized.net","nrk-od-39.akamaized.net","nrk-od-40.akamaized.net","nrk-od-41.akamaized.net","nrk-od-42.akamaized.net","nrk-od-43.akamaized.net","nrk-od-44.akamaized.net","nrk-od-45.akamaized.net","nrk-od-46.akamaized.net","nrk-od-47.akamaized.net","nrk-od-48.akamaized.net","nrk-od-49.akamaized.net","nrk-od-50.akamaized.net","nrk-od-51.akamaized.net","nrk-od-52.akamaized.net","nrk-od-53.akamaized.net","nrk-od-54.akamaized.net","nrk-od-55.akamaized.net","nrk-od-56.akamaized.net","nrk-od-57.akamaized.net","nrk-od-58.akamaized.net","nrk-od-59.akamaized.net","nrk-od-60.akamaized.net","nrk-od-61.akamaized.net","nrk-od-62.akamaized.net","nrk-od-63.akamaized.net","nrk-od-64.akamaized.net","nrk-od-65.akamaized.net","nrk-od-66.akamaized.net","nrk-od-67.akamaized.net","nrk-od-68.akamaized.net","nrk-od-69.akamaized.net","nrk-od-70.akamaized.net","nrk-od-71.akamaized.net","nrk-od-72.akamaized.net","nrk-od-73.akamaized.net","nrk-od-74.akamaized.net","nrk-od-75.akamaized.net","nrk-od-76.akamaized.net","nrk-od-77.akamaized.net","nrk-od-78.akamaized.net","nrk-od-79.akamaized.net","nrk-od-80.akamaized.net","nrk-od-81.akamaized.net","nrk-od-82.akamaized.net","nrk-od-83.akamaized.net","nrk-od-84.akamaized.net","nrk-od-85.akamaized.net","nrk-od-86.akamaized.net","nrk-od-87.akamaized.net","nrk-od-88.akamaized.net","nrk-od-89.akamaized.net","nrk-od-90.akamaized.net","nrk-od-91.akamaized.net","nrk-od-92.akamaized.net","nrk-od-93.akamaized.net","nrk-od-94.akamaized.net","nrk-od-95.akamaized.net","nrk-od-96.akamaized.net","nrk-od-97.akamaized.net","nrk-od-98.akamaized.net","nrk-od-99.akamaized.net"],then:"PROXY NO.PEER",if:[]}]}]},cmds:[{hosts:["dna.contentdelivery.net","nrk-od-00.akamaized.net","nrk-od-01.akamaized.net","nrk-od-02.akamaized.net","nrk-od-03.akamaized.net","nrk-od-04.akamaized.net","nrk-od-05.akamaized.net","nrk-od-06.akamaized.net","nrk-od-07.akamaized.net","nrk-od-08.akamaized.net","nrk-od-09.akamaized.net","nrk-od-10.akamaized.net","nrk-od-11.akamaized.net","nrk-od-12.akamaized.net","nrk-od-13.akamaized.net","nrk-od-14.akamaized.net","nrk-od-15.akamaized.net","nrk-od-16.akamaized.net","nrk-od-17.akamaized.net","nrk-od-18.akamaized.net","nrk-od-19.akamaized.net","nrk-od-20.akamaized.net","nrk-od-21.akamaized.net","nrk-od-22.akamaized.net","nrk-od-23.akamaized.net","nrk-od-24.akamaized.net","nrk-od-25.akamaized.net","nrk-od-26.akamaized.net","nrk-od-27.akamaized.net","nrk-od-28.akamaized.net","nrk-od-29.akamaized.net","nrk-od-30.akamaized.net","nrk-od-31.akamaized.net","nrk-od-32.akamaized.net","nrk-od-33.akamaized.net","nrk-od-34.akamaized.net","nrk-od-35.akamaized.net","nrk-od-36.akamaized.net","nrk-od-37.akamaized.net","nrk-od-38.akamaized.net","nrk-od-39.akamaized.net","nrk-od-40.akamaized.net","nrk-od-41.akamaized.net","nrk-od-42.akamaized.net","nrk-od-43.akamaized.net","nrk-od-44.akamaized.net","nrk-od-45.akamaized.net","nrk-od-46.akamaized.net","nrk-od-47.akamaized.net","nrk-od-48.akamaized.net","nrk-od-49.akamaized.net","nrk-od-50.akamaized.net","nrk-od-51.akamaized.net","nrk-od-52.akamaized.net","nrk-od-53.akamaized.net","nrk-od-54.akamaized.net","nrk-od-55.akamaized.net","nrk-od-56.akamaized.net","nrk-od-57.akamaized.net","nrk-od-58.akamaized.net","nrk-od-59.akamaized.net","nrk-od-60.akamaized.net","nrk-od-61.akamaized.net","nrk-od-62.akamaized.net","nrk-od-63.akamaized.net","nrk-od-64.akamaized.net","nrk-od-65.akamaized.net","nrk-od-66.akamaized.net","nrk-od-67.akamaized.net","nrk-od-68.akamaized.net","nrk-od-69.akamaized.net","nrk-od-70.akamaized.net","nrk-od-71.akamaized.net","nrk-od-72.akamaized.net","nrk-od-73.akamaized.net","nrk-od-74.akamaized.net","nrk-od-75.akamaized.net","nrk-od-76.akamaized.net","nrk-od-77.akamaized.net","nrk-od-78.akamaized.net","nrk-od-79.akamaized.net","nrk-od-80.akamaized.net","nrk-od-81.akamaized.net","nrk-od-82.akamaized.net","nrk-od-83.akamaized.net","nrk-od-84.akamaized.net","nrk-od-85.akamaized.net","nrk-od-86.akamaized.net","nrk-od-87.akamaized.net","nrk-od-88.akamaized.net","nrk-od-89.akamaized.net","nrk-od-90.akamaized.net","nrk-od-91.akamaized.net","nrk-od-92.akamaized.net","nrk-od-93.akamaized.net","nrk-od-94.akamaized.net","nrk-od-95.akamaized.net","nrk-od-96.akamaized.net","nrk-od-97.akamaized.net","nrk-od-98.akamaized.net","nrk-od-99.akamaized.net"],then:"PROXY NO.PEER",if:[]}]},google_hosts:{cmds:[{client_only:true,hosts:["google.com","googleapis.com"],then:"DIRECT",if:[]}]},youtube_hosts:{cmds:[{client_only:true,hosts:["youtube.com","www.youtube.com"],then:"DIRECT",if:[]}]},openai_hosts:{cmds:[{client_only:true,hosts:["openai.com","chatgpt.com"],then:"DIRECT",if:[]}]},vk:{cmds:[{client_only:true,hosts:["vk.com","vk.ru"],then:"DIRECT",if:[]},{root_urls:["vk.com","vk.ru"],then:"PROXY XX",if:[]}]},yandex:{cmds:[{client_only:true,hosts:["yandex.com","yandex.ru","ya.ru"],then:"DIRECT",if:[]},{root_urls:["yandex.com","yandex.ru","ya.ru"],then:"PROXY XX",if:[]}]},hola_browser_internal:{cmds:[{client_only:true,hosts:["___.com","___4.com","___5.com"],then:"DIRECT",if:[]}]},abc:{proxy_country:["US"],cmds:[{hosts:["edgedatg.com","edgedatg.go.com"],if:[{host:"[^.]\\.?edgedatg(\\.go)?\\.com",type:"!~",then:"PROXY XX"}],then:"PROXY US.PEER"}]},stb_ua:{country:{list:["UA"],type:"in"},cmds:[{hosts:["vcms-api2.starlight.digital","vcms-api.starlight.digital"],then:"PROXY UA.PEER",if:[]}]},mediaklikk:{proxy_country:["HU"],cmds:[{hosts:["connectmedia.hu"],if:[{url:".*cdn\\.connectmedia\\.hu\\/.*\\.m3u8",type:"=~",then:"PROXY XX"}],then:"PROXY XX"}]},zdf_de:{match:{root_urls:["zdf.de"],rules:[{cmds:[{hosts:["zdfvodde-vh.akamaihd.net"],if:[{url:".*zdfvodde-vh\\.akamaihd\\.net\\/i\\/zdf\\/.*\\.m3u8",type:"=~",then:"PROXY XX"}],then:"PROXY XX"}]}]},cmds:[{hosts:["zdfvodde-vh.akamaihd.net"],if:[{url:".*zdfvodde-vh\\.akamaihd\\.net\\/i\\/zdf\\/.*\\.m3u8",type:"=~",then:"PROXY XX"}],then:"PROXY XX"}]},fubotv:{match:{root_urls:["fubo.tv"],rules:[{cmds:[{hosts:["fubo.tv"],then:"PROXY XX",if:[]}]}]},cmds:[{hosts:["fubo.tv"],then:"PROXY XX",if:[]}]}}}}}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},6969:(module,exports,__webpack_require__)=>{"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(8763),__webpack_require__(541),__webpack_require__(7345),__webpack_require__(5250),__webpack_require__(4118),__webpack_require__(6386),__webpack_require__(1291),__webpack_require__(9824),__webpack_require__(9641)],__WEBPACK_AMD_DEFINE_RESULT__=function(_,Backbone,be_util,be_vpn_util,zconf,etask,zutil,zerr,conf){const is_bg=be_vpn_util.is_bg();const listener_prefix="l"+(is_bg?"b":"p");const E={};const manifest=be_util.get_manifest();function _destroy(o){try{o.destroy()}catch(err){try{console.error("error in destroy %s",err.stack||err)}catch(_err){}throw err}}const is_object=obj=>obj!=null&&(typeof obj=="object"||obj instanceof Object);const is_array=obj=>Array.isArray(obj)||obj instanceof Array;const _clone_deep=obj=>{let ret;if(is_array(obj)){ret=new Array(obj.length);let n=obj.length;for(let i=0;i<n;i++)ret[i]=is_object(obj[i])?_clone_deep(obj[i]):obj[i];return ret}else if(obj instanceof Date)return new Date(obj);else if(obj instanceof RegExp)return new RegExp(obj);else if(obj instanceof Function)return obj;ret={};for(let i in obj)ret[i]=is_object(obj[i])?_clone_deep(obj[i]):obj[i];return ret};const clone_deep=obj=>is_bg&&conf.firefox_web_ext&&is_object(obj)?_clone_deep(obj):obj;E.model=Backbone.Model.extend({defaults:function(){this._listenerId=_.uniqueId(listener_prefix);if(this._defaults)this._defaults.call(this);this.on("destroy",(function(){this.off();this.stopListening();this.destroyed=true}))},_destroy:function(){_destroy(this)},sync:function(){},assert_inited:function(){be_vpn_util.assert(this.get("inited"),new Error("not inited"))},on_init:function(events,cb){this.on(events,cb);cb.call(this)},listen_to:function(other,events,cb){this.listenTo(other,events,cb);cb.call(this)},fcall:function(a0,a1){return this[a0].apply(this,clone_deep(a1))},ecall:function(a0,a1){return this[a0].apply(this,clone_deep(a1))},safe_set:function(change){var diff=this.changedAttributes(change);if(!diff)return;this.set(diff,{silent:true});_.each(diff,(function(val,key){try{this.trigger("change:"+key)}catch(err){be_util.perr("be_safe_set_err",{key,val},{err,rate_limit:{count:1}});console.error("error in change listener %s",err.stack||err)}}),this);try{this.trigger("change")}catch(e){be_util.perr("be_safe_set_err",{},{err:e,rate_limit:{count:1}});console.error("error in change listener %s",e.stack||e)}},set:function(attributes,options){if(typeof options=="object")options=_.clone(options);Backbone.Model.prototype.set.apply(this,[attributes,options])},assert_no_listeners:function(){if(!this._events||!Object.keys(this._events).length)return;if(Object.keys(this._events).length>1||Object.keys(this._events)[0]!="destroy"){console.error("%s: assert_no_listeners _events %s",this.model_name,Object.keys(this._events));if(zutil.is_mocha())throw new Error("has listeners")}}});let backbone_max_listeners_limit=11;let leak_warn=(obj,events)=>{if(!obj._events)return;if(typeof events=="object")events=Object.keys(events);else events=events.split(/\s+/);for(let event of events){let a=obj._events[event];if(!a||a.length<backbone_max_listeners_limit)continue;console.error("%s: too many event listeners %s %s",obj.model_name,a.length,event);be_util.perr("be_backbone_max_listeners_"+backbone_max_listeners_limit,{count:a.length,module:obj.model_name,event,bt:zerr.get_stack_trace()},{rate_limit:{count:1}});backbone_max_listeners_limit*=10;if(zutil.is_mocha())throw new Error(obj.model_name+" too many listeners")}};if(manifest&&!manifest.update_url||zutil.is_mocha()){E.model.prototype.on=function(events){leak_warn(this,events);return Backbone.Model.prototype.on.apply(this,arguments)};E.model.prototype.listenTo=function(other,events){leak_warn(other,events);return Backbone.Model.prototype.listenTo.apply(this,arguments)}}E.task_model=E.model.extend({defaults:function(){if(this._defaults)this._defaults.call(this);this.queue=[];this.on("destroy",(function(){clearTimeout(this.queue_timer);delete this.queue;this.off();this.stopListening();this.destroyed=true}))},assert_inited:function(){be_vpn_util.assert(this.get("inited"),new Error("not inited"));be_vpn_util.assert(this.queue,new Error("in destroy"))},set_busy:function(opt){this.assert_inited();be_vpn_util.assert(this.get("status")!="error",new Error("set_busy in error"));if(this.get("status")=="ready"||!this.get("status")||this.in_clr_busy){this.in_clr_busy=false;this.set("status_opt",opt);this.set("status","busy");return true}return false},update_progress:function(opt){this.set("status_opt",opt)},clr_busy:function(){this.assert_inited();be_vpn_util.assert(this.get("status")!="error",new Error("clr_busy in error"));if(!this.queue.length){this.unset("status_opt");return this.set("status","ready")}this.queue_timer=setTimeout(function(){this.in_clr_busy=true;this.trigger.apply(this,this.queue.shift())}.bind(this),0)},clr_task:function(task){this.assert_inited();this.queue=_.filter(this.queue,(function(o){return!_.isEqual(o,task)}))},clr_task_by_id:function(id){this.assert_inited();this.queue=_.filter(this.queue,(function(o){return o[0]!=id}))},set_err:function(){this.assert_inited();be_vpn_util.assert(this.get("status")=="busy",new Error("set_err but not busy"));clearTimeout(this.queue_timer);this.queue=[];this.in_clr_busy=0;this.unset("status_opt");return this.set("status","error")},schedule:function(task){this.assert_inited();be_vpn_util.assert(this.get("status")=="busy",new Error("schedule but not busy"));this.queue.push(task)},schedule_clr:function(task){this.clr_task(task);return this.schedule(task)},recover:function(){this.assert_inited();be_vpn_util.assert(this.get("status")=="error",new Error("recover but not in error"));this.unset("status_opt");this.set("status","",{silent:true});return this.trigger("recover")}});return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},1211:(module,exports,__webpack_require__)=>{"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(6386),__webpack_require__(9824),__webpack_require__(57),__webpack_require__(6969),__webpack_require__(177),__webpack_require__(8763),__webpack_require__(9369),__webpack_require__(901),__webpack_require__(1291),__webpack_require__(5250),__webpack_require__(7345)],__WEBPACK_AMD_DEFINE_RESULT__=function(etask,zerr,be_msg,be_backbone,be_chrome,_,be_transport,user_agent,zutil,be_vpn_util,be_util){const chrome=self.chrome;const v3=be_util.is_v3;const is_tpopup_window=be_vpn_util.get_tpopup_mode()=="window";const E=new(be_backbone.model.extend({model_name:"browser",_defaults:function(){this.msg=new be_msg;this.on("destroy",(()=>E.uninit()))}}));if(zutil.is_mocha()){chrome.browserAction={setIcon:()=>{},setBadgeText:()=>{},setBadgeBackgroundColor:()=>{}};chrome.windows={getLastFocused:()=>{},onFocusChanged:{addListener:()=>{},removeListener:()=>{}}};chrome.storage={local:{get:()=>{},set:()=>{},remove:()=>{}}};chrome.tabs={update:()=>{},reload:()=>{},query:()=>{},get:()=>{},onFocusChanged:{addListener:()=>{},removeListener:()=>{}},onCreated:{addListener:()=>{},removeListener:()=>{}},onUpdated:{addListener:()=>{},removeListener:()=>{}},onActivated:{addListener:()=>{},removeListener:()=>{}},onRemoved:{addListener:()=>{},removeListener:()=>{}},onReplaced:{addListener:()=>{},removeListener:()=>{}}}}E.uninit=()=>{if(!E.inited)return;if(zutil.is_mocha()){be_chrome.uninit();E.msg.uninit()}else{be_chrome._destroy();E.msg._destroy()}E.inited=false};E.init=opt=>{if(E.inited)return;E.inited=true;E.browser_version=user_agent.guess_browser().version;E.os=user_agent.guess().os;opt=opt||{};E.msg.init(get_transport(),{context:opt.context!==undefined?opt.context:{}});E.rpc=!be_vpn_util.is_bg()?E.rpc_types.chrome_msg:E.rpc_types.chrome_native;E.rpc.init()};function get_transport(){if(be_vpn_util.is_bg()||is_tpopup_window)return be_transport.chrome_tabs(chrome);return be_transport.tpopup(chrome,zutil.get(self,"hola.tpopup_opt.tab_id",-1))}E.rpc_types={chrome_native:{init:function(){if(this.inited)return;this.inited=true;be_chrome.init(E.msg);be_chrome.impl.init();E.runtime.id=be_chrome.impl.id;E.runtime.url=be_chrome.impl.url;E.runtime.manifest=be_chrome.impl.manifest},call_api:function(obj,sub,func,args,cb,ms,error_cb){var _this=this,_cb=!cb?null:function(){E.runtime.last_error=_this.last_error=chrome.runtime.lastError;return cb.apply(null,arguments)};return be_chrome.impl.call_api(obj,sub,func,args,_cb)},add_listener:(obj,sub,cb,opt,extra)=>be_chrome.impl.add_listener(obj,sub,cb,opt,extra),del_listener:(obj,sub,cb)=>be_chrome.impl.del_listener(obj,sub,cb)},chrome_msg:{init:function(){if(this.inited)return;this.inited=true;be_chrome.init(E.msg);E.rpc.call_api("impl","","init",[],(function(o){E.runtime.id=o.id;E.runtime.manifest=o.manifest;if(E.runtime.url=o.url)return;E.runtime.url=chrome?"chrome-extension://"+o.id:"resource://"+o.id.replace("@","-at-").toLowerCase()+"/hola_firefox_ext"}))},call_api:function(obj,sub,func,args,cb,ms,error_cb,skip_resp){var _this=this;return E.msg.send({msg:"call_api",obj,sub,func,args,has_cb:!!cb,skip_resp},(function(ret){if(!cb)return;E.runtime.last_error=_this.last_error=ret.last_error;if(ret.error){if(error_cb)error_cb(ret);return}cb.apply(null,ret.args)}),ms)},add_listener:(obj,sub,cb)=>E.msg.add_listener({obj,sub},cb),del_listener:(obj,sub,cb)=>E.msg.del_listener({obj,sub},cb)}};E.tabs={disconnect:(tab_id,cb)=>{E.rpc.call_api("tabs","","disconnect",[tab_id],cb)},is_connected:tab_id=>!!E.msg.tab_connections[tab_id],get_tab_connections:tab_id=>E.msg.tab_connections[tab_id]};E.runtime={};E.backbone={client:{obj:{}},server:{obj:{},cb:{}}};E.backbone.client.ping=function(id,ms,cb){E.rpc.call_api("backbone","server","ping",[id],cb,ms,cb)};E.backbone.client.start=function(id){zerr.debug("backbone.client.start "+id);var o=this.obj[id],_this=this;zerr.assert(!o,"client "+id+" already started");o=this.obj[id]=new be_backbone.model;E.msg.on_backbone_event=function(info){var o=_this.obj[info.id];if(!o)return;var ename=info.ename;if(ename.includes("change:")){var attr=ename.replace("change:",""),val=info.args[0];o.set(attr,val)}else o.trigger.apply(o,[ename].concat(info.args))};o.fcall=(func,args)=>E.rpc.call_api("backbone.server.obj."+id,"fcall",func,args);o.ecall=(func,args)=>etask((function*(){const ret=yield etask.cb_apply(E.rpc,".call_api",["backbone.server.obj."+id,"ecall",func,args]);be_vpn_util.assert(!zutil.get(ret,"_error"),zutil.get(ret,"_error"));return ret}));E.rpc.call_api("backbone","server","connect",[id],(function(ret){var o=_this.obj[id];if(!o)return zerr("client %s got connected after stop",id);if(ret.error)return zerr("backbone.client.start error: "+ret.error);o.set(ret.attributes);o.set("_backbone_client_started",true)}));return o};E.backbone.client.stop=function(id){zerr.debug("backbone.client.stop "+id);var o=this.obj[id];zerr.assert(o,"client "+id+" not started");E.rpc.call_api("backbone","server","disconnect",[id,o.get("_backbone_client_id")],null,null,null,true);o._destroy();delete this.obj[id]};E.backbone.server.start=function(obj,id){zerr.debug("backbone.server.start "+id+" cid "+obj.cid);zerr.assert(!this.obj[id],"server "+id+" already started");this.obj[id]=obj};E.backbone.server.stop=function(id){zerr.debug("backbone.server.stop "+id);var o=this.obj[id];zerr.assert(o,"server "+id+" not started");delete this.obj[id]};if(v3)E.init();return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},177:(module,exports,__webpack_require__)=>{"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(8763),__webpack_require__(6386),__webpack_require__(6969),__webpack_require__(9824),__webpack_require__(1291),__webpack_require__(5250),__webpack_require__(7345)],__WEBPACK_AMD_DEFINE_RESULT__=function(_,etask,be_backbone,zerr,zutil,be_vpn_util,be_util){const v3=be_util.is_v3;const chrome=!be_vpn_util.is_tpopup()&&self.chrome;const noop=()=>{};const E=new(be_backbone.model.extend({model_name:"chrome",_defaults:function(){this.on("destroy",(function(){E.uninit()}))}}));E.init=msg=>{if(E.inited||!be_vpn_util.is_bg())return;E.inited=true;E.listeners={"":{}};E.msg=msg;E.msg.on_req=on_req;E.msg.on_add_listener=on_add_listener;E.msg.on_del_listener=on_del_listener;E.msg.on_connect=on_connect;E.msg.on_disconnect=on_disconnect};E.uninit=()=>{if(!E.inited)return;E.msg.on_req=undefined;E.msg.on_add_listener=undefined;E.msg.on_del_listener=undefined;E.msg.on_connect=undefined;E.msg.on_disconnect=undefined};function on_req(j){var req=j.msg;switch(req.msg){case"call_api":var cb=!req.has_cb?null:function(){E.msg.resp(j,{args:_.toArray(arguments),last_error:!chrome?0:chrome.runtime.lastError})};E.impl.call_api(req.obj,req.sub,req.func,req.args,cb,j);if(!req.has_cb&&!req.skip_resp)E.msg.resp(j,{args:[]});break}}function on_add_listener(j){var req=j.msg,id=j.id,cid=j._connection_id||"";var cb=function(){E.msg.send_event(j,_.toArray(arguments))};cb.__j=j;var l=E.listeners[cid];if(!l)return zerr("add: listeners for "+cid+" not inited");zerr.assert(!l[id],"add: listener "+id+" already exists");l[id]=cb;E.impl.add_listener(req.obj,req.sub,cb)}function on_del_listener(j){var req=j.msg,id=j.id,cid=j._connection_id||"";var l=E.listeners[cid];if(!l)return zerr("del: listeners for "+cid+" not inited");var cb=l[id];zerr.assert(cb,"del: listener "+id+" not found");E.impl.del_listener(req.obj,req.sub,cb);delete l[id]}function on_connect(cid){if(E.listeners[cid]){if(!v3)zerr("connect: listeners for "+cid+" already inited");return}E.listeners[cid]={}}function on_disconnect(cid){var l=E.listeners[cid];if(!l)return zerr("disc: listeners for "+cid+" not inited");_.each(zutil.clone(l),(function(e,i){var t;if(t=e.__j)on_del_listener(t);else if(t=e.__backbone)del_backbone_listener(t.id,cid,t.backbone_client_id)}));zerr.assert(_.isEmpty(l),"listeners not empty");delete E.listeners[cid]}function del_backbone_listener(id,connection_id,backbone_client_id){var o=get_backbone_obj(id);var l=E.listeners[connection_id];if(!l){return zerr("del_backbone: listeners for "+connection_id+" not inited")}var cb=l[backbone_client_id];delete l[backbone_client_id];if(!o)return;E.stopListening(o,"all",cb)}function join_dot(obj,sub,func){return _.compact(arguments).join(".")}function get_obj(root,obj,sub){let a=obj.split(".").concat(sub||[]),o=root,i;for(i=0;i<a.length&&o;i++)o=o[a[i]];return i<a.length?null:o}function get_backbone_obj(id){var main=self.be_bg_main;return main&&main.be_browser.backbone.server.obj[id]}function perr(id,info,opt,new_name){let perr_func=zutil.get(self,"be_bg_main.be_util.perr");if(perr_func)return perr_func(id,info,opt,new_name);zerr("perr "+id+" "+(info?info:"")+(opt.err?"\n"+zerr.e2s(opt.err):""))}let sent;function _perr(obj,sub,func,args,err){if(sent)return console.error("skip be_msg_err %s",err);var err_info=err?err.hola_info:undefined;perr("be_msg_err",{method:join_dot(obj,sub,func),args,err_info},{err});sent=true}E.impl={};E.impl.init=function(){if(this.inited)return;this.inited=true;if(!chrome)return;this.id=chrome.runtime.id;this.url=chrome.runtime.getURL("").slice(0,-1);this.manifest=chrome.runtime.getManifest()};E.impl["impl.init"]=chrome&&function(args,cb){this.init();if(cb)cb({id:this.id,url:this.url,manifest:this.manifest})};E.impl["tpopup.set_dont_show_again"]=function(args){if(!self.be_bg_main||!self.be_bg_main.be_info)return zerr("no be_bg_main or be_info");self.be_bg_main.be_info.set_dont_show_again(args[0])};E.impl["tpopup.send_tpopup_msg"]=function(args){chrome.tabs.sendMessage(args[0],args[1])};E.impl["tpopup.trigger"]=function(args){if(!self.be_bg_main||!self.be_bg_main.be_tpopup)return;self.be_bg_main.be_tpopup.trigger(args[0],args[1])};E.impl["be_premium.login_popup_done"]=function(args){if(!self.be_bg_main||!self.be_bg_main.be_premium)return;self.be_bg_main.be_premium.login_popup_done()};E.impl["tpopup.perr"]=function(args){perr(args[1],args[2],args[3],true)};E.impl["backbone.server.connect"]=function(args,cb,j){cb=cb||noop;var id=args[0],o=get_backbone_obj(id),cid=j._connection_id||"";if(!o)return;var attr=o.attributes;var bcid=attr._backbone_client_id=_.uniqueId("bbl");var l=E.listeners[cid];if(!l)return zerr("connect: listeners for "+cid+" not inited");zerr.assert(!l[bcid],"backbone listener for"+bcid+" already exists");var _cb=l[bcid]=function(ename){var _args=[];if(ename.includes("change:"))_args=[o.get(ename.replace("change:",""))];else if(ename!="change")_args=[].slice.call(arguments,1);E.msg.send_backbone_event(j,{id,ename,args:_args})};_cb.__backbone={id,backbone_client_id:bcid};E.listenTo(o,"all",_cb);cb({attributes:attr})};E.impl["backbone.server.disconnect"]=function(args,cb,j){del_backbone_listener(args[0],j._connection_id||"",args[1]);if(cb)cb({})};E.impl["backbone.server.ping"]=function(args,cb,j){cb=cb||noop;var id=args[0],o=get_backbone_obj(id);if(o)cb({})};E.impl.call_api=function(obj,sub,func,args,cb,j){try{var o;if(obj.startsWith("backbone.server.obj.")){cb=cb||noop;var id=obj.replace("backbone.server.obj.","");o=get_backbone_obj(id);if(!o)return;if(sub=="ecall"){return etask([function(){return o.ecall(func,args)},function(){cb.apply(null,arguments)},function catch$(err){cb({_error:""+err});_perr(obj,sub,func,args,err)}])}o[sub].call(o,func,args);cb({});return}var s=join_dot(obj,sub,func);if(_.isFunction(this[s])){if(zerr.is.info())zerr.info(s+"("+zerr.json(args).substr(0,100)+")");return void this[s].call(this,args,cb,j)}o=get_obj(chrome,obj,sub);if(!o||!o[func])return _perr(obj,sub,func,args,new Error("not found"));return o[func].apply(o,args.concat(cb||[]))}catch(e){_perr(obj,sub,func,args,e)}};E.impl.add_listener=function(obj,sub,cb,opt,extra){try{var s=join_dot(obj,sub,"add_listener");if(_.isFunction(this[s])){zerr.info(s+"()");return void this[s].call(this,cb,opt,extra)}var o=get_obj(chrome,obj,sub);if(!o||!o.addListener)return _perr(obj,sub,"add_listener",new Error("not found"));if(!opt)return o.addListener(cb);o.addListener(cb,opt,extra)}catch(e){_perr(obj,sub,"add_listener",{opt,extra},e)}};E.impl.del_listener=function(obj,sub,cb){try{var s=join_dot(obj,sub,"del_listener");if(_.isFunction(this[s])){zerr.info(s+"()");return void this[s].call(this,cb)}var o=get_obj(chrome,obj,sub);if(!o||!o.removeListener)return _perr(obj,sub,"del_listener");o.removeListener(cb)}catch(e){_perr(obj,sub,"del_listener",[],e)}};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},3727:(module,exports,__webpack_require__)=>{"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(6969),__webpack_require__(1211),__webpack_require__(7345),__webpack_require__(5250)],__WEBPACK_AMD_DEFINE_RESULT__=((be_backbone,B,be_util,be_vpn_util)=>{be_vpn_util.assert_bg("be_ext");const assign=Object.assign;const E=new(be_backbone.model.extend({model_name:"ext",_defaults:function(){this.on("destroy",(()=>E.uninit()))}}));E.init=()=>{if(E.inited)return;E.inited=true};E.uninit=()=>{if(!E.inited)return;E.stopListening();E.clear();E.inited=false};E.auth=o=>{const info=be_util.qs_ajax();info.uuid=E.get("uuid");info.is_premium=E.get("is_premium");info.session_key=E.get("session_key")||0;return assign(info,o)};E.is_disabled=()=>!E.get("ext.active")||E.get("ext.suspended");return E}).apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},57:(module,exports,__webpack_require__)=>{"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(8763),__webpack_require__(6969),__webpack_require__(5250),__webpack_require__(9824),__webpack_require__(6545),__webpack_require__(7345)],__WEBPACK_AMD_DEFINE_RESULT__=function(_,be_backbone,be_vpn_util,zerr,array,be_util){const v3=be_util.is_v3;const E=be_backbone.model.extend({model_name:"msg",_defaults:function(){this.id=1;this.unique=Math.random();this.queue={};this.listeners={};this.connections={};this.tab_connections={};this.on("destroy",(function(){this.uninit()}))},unique_id:function(){return this.unique+"_"+this.id++},init:function(transport,opt){if(this.inited)return;this.inited=true;this.opt=opt||{};this.context=this.opt.context;this.transport=transport;this._on_msg=this.on_msg.bind(this);this.transport.add_listener(this._on_msg);if(!this.transport.add_connection_listener||!be_vpn_util.is_bg())return;this._on_connection=this.on_connection.bind(this);this.transport.add_connection_listener(this._on_connection)},uninit:function(){if(!this.inited)return;this.transport.remove_listener(this._on_msg);if(this._on_connection)this.transport.remove_connection_listener(this._on_connection);_.each(this.connections,(function(port){port.disconnect()}));this.inited=false},disconnect:function(tid,cid){var cids=cid?[cid]:(this.tab_connections[tid]||[]).slice();cids.forEach((function(_cid){this.connections[_cid].disconnect();this._after_disconnect(_cid,tid)}),this)},send:function(msg,cb,ms){var j={id:this.unique_id(),msg,cb};this.queue[j.id]=j;if(ms)j.timer=be_vpn_util.set_timeout((()=>this.cancel_send(j.id)),ms);this.transport.send({type:"be_msg_req",id:j.id,msg,context:this.context})},resp:function(j,ret){this.transport.send({type:"be_msg_resp",id:j.id,ret,_tab_id:j._tab_id,_connection_id:j._connection_id,context:j.context})},cancel_send:function(id){var j=this.queue[id];if(!j)return;j.timer=be_vpn_util.clear_timeout(j.timer);if(j.cb)j.cb({error:"cancel_send"});delete this.queue[id]},add_listener:function(msg,cb){be_vpn_util.assert(!cb.__listener_id,new Error("listener_id "+cb.__listener_id+" already exists"));cb.__listener_id=this.unique_id();var j={id:cb.__listener_id,msg,cb};this.listeners[j.id]=j;this.transport.send({type:"be_msg_add_listener",id:j.id,msg,context:this.context})},del_listener:function(msg,cb){const id=cb.__listener_id;be_vpn_util.assert(id,new Error("no listener id"));delete this.listeners[id];delete cb.__listener_id;this.transport.send({type:"be_msg_del_listener",id,msg,context:this.context})},send_event:function(j,args){this.transport.send({type:"be_msg_event",id:j.id,args,_tab_id:j._tab_id,_connection_id:j._connection_id,context:j.context})},send_backbone_event:function(j,info){this.transport.send({type:"be_msg_backbone_event",info,_tab_id:j._tab_id,_connection_id:j._connection_id,context:j.context})},on_connection:function(port){const connection_id=port.name;let tab_id=port.sender.tab&&port.sender.tab.id;if(v3&&!tab_id)tab_id=-1;this.add_connection(port,connection_id,tab_id);if(this.on_connect)this.on_connect(connection_id);const on_disconnect=()=>{delete_timer();port.onMessage.removeListener(on_message);this._after_disconnect(connection_id,tab_id)};const force_reconnect=()=>{zerr.notice("force reconnect: "+connection_id);port.onDisconnect.removeListener(on_disconnect);port.onMessage.removeListener(on_message);delete_timer(port);port.disconnect()};const on_message=msg=>zerr.debug("port message",connection_id,msg.msg);const delete_timer=()=>{if(port._timer){clearTimeout(port._timer);delete port._timer}};port.onDisconnect.addListener(on_disconnect);port.onMessage.addListener(on_message);if(v3&&connection_id.includes(":tpopup:"))port._timer=setTimeout(force_reconnect,250*1e3,port)},on_msg:function(msg){var j;if(!this.transport.is_valid(msg))return;var data=this.transport.get_data(msg);if(!data)return;switch(data.type){case"be_msg_req":if(!this.on_req)return;return this.on_req(data);case"be_msg_resp":j=this.queue[data.id];if(!j)return;j.timer=be_vpn_util.clear_timeout(j.timer);if(j.cb)j.cb(data.ret);delete this.queue[data.id];return;case"be_msg_add_listener":if(!this.on_add_listener)return;return this.on_add_listener(data);case"be_msg_del_listener":if(this.on_del_listener)return;return this.on_del_listener(data);case"be_msg_event":j=this.listeners[data.id];if(!j)return;j.cb.apply(null,data.args);return;case"be_msg_backbone_event":if(!this.on_backbone_event)return;return this.on_backbone_event(data.info);case"be_msg_connect":var _this=this;var port={name:data._connection_id,sender:{tab:{id:data._tab_id}},disconnect:()=>{_this.send({msg:"call_api",obj:"firefox",sub:"workers",func:"disconnect",args:[data._connection_id]})}};this.add_connection(port,data._connection_id,data._tab_id);if(this.on_connect)this.on_connect(data._connection_id);return;case"be_msg_disconnect":_this._after_disconnect(data._connection_id,data._tab_id);return}},add_connection:function(port,cid,tid){zerr.info("accepted connection "+cid+" from tab "+tid);if(!cid)return zerr("add_connection without connection_id");if(this.connections[cid]){if(v3)zerr.notice(`connection: ${cid} reconnected`);else zerr(`connection ${cid} already exists`);return}this.connections[cid]=port;if(!tid)return zerr.notice("not a tab connection: "+cid);this.tab_connections[tid]=this.tab_connections[tid]||[];this.tab_connections[tid].push(cid)},del_connection:function(cid,tid){zerr.info("connection "+cid+" from tab "+tid+" disconnected");if(!cid)return zerr("del_connection without connection_id");if(!this.connections[cid])return zerr("no connection with id: "+cid);delete this.connections[cid];if(!tid)return zerr.notice("not a tab connection: "+cid);var tab_conn=this.tab_connections[tid];if(!tab_conn||!tab_conn.includes(cid))return zerr("no connection "+cid+" for tab "+tid);array.rm_elm(tab_conn,cid);if(!tab_conn.length)delete this.tab_connections[tid]},is_connected:function(tid){return!!this.tab_connections[tid]},_after_disconnect:function(cid,tid){this.del_connection(cid,tid);if(this.on_disconnect)this.on_disconnect(cid)}});return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},143:()=>{"use strict";
// LICENSE_CODE ZON
(()=>{const chrome=self.chrome;const hola=self.hola=self.hola||{};const E=hola.base={};function _zerr(){if(typeof self!="object"||!self.console||!self.console.error)return;Function.prototype.apply.bind(self.console.error,self.console)(arguments)}const uri_comp=s=>encodeURIComponent(s).replace(/%20/g,"+");const qs=(param,opt)=>{var uri="";if(!param)return uri;opt=opt||{};var _uri_comp=opt.space_plus?uri_comp:self.encodeURIComponent;for(var i in param){var val=param[i];if(val===null||val===undefined)continue;uri+=(!uri?"":"&")+_uri_comp(i)+"="+_uri_comp(val)}return uri};const chrome_details=chrome&&chrome.runtime&&chrome.runtime.getManifest&&chrome.runtime.getManifest();const perr_url=false||"perr.hola.org";E.defaults={conf:{url_ccgi:"https://client.hola.org/client_cgi",url_perr:"https://"+perr_url+"/client_cgi",type:"unknown",browser:{firefox:!chrome}},zon_config:{CONFIG_MAKEFLAGS:"",ZON_VERSION:chrome_details?chrome_details.version:"0.0.0"}};E.get_conf=()=>self.conf||E.defaults.conf;E.get_zon_config=()=>self.zon_config||E.defaults.zon_config;var rate_limit=(rl,ms,n)=>{var now=Date.now();if(!rl.count||rl.ts+ms<now){rl.count=1;rl.ts=now;return true}rl.count++;return rl.count<=n};var check_rate_limit=opt=>{var _rate_limit=opt.rate_limit;if(!_rate_limit)return true;var hash={},rl;try{hash=JSON.parse(localStorage.getItem("perr_rate_limit")||"{}")}catch(e){}rl=hash[opt.id]=hash[opt.id]||{};var res=rate_limit(rl,_rate_limit.ms||1e3*60*60,_rate_limit.count||10);try{localStorage.setItem("perr_rate_limit",JSON.stringify(hash))}catch(e){_zerr("localStorage.setItem failed")}return res};E.raw_perr=opt=>{try{var url=E.get_conf().url_perr+"/perr";fetch(url+"?"+qs(opt,{space_plus:true}),{method:"POST"})}catch(e){_zerr("raw_perr failed "+e.stack)}};var get_hola_extension_info=()=>{if(self.hola_extension_info)return self.hola_extension_info;try{var a;if(a=document.documentElement.getAttribute("hola_extension_info"))return JSON.parse(a)}catch(e){}};E.perr_prepare=opt=>{var build=E.build_info(opt);try{opt.uuid=opt.uuid||(get_hola_extension_info()||{}).uuid||localStorage.getItem("uuid")}catch(e){_zerr("perr failed "+e.stack)}opt.cid=opt.cid||self.hola_svc_info&&self.hola_svc_info.cid;opt.ver=build.version;opt.browser=opt.browser||E.browser();opt.build=opt.build||E.build(opt);opt.url=location.href;return opt};E.perr_once_cache={};E.perr_once=opt=>{opt=E.perr_prepare(opt);var id=opt.id,info=opt.info;var holder=E.perr_once_cache[id]=E.perr_once_cache[id]||{};if(info in holder)return holder[info];if(!check_rate_limit(opt))return;var key=id+"."+info;var item;try{item=localStorage.getItem(key)}catch(e){_zerr("localStorage.getItem failed")}if(item===null){item=E.raw_perr(opt)||0;try{localStorage.setItem(key,item)}catch(e){_zerr("localStorage.setItem failed")}}return holder[info]=item};E.perr=opt=>{opt=E.perr_prepare(opt);if(!check_rate_limit(opt))return;E.raw_perr(opt)};var check_opera=/\bOPR\b\/(\d+)/i;var check_edge=/\bEdg\/(\d+)/i;var check_hola=/\bHola\b\/(\d+)/i;var check_ff=/\b(Firefox|PaleMoon)\/(\d+).\d/;E.browser=()=>{var ua=navigator.userAgent;if(check_ff.test(ua))return"firefox";if(check_hola.test(ua))return"hola";if(check_opera.test(ua))return"opera";if(check_edge.test(ua))return"edge";return"chrome"};E.build_info=opt=>{opt=opt||{};var zconf=E.get_zon_config(),conf=E.get_conf();var info={version:zconf.ZON_VERSION&&zconf.ZON_VERSION!="0.0.0"?zconf.ZON_VERSION:opt.version||zconf.ZON_VERSION};info.makeflags=zconf.CONFIG_MAKEFLAGS;if(conf.firefox_web_ext)info.product_type="webextension";else if(chrome)info.product_type=E.get_conf().type;info.id=chrome?chrome.runtime&&chrome.runtime.id:"jid1-4P0kohSJxU1qGg@jetpack";info.browser=E.browser();info.browser_build=self.conf&&self.conf.browser.name||E.browser();info.platform=navigator.platform;info.user_agent=navigator.userAgent;return info};E.build=opt=>{var info=E.build_info(opt),s="";for(var f in info)s+=(s?"\n":"")+f+": "+info[f];return s};const require_perr_sent=[];E.require_on_error=err=>{var mods=err.requireModules||[],_mods=mods.join(" ");var id="be_int_require_err";if(!err.fallback)id+="_fin";_zerr("require fatal error, modules: "+_mods+"\n"+err.stack);err.require_handled=true;if(require_perr_sent.indexOf(id)<0){var fh;if(true)mods.map((m=>require.toUrl(m))).join("\n");E.perr({id,info:_mods||""+err,bt:err.stack,filehead:fh});require_perr_sent.push(id)}if(!err.fallback)throw err};var prev_error_handler=self.onerror;self.onerror=E.onerror=function(message,file,line,col,err){var error_location=file+":"+line+":"+col;if(typeof message=="object")message=message.toString();_zerr("js error: "+error_location+"\n"+message);if(err&&err.require_handled)return;E.perr_once({id:"be_js_err",info:JSON.stringify({file:error_location,msg:message,href:location.href}),bt:err&&err.stack||"",filehead:"userAgent: "+navigator.userAgent});if(prev_error_handler)prev_error_handler.apply(self,arguments)};if(performance.mark)performance.mark("pre_loader")})()},7619:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:()=>State});var _util_etask_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_0__);var _util_util_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_1__);var _util_date_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_2__);
// LICENSE_CODE ZON
const chrome=self.chrome;class State{constructor(name,def,opt){opt=opt||{};this.name=name;this.value=def;this.ttl=opt.ttl||_util_date_js__WEBPACK_IMPORTED_MODULE_2___default().ms.HOUR;this.storage=opt.persistent?chrome.storage.local:opt.persistent===false?chrome.storage.session:chrome.storage.session||chrome.storage.local}get(path,def){return _util_util_js__WEBPACK_IMPORTED_MODULE_1___default().get(this.value,path,def)}set(path,value){let _this=this;return _util_etask_js__WEBPACK_IMPORTED_MODULE_0___default()((function*(){_util_util_js__WEBPACK_IMPORTED_MODULE_1___default().set(_this.value,path,value);yield _this.save()}))}delete(path){let _this=this;return _util_etask_js__WEBPACK_IMPORTED_MODULE_0___default()((function*(){_util_util_js__WEBPACK_IMPORTED_MODULE_1___default().unset(_this.value,path);yield _this.save()}))}save(){if(_util_util_js__WEBPACK_IMPORTED_MODULE_1___default().is_mocha()||!this.storage)return;let _this=this;return _util_etask_js__WEBPACK_IMPORTED_MODULE_0___default()((function*(){yield _util_etask_js__WEBPACK_IMPORTED_MODULE_0___default().cb_apply(_this.storage,".set",[{[_this.name]:{ts:Date.now(),value:_this.value}}])}))}load(){if(_util_util_js__WEBPACK_IMPORTED_MODULE_1___default().is_mocha()||!this.storage)return;let _this=this;return _util_etask_js__WEBPACK_IMPORTED_MODULE_0___default()((function*(){let key=_this.name;let data=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_0___default().cb_apply(_this.storage,".get",[key]);if(!data||!data[key])return;let{value,ts}=data[key];if(value&&Date.now()-ts<_this.ttl)_this.value=value}))}}},9369:(module,exports,__webpack_require__)=>{"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(8763),__webpack_require__(7345)],__WEBPACK_AMD_DEFINE_RESULT__=function(_,be_util){const E={errors:0};function wrap_cb(cb){return function(){try{return cb.apply(this,arguments)}catch(err){E.errors++;E.last_error=err;if(E.errors==1){console.error("transport error %o",err);be_util.perr("be_transport_err",{},{err})}}}}E.chrome_tabs=chrome=>({add_connection_listener:wrap_cb((cb=>{if(chrome.runtime)chrome.runtime.onConnect.addListener(cb)})),remove_connection_listener:wrap_cb((cb=>{if(chrome.runtime)chrome.runtime.onConnect.removeListener(cb)})),add_listener:wrap_cb((cb=>{if(chrome.runtime)chrome.runtime.onMessage.addListener(cb)})),remove_listener:wrap_cb((cb=>{if(chrome.runtime)chrome.runtime.onMessage.removeListener(cb)})),send:wrap_cb((data=>{data._type="tpopup";if((!data._tab_id||data._tab_id==-1)&&chrome.runtime)chrome.runtime.sendMessage(data);else chrome.tabs.sendMessage(data._tab_id,data)})),get_data:e=>e,is_valid:e=>e&&e._type=="tpopup"||e._type=="login_done_popup"});E.tpopup=(chrome,tab_id)=>{const connection_id=tab_id+":tpopup_int:"+_.random(Number.MAX_SAFE_INTEGER);let port=chrome.runtime.connect({name:connection_id});port.onDisconnect.addListener((function uninit(){port.onDisconnect.removeListener(uninit);port=null}));return{add_listener:wrap_cb((cb=>{if(chrome.runtime)chrome.runtime.onMessage.addListener(cb)})),remove_listener:wrap_cb((cb=>{if(chrome.runtime)chrome.runtime.onMessage.removeListener(cb)})),send:wrap_cb((data=>{if(!port)return;data._type="tpopup";data._tab_id=tab_id;data._connection_id=connection_id;if(chrome.runtime)chrome.runtime.sendMessage(data)})),get_data:e=>e,is_valid:e=>e&&e._tab_id==tab_id&&e._type=="tpopup"}};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},7345:(module,exports,__webpack_require__)=>{"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(8763),__webpack_require__(9824),__webpack_require__(6386),__webpack_require__(932),__webpack_require__(4996),__webpack_require__(901),__webpack_require__(665),__webpack_require__(1032),__webpack_require__(1291),__webpack_require__(5250),__webpack_require__(843),__webpack_require__(2181),__webpack_require__(7619),__webpack_require__(5317),__webpack_require__(4118),__webpack_require__(9641)],__WEBPACK_AMD_DEFINE_RESULT__=function(_,zerr,etask,date,sprintf,user_agent,ajax,storage,zutil,be_vpn_util,svc_util,be_no_log,State,rate_limit,zconf,conf){if(ajax.default)ajax=ajax.default;const E={};const is_bg=be_vpn_util.is_bg();const chrome=self.chrome;const assign=Object.assign,if_set=zutil.if_set;let ajax_cb,bext_config_cb;be_no_log=be_no_log.default;State=State.default;let state,init_ts;const{www_host}=conf;E.is_v3=chrome.runtime.getManifest().manifest_version==3;E.os_guess=user_agent.guess();E.browser_guess=user_agent.guess_browser();E.os_win=()=>E.os_guess.os=="windows";E.os_mac=()=>E.os_guess.os=="macos";E.is_mobile=()=>E.os_guess.mobile;let _is_laptop;E.is_laptop=()=>_is_laptop;E.version=()=>zconf.ZON_VERSION;E.install_version=()=>{let ext=get_bg_module("be_ext");if(ext)return ext.get("install_version")};E.install_ts=()=>{let ext=get_bg_module("be_ext");return ext&&ext.get("install_ts")||Date.now()};E.last_install_ts=()=>{let ext=get_bg_module("be_ext");return ext&&ext.get("last_install_ts")||E.install_ts()};var check_opera=/\bOPR\b\/(\d+)/i;E.browser=()=>{if(E.browser_guess.hola_browser)return"hola";if(E.browser_guess.edge)return"edge";var ua=navigator.userAgent;var opera=check_opera.exec(ua);return conf.browser.firefox?"firefox":conf.browser.opera||opera&&opera[1]?"opera":"chrome"};E.qs_ajax=o=>{var info={ext_ver:E.version(),install_ver:E.install_version(),install_ts:E.install_ts(),browser:E.browser(),product:E.get_product(),src_country:storage.get("src_country")};if(zutil.is_mocha()){info.browser=undefined;info.install_ts=undefined}assign(info,o);for(var k in info){if(info[k]===undefined)delete info[k]}return info};let storage_perr_sent;storage.on_err=(api,key,err)=>{if(zutil.is_mocha())return;zerr("%s failed %s %s",api,key,zerr.e2s(err));if(storage_perr_sent)return;storage_perr_sent=true;E.perr("be_storage_err",api+" "+key,{err,rate_limit:{count:1}})};E.get_install_ms=()=>{let ts=E.install_ts();return ts?Date.now()-ts:0};E.get_ua_update_ms=()=>{let ts=storage.get_int("ua_update_ts");return ts?Date.now()-ts:0};const get_bg_module=name=>{if(!is_bg)return null;let bg_main=E.rmt||self.be_bg_main;return name=="be_bg_main"?bg_main:bg_main&&bg_main[name]};E.get_manifest=()=>{if(chrome.runtime&&chrome.runtime.getManifest)return chrome.runtime.getManifest()};const is_enabled_for_url=url=>{let be_vpn=get_bg_module("be_vpn");if(!url.match("^https?://.*"))url=`https://${url}/`;return be_vpn&&be_vpn.get_enabled_rule({url})};E.build_info=opt=>{let ext=get_bg_module("be_ext");let mode=get_bg_module("be_mode");let tabs=get_bg_module("be_tabs");let be_trial=get_bg_module("be_trial");let be_ab_test=get_bg_module("be_ab_test");let be_rule=get_bg_module("be_rule");let be_vpn=get_bg_module("be_vpn");let info={version:zconf.ZON_VERSION,local_ts:new Date,src_country:storage.get("src_country")};let manifest=E.get_manifest();if(manifest){info.manifest_version=manifest.version;info.manifest_ver=manifest.manifest_version}info.conf_stamp=E.CG("stamp");if(mode){if_set(mode.get("svc.version"),info,"svc_version");if_set(mode.get("svc.appid"),info,"svc_appid");if_set(mode.get("pending"),info,"svc_mode_pending");if_set(mode.get("svc.campaign"),info,"campaign");if_set(mode.get("svc.uuid"),info,"svc_uuid")}if(ext){if_set(ext.get("ext.active"),info,"ext.active");let suspended=ext.get("ext.suspended");if_set(suspended?suspended.permanent?"permanent":"temporary":"",info,"ext.suspended");if_set(ext.get("ext.conflict"),info,"ext_conflict");if_set(ext.get("no_permission"),info,"no_permission");if_set(ext.get("is_premium")&&1,info,"is_premium");if_set(ext.get("user_id"),info,"hola_uid_id");let hola_uid=ext.get("hola_uid");if(hola_uid)info.hola_uid_provider=hola_uid.split("/")[0];if_set(ext.get("session_key"),info,"session_key");if_set(ext.get("pap_a_aid"),info,"aff_id");let bext_config=ext.get("bext_config");if_set(zutil.get(bext_config,"version"),info,"conf_ver");if(be_trial){const total_watch_time=be_trial.get_param_from_state("total_watch_time");if(total_watch_time)info.trial_watch_time=date.dur_to_str(total_watch_time);if_set(be_trial.get_watch_time_ms()||undefined,info,"trial_watch_time_ms")}if(be_ab_test)if_set(be_ab_test.get_ab_test_str(),info,"ab_test");let f;if(f=ext.get("features"))assign(info,f)}let active_url;if(tabs){active_url=tabs.get("active.url");info.active_tab=tabs.get("active.id");if(tabs.get("active.incognito"))info.active_incognito=true}if(active_url&&be_rule){let rule=be_vpn.get_enabled_rule({url:active_url,tab_id:info.active_tab});if(rule){let root_url;let parsed=new URL(active_url);if(parsed.protocol=="chrome:"){root_url=parsed.protocol.replace(":","")+"."+parsed.hostname}else root_url=svc_util.get_root_url(active_url);if_set(root_url,info,"root_url");info.proxy_country=rule.country}else if_set(storage.get("last_root_url"),info,"last_root_url")}let enabled_for_browser=be_vpn&&be_vpn.is_enabled_for_browser();info.unblocking_mode=E.full_browser_mode()||enabled_for_browser?"browser":"tab";if_set(opt&&opt.is_tpopup,info,"is_tpopup");if(chrome)info.product_type=conf.type;info.id=zutil.get(chrome,"runtime.id");var browser=E.browser();var browser_ver=browser=="opera"?E.browser_guess.opera_version:E.browser_guess.version;info.browser=browser+" "+browser_ver;info.browser_build=conf.browser.name;info.platform=navigator.platform;info.user_agent=navigator.userAgent;if(self.hola){var now=Date.now();var install_ms;if(install_ms=E.get_install_ms()){info.install_ms=install_ms;info.install_time=date.ms_to_dur_interval(install_ms)}var update,diff;if((update=ext&&ext.get("update_ts"))&&(diff=now-update)<=date.ms.MIN){info.after_update=true;info.update_ms=diff}}info.last_install_ts=ext&&ext.get("last_install_ts");info.since_init_ms=Date.now()-init_ts;if(E.is_v3)info.since_state_init_ms=Date.now()-state.get("init_ts");return info};E.build=(opt,add_build)=>{const info=Object.assign(E.build_info(opt),add_build||{});let s="";for(let f in info)s+=(s&&"\n")+f+": "+info[f];return s};E.perr_id=(id,new_name)=>{if(new_name)return"vpn."+E.browser()+"."+id;if(!id.match(/^be_/))id="be_"+id;return id};function perr_send(id,info,opt){opt=zutil.clone(opt||{});var qs=opt.qs||{},data=opt.data||{};data.is_json=1;if(info&&typeof info!="string")info=zerr.json(info);var err=opt.err;if(err){if(!info)info=""+(err.message||zerr.json(err));else if(!opt.bt)opt.bt=""+(err.message||zerr.json(err));if(err.hola_info){opt.bt="status "+err.hola_info.status+" "+err.hola_info.method+" "+err.hola_info.url+" text "+(""+err.hola_info.response_text).substr(0,256)+"\n"+(opt.bt||"")}}data.info=info;qs.id=id;opt={url:conf.url_perr+"/perr",qs,data,method:"POST",json:1};return ajax_cb?ajax_cb(opt):ajax(opt)}function perr_install(perr_orig,pending){while(pending.length)perr_send.apply(null,pending.shift());return function(id,info,opt){perr_orig.apply(null,arguments);return perr_send(id,info,opt)}}function laptop_test(){_is_laptop=storage.get("is_laptop");if(!_is_laptop&&!E.is_mobile()&&navigator&&navigator.getBattery){navigator.getBattery().then((function(b){_is_laptop=!b.charging||b.chargingTime!=0;storage.set("is_laptop",_is_laptop)}))}}let reinited=false;E.is_bg_reinited=()=>reinited;E.init=()=>etask((function*(){init_ts=Date.now();if(E.is_v3){state=new State("util_state",{perr_rate_limit:{},perr_dropped:{},init_ts:null},{ttl:24*date.ms.HOUR,persistent:false});yield state.load();if(state.get("init_ts"))reinited=true;else yield state.set("init_ts",init_ts)}laptop_test();zerr.perr_install(perr_install)}));E.get_product=()=>conf.type;E.get_connection_type=()=>{const connection=navigator&&(navigator.connection||navigator.mozConnection||navigator.webkitConnection);return connection&&connection.type};E.get_device_type=()=>E.is_mobile()?"mobile":_is_laptop?"laptop":"desktop";const get_ext_opt=()=>({ext_ver:E.version(),install_ver:E.install_version()||E.version(),install_ts:E.install_ts(),src_country:storage.get("src_country"),browser:E.browser(),now:E.now()});E.get_site_key=root_url=>svc_util.get_site_key(E.get_bext_config(),get_ext_opt(),root_url);E.is_same_site=(root_url1,root_url2)=>{if(root_url1==root_url2)return true;let key1=E.get_site_key(root_url1),key2=E.get_site_key(root_url2);return!!(key1&&key2&&key1==key2)};E.get_site_conf=(root_url,path,def)=>svc_util.get_site_conf(E.get_bext_config(),get_ext_opt(),root_url,path,def);const get_tests_by_conf=(conf,path)=>{let conf2test=conf&&conf._conf2ab_test_;if(!conf2test||!path)return[];let key=path.split(".")[0];return conf2test[key]};E.get_trial_conf=(trial,path,def)=>{trial=trial||{};let tests=get_tests_by_conf(trial.conf,path)||[];for(let test of tests){if(ab_test_report)ab_test_report(test,path)}return path?zutil.get(trial.conf,path,def):trial.conf||def};let ab_test_report;E.set_ab_test_report_cb=cb=>ab_test_report=cb;E.get_suggestion_conf=(site_conf,src_country)=>{if(!site_conf)return;src_country=(src_country||"").toUpperCase();let suggestion_popup=site_conf.suggestion_popup||{};return suggestion_popup[src_country]===undefined?suggestion_popup["*"]:suggestion_popup[src_country]};E.convert_url2regex=(conf,name)=>{const rules=conf&&conf[name];if(!rules)return;conf[name]=rules.map((rule=>assign({},rule,{url:typeof rule.url=="string"?new RegExp(rule.url.replace(/\./g,"\\.").replace(/\*\*/,"*").replace(/^\*/,"").replace(/\*/g,".*")):rule.url})))};E.find_conf_rule_by_url=(conf,name,url)=>{const rules=conf&&conf[name];if(rules)return rules.find((r=>r.url&&r.url.test&&r.url.test(url)))};E.get_site_verify_conf=(root_url,url,country)=>{let verify;if(!(verify=E.get_site_conf(root_url,"verify")))return;let sv,site,name=verify[country]===undefined?"*":country;if(!(site=E.find_conf_rule_by_url(verify,name,url))&&(!(sv=verify[name])||!sv.find((v=>!v.url)))){return}let key=E.get_site_key(root_url),idx=key.indexOf("_");return assign({id:key.slice(0,idx!=-1?idx:undefined)},site)};E.get_dont_show_def_period=()=>E.CG("popup.dont_show_def_period","7d");E.reload_ext=(cb,period)=>{var info;period=period||date.ms.MIN;if(!(info=storage.get_json("reload_ext")))info={ts:Date.now(),count:0};var diff=Date.now()-info.ts;if(diff>period||diff<0){info.ts=Date.now();info.count=1}else if(info.count<2)info.count++;else return zerr("too many reload_ext "+info.count);storage.set_json("reload_ext",info);cb();return true};E.reload_ext_native=function(args){E.perr("be_runtime_reload_ext");storage.set("reload_ext_ts",Date.now());if(chrome.runtime.reload)return chrome.runtime.reload();var bg=chrome.extension.getBackgroundPage();bg.location.reload();if(self!=bg)self.close()};E.check_permission=name=>{if(!chrome||!chrome.permissions)return;return etask({name:"check_permission",cancel:true},(function*check_permission(){try{let info={origins:E.is_v3?["*://*/*"]:["<all_urls>"]};if(name)info.permissions=[name];chrome.permissions.contains(info,(res=>this.continue(res)));return yield this.wait()}catch(e){E.perr("check_permission_failed",{},{err:e})}}))};E.grant_permission=function(name){if(!chrome||!chrome.permissions)return;return etask({name:"grant_permission",cancel:true},(function*grant_permission(){try{chrome.permissions.request({permissions:[name],origins:E.is_v3?["*://*/*"]:["<all_urls>"]},(res=>this.continue(res)));return yield this.wait()}catch(e){E.perr("grant_permission_failed",{},{err:e})}}))};E.set_ajax_cb=cb=>{ajax_cb=cb};E.set_bext_config_cb=cb=>{bext_config_cb=cb};E.format_log=log=>{const skips=[/backbone\.\w+\./,/ajax.*(perr| url )/,/perr.*rate too high/,/connection.*tpopup(_int)?:[0-9]+/,/be_tab_unblocker.*chrome-extension/,/stop .*cws/,/: (tab:[\d-]+ )?[a-z.]*popup /,/fetch_rules/,/be_req_bw/,/update url .* is_vpn false/,/checking if site has high unblocking/,/impl\.init/,/be_(bw_)?req_err/,/not_working_trigger/,/be\.ccgi\.send/,/be_vpn_total_active_time/,/be_media_failure/];const formats=[{from:/(perr [\w.]+) .*$/,to:"$1"}];const format=line=>{let ret=line;formats.forEach((f=>{ret=ret.replace(f.from,f.to)}));return ret};const map=line=>{if(!/]$/.test(line))return format(line);let cnt=0,str;let args_len=line.split("").reverse().findIndex((c=>{if(c=='"')return void(str=!str);return!str&&(cnt+=c=="]"?1:c=="["?-1:0)==0}));if(args_len==-1)return format(line);args_len++;const fmt=line.slice(0,-args_len);try{const args=JSON.parse(line.slice(-args_len));line=sprintf.apply(null,[fmt].concat(args))}catch(e){line+=" (truncated)"}return format(line)};return(log||[]).map(map).filter((line=>!skips.find((s=>s.test(line)))))};function throttle_log(log,agg){const throttle=[{test:/tab_unblocker slow/,per:date.ms.MIN},{test:/media failure detected/,per:date.ms.SEC},{test:/popup not allowed/},{test:/tab already attached/},{test:/perr be_wrong_agent/}];return log.map((l=>{let t=throttle.find((_t=>_t.test.test(l)));if(!t)return l;let m,prefix=(m=l.match(/^\[[\w[\]]+\] /))&&m[0]||"";let _l=l.replace(prefix,"");let date_str=_l.substr(0,23),d=new Date(date_str);if(!t.last){t.last=d;t.count=0;return l}let count=++t.count;if(!t.per||agg&&d-t.last<t.per)return;t.last=d;t.count=0;return agg&&count>1?prefix+date_str+" x"+count+_l.substr(23):l})).filter((l=>l))}E.get_zerr_log=()=>zerr.log?E.format_log(zerr.log).slice(-zerr.log.max_size):[];E.get_log=(ui_log=[])=>{let idx=0;const be_ext=get_bg_module("be_ext");const is_premium=be_ext&&be_ext.get("is_premium");const map=f=>l=>({from:f,line:l,idx:idx++});const log=E.get_zerr_log().map(map(is_bg?"bg":"ui")).concat(ui_log.map(map("ui"))).sort(((a,b)=>a.from==b.from?a.idx-b.idx:a.line.localeCompare(b.line))).map((c=>"["+(is_premium?"P":"F")+"]["+c.from+"] "+c.line));return throttle_log(log,true)};E.perr_opt=(id,info,opt)=>{const bg_main=get_bg_module("be_bg_main");let{err,bt,filehead}=opt,ver=E.version();bt=bt||err&&zerr.e2s(err);if(err&&err.hola_info){bt="status "+err.hola_info.status+" "+err.hola_info.method+" "+err.hola_info.url+" text "+(""+err.hola_info.response_text).substr(0,256)+"\n"+bt}if(err&&err.etask)opt.err=_.omit(err,"etask");let qs={id,ext_ver:ver,product:E.get_product(),browser:E.browser()};if(opt.with_log)filehead=(filehead||"")+"\n"+E.get_log(opt.ui_log);if(info&&typeof info=="object"){info=assign({},info);const url_keys=["root_url","root_url_prev","tab_url","page_url","top_url"];for(let key of url_keys){if(info[key]&&typeof info[key]=="string"&&!is_enabled_for_url(info[key])){delete info[key]}}}opt.data={bt,info,filehead,ver,build:E.build({is_tpopup:opt.is_tpopup},opt.build)};qs.uuid=bg_main&&bg_main.get("uuid")||storage.get("uuid");opt.qs=qs;let err_re=/err|slow|problem|fail|bad|mismatch|invalid|wrong|missing/;opt.level=opt.level||(err||bt||id.match(err_re)?zerr.L.ERR:zerr.L.NOTICE);return{id,info,opt}};let perr_cb;E.set_perr_cb=cb=>perr_cb=cb;E.trigger_user_message=id=>{const ext=get_bg_module("be_ext");if(!ext)return;const valid_user_message=ext.get("valid_user_message")||[];let valid_till=-1;const is_msg_triggered=valid_user_message.find((vm=>{const trigger=vm.trigger;if(!trigger)return false;const events=vm.trigger.events;if(!events)return false;const found=events.indexOf(id)>-1;if(found)valid_till=trigger.expires?Date.now()+trigger.expires:-1;return found}));if(!is_msg_triggered)return;const um=storage.get_json("user_message_show")||[];const um_shown=storage.get_json("user_message_shown")||[];if(um_shown.indexOf(is_msg_triggered.id)>=0)return;const m_exist=um.find((one=>one.id==is_msg_triggered.id));if(m_exist){m_exist.ts=Date.now();m_exist.valid_till=valid_till}else{um.push(Object.assign({},is_msg_triggered,{ts:Date.now(),valid_till}))}const n_um=um.slice();storage.set_json("user_message_show",n_um);ext.set("user_message_show",n_um)};E.perr=(id,info,opt,new_name)=>be_no_log.enabled(id)?null:etask((function*(){info=info||{};opt=opt||{};id=E.perr_id(id,new_name);let conf_rate_limit=E.CG(`perr_rate_limit.${id}`);if(conf_rate_limit){opt.rate_limit=opt.rate_limit||{};opt.rate_limit.count=conf_rate_limit}if(E.is_v3&&state){let _rate_limit=opt.rate_limit||{};opt.rate_limit=false;let ms=_rate_limit.ms||date.ms.HOUR,count=_rate_limit.count||10;let{disable_drop_count}=_rate_limit;let rl=state.get(`perr_rate_limit.${id}`)||{};let dropped=state.get(`perr_dropped.${id}`)||0;let drop=!rate_limit(rl,ms,count);yield state.set(`perr_rate_limit.${id}`,rl);if(drop){yield state.set(`perr_dropped.${id}`,dropped+1);zerr("perr %s %s rate too high %s %d %d",id,zerr.json(info),zerr.json(rl),ms,count);return}if(dropped){yield state.set(`perr_dropped.${id}`,0);if(!disable_drop_count&&info&&typeof info!="string")info.w=dropped}}const bg_main=get_bg_module("be_bg_main");if(conf.check_agree_ts&&!(bg_main&&bg_main.get("agree_ts")))return void zerr("no agree_ts, skip perr %s",id);let browser_test=storage.get_json("test_from_browser_ab");if(!browser_test)browser_test={};if(!opt.build)opt.build={};const www_tests=yield be_vpn_util.get_www_tests();opt.build=Object.assign({},opt.build,www_tests,browser_test);let perr_opt=E.perr_opt(id,info,opt);if(zutil.is_mocha())return;let res=yield zerr.perr(id,perr_opt.info,perr_opt.opt);if(perr_cb)perr_cb(res);E.trigger_user_message(id);return res}));E.get_bext_config=()=>bext_config_cb?bext_config_cb():storage.get_json("bext_config_last");E.CG=(path,def)=>zutil.get(E.get_bext_config(),path,def);E.check_min_ver=min_ver=>svc_util.check_min_ver(E.version(),min_ver);E.check_min_install_ver=min_ver=>svc_util.check_min_install_ver(E.install_version()||E.version(),min_ver);E.check_min_install_ts=ts=>svc_util.check_min_install_ts(E.install_ts(),ts);E.check_min_tfi=tfi=>!tfi||Date.now()-E.install_ts()>tfi;E.is_conf_allowed=(on,id)=>{let random;if(!on)return false;id=id||"ext_rand_id";if(!(random=+storage.get(id)))storage.set(id,random=Math.random());return random<on};E.proxy_error_ui_enabled=type=>{const c=E.CG("proxy_error_ui")||{};return!!(E.check_min_ver(c.min_ver)&&c[type])};E.set_hola_org_cookie=(name,value)=>chrome.cookies.set({url:`https://${www_host}`,domain:`.${www_host}`,name,value});E.del_hola_org_cookie=name=>{try{chrome.cookies.remove({url:`https://${www_host}`,name})}catch(e){console.error(`falied to rm ${www_host} cookes %s`,e)}};let now_cb;E.set_now_cb=cb=>now_cb=cb;E.now=()=>now_cb?now_cb():Date.now();E.get_dpi=()=>{try{let div=document.createElement("div");div.style.width="1in";document.body.appendChild(div);let ppi=document.defaultView.getComputedStyle(div,null).getPropertyValue("width");document.body.removeChild(div);return parseFloat(ppi)||96}catch(e){console.error("failed to get dpi %s",e);return 96}};E.set_full_browser_mode=value=>storage.set("full_browser_mode",value);E.full_browser_mode=()=>storage.get_json("full_browser_mode");E.init();return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},7676:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _util_etask_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_0__);var _util_date_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_1__);var _util_util_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_2__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4__);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_5__);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6__);var _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(8552);var _bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(1002);var _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(6210);var _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(8076);var _bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(9265);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(843);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_12__);
// LICENSE_CODE ZON
const{CG}=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default();const chrome=self.chrome;_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().assert_bg("be_ab_test");const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_5___default().task_model.extend({model_name:"ab_test",_defaults:function(){this.on("destroy",(()=>E.uninit()))}}));let ab_states;E.get_ab_tests=states=>{const res=[];for(let[test_name,state]of Object.entries(states||ab_states||{}))res.push(`${test_name}_${state.value}`);return res};E.get_ab_states=()=>{const res={};for(let[test_name,state]of Object.entries(ab_states||{}))res[test_name]=state.value;return res};E.get_ab_test_str=()=>E.get_ab_tests().join(",");const get_filter_data=()=>{let _rules=_util_util_js__WEBPACK_IMPORTED_MODULE_2___default().is_mocha()?_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z["default"].get("rules"):_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get("rules");let rules=Object.values(_rules&&_rules.unblocker_rules||{});let enabled_rules=rules.filter((r=>r.enabled)).map((r=>r.name));let all_rules=rules.map((r=>r.name));return{now:_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_7__["default"].now(),ext_ver:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().version(),uuid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("uuid"),uuid_md5:_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_7__["default"].get_uuid_md5(),browser:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().browser(),svc_detected:+_bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_8__.Z.get("svc.detected")||0,hola_svc_detected:+_bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_8__.Z.get("svc.hola_svc_detected")||0,os:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().os_guess.os,install_ver:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().install_version()||_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().version(),install_ts:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().install_ts(),last_install_ts:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().last_install_ts(),signed_in:!!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("user_id"),is_premium:!!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("is_premium"),src_country:(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_9__["default"].get("country")||"").toUpperCase(),enabled_rules,all_rules}};const get_www_test=(test_conf,www_tests)=>{if(!test_conf.www_tests)return null;www_tests=www_tests||{};for(let t of test_conf.www_tests){if(t in www_tests)return{name:t,value:www_tests[t]?"on":"off"}}return null};const is_test_available=(test_name,test_conf,www_tests)=>{if(!test_conf||test_conf.filter&&!_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().match_filter(get_filter_data(),test_conf.filter)){return false}return CG(`debug.ab_test.${test_name}.enable`)||_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().check_min_ver(test_conf.min_ver)&&_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().check_min_install_ts(test_conf.min_install_ts)&&_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().check_min_install_ver(test_conf.min_install_ver)&&_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().check_min_tfi(test_conf.min_tfi)&&(!test_conf.www_tests||!!get_www_test(test_conf,www_tests))};const assign_test_group=(test_name,test_conf,www_tests)=>{let debug_enabled=CG(`debug.ab_test.${test_name}.enable`);let debug_rand=+CG(`debug.ab_test.${test_name}.rand`)||0;let www_test=!debug_rand&&get_www_test(test_conf,www_tests);if(www_test){return{ver:test_conf.ver,www_test_name:www_test.name,value:www_test.value}}const rand=debug_enabled?debug_rand:Math.random();const value=((test_conf.value||[]).find((v=>v[0]<=rand&&rand<v[1]))||[])[2];return{rand,ver:test_conf.ver,value}};let update_et;const update=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_0___default()((function*(){this.finally((()=>update_et=null));if(update_et)yield this.wait_ext(update_et);update_et=this;if(!_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_11__["default"].get("updated")||chrome.extension.inIncognitoContext&&!CG("stamp")){return}let www_tests=yield _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().get_www_tests();let ab_conf=CG("ab_tests")||{};ab_states=ab_states||{};let prev_states=_util_util_js__WEBPACK_IMPORTED_MODULE_2___default().clone_deep(ab_states);for(let test_name of Object.keys(ab_states)){if(is_test_available(test_name,ab_conf[test_name],www_tests))continue;delete ab_states[test_name];_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_ab_test_clear",{test_name})}for(let[test_name,test_conf]of Object.entries(ab_conf)){if(!is_test_available(test_name,ab_conf[test_name],www_tests))continue;let curr=ab_states[test_name];if(!CG(`debug.ab_test.${test_name}.enable`)&&curr&&(curr.ver||0)>=test_conf.ver){continue}ab_states[test_name]=assign_test_group(test_name,test_conf,www_tests);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_ab_test_selected",{test_name,state:ab_states[test_name]})}for(let test_name of Object.keys(ab_states)){let conf=ab_conf[test_name];if(!conf.ext_tests)continue;let curr_ab_tests=new Set(E.get_ab_tests(ab_states));if(conf.ext_tests.every((t=>curr_ab_tests.has(t))))continue;delete ab_states[test_name]}yield _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_7__["default"].storage_local_set({ab_states});if(!_util_util_js__WEBPACK_IMPORTED_MODULE_2___default().equal_deep(prev_states,ab_states))_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().trigger("ab_test_change");update_ref()}));const update_ref=()=>{let ab_conf=CG("ab_tests")||{};let ref="";for(let[test_name,state]of Object.entries(ab_states)){if(ab_conf[test_name]&&ab_conf[test_name].ref_prefix)ref+=test_name+"_"+state.value+"_"}E.set("ref_prefix",ref)};E.load_state=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_0___default()((function*(){let ret=yield _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_7__["default"].storage_local_get("ab_states");ab_states=ret&&ret.ab_states||{};_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().trigger("ab_test_change");update_ref()}));const sent_perrs={};E.report=(filter_str,conf_key)=>{for(let[test_name,state]of Object.entries(ab_states)){if(!filter_str.startsWith(test_name))continue;let id=`be_ab_test_report_${test_name}_${state.value}`;if(sent_perrs[id])continue;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr(id,{conf_key},{rate_limit:{count:1,ms:_util_date_js__WEBPACK_IMPORTED_MODULE_1___default().ms.DAY}});sent_perrs[id]=true}};E.init=()=>{if(_util_util_js__WEBPACK_IMPORTED_MODULE_2___default().is_mocha())return;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().set_ab_test_report_cb(E.report);E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default(),"change:bext_config",update);E.listen_to(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z,"change:rules",update);E.listen_to(_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_11__["default"],"change:user",update);if(!_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_11__["default"].get("updated"))_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_11__["default"].once("change:updated",update)};E.uninit=()=>{if(_util_util_js__WEBPACK_IMPORTED_MODULE_2___default().is_mocha())return;E.stopListening();_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_11__["default"].off("change:updated",update)};E.t={update};const __WEBPACK_DEFAULT_EXPORT__=E},9651:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var underscore__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8763);var underscore__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_0__);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__);var _bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1211);var _bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_2__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_3__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4__);var _util_ajax_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(665);var _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(2227);var _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_6__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_7__);var _util_escape_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(4336);var _util_escape_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_util_escape_js__WEBPACK_IMPORTED_MODULE_8__);var _util_url_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(5305);var _util_url_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_util_url_js__WEBPACK_IMPORTED_MODULE_9__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10__);var _util_date_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_11__);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_12__);var _util_util_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_13__);var _util_storage_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(1032);var _util_storage_js__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(_util_storage_js__WEBPACK_IMPORTED_MODULE_14__);var _util_rand_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(4135);var _util_rand_js__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(_util_rand_js__WEBPACK_IMPORTED_MODULE_15__);var _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(8552);var conf__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(9641);var _pub_state_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(7619);var _bext_vpn_bg_bext_config_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(39);var _bext_vpn_bg_bext_config_js__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(_bext_vpn_bg_bext_config_js__WEBPACK_IMPORTED_MODULE_19__);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(843);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_20___default=__webpack_require__.n(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_20__);
// LICENSE_CODE ZON
_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_12___default().assert_bg("be_bg_ajax");let chrome=self.chrome;let is_agent_fallback,stats={};const assign=Object.assign;const{SEC,MIN,HOUR}=_util_date_js__WEBPACK_IMPORTED_MODULE_11___default().ms;let bg_ajax,rand_subset=_util_rand_js__WEBPACK_IMPORTED_MODULE_15___default().rand_subset;const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default().task_model.extend({model_name:"bg_ajax",_defaults:function(){this.on("destroy",(()=>E.uninit()))}}));const{www_host}=conf__WEBPACK_IMPORTED_MODULE_17__;const tests=["ccgi","ccgi_cdn","hola","perr"];const CG=(path,def)=>_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().get(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("bext_config")||_bext_vpn_bg_bext_config_js__WEBPACK_IMPORTED_MODULE_19___default(),path,def);const CGA=(path,def)=>_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().get(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("bext_config")||_bext_vpn_bg_bext_config_js__WEBPACK_IMPORTED_MODULE_19___default(),"bg_ajax."+path,def);let state;_util_ajax_js__WEBPACK_IMPORTED_MODULE_5__["default"].events.on("timeout",(()=>{_util_storage_js__WEBPACK_IMPORTED_MODULE_14___default().set("ajax_timeout",_util_storage_js__WEBPACK_IMPORTED_MODULE_14___default().get_int("ajax_timeout")+1)}));_util_ajax_js__WEBPACK_IMPORTED_MODULE_5__["default"].events.on("server_ts",(server_ts=>_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_16__["default"].update_ts(server_ts)));_util_ajax_js__WEBPACK_IMPORTED_MODULE_5__["default"].events.on("conf_ver",(conf_ver=>_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_16__["default"].check_conf_ver(conf_ver)));const do_ajax=opt=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*do_ajax_(){this.on("cancel",(()=>_util_ajax_js__WEBPACK_IMPORTED_MODULE_5__["default"].abort(et)));let et=(0,_util_ajax_js__WEBPACK_IMPORTED_MODULE_5__["default"])(assign({},opt,{perr:_opt=>_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().perr(_opt.id,_opt.info,_opt)}));return yield et}));const sample_agents=agents=>{const limit=CGA("agents_limit",5);return rand_subset(agents,Math.min(agents.length,limit))};const get_cloud_conf_url=failed_urls=>{let urls=_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().clone_deep(CGA("cloud_agents")||[]);failed_urls=failed_urls||[];for(let failed_url of failed_urls){let i=urls.findIndex((item=>item.url==failed_url));if(i<0)continue;let inc_rand=urls[i].rand/(urls.length-1);urls.splice(i,1);urls.forEach((item=>item.rand+=inc_rand))}urls=urls.sort(((a,b)=>a.rand-b.rand));let random=Math.random();for(let item of urls){if(random<item.rand)return item.url;random-=item.rand}};let load_cloud_conf_et;const load_cloud_conf=()=>{if(load_cloud_conf_et)return load_cloud_conf_et;return _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*load_cloud_conf_(){load_cloud_conf_et=this;this.finally((()=>load_cloud_conf_et=null));let failed_urls=[];while(true){let url=get_cloud_conf_url(failed_urls);if(!url){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().perr("be_cloud_conf_load_err",{err:"all urls failed"});return}try{_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().perr("be_cloud_conf_load",{url},{with_log:true});let res=yield do_ajax({url,text:1,retry:3});if(!res)throw new Error("empty res");res=res.substr(res.length-3)+res.substr(0,res.length-3);if(res.length%4)res+="=".repeat(4-res.length%4);return JSON.parse(atob(res))}catch(e){failed_urls.push(url);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().perr("be_cloud_conf_load_url_err",{url},{err:e})}}}))};const get_cloud_conf=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){let cached=state.get("cloud_conf")||{};let cache_age=cached&&Date.now()-cached.cache_ts;if(cache_age&&cache_age<CGA("cloud_conf_cache_ttl",2*HOUR))return cached;let res=yield load_cloud_conf();if(!res)return cached;res.cache_ts=Date.now();yield state.set("cloud_conf",res);update_hola_domains();return res}));let cloud_agents=[];const get_cloud_agents=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){let cloud_conf=yield get_cloud_conf();let agents=(_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().get(cloud_conf,"agents")||[]).map((a=>({ip:a.ip,port:a.port,name:a.name,host:a.host||a.name&&a.name+".hola.org"||undefined})));cloud_agents=sample_agents(agents);return cloud_agents}));const on_lib_event=o=>{if(o.id!="verify_done")return;let ts=Date.now();if(!stats.ts||ts-stats.ts>15*MIN)stats={ts,verify_host:{s:0,f:0},verify_ip:{s:0,f:0}};let name=o.data.url.startsWith("http:")?"verify_ip":"verify_host";stats[name][o.data.err&&o.data.err!="agent_err"?"f":"s"]++;is_agent_fallback=stats.verify_ip.s>0&&!stats.verify_host.s&&stats.verify_host.f};function BgAjax(){}BgAjax.prototype.init=function(){const copy=opt=>{opt.mem_agents=(opt.mem_agents||[]).map((a=>({port:22224,ip:a.ip,host:a.host})));opt.build_agents=(opt.build_agents||[]).map((a=>({ip:a.ip,port:a.port,host:a.host||a.name&&a.name+".hola.org"||undefined})));return assign({},opt)};const set_url=(opt,pref,uri)=>{opt.hola=pref+www_host+uri;opt.hola_mirrors=()=>E.hola_mirrors.map((m=>pref+m+uri));return opt};const perr=opt=>{if(!CGA("disable_perr_all")&&!CGA("disable_perr",{})[opt.id])_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().perr(opt.id,opt.info,opt)};const def={ignore:[],api:{perr,ajax_via_proxy:E.ajax_via_proxy,CG,apply_agent_fallback_rule:E.apply_agent_fallback_rule,get_agent_fallback_rules:()=>E.agent_domain_fallback_rules},dbg_logs:CGA("dbg_logs")};const agents_opt={mem_agents:E.be_tab_unblocker.get_all_agents(),build_agents:sample_agents(conf__WEBPACK_IMPORTED_MODULE_17__.agents),cloud_agents:get_cloud_agents};const agents=Object.keys(agents_opt);const direct=["hola"];direct.concat(agents).forEach((name=>{if(CGA("disable_"+name))def.ignore.push(name)}));if(CGA("disable_agents"))def.ignore=def.ignore.concat(agents).concat("common_agents");const client_uri=CGA("client_uri","/client_cgi/conn_test");const client_cdn_uri=CGA("client_cdn_uri","/client_cgi/conn_test");const ccgi_opt=set_url({def_url:conf__WEBPACK_IMPORTED_MODULE_17__.url_ccgi},"client.",client_uri);let opt=assign({},ccgi_opt,def,agents_opt,{name:"agents_check",selected:state.get("selected_agents"),ignore:["common_agents"],ignore_direct:true});this.agents_check=new(_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_6___default().ConnectivityCheck)(copy(opt));def.common_agents=this.agents_check;opt=assign({selected:state.get("selected_ccgi"),name:"ccgi_check"},ccgi_opt,agents_opt,def);this.ccgi_check=new(_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_6___default().ConnectivityCheck)(copy(opt));opt=assign({selected:state.get("selected_ccgi_cdn"),name:"ccgi_cdn_check"},set_url({def_url:conf__WEBPACK_IMPORTED_MODULE_17__.url_ccgi_cdn},"client-cdn4.",client_cdn_uri),agents_opt,def);this.ccgi_cdn_check=new(_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_6___default().ConnectivityCheck)(copy(opt));const www_uri=CGA("www_uri","/conn_test");opt=assign({selected:state.get("selected_hola"),name:"hola_check"},set_url({def_url:`https://${www_host}/`},"",www_uri),agents_opt,def);this.hola_check=new(_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_6___default().ConnectivityCheck)(copy(opt));const perr_uri=CGA("perr_uri","/client_cgi/perr/conn_test");opt=assign({selected:state.get("selected_perr"),name:"perr_check"},set_url({def_url:conf__WEBPACK_IMPORTED_MODULE_17__.url_perr},"perr.",perr_uri),agents_opt,def);this.perr_check=new(_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_6___default().ConnectivityCheck)(copy(opt));this.update_selected("hola",this.hola_check);this.update_selected("ccgi",this.ccgi_check);this.update_selected("ccgi_cdn",this.ccgi_cdn_check);this.update_selected("perr",this.perr_check);this.inited=true;_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_6___default().on("lib_event",on_lib_event);this.check_agent_domain_fallback()};BgAjax.prototype.uninit=function(){let _this=this;this.inited=false;tests.forEach((function(name){name+="_check";if(_this[name])_this[name]=_this[name].uninit()}));if(this.agents_check)this.agents_check=this.agents_check.uninit();if(load_cloud_conf_et)load_cloud_conf_et.return();if(this.cookies_et)this.cookies_et.return();_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_6___default().off("lib_event",on_lib_event);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().set("bg_ajax.is_active",false)};const get_query_params=qs=>{if(!qs)return;let res={};qs=typeof qs=="object"?qs:_util_url_js__WEBPACK_IMPORTED_MODULE_9___default().qs_parse(qs);for(let p in qs){if(qs[p]===undefined)continue;res[p]=qs[p]}return res};BgAjax.prototype._ajax=function(conn_info,req){let url=E.get_selected_url({info:conn_info,url:req.url});if(req.qs)url=_util_url_js__WEBPACK_IMPORTED_MODULE_9___default().qs_add(url,get_query_params(req.qs));if(!conn_info.agent||req.no_proxy){req=underscore__WEBPACK_IMPORTED_MODULE_0___default().omit(req,"url","qs");req.url=url;return do_ajax(req)}let opt=assign({always:true,ignore_redir:true,hdrs:assign({"Cache-Control":"no-cache,no-store,must-revalidate,"+"max-age=-1"},req.headers),force_headers:true,fix_307:true,src:"bg_ajax",agent:conn_info.agent,force:"proxy",prot:"proxy"},underscore__WEBPACK_IMPORTED_MODULE_0___default().pick(req,"data","with_credentials"));let method=req.method||"GET";if(opt.data){if(method=="GET"){url=_util_url_js__WEBPACK_IMPORTED_MODULE_9___default().qs_add(url,get_query_params(opt.data));delete opt.data}else{if(typeof opt.data=="object")opt.data=_util_escape_js__WEBPACK_IMPORTED_MODULE_8___default().qs(opt.data);opt.hdrs["Content-Type"]="application/x-www-form-urlencoded; "+"charset=UTF-8"}}let t=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_12___default().set_timeout((()=>et.throw(new Error(conn_info.agent.ip+" timeout"))),req.timeout||20*SEC);let et=_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()({cancel:true},(function*ajax_via_proxy_(){this.finally((()=>_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_12___default().clear_timeout(t)));let res=yield E.ajax_via_proxy({url,type:method},opt);res=res||{};let err;if(err=res.orig_res&&(res.orig_res.error||res.orig_res.statusCode>=400&&"bad status code")){if(opt.no_throw)return{err,status:res.status||0};throw new Error(conn_info.agent.ip+" "+err)}let status=_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().get(res.orig_res,"statusCode");let etag=_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().get(res.orig_res,"headers.etag");try{res=res.data&&req.json?JSON.parse(res.data):res.data}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_7___default()(_util_zerr_js__WEBPACK_IMPORTED_MODULE_7___default().e2s(e))}if(req.full_response)return{data:res,status,etag};return res}));return et};BgAjax.prototype.update_cookies=function(){let _this=this;return _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()({name:"update_cookies",cancel:true},(function*(){if(_this.cookies_et)return yield this.wait_ext(_this.cookies_et);_this.cookies_et=_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*cookies_et_(){try{let domains=[www_host,...E.hola_domains.filter((d=>d!=www_host))];let map={},ets={};for(let d of domains){map[d]={name:"connect.sid",url:`https://${d}/`};ets[d]=_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().cb_apply(chrome.cookies,".get",[map[d]])}const res=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().all({allow_fail:true},ets);const values=Object.values(res);if(values.every((v=>!v))||values[0]&&values.every((v=>v&&v.value==values[0].value))){return this.return()}let exp=[];for(let d of domains){if(res[d]&&res[d].expirationDate)exp.push({name:d,date:res[d].expirationDate})}exp=exp.sort(((a,b)=>b.date-a.date))[0];for(let d of domains){if(res[d]&&res[d].expirationDate==exp.date)continue;yield _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().cb_apply(chrome.cookies,".remove",[map[d]]);yield _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().cb_apply(chrome.cookies,".set",[assign(_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().pick(res[exp.name],"expirationDate","sameSite","value","httpOnly","secure"),map[d])])}}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_7___default()(_util_zerr_js__WEBPACK_IMPORTED_MODULE_7___default().e2s(e))}finally{delete _this.cookies_et}}));return yield _this.cookies_et}))};BgAjax.prototype.check_agent_domain_fallback=function(force){if(!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().check_min_ver(CGA("enable_agent_domain_fallback_min_ver"))||!this.agents_check){return}let _this=this;return _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*check_agents_connectivity_(){this.finally((()=>{_this.agents_check_et=undefined}));if(_this.agents_check_et)return yield this.wait_ext(_this.agents_check_et);_this.agents_check_et=this;let selected=_this.agents_check.selected;if(selected&&force){_this.reset("agents");selected=_this.agents_check.selected}if(!selected){yield _this.agents_check.run({force});if(!_this.agents_check||!_this.agents_check.selected)return;selected=_this.agents_check.selected;state.set("selected_agents",selected)}let curr_rule=state.get("agent_fallback_rule");let new_rule=selected&&selected.agent&&selected.agent.fallback_rule;if(curr_rule==new_rule)return;state.set("agent_fallback_rule",new_rule);if(new_rule){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().perr("be_agent_domain_fallback",{agent:_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().pick(selected.agent,"ip","port","host","fallback_rule"),force})}else{_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().perr("be_agent_domain_fallback_reset",{fallback_rule:curr_rule,force},{with_log:true})}}))};BgAjax.prototype.need_agent_domain_fallback=function(){return!!state.get("agent_fallback_rule")};BgAjax.prototype.get_agent_fallback_host=function(host){if(!state.get("agent_fallback_rule"))return host;return E.apply_agent_fallback_rule(host,state.get("agent_fallback_rule"))};BgAjax.prototype.update_selected=function(name,e){let link;if(e.selected&&(link=e.get_backend_link())&&!link.agent){E.set(name+"_selected",e.selected.name);let hostname=e.selected.success_url&&_util_url_js__WEBPACK_IMPORTED_MODULE_9___default().parse(e.selected.success_url).hostname;E.set(name+"_conn_hostname",hostname)}};BgAjax.prototype.make_ajax=function(name,e,req){if(e.selected)return this._ajax(e.get_backend_link(),req);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().set("bg_ajax.is_active",true);let _this=this;return _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*make_ajax_(){if(e.run_et)yield this.wait_ext(e.run_et);else{this.finally((()=>e.run_et=undefined));e.run_et=e["run"+(CGA("parallel",true)?"_parallel":"")]();yield e.run_et;state.set("selected_"+name,e.selected);_this.update_selected(name,e)}return yield _this._ajax(e.get_backend_link(),req)}))};BgAjax.prototype.ccgi_ajax=function(req){return this.make_ajax("ccgi",this.ccgi_check,req)};BgAjax.prototype.ccgi_cdn_ajax=function(req){return this.make_ajax("ccgi_cdn",this.ccgi_cdn_check,req)};BgAjax.prototype.hola_ajax=function(req){const _this=this,hc=this.hola_check;return _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*hola_ajax_(){yield _this.update_cookies();return yield _this.make_ajax("hola",hc,req)}))};BgAjax.prototype.perr_ajax=function(req){return this.make_ajax("perr",this.perr_check,req)};BgAjax.prototype.reset=function(type){let c=type+"_check",now=Date.now();if(!this[c]||this[c].et||this[c].error_ts&&now-this[c].error_ts<5*MIN){return}state.set("selected_"+type,null);this[c].reset();this[c].error_ts=now};function _ajax(req,type){req=assign({json:!req.text},req);let use_bg_ajax;return _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*_ajax_(){this.finally((()=>{if(req.force_pac){E.set("need_pac",(E.get("need_pac")||0)-1);E.be_tab_unblocker.update_pac()}}));try{if(req.force_pac){E.set("need_pac",(E.get("need_pac")||0)+1);yield E.be_tab_unblocker.update_pac()}const name=type+"_ajax";if(init_et)yield init_et;use_bg_ajax=bg_ajax&&bg_ajax.inited&&bg_ajax[name];return use_bg_ajax?yield bg_ajax[name](req):yield do_ajax(req)}catch(e){if(bg_ajax&&use_bg_ajax&&!req.no_proxy){if(E.get_agent_fallback(type)){bg_ajax.reset("agents");for(let t of tests){if(t!=type&&E.get_agent_fallback(t))bg_ajax.reset(t)}}bg_ajax.reset(type)}throw e}}))}const get_myip=proxy=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*_get_myip(){let host=proxy.host||(proxy.name?proxy.name+".hola.org":null);if(!host)return;let url=`https://${host}:${proxy.port}/myip`;try{return yield do_ajax({url,retry:3,expect:200,json:true})}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_7___default()("failed to detect location - "+_util_zerr_js__WEBPACK_IMPORTED_MODULE_7___default().e2s(e))}}));E.need_agent_domain_fallback=()=>bg_ajax&&bg_ajax.need_agent_domain_fallback();E.get_agent_fallback_host=host=>bg_ajax&&bg_ajax.get_agent_fallback_host(host);E.apply_agent_fallback_rule=(host,f_rule)=>{let m=host.match(/[a-z]+([0-9]+)/);let agent_n=m&&m[1];if(!f_rule||!agent_n)return host;return f_rule.replace("${n}",agent_n)};E.get_agent_fallback_rule=()=>state&&state.get("agent_fallback_rule");E.is_agent_fallback=()=>{if(is_agent_fallback)return true;for(let t of tests){if(E.get_agent_fallback(t))return true}};const get_selected=name=>{name=name||"ccgi";let e=bg_ajax&&bg_ajax[name+"_check"];return e&&e.selected&&e.get_backend_link()};E.get_agent_fallback=name=>{const e=get_selected(name);return e&&e.agent};E.get_selected_url=opt=>{let url,e=opt.info||get_selected(opt.name);if(url=e&&e.url){let burl=_util_url_js__WEBPACK_IMPORTED_MODULE_9___default().parse(url),rurl=_util_url_js__WEBPACK_IMPORTED_MODULE_9___default().parse(opt.url);url=burl.protocol+"//"+burl.hostname+rurl.path}return url||opt.url};const find_agent=ip=>{let agents=_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_6___default().find_agents({ip});if(agents&&agents.length)return agents[0];if(cloud_agents){let agent=cloud_agents.find((a=>a.ip==ip));if(agent)return agent}if(conf__WEBPACK_IMPORTED_MODULE_17__.agents){let agent=conf__WEBPACK_IMPORTED_MODULE_17__.agents.find((a=>a.ip==ip));if(agent)return agent}};E.get_location=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*get_location(){let info,agent;if((agent=E.get_agent_fallback())&&(agent.host||agent.name)){_util_zerr_js__WEBPACK_IMPORTED_MODULE_7___default().notice("get_location: use agent");return yield get_myip(agent)}try{_util_zerr_js__WEBPACK_IMPORTED_MODULE_7___default().notice("get_location: use ccgi");info=yield E.ccgi_ajax({qs:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().auth(),url:conf__WEBPACK_IMPORTED_MODULE_17__.url_ccgi+"/fetch_info",retry:1,no_proxy:true})}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_7___default()("get_location failed: "+_util_zerr_js__WEBPACK_IMPORTED_MODULE_7___default().e2s(e))}if(info&&info.req&&info.req.ip){agent=find_agent(info.req.ip);if(agent)info=null}if((agent=E.get_agent_fallback()||agent)&&(agent.host||agent.name)){_util_zerr_js__WEBPACK_IMPORTED_MODULE_7___default().notice("get_location: use agent");return yield get_myip(agent)}return(info||{}).req}));E.is_active=()=>_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("bg_ajax.is_active");E.ccgi_ajax=req=>_ajax(req,"ccgi");E.ccgi_cdn_ajax=req=>_ajax(req,"ccgi_cdn");E.hola_ajax=req=>_ajax(req,"hola");E.perr_ajax=req=>_ajax(req,"perr");E.ajax=(req,type)=>{type=type||(_util_url_js__WEBPACK_IMPORTED_MODULE_9___default().parse(req.url).hostname||"").split(".")[0];if(type=="client")type="ccgi";return _ajax(req,type)};E.hola_hostname=()=>{if(CG("disable_hola_hostname_fallback"))return www_host;return E.get("hola_conn_hostname")||www_host};E.hola_url=()=>"https://"+E.hola_hostname();const update_state=()=>{let ext_enabled=!!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("enabled");let bg_ajax_enabled=!!bg_ajax;if(ext_enabled==bg_ajax_enabled)return;if(ext_enabled)init();else uninit()};let init_et;E.init=be_tab_unblocker=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){init_et=this;this.finally((()=>init_et=null));E.uninit();state=new _pub_state_js__WEBPACK_IMPORTED_MODULE_18__["default"]("bg_ajax_state",{selected_agents:null,selected_ccgi:null,selected_ccgi_cdn:null,selected_hola:null,selected_perr:null,cloud_conf:null,agent_fallback_rule:null},{persistent:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().check_min_ver(CGA("persistent_state_min_ver")),ttl:CGA("state_ttl",4*HOUR)});yield state.load();chrome=self.chrome;if(E.be_tab_unblocker=be_tab_unblocker)E.be_tab_unblocker.be_bg_ajax=E;_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_16__["default"].be_bg_ajax=E;E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default(),"change:bext_config",update_hola_domains);E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default(),"change:ext.active",update_state)}));E.reset=function(force){if(!bg_ajax&&!force)return;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().perr("be_bg_ajax_reset",{force});if(bg_ajax)bg_ajax.uninit();bg_ajax=new BgAjax;bg_ajax.init()};E.is_inited=()=>bg_ajax&&bg_ajax.inited;const init=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*bg_ajax_init_(){if(bg_ajax)return;bg_ajax=new BgAjax;yield bg_ajax.init();_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().set_ajax_cb((req=>E.perr_ajax(req)))}));function is_dev_build(){return _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().browser()=="chrome"&&(_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_2___default().runtime.id!="gkojfkhlekighikafcpjkiklfbnlmeio"&&_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_2___default().runtime.id!="bbjkgcbckkalmlpimfinpdmaelnknlee")||_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().browser()=="opera"&&_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_2___default().runtime.id!="ekmmelpnmfdegjhnmadddcfjcahpajnm"||_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().browser()=="edge"&&_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_2___default().runtime.id!="eibinhpjpbkmjeohlclnebmkhdfehpbf"}E.hola_api_call=(path,opt)=>{opt=opt||{};opt.method=opt.method||"GET";const xsrf_header=(conf__WEBPACK_IMPORTED_MODULE_17__.firefox_web_ext||is_dev_build())&&!["GET","HEAD","OPTIONS"].includes(opt.method);return _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*hola_api_call_(){let headers;if(xsrf_header){const c=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().cb_apply(chrome.cookies,".get",[{url:`https://${www_host}/`,name:"XSRF-TOKEN"}]);if(c&&c.value&&typeof c.value=="string")headers={"x-xsrf-token":c.value}}return yield E.hola_ajax({url:`https://${www_host}/`+path,qs:opt.qs,data:opt.data,method:opt.method,headers,text:opt.text,json:!opt.text,with_credentials:true})}))};const get_agent_key=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*get_agent_key_(){let key=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("agent_key");if(key)return key;let ret=yield _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_16__["default"].storage_local_get("agent_key");return ret&&ret.agent_key}));E.ajax_via_proxy=(target_url,opt)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*ajax_via_proxy(){const{agent,data,hdrs,always,with_credentials,timeout=30*SEC}=opt;if(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().is_disabled()&&!E.is_inited()){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().perr("be_bg_ajax_not_inited",{},{with_log:true});return}let url,method,credentials;if(typeof target_url=="object"){method=target_url.type;target_url=target_url.url}let body,headers=assign({},hdrs);if(typeof data=="object"){body=new FormData;for(let key in data)body.append(key,data[key])}else body=data;let controller=self.AbortController?new self.AbortController:{abort:reason=>this.throw(new Error(reason)),signal:null};let tout_id=setTimeout((()=>controller.abort("timeout")),timeout);const clear_timeout=()=>{clearTimeout(tout_id);tout_id=null};this.finally((()=>{if(tout_id){controller.abort();clear_timeout()}}));if(agent){let is_hola=_util_url_js__WEBPACK_IMPORTED_MODULE_9___default().is_hola_domain(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_20___default().get_root_url(target_url));headers["x-hola-target-url"]=target_url;url=`https://${agent.host}:${agent.port}/ajax_via_proxy`;let uuid=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("uuid");if(!uuid)throw new Error("uuid is missing");let key=yield get_agent_key();if(key){let prem=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("is_premium")?"1":"0";let user=`user-uuid-${uuid}-is_prem-${prem}`;headers["x-hola-auth"]="Basic "+btoa(`${user}:${key}`)}else if(!is_hola)throw new Error("agent_key is missing");let cookies=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().cb_apply(self.chrome.cookies,".getAll",[{url:target_url}]);if(cookies&&cookies.length){headers["x-hola-target-cookie2"]=encodeURIComponent(cookies.map((c=>`${c.name}=${c.value}`)).join("; "))}credentials="omit"}else{url=target_url;credentials=with_credentials?"include":"same-origin"}let response;fetch(url,{method:method||"GET",body,signal:controller.signal,headers:new self.Headers(headers),credentials}).then((res=>{clear_timeout();response=res;if(res.ok||always)return res.text();this.throw(new Error(`${res.status} ${res.statusText}`))})).then((data=>{let headers={};for(let pair of response.headers.entries())headers[pair[0]]=pair[1];this.continue({data,agent,status:response.status,orig_res:{statusCode:response.status,headers}})})).catch((err=>{clear_timeout();if(always){this.continue({agent,status:0,orig_res:{statusCode:0,headers:null,error:""+err}})}else this.throw(err instanceof Error?err:new Error(""+err))}));return yield this.wait()}));E.hola_domains=_util_url_js__WEBPACK_IMPORTED_MODULE_9___default().hola_domains;E.check_agent_domain_fallback=force=>{if(bg_ajax&&bg_ajax.inited)bg_ajax.check_agent_domain_fallback(force)};E.agent_domain_fallback_rules=[];E.hola_mirrors=[];const update_hola_domains=()=>{E.hola_domains=_util_url_js__WEBPACK_IMPORTED_MODULE_9___default().hola_domains.slice();let prev_fallback=E.agent_domain_fallback_rules;let prev_hola_mirrors=E.hola_mirrors;let cloud_conf=state.get("cloud_conf")||{};if(cloud_conf&&cloud_conf.updated_ts>CG("stamp")){E.hola_mirrors=cloud_conf.bext_mirrors||[];E.agent_domain_fallback_rules=cloud_conf.bext_agent_mirrors||[]}else{E.hola_mirrors=CGA("hola_mirrors")||[];E.agent_domain_fallback_rules=CGA("agent_domain_fallback_rules")||[]}let agent_domains=E.agent_domain_fallback_rules.map((r=>_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_20___default().get_root_url(_util_url_js__WEBPACK_IMPORTED_MODULE_9___default().add_proto(r.replace("${n}",1)))));for(let host of E.hola_mirrors.concat(agent_domains)){if(!E.hola_domains.includes(host))E.hola_domains.push(host)}if(!E.hola_mirrors.length||!E.agent_domain_fallback_rules.length){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().perr("be_bg_ajax_empty_mirrors",{hola_mirrors:E.hola_mirrors,agent_domain_fallback_rules:E.agent_domain_fallback_rules},{with_log:true})}if(prev_hola_mirrors.length&&!_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().equal_deep(prev_hola_mirrors,E.hola_mirrors)||prev_fallback.length&&!_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().equal_deep(prev_fallback,E.agent_domain_fallback_rules)){E.reset()}};function uninit(){if(bg_ajax)bg_ajax=bg_ajax.uninit();_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().set_ajax_cb()}E.uninit=()=>{uninit();E.stopListening()};if(_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().is_mocha())E.t={BgAjax,get_cloud_agents};const __WEBPACK_DEFAULT_EXPORT__=E},1349:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{"use strict";var _bext_pub_pre_loader_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(143);var _bext_pub_pre_loader_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_bext_pub_pre_loader_js__WEBPACK_IMPORTED_MODULE_0__);var _bext_vpn_bg_bg_main_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2169);
// LICENSE_CODE ZON
const chrome=self.chrome;let install_details;const init=()=>{const now=Date.now();self.hola.t={l_start:now};chrome.runtime.onInstalled.addListener((details=>{install_details={reason:details.reason};if(_bext_vpn_bg_bg_main_js__WEBPACK_IMPORTED_MODULE_1__.Z)_bext_vpn_bg_bg_main_js__WEBPACK_IMPORTED_MODULE_1__.Z.set("install_reason",details.reason)}));self.be_bg_main=_bext_vpn_bg_bg_main_js__WEBPACK_IMPORTED_MODULE_1__.Z;_bext_vpn_bg_bg_main_js__WEBPACK_IMPORTED_MODULE_1__.Z.init({install_details})};init()},7362:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var underscore__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8763);var underscore__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_0__);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_2__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_3__);var _util_url_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5305);var _util_url_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_util_url_js__WEBPACK_IMPORTED_MODULE_4__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5__);var _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(8552);var _bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(737);var _bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(1002);var _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(8076);var _bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(3886);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(4130);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_11__);var _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(6210);var _bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(9265);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_14__);var _bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(7666);var zon_config__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(4118);var conf__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(9641);
// LICENSE_CODE ZON
_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_14___default().assert_bg("be_ccgi");const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default().model),chrome=self.chrome;E.init=be_ext=>{if(E.inited)return;E.inited=true;E.init_ts=Date.now();E.sp=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_14___default().new_etask("be_ccgi");E.be_ext=be_ext;E.be_mode=_bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_8__.Z;E.listening=false;start_listen();E.on("destroy",E.uninit)};E.uninit=()=>{E.sp.return();stop_listen()};function start_listen(){if(E.listening)return;chrome.runtime.onMessage.addListener(ccgi_ipc_handler);E.listening=true}function stop_listen(){if(!E.listening)return;chrome.runtime.onMessage.removeListener(ccgi_ipc_handler);E.listening=false}function send_msg(msg,resp_cb){try{return resp_cb(msg)}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().perr("be_ccgi_send_err",msg.id,{err:e,filehead:_util_zerr_js__WEBPACK_IMPORTED_MODULE_3___default().json(msg)})}}function ccgi_resp(msg,resp_cb){underscore__WEBPACK_IMPORTED_MODULE_0___default().defer(send_msg,msg,resp_cb);return true}function ccgi_ipc_handler(msg,sender,resp_cb){if(!E.inited||!_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().is_hola_url(sender.origin+"/")||msg._type&&msg._type!="ccgi"){return}switch(msg.id){case"callback":msg.data={init_ts:E.init_ts,install_ts:E.be_ext.get("install_ts"),connected:E.be_ext.get("enabled"),disable:!E.be_ext.get("enabled"),uuid:E.be_ext.get("uuid"),session_key:E.be_ext.get("session_key")||0,ver:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().version(),mode:E.be_mode.get("mode"),mode_duration:Date.now()-E.be_mode.get("ts"),pending:E.be_mode.get("pending"),type:conf__WEBPACK_IMPORTED_MODULE_17__.type,browser:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().browser(),release:zon_config__WEBPACK_IMPORTED_MODULE_16__._RELEASE,svc_mode:_bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_8__.Z.get("mode"),svc_mode_pending:_bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_8__.Z.get("pending"),svc_info:E.be_mode.get("svc.info"),build_info:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().build_info(),has_opened_popup:_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].get("has_opened_popup")};return ccgi_resp(msg,resp_cb);case"enable":E.be_ext.set("enabled",!!msg.data);break;case"ping":msg.data={uuid:E.get("uuid"),session_key:E.get("session_key")||0,ver:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().version(),type:conf__WEBPACK_IMPORTED_MODULE_17__.type,browser:E.get("browser"),install_ts:E.be_ext.get("install_ts")};return ccgi_resp(msg,resp_cb);case"open_be_tab":_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_6__["default"].open_be_tab(msg.opt);break}if(!_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_10__.Z.get("inited")){_util_zerr_js__WEBPACK_IMPORTED_MODULE_3___default().notice("skip msg.id %s, be_vpn not inited",msg.id);return}switch(msg.id){case"svc_callback":msg.data=null;E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({name:"svc_callback",cancel:true},(function*(){try{const r=yield _bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_7__["default"].callback({raw:1});r.from_be=true;msg.data=r;ccgi_resp(msg,resp_cb)}catch(e){ccgi_resp(msg,resp_cb)}})));return true;case"update_rules":msg.data={};try{_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_9__.Z.trigger("fetch_rules",false)}catch(e){}return ccgi_resp(msg,resp_cb);case"vpn_enable":msg.data={};E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({name:"vpn_enable",cancel:true},[function(){},function catch$(err){return msg.data.err=""+err},function finally$(){return ccgi_resp(msg,resp_cb)}]));return true;case"perr":_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().perr(msg.perr_id,JSON.parse(msg.info));break;case"set_rule":msg.data={};E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({name:"set_rule",cancel:true},(function*(){try{return yield _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_9__.Z.set_rule(msg.opt)}catch(e){return msg.data.err=""+e}finally{if(!msg.no_resp)ccgi_resp(msg,resp_cb)}})));return!msg.no_resp;case"fetch_rules":msg.data={};E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({name:"fetch_rules",cancel:true},(function*(){try{yield _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_9__.Z.update_rules();return msg.data.rules=yield _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_9__.Z.get("rules")}catch(e){return msg.data.err=""+e}finally{if(!msg.no_resp)ccgi_resp(msg,resp_cb)}})));return!msg.no_resp;case"enable_root_url":msg.data={};E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({name:"enable_root_url",cancel:true},(function*(){try{return msg.data.rule=yield _bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_10__.Z.enable_root_url(msg.opt)}catch(e){return msg.data.err=""+e}finally{if(!msg.no_resp)ccgi_resp(msg,resp_cb)}})));return!msg.no_resp;case"refresh_membership":_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_13__["default"].schedule_refresh_user(Object.assign({force_premium:true,reason:"ccgi_call"},msg.data));break;case"get_log":break;case"set_dont_show_again":try{E.sp.spawn(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].set_dont_show_again(msg.data))}catch(e){}break;case"set_svc_downloaded":return ccgi_resp(msg,resp_cb);case"is_dont_show":E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function(){try{msg.data={is_dont_show:_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].is_dont_show(msg.data.root_url)};ccgi_resp(msg,resp_cb)}catch(e){ccgi_resp(msg,resp_cb)}})));return true;case"set_enabled_for_browser":try{E.sp.spawn(_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_10__.Z.set_enabled_for_browser(msg.data.enable,{country:"us"}))}catch(e){}break;case"is_enabled_for_browser":E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function(){try{msg.data={enable:_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_10__.Z.is_enabled_for_browser()};ccgi_resp(msg,resp_cb)}catch(e){ccgi_resp(msg,resp_cb)}})));return true;case"set_browser_country":try{let{country}=msg.data;if(country=="uk")country="gb";E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){try{msg.data.result=yield _bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_10__.Z.set_browser_country({country,tab_id:sender.tab.id,src:"new_tab"});ccgi_resp(msg,resp_cb)}catch(e){msg.data.err=""+e;ccgi_resp(msg,resp_cb)}})))}catch(e){}return true;case"get_browser_country":E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function(){try{let rule=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_10__.Z.get_all_browser_rule();msg.data={enable:_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_10__.Z.is_enabled_for_browser(),country:rule&&rule.country};ccgi_resp(msg,resp_cb)}catch(e){ccgi_resp(msg,resp_cb)}})));return true;case"force_full_browser_mode":try{E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){try{yield _bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_10__.Z.force_full_browser_mode(msg.data.enable);ccgi_resp(msg,resp_cb)}catch(e){msg.data.err=""+e;ccgi_resp(msg,resp_cb)}})))}catch(e){}return true;case"set_browser_ab":try{E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){try{yield _bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_10__.Z.set_browser_ab(msg.data.tests);ccgi_resp(msg,resp_cb)}catch(e){msg.data.err=""+e;ccgi_resp(msg,resp_cb)}})))}catch(e){}return true;case"get_full_browser_mode":E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function(){try{msg.data={enabled:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().full_browser_mode()};ccgi_resp(msg,resp_cb)}catch(e){ccgi_resp(msg,resp_cb)}})));return true;case"force_suggestion":E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({name:"force_suggestion",cancel:true},(function*(){try{return yield _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_11___default().set_force_suggestion(msg.tab_id||sender.tab.id,true)}catch(e){return msg.data.err=""+e}finally{if(!msg.no_resp)ccgi_resp(msg,resp_cb)}})));return!msg.no_resp;case"set_trial_experiment":return ccgi_resp(msg,resp_cb);case"shoop_force_url":return;case"get_ext_timer":E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function(){try{const trial=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_15__["default"].get_trial_active("newtab");if(!trial)msg.data={trial:false};else{const timer_trial=trial.interval_ts||trial.start_ts;const add=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_15__["default"].get_used_cycle_time("newtab",true);msg.data={trial:true,timer:timer_trial-add}}msg.data.is_premium=E.be_ext.get("is_premium");ccgi_resp(msg,resp_cb)}catch(e){ccgi_resp(msg,resp_cb)}})));return true;case"notify_survey_done":_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_15__["default"].notify_survey_done();return true;default:_util_zerr_js__WEBPACK_IMPORTED_MODULE_3___default()("unknown ccgi message "+_util_zerr_js__WEBPACK_IMPORTED_MODULE_3___default().json(msg))}}if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().is_v3)start_listen();const __WEBPACK_DEFAULT_EXPORT__=E},1679:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0__);var _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6210);var _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8076);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(4130);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_3__);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(843);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_4__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_5__);var _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(8552);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_7__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_8__);var _util_util_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_9__);var _util_ajax_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(665);var _util_date_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_11__);var _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(2227);var _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_13__);
// LICENSE_CODE ZON
const chrome=self.chrome;const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0___default().task_model.extend({model_name:"dev_mode"}));const assign=Object.assign;E.force_tpopup=type=>{var tab_url=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_3___default().get("active.url");var tab_id=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_3___default().get("active.id");if(!tab_url||!tab_id)return;var domain=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().get_root_url(tab_url);_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_1__["default"].set_force_tpopup(domain,type);if(type=="suggestion")_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_3___default().set_force_suggestion(tab_id,true);chrome.tabs.reload(tab_id)};const on_change_mode=()=>{_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_5___default().set("dev_mode",E.get("dev_mode"));_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().enable_events_logging(E.get("dev_mode"))};function on_change(e){_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_6__["default"].storage_local_set({dev_mode_conf:e.attributes});E.trigger("change:dev_mode")}const get_debug_peer_rule=opt=>{let popt;if(!(popt=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_7___default().get_peer_filter_opt(opt.filter)))return;const rule={name:"debug_peer",root_url:"debug_peer",enabled:+!!(opt.on&&E.get("debug_proxy")&&(opt.proxy_traffic||opt.def_traffic)),country:popt.country||"us",no_reload:true,def_traffic:opt.def_traffic,proxy_traffic:opt.proxy_traffic};_util_util_js__WEBPACK_IMPORTED_MODULE_9___default().if_set(popt.asn,rule,"asnum");_util_util_js__WEBPACK_IMPORTED_MODULE_9___default().if_set(popt.cid,rule,"cid");_util_util_js__WEBPACK_IMPORTED_MODULE_9___default().if_set(popt.country,rule,"peer_country");_util_util_js__WEBPACK_IMPORTED_MODULE_9___default().if_set(popt.ip,rule,"peer_ip");return rule};function on_change_debug_peer(e){let rule,debug_peer=E.get("debug_peer")||{filter:""};if(!(rule=get_debug_peer_rule(debug_peer)))return;_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_2__.Z.trigger("set_rule",rule)}E.enable=dev_mode=>E.set("dev_mode",!!dev_mode);const update_dev_mode=()=>{const uuids=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().CG("debug_menu_uuid_md5")||[];if(uuids.includes(_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_6__["default"].get_uuid_md5()))E.enable(true)};E.init=()=>{E.on("change:dev_mode",on_change_mode);E.on("change:debug_peer change:debug_proxy",on_change_debug_peer);E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_5___default(),"change:bext_config",update_dev_mode);return _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*dev_mod_init(){let o=yield _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_6__["default"].storage_local_get("dev_mode_conf");_util_util_js__WEBPACK_IMPORTED_MODULE_9___default().forEach(o,((name,val)=>E.set(name,val)));E.on("change",on_change)}))};E.uninit=()=>{E.off("change",on_change);E.off("change:dev_mode",on_change_mode);E.off("change:debug_peer change:debug_proxy",on_change_debug_peer);E.stopListening()};E.get_debug_peer_info=(top_url,opt)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*get_debug_peer_info(){const res={curl:"",cid:""};const rule=get_debug_peer_rule(opt);if(!rule||!rule.enabled)return assign({err:"rule not found or disabled"},res);let agent=_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().get_chosen_agent({country:rule.country},rule);if(!agent)return assign({err:"agent not found"},res);let port,plist;if(plist=agent.port_list)port=agent.port==plist.direct?25333:+agent.port+1e3;port=port||agent.port;let qs=assign({proxy_country:rule.country,ping_id:"debug_peer",root_url:rule.name,is_premium:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_5___default().get("is_premium")},_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().qs_ajax({uuid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_5___default().get("uuid")}));try{qs.key=(yield _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_6__["default"].storage_local_get("agent_key")).agent_key}catch(e){}_util_util_js__WEBPACK_IMPORTED_MODULE_9___default().if_set(rule.asnum,qs,"asnum");_util_util_js__WEBPACK_IMPORTED_MODULE_9___default().if_set(rule.cid,qs,"peer_cid");_util_util_js__WEBPACK_IMPORTED_MODULE_9___default().if_set(rule.peer_country,qs,"peer_country");_util_util_js__WEBPACK_IMPORTED_MODULE_9___default().if_set(rule.peer_ip,qs,"peer_ip");let url="https://"+(agent.host||agent.ip)+":"+port+"/verify_proxy";let verify,t0=Date.now();try{verify=yield _util_ajax_js__WEBPACK_IMPORTED_MODULE_10__["default"].json({timeout:20*_util_date_js__WEBPACK_IMPORTED_MODULE_11___default().ms.SEC,url,qs})}catch(e){}if(!verify||verify.error)return assign({error:verify.error||"verify request failed"},res);res.cid=verify.cid||"not_found";let m;if(verify.cid&&(m=verify.cid.match(/_(\d+\.\d+\.\d+\.\d+)_/)))res.peer_ip=m[1];res.curl=`curl '${top_url}' --proxy 'http://${agent.host}:${port}' `+"--proxy-user "+_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_7___default().get_user_name(qs)+":"+qs.key;return res}));E.change_peer=opt=>_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*change_peer(){const rule=get_debug_peer_rule(opt);yield _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_2__.Z.change_proxy_wait({rule,desc:"not_working",root_url:rule.root_url,tab_id:rule.name})}));const __WEBPACK_DEFAULT_EXPORT__=E},7310:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){const is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(6386),__webpack_require__(5305),__webpack_require__(1291)],__WEBPACK_AMD_DEFINE_RESULT__=((etask,zurl,zutil)=>{const E={},assign=Object.assign;const is_force_rule_for_country=(rule,country)=>{if(!country)return true;if(rule.countries)return rule.countries.includes(country);if(rule.exclude_countries)return!rule.exclude_countries.includes(country);return true};E.convert_blob2check=(conf,name)=>{const rules=conf&&conf[name]&&conf[name].rules;if(!rules)return;conf[name].rules=rules.map((rule=>assign({},rule,{domain:new RegExp("^"+zurl.http_glob_host(rule.domain)+"$")})))};E.find_rule=(root_url,conf,name,src_country)=>{const rules=conf&&conf[name]&&conf[name].rules;if(!rules||!root_url)return;return rules.find((rule=>{if(!rule.domain.test(root_url))return false;return is_force_rule_for_country(rule,src_country)}))};return E}).apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},8084:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var underscore__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8763);var underscore__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_0__);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_2__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_5__);var _util_util_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_6__);var _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(8076);var _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(897);var _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_8__);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(4130);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9__);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_10__);
// LICENSE_CODE ZON
_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().assert_bg("be_icon");const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default().task_model.extend({model_name:"icon"}));const chrome=self.chrome,assign=Object.assign;const v3=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().is_v3;const{CG}=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default();const action=v3?chrome.action:chrome.browserAction;let icons={};const images={gray:{19:"bext/vpn/ui/img/icon19_gray.png",38:"bext/vpn/ui/img/icon38_gray.png"},ok_new:{16:"bext/vpn/ui/img/icon16_new.png",48:"bext/vpn/ui/img/icon48_new.png"},mitm_icon:{19:"bext/vpn/ui/img/ic_unblock19.png",38:"bext/vpn/ui/img/ic_unblock38.png"},error_icon:{19:"bext/vpn/ui/img/ic_error_19.png",38:"bext/vpn/ui/img/ic_error_38.png"}};const FLAGS_PATH="svc/vpn/pub/img/flag/32_4x3/";E.uninit=()=>{if(!E.get("inited"))return;E.off("destroy",E.uninit);E.off("refresh",on_refresh);E.stopListening();E.sp.return();E.clear()};E.init=()=>{if(E.get("inited"))return;E.set("inited",true);E.sp=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().new_etask("be_icon");E.on("destroy",E.uninit);E.on("refresh",on_refresh);E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default(),"change:enabled",refresh_all);E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default(),"change:ext.conflict",refresh_all);E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default(),"change:is_blocked_by_av",refresh_all);E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default(),"change:no_permission",refresh_all);E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default(),"mitm_change",refresh_active);E.listenTo(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_7__.Z,"change:stamp",refresh_active);E.listenTo(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_7__.Z,"change:rules",refresh_active);E.listenTo(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_7__.Z,"change:tabs_stub_rules change:per_tab_rules",refresh_active);E.listenTo(_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_8___default(),"change:tab_load_err",refresh_active);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9___default(),"change:active.url change:active.id",refresh_active);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9___default(),"updated",(o=>{if(!o.info.url&&!o.info.status)return;E.refresh({tab:o.tab})}));E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9___default(),"completed",(o=>{if(!o.frameId&&o.tabId>=0)E.refresh({tabId:o.tabId})}));refresh_all()};function refresh_active(){E.refresh({retry:1})}function refresh_all(){icons={};refresh(null);chrome.tabs.query({},(tabs=>tabs.forEach((tab=>{var url=tab&&tab.url||"",rule=get_rule(url,tab&&tab.id);if(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("enabled")&&(!rule||!rule.enabled||!rule.country))return;refresh(tab)}))))}function tab_opt(tab,opt){return assign(opt,tab?{tabId:tab.id}:{})}function set_icon_cb(retry){return function(){if(!chrome.runtime.lastError)return;var err=chrome.runtime.lastError.message;_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default()("set_icon_err: ",err);if(!underscore__WEBPACK_IMPORTED_MODULE_0___default().isNumber(retry))return;if(retry>0)return E.refresh({retry:retry-1});_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("set_icon_err",{retry},{rate_limit:{count:1},err})}}function is_path_eq(a,b){if(!a||!b)return;if(typeof a=="string"||typeof b=="string")return a==b;var keys=Object.keys(a);if(keys.length!=Object.keys(b).length)return;for(var i=0;i<keys.length;i++){if(a[keys[i]]!=b[keys[i]])return}return true}const set_icon=(opt,cb)=>{const id=opt.tabId!==undefined?opt.tabId:"global";const name=opt.name;let path=images[name]||FLAGS_PATH+name+".png";if(is_path_eq(icons[id],path)&&is_path_eq(icons.global,path))return cb&&cb();icons[id]=path;let data=typeof path=="string"?{32:path}:path;action.setIcon(assign(_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().pick(opt,"tabId"),{path:data}),cb)};let get_rule=(url,tab_id)=>{let stub_rule=tab_id&&_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_7__.Z.get_stub_rule(tab_id)||tab_id&&_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_7__.Z.get_per_tab_rule(tab_id);if(stub_rule&&stub_rule.enabled&&_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().is_stub_url(url,_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("is_premium"))){return stub_rule}return _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_7__.Z.get_rules(url)[0]};const refresh=(tab,retry)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*_refresh(){const cb=set_icon_cb(retry);const url=tab&&tab.url||"",tab_id=tab&&tab.id;if(tab_id<0)return;if(!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("enabled")||_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("ext.conflict")||_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("ext.suspended")||_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("no_permission")||_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("is_blocked_by_av")&&CG("blocked_by_av.show_popup")){yield set_icon(tab_opt(tab,{name:"gray"}),cb);action.setBadgeText(tab_opt(tab,{text:"off"}));action.setBadgeBackgroundColor(tab_opt(tab,{color:"#FF8800"}));return}action.setBadgeText(tab_opt(tab,{text:""}));if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().proxy_error_ui_enabled("icon")&&tab_id&&_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_8___default().get_tab_load_err(tab_id)){yield set_icon(tab_opt(tab,{name:"error_icon"}),cb);return}const rule=get_rule(url,tab_id);if(!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("enabled")||!rule||!rule.enabled||!rule.country){let name="ok_new";yield set_icon(tab_opt(tab,{name}),cb);if(rule&&!rule.country){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("icon_no_country_err",{url,rule},{rate_limit:{count:1}})}return}if(rule.mitm)return void(yield set_icon(tab_opt(tab,{name:"mitm_icon"}),cb));yield set_icon(tab_opt(tab,{name:rule.country.toLowerCase()}),cb)}));E.refresh=o=>E.trigger("refresh",o);function on_refresh(o){if(!E.get("inited"))return;E.sp.spawn({name:"refresh",cancel:true},_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*on_r_(){try{const tab=o&&o.tab?o.tab:o&&o.tabId?yield _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9___default().get_tab(o.tabId):yield _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9___default().active();if(!tab)return;return yield refresh(tab,o&&o.retry)}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_icon_refresh_err",{},{err:e})}})))}const __WEBPACK_DEFAULT_EXPORT__=E},6210:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var underscore__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8763);var underscore__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_0__);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_2__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4__);var _util_util_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_5__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_6__);var _util_date_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_7__);var _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(9651);var _util_storage_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(1032);var _util_storage_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_util_storage_js__WEBPACK_IMPORTED_MODULE_9__);var _bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(737);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11__);var _svc_hola_pub_svc_ipc_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(764);var _svc_hola_pub_svc_ipc_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_svc_hola_pub_svc_ipc_js__WEBPACK_IMPORTED_MODULE_12__);var _util_url_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(5305);var _util_url_js__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(_util_url_js__WEBPACK_IMPORTED_MODULE_13__);var conf__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(9641);var _pub_state_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(7619);
// LICENSE_CODE ZON
_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().assert_bg("be_info");const chrome=self.chrome;const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default().task_model.extend({model_name:"info",_defaults:function(){this.on("destroy",(()=>E.uninit()))}}));let state;let unblocking_rate={};const on_location=underscore__WEBPACK_IMPORTED_MODULE_0___default().debounce((()=>{const location=E.get("location");E.set("country",location?location.country:null);_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set("src_country",E.get("country"))}));E.init=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){if(E.get("inited"))return;state=new _pub_state_js__WEBPACK_IMPORTED_MODULE_15__["default"]("be_info_state",{dont_show_count:{},user_id:null},{persistent:false});yield state.load();_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().set_perr_cb(perr_res_cb);E.set("inited",true);E.set("vpn_work_yes",_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get_int("vpn_work_yes"));E.set("vpn_last_rating",_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get_int("vpn_last_rating"));E.set("rate_on_store",_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get_int("rate_on_store"));E.set("location",_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get_json("location"));E.set("has_opened_popup",_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get_int("has_opened_popup"));E.sp=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().new_etask("be_info");E.on("recover",E.fetch_info);E.on_init("change:location",on_location);E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default(),"change:ext.active change:uuid change:ext.suspended",E.fetch_info);E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default(),"change:user_id",E.set_user_id);E.set("settings",_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get_json("settings")||{});unblocking_rate={};if(!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().is_bg_reinited()||!E.get("location"))E.fetch_info();E.trigger("inited")}));E.uninit=()=>{if(!E.get("inited"))return;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().set_perr_cb();E.sp.return();unblocking_rate={};E.off("change:location",on_location);E.off("recover",E.fetch_info);E.stopListening();E.clear()};const perr_res_cb=res=>{if(res&&res.ip&&res.country&&!(_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.is_active()&&_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.get_agent_fallback("perr"))){set_location(res)}};const set_location=opt=>{if(!opt)return;let{ip,country}=opt;const location=E.get("location");if(location&&location.ip==ip&&location.country==country)return;E.set("location",{ip,country});_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set_json("location",{ip,country})};const set_settings=settings=>{settings=settings||{};_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set_json("settings",settings);E.set("settings",settings)};E.get_unblocking_rate_url=(limit,src_country)=>{src_country=(src_country||"").toLowerCase();const url=conf__WEBPACK_IMPORTED_MODULE_14__.url_ccgi+"/unblocking_rate";return _util_url_js__WEBPACK_IMPORTED_MODULE_13___default().qs_add(url,{src_country,limit})};E.get_unblocking_rate=(limit,src_country)=>{src_country=(src_country||E.get("country")||"").toLowerCase();if(!src_country)return;const now=Date.now();for(let k in unblocking_rate){if(now-unblocking_rate[k].ts>15*_util_date_js__WEBPACK_IMPORTED_MODULE_7___default().ms.MIN)delete unblocking_rate[k]}return _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({cancel:true},(function*get_unblocking_rate(){let key=src_country+"_"+limit;if(unblocking_rate[key]&&(unblocking_rate[key].et||unblocking_rate[key].info)){return unblocking_rate[key].et?yield this.wait_ext(unblocking_rate[key].et):unblocking_rate[key].info}unblocking_rate[key]={et:this};this.on("finally",(()=>unblocking_rate[key].et=undefined));let res,err;for(let i=0;i<=1;i++){try{res=yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.ccgi_ajax({url:conf__WEBPACK_IMPORTED_MODULE_14__.url_ccgi+"/unblocking_rate",data:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().qs_ajax({src_country,limit})});if(res)break}catch(e){err=e}}if(!res&&!err)err="empty_response";if(!err){unblocking_rate[key]={info:res,ts:Date.now()};return res}_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_unblocking_rate_err",{key},{err})}))};E.fetch_info=()=>E.trigger("fetch_info");E.on("fetch_info",(()=>{if(!E.set_busy({desc:"Configuring..."}))return E.schedule_clr(["fetch_info"]);return E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({name:"fetch_info",cancel:true},(function*(){try{_util_zerr_js__WEBPACK_IMPORTED_MODULE_6___default().notice("be_info: fetch_info");set_location(yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.get_location());E.clr_busy()}catch(e){E.set_err();_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_info_fetch_info_err",{},{err:e,rate_limit:{count:3}})}})))}));E.set_user_id=()=>{E.trigger("set_user_id")};E.on("set_user_id",(()=>{var user_id=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("user_id"),is_premium=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("is_premium");if(user_id===undefined||user_id==state.get("user_id"))return;return _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()("set_user_id",(function*set_user_id_(){try{yield _bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_10__["default"].update_info();const sync_data=!_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_10__["default"].get("info")?{missing_svc:true}:yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().all({token:get_user_sync_token()});const sync_token=sync_data.token;const missing_svc=sync_data.missing_svc;yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().all({allow_fail:true},{svc:!missing_svc&&_svc_hola_pub_svc_ipc_js__WEBPACK_IMPORTED_MODULE_12___default().ajax({cmd:"user_token_update.json?token="+user_id+(is_premium?"&premium":"")+(sync_token?"&sync="+sync_token:"")})});state.set("user_id",user_id);if(user_id)E.trigger("user_id_set")}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_info_set_user_id_err",{},{err:e})}}))}));function fix_dont_show(data,root_url){var val=data[root_url];if(val&&val.period){data[root_url]={};data[root_url][val.type||"default"]=val;delete val.type}}E.set_dont_show_again=opt=>{opt=_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().clone(opt);const root_url=opt.root_url;if(!root_url)return;const type=opt.type||"default";if(opt.period=="session"){if(opt.src=="outside_click"){let prev=state.get(["dont_show_count",root_url])||0;state.set(["dont_show_count",root_url],prev+1);if(!prev)return}opt.period="1h"}if(opt.period=="default")opt.period=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().get_dont_show_def_period();var settings=E.get("settings")||{};var data=settings.dont_show=settings.dont_show||{};fix_dont_show(data,root_url);if(opt.unset){if(data[root_url])delete data[root_url][type]}else{data[root_url]=data[root_url]||{};data[root_url][type]={ts_user:_util_date_js__WEBPACK_IMPORTED_MODULE_7___default().to_sql(new Date),period:opt.period,src:opt.src}}set_settings(settings);E.trigger("change:settings");_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_set_dont_show_again",opt)};function _is_dont_show(val,type){if(val&&!val.period)val=val[type];if(!val)return false;if(val.period=="never")return true;const dur=val.period=="default"?_util_date_js__WEBPACK_IMPORTED_MODULE_7___default().ms.WEEK:_util_date_js__WEBPACK_IMPORTED_MODULE_7___default().str_to_dur(val.period);if(dur)return new Date-_util_date_js__WEBPACK_IMPORTED_MODULE_7___default().from_sql(val.ts_user)<dur;return false}E.is_dont_show=(root_url,type)=>{type=type||"default";const settings=E.get("settings");const data=settings&&settings.dont_show;return!!data&&(_is_dont_show(data.all,type)||_is_dont_show(data[root_url],type))};E.get_dont_show_rules=type=>{const res=[];type=type||"default";const settings=E.get("settings");const data=settings&&settings.dont_show||{};Object.keys(data).forEach((url=>{if(_is_dont_show(data[url],type))res.push(url)}));return res};E.set_force_tpopup=(root_url,type)=>{var force=E.get("force_tpopup")||_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get_json("force_tpopup")||{};force[root_url]={ts:_util_date_js__WEBPACK_IMPORTED_MODULE_7___default().to_sql(new Date),type};E.set("force_tpopup",force);_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set_json("force_tpopup",force)};E.unset_force_tpopup=root_url=>{const force=E.get("force_tpopup")||_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get_json("force_tpopup")||{};delete force[root_url];E.set("force_tpopup",force);_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set_json("force_tpopup",force)};E.is_force_tpopup=root_url=>{const force=E.get("force_tpopup")||_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().get_json("force_tpopup")||{};if(!force||!force[root_url])return false;const _ts=force[root_url].ts;const type=force[root_url].type;if(!_ts)return false;const ts=_util_date_js__WEBPACK_IMPORTED_MODULE_7___default().from_sql(_ts);if(Date.now()-ts>30*_util_date_js__WEBPACK_IMPORTED_MODULE_7___default().ms.MIN)return false;return type||true};E.increment_vpn_work_yes=()=>{const counter=E.get("vpn_work_yes")+1;_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set("vpn_work_yes",counter);E.set("vpn_work_yes",counter)};E.set_vpn_last_rating=rating=>{_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set("vpn_last_rating",rating);E.set("vpn_last_rating",rating)};E.set_rate_on_store=ts=>{_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set("rate_on_store",ts);E.set("rate_on_store",ts)};E.set_has_opened_popup=()=>{const ts=Date.now();_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set("has_opened_popup",ts);E.set("has_opened_popup",ts)};E.reset_rate_us=()=>{E.set_vpn_last_rating(0);E.set_rate_on_store(0);_util_storage_js__WEBPACK_IMPORTED_MODULE_9___default().set("vpn_work_yes",0);E.set("vpn_work_yes",0)};var join_sessions_etask;function join_sessions(user){if(user.disable_account_changes)return;return _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()("join_sessions",(function*join_sessions_(){this.finally((()=>join_sessions_etask=undefined));join_sessions_etask=this;yield _bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_10__["default"].update_info();let sync_token;try{if(!(sync_token=_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_10__["default"].get("sync_token")))return;return yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.hola_api_call("users/auth/token/join",{qs:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().qs_ajax({token:sync_token,uuid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("uuid")}),method:"POST"})}catch(e){}}))}function get_user_sync_token(){return _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()("get_user_sync_token",(function*get_user_sync_token_(){yield join_sessions_etask;try{const data=yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.hola_api_call("users/auth/token/generate",{qs:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().qs_ajax({uuid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("uuid")})});return data.token}catch(e){return""}}))}E.get_user_data=query=>{var last_res;return _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()("get_user_data",(function*get_user_data_(){const res=yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.hola_api_call("users/get_user",query);last_res=res||{};if(last_res.user){join_sessions(last_res.user);return last_res}yield _bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_10__["default"].update_info();let sync_token;try{if(!(sync_token=_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_10__["default"].get("sync_token")))return last_res;yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.hola_api_call("users/auth/token/login",{qs:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().qs_ajax({token:sync_token,uuid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("uuid")}),method:"POST"})}catch(e){return last_res}const data=yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.hola_api_call("users/get_user",query);return data||last_res}))};E.is_verified=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*is_verified_(){let res=yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.hola_api_call("users/is_verified");return res&&res.verified}));E.resend_verification_email=()=>_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.hola_api_call("users/send_email_verification",{method:"POST"});E.set_login_redirect=value=>chrome.cookies.set({value,url:_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.hola_url(),name:"bext_login_origin",expirationDate:(Date.now()+5*_util_date_js__WEBPACK_IMPORTED_MODULE_7___default().ms.MIN)/1e3});E.set_email_verify_url=value=>chrome.cookies.set({value,url:_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.hola_url(),name:"email_verify_next_url",expirationDate:(Date.now()+_util_date_js__WEBPACK_IMPORTED_MODULE_7___default().ms.HOUR)/1e3});const __WEBPACK_DEFAULT_EXPORT__=E},7148:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_1__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_2__);var _util_util_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_3__);var _util_storage_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1032);var _util_storage_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_util_storage_js__WEBPACK_IMPORTED_MODULE_4__);var _util_escape_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(4336);var _util_escape_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_util_escape_js__WEBPACK_IMPORTED_MODULE_5__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_6__);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(4130);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_7__);var _bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2426);var _bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_9__);var _bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(9265);var _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(897);var _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_11__);var _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(6210);var _util_browser_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(6069);var _util_browser_js__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(_util_browser_js__WEBPACK_IMPORTED_MODULE_13__);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_14__);var _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(8552);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(843);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_16__);var _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(9651);var _bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(7666);
// LICENSE_CODE ZON
_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_14___default().assert_bg("be_mitm");const assign=Object.assign;const chrome=self.chrome;const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0___default().task_model.extend({model_name:"mitm",_defaults:function(){this.on("destroy",(()=>E.uninit()))}}));let perr=(name,info,opt)=>{opt=opt||{};let timeline=_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().get_timeline();if(timeline)opt.filehead=timeline+"\n\n"+(opt.filehead||"");_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_9___default().perr(name,assign({},info),opt)};E.set_unblock=(root_url,tab_id)=>{_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().trace(tab_id,root_url,"user choice unblock");handler.enable_rule(root_url);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_6___default().trigger("mitm_change",root_url)};E.set_ignore=(root_url,tab_id)=>{const rule=handler.get_rule(root_url);if(rule&&rule.enabled_ts)return;_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().trace(tab_id,root_url,"user choice ignore");handler.ignore_rule(root_url);let tab_url=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_14___default().root2url(root_url);if(_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_11___default().get_enabled_rule(tab_url))E.be_vpn.stop_vpn(tab_url,tab_id);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_6___default().trigger("mitm_change",root_url)};E.remove_rule=root_url=>{if(!handler)return;delete handler.rules[root_url];_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_6___default().trigger("mitm_change",root_url)};const cb_wrapper=_util_zerr_js__WEBPACK_IMPORTED_MODULE_2___default().catch_unhandled_exception;const is_unblock_allowed=(tab_id,tab_url)=>{if(_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_11___default().get_enabled_rule(tab_url))return false;if(!_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_15__["default"].is_vpn_allowed(tab_url,true,_util_browser_js__WEBPACK_IMPORTED_MODULE_13___default().isInNet))return false;if(_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_18__["default"].is_vpn_forbidden())return false;if(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_6___default().get("is_premium"))return true;const tab_unblocker=_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_11___default().tab_unblockers[tab_id];if(tab_unblocker)return!tab_unblocker.force_premium;return!_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_10__["default"].get_force_premium_rule(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_16___default().get_root_url(tab_url),{tab_url})};E.get_confirm_tab_url=(root_url,tab_id)=>"mitm.html?"+_util_escape_js__WEBPACK_IMPORTED_MODULE_5___default().qs({root_url,tab_id});E.open_confirm_tab=(root_url,tab_id)=>_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_15__["default"].open_be_tab({force_active:true,url:E.get_confirm_tab_url(root_url,tab_id)});const handle_mitm_block=(reason,root_url,tab_id,tab_url)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()((function*(){_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().trace(tab_id,tab_url,"handle_mitm_block");if(!is_unblock_allowed(tab_id,tab_url)){return void perr("handle_mitm_block_not_allowed",{root_url,tab_url,reason})}const unblock=handler.need_unblock(root_url);if(!unblock){return void perr("handle_mitm_block_no_need",{root_url,tab_url,reason})}if(unblock.mode==_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().modes.MANUAL){perr("handle_mitm_block_show_popup",{root_url,tab_url,reason});_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().trace(tab_id,tab_url,"trigger mitm popup");_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_6___default().trigger("mitm_change",root_url);if(_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().is_inside_popup_allowed(root_url)&&tab_id)_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_7___default().reload(tab_id);else E.open_confirm_tab(root_url,tab_id);return}if(unblock.mode==_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().modes.AUTO){perr("handle_mitm_block_auto",{root_url,tab_url,reason});_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().trace(tab_id,tab_url,"trigger mitm auto rule + popup");_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_6___default().trigger("mitm_change",root_url);yield E.be_vpn.unblock_action({url:tab_url,tab_id,mitm:true,country:"us"});_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_7___default().reload(tab_id);return}handler.enable_rule(root_url);_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().trace(tab_id,tab_url,"ignore due to dry mode");perr("handle_mitm_block_dry",{root_url,tab_url,reason})}));const SSL_ERRORS=["CERT_ERROR_IN_SSL_RENEGOTIATION","SSL_HANDSHAKE_NOT_COMPLETED","SSL_SERVER_CERT_CHANGED","CERT_COMMON_NAME_INVALID","CERT_AUTHORITY_INVALID","CERT_CONTAINS_ERRORS","CERT_INVALID"];const GEN_ERRORS=["CONNECTION_REFUSED"];const err_listener=cb_wrapper((o=>{o=o||{};const tab_id=o.tabId||o.id;const err=o.error&&o.error.split("::ERR_")[1];if(o.frameId||!tab_id||tab_id==-1||_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_6___default().is_disabled()||!err||!(SSL_ERRORS.includes(err)||GEN_ERRORS.includes(err))){return}const status_code=o.statusCode||o.http_status_code||0;const tab_url=o.url||_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_7___default().get_url(tab_id);const root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_16___default().get_root_url(tab_url);const name="mitm_"+(GEN_ERRORS.includes(err)?"gen":"cert")+"_err";_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().trace(tab_id,tab_url,"hook error init");const reason=GEN_ERRORS.includes(err)?_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().reasons.CONN_ERROR:_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().reasons.INVALID_CERT;if(!root_url||!is_unblock_allowed(tab_id,tab_url))return void _bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().trace(tab_id,tab_url,"unblock not allowed");if(!handler.is_verification_allowed(root_url,reason))return void _bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().trace(tab_id,tab_url,"mitm not allowed");perr("verify_"+name,{root_url,tab_url,reason});return _util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()((function*init_mitm_check_err_(){_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().trace(tab_id,tab_url,"get_agents country us");const country="us";const agents=yield _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_11___default().get_rule_agents({country});_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().trace(tab_id,tab_url,"call check_mitm_blocking code "+status_code+" with "+agents.length+" us agents");const rule=yield handler.verify_mitm(root_url,tab_url,agents,country,reason);if(rule&&rule.mitm_detected_ts){perr("verified_"+name,{root_url,tab_url,reason});yield handle_mitm_block(reason,root_url,tab_id,tab_url)}else perr("false_positive_"+name,{root_url,tab_url,reason})}))}));E.is_popup_needed=root_url=>{if(!handler||_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].is_dont_show(root_url)||_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_18__["default"].is_vpn_forbidden()){return}const unblock=handler.need_unblock(root_url);return unblock&&[_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().modes.AUTO,_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().modes.MANUAL].includes(unblock.mode)};E.get_rules=()=>handler&&handler.get_exposed_rules();E.get_dialog=root_url=>{if(E.is_popup_needed(root_url))return{country:"us"}};E.trace=_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().trace;let hooks_inited;const init_hooks=()=>{if(hooks_inited||_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().is_mocha())return;try{chrome.webNavigation.onErrorOccurred.addListener(err_listener)}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_2___default()("add mitm hook err: %s",e);perr("be_add_mitm_hooks_err",{},{err:e,rate_limit:{count:1}})}hooks_inited=true};const uninit_hooks=()=>{if(!hooks_inited)return;try{chrome.webNavigation.onErrorOccurred.removeListener(err_listener)}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_2___default()("rm mitm hook err: %s",e);perr("be_rm_mitm_hooks_err",{},{err:e,rate_limit:{count:1}})}hooks_inited=false};let on_conf_update=()=>{if(_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().is_enabled())init_hooks();else uninit_hooks()};let debug={cleanup_rules:()=>handler.cleanup_rules(),dump_rules:()=>console.table(Object.values(handler.rules)),test_xhr:(url,country)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()((function*(){url=url||_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_7___default().get("active.url");_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().trace("debug test_xhr call. url: "+url);country=country||"us";const agents=yield _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_11___default().get_rule_agents({country});const root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_16___default().get_root_url(url);const rule=yield handler.verify_mitm(root_url,url,agents,country);_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().trace("debug test_xhr result: "+(rule?"mitm detected":"no mitm"))}))};let handler;E.init=be_vpn=>{E.be_vpn=be_vpn;E.sp=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_14___default().new_etask("be_mitm");_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().init({conf_get:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_9___default().CG,be_util:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_9___default(),be_info:_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"],perr,now:_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_15__["default"].now,zerr:_util_zerr_js__WEBPACK_IMPORTED_MODULE_2___default(),be_ext:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_6___default(),get_uuid_md5:_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_15__["default"].get_uuid_md5,ajax_via_proxy:_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.ajax_via_proxy,storage:_util_storage_js__WEBPACK_IMPORTED_MODULE_4___default()});handler=new(_bext_vpn_bg_mitm_lib_js__WEBPACK_IMPORTED_MODULE_8___default().Handler);E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_6___default(),"change:bext_config",on_conf_update);on_conf_update();if(typeof self!=="undefined")self.mitm=debug};E.uninit=()=>{if(E.sp)E.sp.return();E.stopListening()};const __WEBPACK_DEFAULT_EXPORT__=E},2426:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){const is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(6386),__webpack_require__(5305),__webpack_require__(1291),__webpack_require__(932),__webpack_require__(6262),__webpack_require__(843)],__WEBPACK_AMD_DEFINE_RESULT__=function(etask,zurl,zutil,date,version_util,svc_vpn_util){const E={debug:{}};const assign=Object.assign;let SEC=1e3,MIN=60*SEC;let api;const def_api={conf_get:()=>{},be_info:null,be_util:null,be_ext:null,perr:(id,info,opt)=>{},now:()=>Date.now(),zerr:{notice:()=>{}}};E.reasons={UNKNOWN:"unknown",INVALID_CERT:"invalid_cert",CONN_ERROR:"conn_error",REDIRECT:"redirect",TIMEOUT:"timeout"};E.modes={DRY:"dry",MANUAL:"manual",AUTO:"auto"};const CG=(s,def)=>api.conf_get(s,def);let get_client_params=root_url=>{let now=api.now();let ext_ver=api.be_util.version();return{now,ext_ver,root_url,conf_ver:CG("version"),uuid:api.be_ext.get("uuid"),uuid_md5:api.get_uuid_md5(),browser:api.be_util.browser(),install_ver:api.be_util.install_version()||ext_ver,install_ts:api.be_util.install_ts()||now,signed_in:+!!api.be_ext.get("user_id"),is_premium:+!!api.be_ext.get("is_premium"),src_country:(api.be_info.get("country")||"").toUpperCase(),ip:(api.be_info.get("location")||{}).ip,conn:api.be_util.get_connection_type()||"eth",dev:api.be_util.get_device_type()}};const query_conf=root_url=>{let res={};let client_params=get_client_params(root_url);let conf=CG("mitm2.rules")||[];for(let c of conf){if(!c.conf||!svc_vpn_util.match_filter(client_params,c.filter))continue;let{reasons}=res;assign(res,c.conf);if(c.conf.reasons)res.reasons=assign({},reasons,c.conf.reasons)}return res};const CGM=(root_url,path,def)=>zutil.get(query_conf(root_url),path,def);E.is_inside_popup_allowed=root_url=>CGM(root_url,"inside_popup");E.is_enabled=()=>{if(CG("debug.mitm2"))return true;return svc_vpn_util.check_min_ver(api.be_util.version(),CG("mitm2.min_ver"))};let _timeline;E.get_timeline=()=>{if(!_timeline||!CG("mitm2.trace.add_to_perr"))return;return _timeline.log.map((l=>date.to_sql(l.ts)+": "+l.msg)).join("\n")};E.trace=function(tab_id,tab_url,str){let msg;if(arguments.length==1)msg=tab_id;else msg=`tab_id: ${tab_id}, tab_url: ${tab_url}: ${str}`;let tconf=CG("mitm2.trace",{});if(tconf.print_to_logs)api.zerr.notice(msg);if(!tconf.add_to_perr)return;if(!_timeline)_timeline={log:[]};_timeline.log.push({ts:api.now(),msg});let max_size=tconf.max_size||500;if(max_size<_timeline.log.length)_timeline.log=_timeline.log.slice(max_size>>1)};let xhr_test=(url,opt)=>etask((function*xhr_test_(){let timeout=3*SEC;let ajax_opt=assign({force:opt.agent?"proxy":"direct",always:true,hdrs_abort:true,ignore_redir:true,force_headers:true,fix_307:true,prot:opt.agent&&"proxy",src:"bg_ajax",hdrs:{"Cache-Control":"no-cache,"+"no-store,must-revalidate,max-age=-1"},timeout},opt);E.trace("ajax to "+url);let resp,ts=api.now();try{resp=yield api.ajax_via_proxy({url,type:"GET"},ajax_opt)}catch(e){if(/timeout/.test(e))resp={orig_res:{error:"timeout"}}}let ret=resp&&resp.orig_res||{error:"ajax failed"};let status_code=ret.statusCode!=undefined?ret.statusCode:ret.code;delete ret.body;E.trace("resp "+(ret.error||status_code)+" after "+(api.now()-ts)+"ms");return status_code==200||status_code==301}));const get_reason_mode=(root_url,reason)=>{if(CG("debug.mitm2_auto"))return E.modes.AUTO;if(CG("debug.mitm2_manual"))return E.modes.MANUAL;const reason_conf=CGM(root_url,["reasons",reason]);if(!reason_conf||!reason_conf.enable)return;return reason_conf.mode||E.modes.DRY};class Handler{constructor(){this.rules={};const stored_rules=api.storage&&api.storage.get_json("mitm2_rules");if(stored_rules){for(let root_url in stored_rules)this.init_rule(root_url,stored_rules[root_url])}this.running_verifications={}}store(){if(!api.storage)return;api.storage.set_json("mitm2_rules",this.rules)}cleanup_rules(){api.storage.set_json("mitm2_rules",null);this.rules={};E.trace("cleanup rules")}init_rule(root_url,rule){rule=rule||{};let now=api.now();return this.rules[root_url]={root_url:root_url||rule.root_url,ver:rule.ver||api.be_util.version(),ts:rule.ts||now,reason:rule.reason||E.reasons.UNKNOWN,mode:rule.mode||E.modes.DRY,ignored_ts:rule.ignored_ts||null,enabled_ts:rule.enabled_ts||null,mitm_detected_ts:rule.mitm_detected_ts||null}}get_rule(root_url){let rule=this.rules[root_url];if(!rule||rule.ts<CG("mitm2.rule_min_ts"))return;const reason_mode=get_reason_mode(root_url,rule.reason);if(!reason_mode)return;if(reason_mode!=E.modes.DRY&&(!rule.mode||rule.mode==E.modes.DRY))return;return rule}get_exposed_rules(){let min_ts=CG("mitm2.rule_min_ts")||0;return Object.values(this.rules).filter((rule=>min_ts<rule.ts&&rule.mode&&rule.mode!=E.modes.DRY))}enable_rule(root_url){let rule=this.get_rule(root_url);if(!rule)return;rule.ignored_ts=null;rule.enabled_ts=api.now();this.store()}ignore_rule(root_url){let rule=this.get_rule(root_url);if(!rule)return;rule.ignored_ts=api.now();rule.enabled_ts=null;this.store()}need_unblock(root_url){if(!E.is_enabled())return;let rule=this.get_rule(root_url);if(!rule||!rule.mitm_detected_ts||rule.ignored_ts||rule.enabled_ts){return}const mode=get_reason_mode(root_url,rule.reason);return mode?{mode}:null}is_verification_allowed(root_url,reason){if(!E.is_enabled())return;if(this.running_verifications[root_url])return;let conf=CGM(root_url,"");if((conf.exclude_sites||[]).includes(root_url))return;const reason_mode=get_reason_mode(root_url,reason);if(!reason_mode)return;let rule=this.get_rule(root_url);if(rule&&rule.last_verification_ts)return;return true}verify_mitm(root_url,tab_url,agents,country,reason){let _this=this;return etask((function*(){if(_this.running_verifications[root_url])return this.wait_ext(_this.running_verifications[root_url]);let rule=_this.get_rule(root_url);if(!rule)rule=_this.init_rule(root_url);_this.running_verifications[root_url]=this;this.finally((()=>{_this.running_verifications[root_url]=null}));rule.last_verification_ts=api.now();rule.mode=get_reason_mode(root_url,reason);_this.store();for(let agent of agents){if(yield xhr_test(tab_url,{agent,country})){rule.reason=reason||E.reasons.UNKNOWN;rule.mitm_detected_ts=api.now();_this.store();return rule}}}))}}E.Handler=Handler;E.init=_api=>{api=assign({},def_api,_api)};E.t={};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},1002:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_1__);var _bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(737);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3__);var _util_storage_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1032);var _util_storage_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_util_storage_js__WEBPACK_IMPORTED_MODULE_4__);var _util_date_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_5__);
// LICENSE_CODE ZON
let be_bg_main=self.be_bg_main;const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0___default().task_model.extend({model_name:"mode",_defaults:function(){this.on("destroy",(()=>E.uninit()))}}));function update_pending(new_mode,change){var last_mode=_util_storage_js__WEBPACK_IMPORTED_MODULE_4___default().get("last_mode"),pending;if(new_mode=="ext"&&last_mode)pending=last_mode;if(pending==E.get("pending"))return;change.pending=pending;_util_zerr_js__WEBPACK_IMPORTED_MODULE_1___default().info("pending mode set to "+pending)}let disconnections=[],ignore_svc;function maybe_ignore_svc(){if(_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_2__["default"].get("proxyjs_connected")||E.get("mode")!="exe")return;disconnections.push(_util_date_js__WEBPACK_IMPORTED_MODULE_5___default()());disconnections=disconnections.slice(-2);if(disconnections.length==2&&Date.now()-disconnections[0]<_util_date_js__WEBPACK_IMPORTED_MODULE_5___default().ms.SEC*10){_util_zerr_js__WEBPACK_IMPORTED_MODULE_1___default().info("Too frequent disconnections - ignoring svc");ignore_svc=true}}function is_svc_connected(){return _bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_2__["default"].get("proxyjs_connected")}function update_mode(){var new_mode=is_svc_connected()&&!ignore_svc?"exe":"ext";var change={},mode_changed;if(new_mode!=E.get("mode"))mode_changed=true;maybe_ignore_svc();update_pending(new_mode,change);Object.assign(change,{mode:new_mode,is_svc:new_mode!="ext",is_ext:new_mode=="ext","svc.detected":!!_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_2__["default"].get("version"),"svc.hola_svc_detected":!!_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_2__["default"].get("is_hola_svc"),"svc.version":_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_2__["default"].get("version"),"svc.appid":_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_2__["default"].get("appid"),"svc.campaign":_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_2__["default"].get("campaign"),"svc.uuid":_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_2__["default"].get("uuid"),"svc.info":_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_2__["default"].get("info"),"svc.callback_raw":_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_2__["default"].get("callback_raw"),"svc.callback_ts":_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_2__["default"].get("callback_ts")});if(mode_changed)change.ts=Date.now();E.safe_set(change);be_bg_main.safe_set(change);if(!mode_changed)return;if(new_mode!="ext")_util_storage_js__WEBPACK_IMPORTED_MODULE_4___default().set("last_mode",new_mode);_util_zerr_js__WEBPACK_IMPORTED_MODULE_1___default().info("mode set to "+new_mode);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().perr("mode_change",{new_mode,proxyjs_connected:_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_2__["default"].get("proxyjs_connected")});E.set("mode_change_count",(E.get("mode_change_count")||0)+1)}E.init=()=>{be_bg_main=self.be_bg_main;E.listenTo(_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_2__["default"],"all",update_mode);update_mode()};E.uninit=()=>{E.stopListening();E.clear()};const __WEBPACK_DEFAULT_EXPORT__=E},7957:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_1__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2__);var _bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1225);var _bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_3__);var _util_url_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5305);var _util_url_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_util_url_js__WEBPACK_IMPORTED_MODULE_4__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5__);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6__);var underscore__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(8763);var underscore__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_7__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_8__);var _util_date_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_9__);var _util_util_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_10__);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(843);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_11__);var _bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(1679);var _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(9651);var conf__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(9641);
// LICENSE_CODE ZON
const v3=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().is_v3;const ff_webext=conf__WEBPACK_IMPORTED_MODULE_14__.firefox_web_ext;let chrome,is_etask_perf_on,bext_config={};const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0___default().task_model.extend({model_name:"pac",_defaults:function(){this.stats={total:0,slow:{}};this.on("destroy",(()=>E.uninit()))}}));function get_hola_domains(){return _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_13__.Z.hola_domains.concat(_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().hola_browser_internal_domains)}function update_config(){bext_config=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2___default().get("bext_config")||{};is_etask_perf_on=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2___default().get("gen.is_etask_perf_on");if(is_etask_perf_on&&!_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default().perf())_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default().perf(true);if(!is_etask_perf_on&&_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default().perf())_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default().perf(false)}function on_debug_pac(){let on=_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_12__["default"].get("debug_pac");_util_zerr_js__WEBPACK_IMPORTED_MODULE_8___default().notice("virtual pac %s",on?"on":"off");if(on)_bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_3___default().init({key:E.pac_key,hola_domains:get_hola_domains()});else _bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_3___default().t.reset()}E.init=()=>{if(E.inited)return;chrome=self.chrome;E.sp=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().new_etask("be_pac");E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2___default(),"change:bext_config",update_config);E.listen_to(_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_12__["default"],"change:debug_pac",on_debug_pac);monitor_init();update_config();E.inited=true};var monitor_init=period=>{var first_reported,prev_slow,start=Date.now();if(E.timer)E.timer=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().clear_timeout(E.timer);var reset=(cb,keep_stats)=>{if(!keep_stats){if(is_etask_perf_on)_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default().perf_stat={};E.stats={total:0,slow:{}}}first_reported=true;start=Date.now();if(cb)E.timer=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().set_timeout(cb,_util_date_js__WEBPACK_IMPORTED_MODULE_9___default().ms.HOUR,{sp:E.sp})};E.timer=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().set_timeout((function pac_slow(){var ts=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2___default().get("last_install_ts")||_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2___default().get("update_ts");if(!first_reported&&ts!=self.hola.t.l_start)return reset(pac_slow,true);var send;for(var src in E.stats.slow){if(E.stats.slow[src]["100"]||E.stats.slow[src]["1000"]){send=true;break}}if(!prev_slow&&send){var info=Object.assign({period:Date.now()-start},E.stats);if(is_etask_perf_on)info.etask_perf_stat=_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default().perf_stat;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().perr("be_tab_unblocker_slow",_util_zerr_js__WEBPACK_IMPORTED_MODULE_8___default().json(info))}prev_slow=send;reset(pac_slow)}),period||5*_util_date_js__WEBPACK_IMPORTED_MODULE_9___default().ms.MIN,{sp:E.sp})};E.uninit=()=>{E.inited=false;E.timer=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().clear_timeout(E.timer);E.sp.return();E.stopListening()};function get_pac_scope(){if(chrome&&chrome.extension&&chrome.extension.inIncognitoContext)return"incognito_session_only";return"regular_only"}function err_cb(err){let{details,error}=err||{};if(error=="net::ERR_PROXY_CONNECTION_FAILED"&&!details)return;if(error=="net::ERR_PAC_SCRIPT_FAILED"){let m;if(m=(""+details).match(/Uncaught Error: init_ts ([0-9]+)/)){E.pac_engine_init_ts=+m[1];return _util_zerr_js__WEBPACK_IMPORTED_MODULE_8___default().notice("pac_engine init_ts %s",E.pac_engine_init_ts)}if(m=(""+details).match(/Uncaught Error: pac_auto_reload init ts mismatch/)){_util_zerr_js__WEBPACK_IMPORTED_MODULE_8___default()("pac_engine auto_reloaded detected on init");_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2___default().trigger("pac_reload");reset_pac_file();_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().push_event("pac_reload",{init_ts:E.pac_engine_init_ts,new_ts:+m[1]});return}if(m=(""+details).match(/Uncaught Error: pac_auto_reload init_ts ([0-9]+)/)){if(E.pac_engine_init_ts==m[1])return;_util_zerr_js__WEBPACK_IMPORTED_MODULE_8___default()("pac_engine auto_reloaded detected init_ts %s -> %s",new Date(E.pac_engine_init_ts),new Date(+m[1]));_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2___default().trigger("pac_reload");_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().push_event("pac_reload",{init_ts:E.pac_engine_init_ts,new_ts:+m[1]});_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().perr("pac_engine_auto_reload",{error,details,init_ts:E.pac_engine_init_ts,new_ts:m[1]},{err,rate_limit:{count:3}});E.pac_engine_init_ts=+m[1];if(_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_12__["default"].get("debug_pac")||v3)_bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_3___default().t.reset();return}if(/Uncaught Error: pac_get_log /.test(details)||/Uncaught Error: pac_dump /.test(details)){_util_zerr_js__WEBPACK_IMPORTED_MODULE_8___default()("proxy error %s %o %s",error,err,(""+details).replace(/\\n/g,"\n"));return}if(/Uncaught Error: pac_get_last_proxied_hosts /.test(details))return}send_proxy_error_perr(err)}const get_last_proxied_hosts=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()((function*(){const on_err=err=>{let{details}=err||{};if(!details)return;let m=details.match(/pac_get_last_proxied_hosts <(.*)>/);if(m&&m[1])this.continue(JSON.parse(m[1]))};this.finally((()=>chrome.proxy.onProxyError.removeListener(on_err)));chrome.proxy.onProxyError.addListener(on_err);fetch("http://__hola__.pac_get_last_proxied_hosts.local.hola/",{method:"POST"}).catch((()=>{}));return yield this.wait(10*_util_date_js__WEBPACK_IMPORTED_MODULE_9___default().ms.SEC)}));const send_proxy_error_perr=err=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()((function*(){const{details,error}=err||{};let last_proxied_hosts;try{last_proxied_hosts=yield get_last_proxied_hosts()}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_8___default()(e)}_util_zerr_js__WEBPACK_IMPORTED_MODULE_8___default()("proxy error %s %o %s %o",error,err,(""+details).replace(/\\n/g,"\n"),last_proxied_hosts);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().perr("proxy_error",{error,details,last_proxied_hosts,agent_fallback_rule:_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_13__.Z.get_agent_fallback_rule(),active_rules:E.active_rules},{rate_limit:{count:3}})}));E.ajax_get_pac_init_ts=()=>{let url="http://__hola__.pac_get_init_ts.local.hola/?rnd="+Math.random();fetch(url,{method:"POST"}).catch((()=>{}))};let set_pac=script=>{E.has_pac=!!script;const scope=get_pac_scope();if(_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().is_mocha())return;return _util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()((function*set_pac_(){try{chrome.proxy.onProxyError.removeListener(err_cb);E.pac_engine_init_ts=0;if(script){chrome.proxy.onProxyError.addListener(err_cb);yield _util_etask_js__WEBPACK_IMPORTED_MODULE_1___default().cb_apply(chrome.proxy.settings,".set",[{scope,value:{mode:"pac_script",pacScript:{data:script}}}]);E.ajax_get_pac_init_ts()}else{yield _util_etask_js__WEBPACK_IMPORTED_MODULE_1___default().cb_apply(chrome.proxy.settings,".clear",[{scope}])}}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().perr("set_pac_err",{},{err:e,rate_limit:{count:1}})}}))};function check_need_ext_settings(){return(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2___default().get("has_active_rules")||_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_13__.Z.get("need_pac"))&&!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2___default().is_disabled()}const gen_pac_script_str=options=>{let res="var pac_engine = ("+_bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_3___default().module_fn+")();\n"+"pac_engine.init("+JSON.stringify(options)+");\n"+"function FindProxyForURL(url, host){\n"+"    return pac_engine.FindProxyForURL(url, host); }\n";if(v3){let json1=JSON.stringify(E.rules_map);let json2=JSON.stringify(E.active_rules);res+=`pac_engine.set_v3_rules(${json1}, ${json2})\n`}return res};const reset_pac_file=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()((function*(){E.has_pac=false;return yield E.update_pac_file_state()}));E.add_active_rule=root_url=>{E.active_rules=E.active_rules||[];if(E.active_rules.includes(root_url))return;E.active_rules.push(root_url);_util_zerr_js__WEBPACK_IMPORTED_MODULE_8___default().notice(`add tab rule ${root_url}`);return set_pac_rule({cmd:"add_active_rule",key:E.pac_key,opt:{root_url}})};E.del_active_rule=root_url=>{E.active_rules=E.active_rules||[];let index=E.active_rules.indexOf(root_url);if(index<0)return;E.active_rules.splice(index,1);_util_zerr_js__WEBPACK_IMPORTED_MODULE_8___default().notice(`del tab rule ${root_url}`);return set_pac_rule({cmd:"del_active_rule",key:E.pac_key,opt:{root_url}})};E.add_v3_rule=(root_url,host,cmd)=>{E.rules_map=E.rules_map||{};E.rules_map[root_url]=E.rules_map[root_url]||{};if(E.rules_map[root_url][host]==cmd)return;E.rules_map[root_url][host]=cmd;_util_zerr_js__WEBPACK_IMPORTED_MODULE_8___default().notice(`add manifest v3 rule ${root_url} ${host} ${cmd}`);return set_pac_rule({cmd:"add_v3_rule",key:E.pac_key,opt:{root_url,host,cmd}})};E.set_v3_rules=(rules_map,active_rules)=>{if(_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().equal_deep(E.rules_map||{},rules_map||{})&&_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().equal_deep(E.active_rules||[],active_rules||[])){return}E.rules_map=rules_map;E.active_rules=active_rules;_util_zerr_js__WEBPACK_IMPORTED_MODULE_8___default().notice("set manifest v3 rules");return E.update_pac_file_state(true)};E.find_proxy=(url,skip_default)=>_bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_3___default().FindProxyForURL(url,_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().get_host(url),skip_default);E.update_pac_file_state=force=>{if(ff_webext)return;var need_pac=check_need_ext_settings();if(!force&&!!E.has_pac==!!need_pac)return;_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2___default().trigger("pac_init");if(!need_pac){if(_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_12__["default"].get("debug_pac")||v3)_bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_3___default().t.reset();return set_pac(null)}var arr=new Uint8Array(32),key="";self.crypto.getRandomValues(arr);underscore__WEBPACK_IMPORTED_MODULE_7___default().each(arr,(a=>{key+=a.toString(16)}));E.pac_key=key;var options={key:E.pac_key,hola_domains:get_hola_domains()};if(!bext_config.disable_pac_engine_auto_reload_init)options.set_ts=Date.now();var et=set_pac(gen_pac_script_str(options));if(_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_12__["default"].get("debug_pac")||v3){_bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_3___default().init(options);_bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_3___default().set_v3_rules(_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().clone_deep(E.rules_map),_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().clone_deep(E.active_rules))}return et};function hex_encode(s){let h="";for(let i=0;i<s.length;i++)h+=s.charCodeAt(i).toString(16);return h}const get_rule_url=rule=>{let prefix=hex_encode(JSON.stringify(rule));return"http://__hola__.set."+prefix+".local.hola/"};const set_pac_rule=v3?(rule,opt)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()({cancel:true},(function*_set_pac_rule(){let controller=new self.AbortController;this.finally((()=>controller.abort()));opt=opt||{};let dur,url=get_rule_url(rule);E.stats.total++;const t0=Date.now();try{if(_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_12__["default"].get("debug_pac")||v3){try{_bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_3___default().FindProxyForURL(url,_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().get_host(url))}catch(err){}}fetch(url,{method:"POST",signal:controller.signal}).catch((()=>this.continue())).then((()=>this.continue()));yield this.wait(20*_util_date_js__WEBPACK_IMPORTED_MODULE_9___default().ms.SEC)}catch(err){}if((dur=Date.now()-t0)>10){let s,src="async_"+(opt.src||"idle");if(!(s=E.stats.slow[src]))s=E.stats.slow[src]={10:0,100:0,1e3:0,max:0};s[dur>1e3?"1000":dur>100?"100":"10"]++;s.max=Math.max(dur,s.max)}})):(rule,opt)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()({cancel:true},(function*_set_pac_rule(){this.finally((()=>{if(!xhr)return;xhr.abort();xhr.onload=xhr.onabort=xhr.onerror=null}));opt=opt||{};let dur,xhr=new XMLHttpRequest;let url=get_rule_url(rule);xhr.open("POST",url,opt.async||_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().is_mocha());E.stats.total++;const t0=Date.now();if(opt.async)xhr.onload=xhr.onabort=xhr.onerror=()=>this.continue();try{if(_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_12__["default"].get("debug_pac")){try{_bext_vpn_bg_pac_engine_js__WEBPACK_IMPORTED_MODULE_3___default().FindProxyForURL(url,_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().get_host(url))}catch(err){}}xhr.send(null);if(opt.async)yield this.wait(20*_util_date_js__WEBPACK_IMPORTED_MODULE_9___default().ms.SEC)}catch(err){}if((dur=Date.now()-t0)>10){let s,src=(opt.async?"async_":"")+(opt.src||"idle");if(!(s=E.stats.slow[src]))s=E.stats.slow[src]={10:0,100:0,1e3:0,max:0};s[dur>1e3?"1000":dur>100?"100":"10"]++;s.max=Math.max(dur,s.max);if(!opt.async&&dur>100){_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().push_event("pac_slow",{url:rule.set,set_url:url,dur})}}}));E.unset_proxy_for_host=(host,opt)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()({cancel:true},(function*unset_proxy_for_host(){if(!E.pac_key)return;let rule={unset:host,key:E.pac_key};if(!_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().is_mocha()&&E.pac_engine_init_ts)rule.init_ts=E.pac_engine_init_ts;yield set_pac_rule(rule,opt)}));E.set_proxy_for_host=(host,proxy_str,deadline_ts,opt)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()({cancel:true},(function*set_proxy_for_host(){if(!E.pac_key)return;var n=proxy_str.split(" ");if(n.length<2||!{PROXY:1,SOCKS:1,SOCKS5:1,HTTPS:1}[n[0]])proxy_str="DIRECT";let rule={proxy:proxy_str,set:host,key:E.pac_key,d_ts:deadline_ts};if(_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().is_mocha())delete rule.d_ts;if(!_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().is_mocha()&&E.pac_engine_init_ts)rule.init_ts=E.pac_engine_init_ts;yield set_pac_rule(rule,opt)}));const __WEBPACK_DEFAULT_EXPORT__=E},1225:(module,exports)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function module_fn(){var E={module_fn},g_pac_engine={},g_log=[],local_redir;var regex_url2host=/^(?:https?|wss?):\/\/([^\/]+)/;var regex_local_cmd_host=/^__hola__\.set\.(.*)\.local\.hola$/;var regex_hola_trigger=/^([-\w]+)-(\d+)\.(\w+)\.trigger\.hola\.org$/;var TEMP_ACTIVE_TTL=1e3,v3_temp_active={};var v3_all_tab_rules={},v3_active_tabs=[],v3_hosts_map;var last_proxied_hosts=[];function reset(){local_redir={rules:{},counter:0};v3_all_tab_rules={};v3_active_tabs=[];v3_temp_active={};v3_hosts_map=undefined}function log(s){var text=(new Date).toISOString()+" "+s;if(typeof alert!="undefined")alert(text);if(typeof console!="undefined")console.log(s);g_log.push(text);if(g_log.length>256)g_log.splice(0,g_log.length/2)}function pac_dump(){var str="";str+="init_ts: "+g_pac_engine.init_ts+"\n";str+="g_pac_engine:\n";try{str+=JSON.stringify(g_pac_engine)}catch(e){str+=e}str+="\nlocal_redir:\n";str+="  counter: "+local_redir.counter+"\n";str+="  rules:\n";for(var host in local_redir.rules){var rule=local_redir.rules[host];var ttl=rule.deadline_ts-Date.now();if(ttl>0)str+="    "+host+": "+rule.proxy+" (ttl "+(ttl/1e3|0)+"s)\n"}return str}function hex_decode(h){var s="";for(var i=0;i<h.length;i+=2)s+=String.fromCharCode(parseInt(h.substr(i,2),16));return s}function add_local_rule(host,proxy,deadline_ts){var cur_ts=Date.now(),entry=local_redir.rules[host];if(!entry||entry.proxy!=proxy)entry=local_redir.rules[host]={proxy};entry.deadline_ts=deadline_ts||cur_ts+6e4;local_redir.counter++;if(local_redir.counter>1e3){for(var i in local_redir.rules){var local=local_redir.rules[i];if(local.deadline_ts<cur_ts)delete local_redir.rules[i]}local_redir.counter=0}}function url2host(url){var n=url.match(regex_url2host);return n?n[1]:url}function get_local_rule(url){var host=url2host(url),rule=local_redir.rules[host];if(!rule)return;if(rule.deadline_ts<Date.now())return void delete local_redir.rules[host];return rule.proxy}function init_hola_domains_re(hola_domains){var domains=hola_domains.join("|").replace(/\./g,"\\.");return new RegExp("^(.*\\.)?("+domains+")$")}var hola_domain_re;function is_ip(host){var m=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/.exec(host);if(!m)return false;for(var i=1;i<=4;i++){if(+m[i]>255)return false}return true}function convert_addr(ipchars){var bytes=ipchars.split(".");var result=(bytes[0]&255)<<24|(bytes[1]&255)<<16|(bytes[2]&255)<<8|bytes[3]&255;return result>>>0}function is_in_net(ipaddr,pattern,maskstr){var test=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/.exec(ipaddr);if(!test||test[1]>255||test[2]>255||test[3]>255||test[4]>255)return false;var host=convert_addr(ipaddr);var pat=convert_addr(pattern);var mask=convert_addr(maskstr);return(host&mask)==(pat&mask)}function is_private_network(hostname){if(!hostname.includes("."))return true;if(!is_ip(hostname))return false;return is_in_net(hostname,"10.0.0.0","255.0.0.0")||is_in_net(hostname,"172.16.0.0","255.240.0.0")||is_in_net(hostname,"192.168.0.0","255.255.0.0")||is_in_net(hostname,"127.0.0.0","255.0.0.0")}var generic_2ld={com:1,biz:1,net:1,org:1,xxx:1,edu:1,gov:1,ac:1,co:1,or:1,ne:1,kr:1,jp:1,jpn:1,cn:1};function get_root_domain(domain){if(is_ip(domain))return domain;var s=domain.split("."),root=s,len=s.length;if(len>2){if(generic_2ld[s[len-2]])root=s.slice(-3,len);else root=s.slice(-2,len)}return root.join(".")}function get_global_rule(host,skip_default){if(!v3_hosts_map)return null;if(is_private_network(host)||host.match(hola_domain_re))return"DIRECT";if(is_ip(host))return v3_hosts_map[host]||v3_hosts_map.default;add_temp_active_rule(get_root_domain(host));var index=-1;for(;;){var rule;if(rule=v3_hosts_map[host.substr(index+1)])return rule;if((index=host.indexOf(".",index+1))<0)break}return skip_default?null:v3_hosts_map.default}function local_hola_handler(hex_payload){var msg;try{msg=JSON.parse(hex_decode(hex_payload))}catch(e){}if(!msg||msg.key!=g_pac_engine.key)return"DIRECT";if(msg.unset)delete local_redir.rules[msg.unset];else if(msg.cmd=="add_active_rule")E.add_active_rule(msg.opt);else if(msg.cmd=="del_active_rule")E.del_active_rule(msg.opt);else if(msg.cmd=="add_v3_rule")E.add_v3_rule(msg.opt);else add_local_rule(msg.set,msg.proxy,msg.d_ts);if(msg.init_ts&&g_pac_engine.init_ts!=msg.init_ts)throw new Error("pac_auto_reload init_ts "+g_pac_engine.init_ts);return"PROXY 127.0.0.1:0"}E.init=function(options){options=options||{};hola_domain_re=init_hola_domains_re(options.hola_domains||[]);g_pac_engine={init_ts:Date.now(),key:options.key};reset();if(options.set_ts&&options.set_ts+3e3<g_pac_engine.init_ts)throw new Error("pac_auto_reload init ts mismatch")};function merge_hosts_map(hosts_map){for(var key in hosts_map){if(!v3_hosts_map[key]||hosts_map[key]!="DIRECT")v3_hosts_map[key]=hosts_map[key]}}function update_hosts_map(){if(!v3_all_tab_rules||!v3_active_tabs)return v3_hosts_map=null;v3_hosts_map={};var now=Date.now(),i;for(i=0;i<v3_active_tabs.length;i++)merge_hosts_map(v3_all_tab_rules[v3_active_tabs[i]]);var temp_active=Object.keys(v3_temp_active);for(i=0;i<temp_active.length;i++){var root_url=temp_active[i];if(now-v3_temp_active[root_url]<TEMP_ACTIVE_TTL&&!v3_hosts_map[root_url]){merge_hosts_map(v3_all_tab_rules[root_url])}}}E.set_v3_rules=function(rules_map,active_rules){v3_all_tab_rules=rules_map||{};v3_active_tabs=active_rules||[];update_hosts_map()};E.add_active_rule=function(opt){var root_url=opt.root_url;if(v3_active_tabs.includes(root_url)||!v3_all_tab_rules[root_url])return;delete v3_temp_active[root_url];v3_active_tabs.push(root_url);update_hosts_map()};E.del_active_rule=function(opt){var root_url=opt.root_url;var index=v3_active_tabs.indexOf(root_url);if(index<0)return;delete v3_temp_active[root_url];v3_active_tabs.splice(index,1);update_hosts_map()};function add_temp_active_rule(root_url){if(v3_active_tabs.includes(root_url)||!v3_all_tab_rules[root_url])return void update_temp_active_rules();v3_temp_active[root_url]=Date.now();update_hosts_map()}function update_temp_active_rules(){var temp_active=Object.keys(v3_temp_active);var now=Date.now();var changed;for(var i=0;i<temp_active.length;i++){var root_url=temp_active[i];if(now-v3_temp_active[root_url]>TEMP_ACTIVE_TTL){delete v3_temp_active[root_url];changed=true}}if(changed)update_hosts_map()}E.add_v3_rule=function(opt){var root_url=opt.root_url,host=opt.host,cmd=opt.cmd;v3_all_tab_rules[root_url]=v3_all_tab_rules[root_url]||{};v3_all_tab_rules[root_url][host]=cmd};function handle_debug(host){switch(host){case"__hola__.pac_get_init_ts.local.hola":throw new Error("init_ts "+g_pac_engine.init_ts);case"__hola__.pac_dump.local.hola":throw new Error("pac_dump "+pac_dump());case"__hola__.pac_get_log.local.hola":throw new Error("pac_get_log ["+g_log.join("\n")+"]");case"__hola__.pac_get_last_proxied_hosts.local.hola":throw new Error("pac_get_last_proxied_hosts <"+JSON.stringify(last_proxied_hosts)+">")}}function log_host(host){var i=last_proxied_hosts.indexOf(host);if(i!=-1)last_proxied_hosts.splice(i,1);last_proxied_hosts.unshift(host);if(last_proxied_hosts.length>10)last_proxied_hosts.pop()}E.FindProxyForURL=function(url,host,skip_default){var m;if(host[0]=="_"){m=host.match(regex_local_cmd_host);if(m)return local_hola_handler(m[1]);handle_debug(host)}if(host.endsWith("trigger.hola.org")){m=host.match(regex_hola_trigger);if(m){log_host(host);return"HTTPS "+m[1].replace(/_/g,".")+":"+m[2]}}var proxy=get_local_rule(url)||get_global_rule(host,skip_default)||!skip_default&&"DIRECT";if(proxy!="DIRECT")log_host(host);return proxy};E.t={local_redir:function(){return local_redir},reset};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},9265:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var conf__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9641);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_2__);var _util_date_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_3__);var _util_escape_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(4336);var _util_escape_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_util_escape_js__WEBPACK_IMPORTED_MODULE_4__);var _util_url_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(5305);var _util_url_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_util_url_js__WEBPACK_IMPORTED_MODULE_5__);var _svc_account_pub_membership_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6467);var _svc_account_pub_membership_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_svc_account_pub_membership_js__WEBPACK_IMPORTED_MODULE_6__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8__);var _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(9651);var _util_util_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_10__);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11__);var _bext_vpn_util_no_log_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(2181);var _util_version_util_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(6262);var _util_version_util_js__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(_util_version_util_js__WEBPACK_IMPORTED_MODULE_13__);var _bext_vpn_bg_force_lib_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(7310);var _bext_vpn_bg_force_lib_js__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(_bext_vpn_bg_force_lib_js__WEBPACK_IMPORTED_MODULE_14__);var _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(6210);var _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(8552);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(4130);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_17__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_18__);var _util_storage_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(1032);var _util_storage_js__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(_util_storage_js__WEBPACK_IMPORTED_MODULE_19__);var _pub_state_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(7619);
// LICENSE_CODE ZON
_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().assert_bg("be_premium");const chrome=self.chrome,assign=Object.assign;const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default().task_model.extend({model_name:"premium",_defaults:function(){this.on("destroy",(()=>E.uninit()))}}));let membership_timeout,daily_refresh_timer,state;E.is_active=()=>_svc_account_pub_membership_js__WEBPACK_IMPORTED_MODULE_6___default().is_active(E.get("membership"));E.is_ultra=()=>_svc_account_pub_membership_js__WEBPACK_IMPORTED_MODULE_6___default().is_ultra(E.get("membership"));E.is_paid=()=>_svc_account_pub_membership_js__WEBPACK_IMPORTED_MODULE_6___default().is_paid(E.get("membership"));E.is_dunning=()=>{const m=E.get("membership");return m&&m.dunning&&m.reason&&!_util_storage_js__WEBPACK_IMPORTED_MODULE_19___default().get("dunning_completed")};E.logout_user=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*logout_user(){E.be_rule.disable_premium();yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_9__.Z.hola_api_call("users/logout/inline",{method:"POST",text:true});set_user(null);E.set("membership",null);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().set("is_premium",false);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().set("is_ultra",false)}));const set_user=user=>{_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().set("user_id",_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().get(user,"user._id",""));_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().set("hola_uid",_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().get(user,"user.hola_uid"));_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().set("pap_a_aid",_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().get(user,"user.pap.a_aid"));E.set("user",user&&user.user);state.set("user",user);if(!user)E.be_rule.disable_trial_on_logout()};const update_uuid_info=is_init=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*_update_uuid_info(){try{let url=conf__WEBPACK_IMPORTED_MODULE_0__.url_ccgi+"/get_uuid_info";let qs=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().auth();let uuid_info=is_init?state.get("uuid_info"):null;if(!uuid_info){uuid_info=yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_9__.Z.ccgi_ajax({url,qs});state.set("uuid_info",uuid_info)}_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().set("uuid_info",uuid_info);yield _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_16__["default"].verify_install_ts(uuid_info)}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_18___default().warn("update_uuid_info failed %s",_util_zerr_js__WEBPACK_IMPORTED_MODULE_18___default().e2s(e))}}));var last_refreshed=0;E.refresh_user=opt=>{opt=assign({},opt);let is_init=opt.reason=="init";let user_id=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().get("user_id");var now;_util_zerr_js__WEBPACK_IMPORTED_MODULE_18___default().notice("be_premium: refresh_user %O",opt);if((now=Date.now())-last_refreshed<300){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("refresh_user_multiple",{user_id},{rate_limit:{count:2},err:new Error,with_log:true})}last_refreshed=now;if(refresh_user_et)refresh_user_et.return();_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().clear_timeout(membership_timeout);return _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({name:"refresh_user",cancel:true},(function*(){try{let _user=is_init?state.get("user"):null;_user=_user||(yield _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_15__["default"].get_user_data({data:{uuid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().get("uuid"),source:"be_premium"}}));let _membership=is_init?state.get("membership"):null;if(user_id!=_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().get(_user,"user._id")||opt.force_premium){_membership=_membership||(yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_9__.Z.hola_api_call("users/payment/get_membership?ver="+_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().version()))}else _membership=yield E.get("membership");yield update_uuid_info(is_init);const old_is_active=E.is_active();E.set("membership",_membership);state.set("membership",_membership);let is_active=E.is_active();_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().set("is_premium",is_active);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().set("is_ultra",E.is_ultra());let pro_grace_period_ts=_membership&&_membership.pro_grace_period_ts;_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().set("is_pro_grace_period",pro_grace_period_ts&&now<pro_grace_period_ts);set_user(_user);_bext_vpn_util_no_log_js__WEBPACK_IMPORTED_MODULE_12__["default"].set_plus(is_active);if(!is_active&&old_is_active)E.be_rule.disable_premium();else if(is_active&&!old_is_active)E.be_rule.disable_stubs();let end_date=_svc_account_pub_membership_js__WEBPACK_IMPORTED_MODULE_6___default().get_end_date(_membership);let end_ts=end_date&&end_date.getTime()||0;let ms_left=end_ts-_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_16__["default"].now();if(ms_left>0&&ms_left<_util_date_js__WEBPACK_IMPORTED_MODULE_3___default().ms.DAY){_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().clear_timeout(membership_timeout);membership_timeout=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().set_timeout((()=>E.sp.spawn(E.refresh_user({force_premium:true}))),ms_left)}return _membership}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("refresh_user_fail",{},{err:e});_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().clear_timeout(membership_timeout);membership_timeout=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().set_timeout((()=>E.sp.spawn(E.refresh_user(opt))),Math.random()*_util_date_js__WEBPACK_IMPORTED_MODULE_3___default().ms.HOUR)}finally{if(!E.get("updated"))E.set("updated",true);E.trigger("user_updated")}}))};let refresh_user_et;E.schedule_refresh_user=opt=>{if(refresh_user_et)refresh_user_et.return();_util_zerr_js__WEBPACK_IMPORTED_MODULE_18___default().notice("be_premium: schedule_refresh_user %O",opt);E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*schedule_refresh_user_(){refresh_user_et=this;this.finally((()=>{refresh_user_et=null}));yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().sleep(1e3);yield E.refresh_user(opt)})))};function is_blacklist(root_url,tab_url){if(!root_url)return false;if(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().get("is_premium"))return false;const blacklist=(E.be_rule.get("rules")||{}).blacklist||{};return blacklist[root_url]||tab_url&&blacklist[_util_url_js__WEBPACK_IMPORTED_MODULE_5___default().parse(tab_url).hostname]}E.get_force_premium_rule=(root_url,opt)=>{opt=opt||{};if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().full_browser_mode())return false;let rule;if(is_blacklist(root_url,opt.tab_url)){rule={id:root_url,domain:new RegExp(root_url),blacklist:true};return rule}opt=opt||{};rule=_bext_vpn_bg_force_lib_js__WEBPACK_IMPORTED_MODULE_14___default().find_rule(root_url,_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().get("bext_config"),"force_premium",_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_15__["default"].get("country"));if(!rule)return false;const install_ver=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().get("install_version");if(!opt.ignore_install_version&&rule.install_ver_min&&install_ver&&_util_version_util_js__WEBPACK_IMPORTED_MODULE_13___default().cmp(install_ver,rule.install_ver_min)<0){return false}if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().get_site_conf(root_url,"trial"))return false;return rule};E.get_force_premium_rules=(root_urls,opt)=>root_urls.map((root_url=>E.get_force_premium_rule(root_url,opt)));const info_inited_cb=()=>{if(_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().is_mocha()&&last_refreshed)return;E.sp.spawn(E.refresh_user({reason:"init"}))};let login_popup_id,login_tab_id,login_win_id;E.open_login_popup=({method,signup,root_url,force})=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){try{_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_open_login_popup",{method,signup,force});if(force)_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().set("force_login_ts",_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_16__["default"].now());let next=chrome.runtime.getURL("")+"js/login_done.html";let qs;if(method=="email"){qs=_util_escape_js__WEBPACK_IMPORTED_MODULE_4___default().qs({next,hide_social:1,signup:signup?1:undefined,uuid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().get("uuid"),root_url,ver:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().version()})}else if(!method){qs=_util_escape_js__WEBPACK_IMPORTED_MODULE_4___default().qs({next,state:"login_buttons",uuid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().get("uuid"),root_url,ver:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().version()})}else qs=_util_escape_js__WEBPACK_IMPORTED_MODULE_4___default().qs({next});let url=!method||method=="email"?_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_9__.Z.hola_url()+`/bext_login?${qs}`:_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_9__.Z.hola_url()+`/users/auth/${method}/popup?${qs}`;_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_15__["default"].set_login_redirect(new URL(next).hostname);yield close_login_popup();login_tab_id=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_17___default().get("active.id");let cur_win=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().cb_apply(chrome.windows,".getLastFocused",[]);login_win_id=cur_win&&cur_win.id;let win=yield _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_16__["default"].create_window({width:500,height:550,url});login_popup_id=win.id}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_open_login_popup_err",{method,signup},{err:e})}}));const close_login_popup=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){if(login_popup_id>0)yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().cb_apply(chrome.windows,".remove",[login_popup_id]);login_popup_id=null}));E.login_popup_done=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){yield close_login_popup();if(login_win_id){yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().cb_apply(chrome.windows.update,[login_win_id,{focused:true}]);login_win_id=null}if(login_tab_id){yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().cb_apply(chrome.tabs.update,[login_tab_id,{active:true}]);login_tab_id=null}yield E.refresh_user({reason:"login_popup_done"});E.trigger("login_done")}));const on_pap_a_aid=()=>{const aff_id=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().get("pap_a_aid");if(!aff_id)return;const prev_aff_id=_util_storage_js__WEBPACK_IMPORTED_MODULE_19___default().get("pap_a_aid");_util_storage_js__WEBPACK_IMPORTED_MODULE_19___default().set("pap_a_aid",aff_id);if(aff_id!=prev_aff_id)_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_aff_id_changed",{aff_id,prev_aff_id})};E.init=be_rule=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){if(E.inited)return;state=new _pub_state_js__WEBPACK_IMPORTED_MODULE_20__["default"]("be_premium_state",{user:null,membership:null,uuid_info:null},{persistent:false});yield state.load();E.inited=true;E.be_rule=be_rule;E.sp=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().new_etask("be_premium");if(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_15__["default"].get("inited"))info_inited_cb();else _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_15__["default"].on("inited",info_inited_cb);daily_refresh_timer=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().set_interval(E.refresh_user.bind(E,{force_premium:true}),_util_date_js__WEBPACK_IMPORTED_MODULE_3___default().ms.DAY,{sp:E.sp,name:"refresh_user"});E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default(),"change:pap_a_aid",on_pap_a_aid)}));E.uninit=opt=>{opt=opt||{};E.inited=false;_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_15__["default"].off("inited",info_inited_cb);E.sp.return();_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().clear_timeout(membership_timeout);_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_11___default().clear_interval(daily_refresh_timer);last_refreshed=0;close_login_popup();if(!opt.keep_user)E.clear();E.stopListening()};const __WEBPACK_DEFAULT_EXPORT__=E},8076:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var underscore__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8763);var underscore__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_0__);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_2__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_5__);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6__);var _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(897);var _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_7__);var _util_url_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(5305);var _util_url_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_util_url_js__WEBPACK_IMPORTED_MODULE_8__);var _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(9651);var _util_array_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(6545);var _util_array_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(_util_array_js__WEBPACK_IMPORTED_MODULE_10__);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(843);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_11__);var _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(2227);var _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12__);var _bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(1002);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(4130);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14__);var _util_date_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_15__);var _util_util_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_16__);var _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(6210);var _bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(7666);var _util_storage_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(1032);var _util_storage_js__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(_util_storage_js__WEBPACK_IMPORTED_MODULE_19__);var conf__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(9641);var _bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(9265);
// LICENSE_CODE ZON
_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().assert_bg("be_rule");const SEC=_util_date_js__WEBPACK_IMPORTED_MODULE_15___default().ms.SEC,chrome=self.chrome,assign=Object.assign;let be_bg_main,tab_state={},bext_config={};const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default().task_model.extend({model_name:"rule",rules:undefined,_defaults:function(){this.on("destroy",(()=>E.uninit()))}}));let stamp;const v3=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().is_v3;const CG=(path,def)=>_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().get(bext_config,path,def);_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_7___default().be_rule=E;E.tasks=[];E.task_cancel_all=()=>_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().forEach(E.tasks,(task=>task.return()));E.task_insert=task=>E.tasks.push(task);E.task_remove=task=>_util_array_js__WEBPACK_IMPORTED_MODULE_10___default().rm_elm(E.tasks,task);E.uninit=()=>{if(!E.get("inited"))return;E.sp.return();E.off("recover",on_recover);E.off("fetch_rules",fetch_rules);E.off("set_rule",set_rule);E.stopListening();E.clear();E.task_cancel_all();E.rules=undefined};const on_max_redirects=(from,to,urls)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({cancel:true},(function*_on_max_redirects(){if(CG("disable_max_redirects"))return;let urules,rules=_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().get_rules();if(!rules||!(urules=rules.unblocker_rules))return;let update;for(let name in urules){let r=urules[name];if(!r.enabled||r.name!=from&&r.name!=to)continue;r.enabled=false;E.set_rule({name:r.name,country:r.country,enabled:r.enabled});update=true}if(!update)return;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("max_redirect_rule_disable",{from,to,urls},{rate_limit:{count:1}});yield E.update_rules(rules)}));E.init=()=>{if(E.get("inited"))return;be_bg_main=self.be_bg_main;E.set("inited",true);E.set("tabs_stub_rules",{});E.set("per_tab_rules",{});E.set("enable_ts",_util_storage_js__WEBPACK_IMPORTED_MODULE_19___default().get("enable_ts"));E.sp=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().new_etask("be_rule");E.on("recover",on_recover);E.on("fetch_rules",fetch_rules);E.on("set_rule",set_rule);E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default(),"change:ext.active change:ext.suspended change:session_key",underscore__WEBPACK_IMPORTED_MODULE_0___default().debounce((()=>{set_rules()})));E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default(),"completed error_occured",(info=>{if(!_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().get(info,"tabId"))return;var fix_task=fix_tasks[info.tabId];if(!fix_task)return;if(!fix_task.fix_waiting)return;fix_task.continue()}));E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default(),"created",(o=>{let tab=o.tab;let stub_rule=E.get_stub_rule(tab.openerTabId);let url=tab.url||tab.pendingUrl;if(tab.openerTabId&&!_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().is_new_tab(url)&&stub_rule)E.set_stub_rule(tab.id,stub_rule);let tab_rule=E.get_per_tab_rule(tab.openerTabId);if(tab.openerTabId&&!_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().is_new_tab(url)&&tab_rule)E.set_per_tab_rule(tab.id,tab_rule)}));E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default(),"max_redirect_sequence",on_max_redirects);_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().on("local_rules_set",(()=>E.update_rules(undefined,{resolve:true})));const set_rules=resolve=>{E.update_rules(bext_config.proxy_rules||null,{resolve});stamp=bext_config.stamp};E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default(),"change:bext_config",(()=>{bext_config=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("bext_config")||{};if(bext_config.proxy_rules&&(!stamp||stamp!=bext_config.stamp))set_rules(!stamp)}));E.listen_to(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_17__["default"],"change:country",(()=>{if(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_17__["default"].get("country"))set_rules()}));if(_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().is_mocha())E.update_rules(undefined,{resolve:true})};function on_recover(){E.trigger("fetch_rules")}E.get_rules=(url,ignore)=>_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().get_rules(E.rules,url,ignore);E.get_rule_ratings=args=>_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_9__.Z.ccgi_ajax({data:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().qs_ajax(args),url:conf__WEBPACK_IMPORTED_MODULE_20__.url_ccgi+"/rule_ratings"});E.get_groups_from_ratings=ratings=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({name:"get_groups_from_ratings",cancel:true},(function*(){let groups=[];ratings.forEach((cr=>{cr.rules.forEach((r=>{if(r.rating<=0)return;groups.push(underscore__WEBPACK_IMPORTED_MODULE_0___default().pick(r,"name","type","country"))}))}));if(!groups.length)return;groups=yield _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().get_groups(groups);if(!_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().get(groups,"unblocker_rules"))return groups;_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().forEach(groups.unblocker_rules,(r=>delete r.enabled));return groups}));E.update_rules=(rules,opt)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*update_rules(){if(rules)_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().set_rules(rules);if(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().is_disabled()||!rules&&rules!==undefined)E.rules=undefined;else{E.rules=_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().get_rules();E.set("rules",E.rules)}yield _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_7___default().update_rule_urls(E.rules,opt);E.set("stamp",_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().get(E.rules,"stamp",0))}));function fetch_rules(){if(!E.get("inited"))return;E.task_cancel_all();if(!E.set_busy({desc:"Changing country..."}))return E.schedule_clr(["fetch_rules"]);var auth=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().auth();if(!auth.uuid||!auth.session_key)return E.clr_busy();E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({cancel:true},(function*fetch_rules_(){this.finally((()=>{if(E.get("status")=="busy")E.clr_busy()}));try{yield E.update_rules()}catch(e){E.set_err();_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_script_fetch_rules_err",{},{err:e})}})))}E.set_rule=(opt,update)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*_set_rule(){if(!opt)return;if(opt.tab_id&&opt.per_tab)E.set_per_tab_rule(opt.tab_id,opt);if(opt.stub)return void E.set_stub_rule(opt.tab_id,opt);if(opt.tab_id)E.set_stub_rule(opt.tab_id,null);if(opt.enabled)opt.src_country=(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_17__["default"].get("country")||"").toLowerCase();if(_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_18__["default"].get_trial_active(opt.name))opt.src="trial";_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().set_rule(opt);E.trigger("rule_set",opt);if(update){yield E.update_rules(undefined,{resolve:opt.enabled,rule:opt,reload:!opt.no_reload})}}));function set_tab_state(tab_id,state){if(!tab_id||tab_id==-1)return;var s=tab_state[tab_id]=tab_state[tab_id]||{};if(s.state==state)return;var prev=s.state||"idle";s.state=state;E.trigger("set_tab_state",{tab_id,prev,curr:s.state})}const get_tab_id=tab_id=>tab_id===undefined?_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default().get("active.id"):tab_id;E.get_tab_state=tab_id=>(tab_state[get_tab_id(tab_id)]||{}).state||"idle";const set_enable_ts=ts=>{E.set("enable_ts",ts);_util_storage_js__WEBPACK_IMPORTED_MODULE_19___default().set("enable_ts",ts)};const set_rule_tasks={};function set_rule(opt){_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().assert(E.get("inited"),new Error("set_rule failed, be_rule not inited"));opt=assign({},opt);const{tab_id}=opt;E.task_cancel_all();if(fix_tasks[tab_id])fix_tasks[tab_id].return();if(set_rule_tasks[tab_id])set_rule_tasks[tab_id].return();if(!E.set_busy({desc:opt.enabled?"Finding peers...":"Stopping peer routing..."})){return E.schedule(["set_rule",opt])}E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({cancel:true},(function*_set_rule(){set_rule_tasks[tab_id]=this;set_tab_state(opt.tab_id,opt.enabled?"enable_rule":"disable_rule");this.finally((()=>{delete set_rule_tasks[tab_id];E.clr_busy();set_tab_state(tab_id,"idle")}));const hola_uid=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("hola_uid");try{if(_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().is_mocha())E.t.set_rule_sp=this;set_tab_state(tab_id,"update_rules");E.update_progress({desc:"Changing country..."});if(!opt.stub&&opt.enabled){_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().reverify_country_agents(opt.country);if(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().is_debug_peer(opt))_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().reauth_country_agents(opt.country,0);let to=_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().get(bext_config,"set_rule_timeout",10*SEC);if(to)this.alarm(to,{throw:new Error("timeout")})}yield E.set_rule(opt,true);if(!opt.stub){let r=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().find_rule(E.rules&&E.rules.unblocker_rules,opt);let is_enabled=r&&r.enabled;if(!!is_enabled!=!!opt.enabled)_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_set_rule_mismatch",{opt,r,hola_uid})}set_tab_state(tab_id,"rule_set");const info={name:opt.name,type:opt.type,country:opt.country,enabled:opt.enabled,hola_uid};if(!E.get("enable_ts")){const ts=Date.now();set_enable_ts(ts);info.first_enable=ts;info.aff_id=be_bg_main.get("aff_id")}_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_set_rule_ok",info)}catch(e){set_tab_state(tab_id,"set_rule_err");_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_script_set_rule_err",{hola_uid},{err:e})}})))}E.is_enabled=rule=>{if(!rule)return true;if(!E.rules||!E.rules.unblocker_rules)return false;var r=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().find_rule(E.rules.unblocker_rules,rule);return r&&r.enabled};E._change_proxy=opt=>{if(!E.get("inited")||opt.rule.changing_proxy||!E.is_enabled(opt.rule))return;opt.rule.changing_proxy=true;set_tab_state(opt.tab_id,"change_proxy");return _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({cancel:true},(function*change_proxy(){this.finally((()=>{opt.rule.changing_proxy=false;E.task_remove(this)}));E.task_insert(this);E.update_progress({desc:"Trying another peer..."});const exclude=opt.exclude||_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().get_active_agents(opt.rule);let res=yield _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().replace_agents(opt.rule,exclude);if(v3)yield _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_7___default().update_rule_urls(E.rules);return res}))};function get_report(opt){let tab_id=get_tab_id(opt.tab_id),rule=opt.rule||{};let req_errors,user=_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_21__["default"].get("user");if(opt.send_logs&&be_bg_main)req_errors=be_bg_main.get_dumped_errors(tab_id);let page_load,trace;if((trace=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default().get_trace(tab_id))&&trace.length)page_load=trace[trace.length-1].duration;let tu=_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_7___default().get_tab_unblocker(tab_id)||{};let url=opt.url||_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default().get("active.url");return assign({src_country:opt.src_country||(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_17__["default"].get("country")||"").toLowerCase(),hola_uid:user&&user.hola_uid,url,root_url:opt.root_url||get_root_url(tab_id),premium:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("is_premium"),proxy_country:rule.country&&rule.country.toLowerCase(),tab_id,callback_raw:_bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_13__.Z.get("svc.callback_raw"),callback_ts:_bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_13__.Z.get("svc.callback_ts"),mode_change_count:_bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_13__.Z.get("mode_change_count"),multiple_mode_changes:_bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_13__.Z.get("mode_change_count")>2,real_url:_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default().get("active.url"),status:_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default().get("active.status"),agent:_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().get_active_agents(opt.rule),agents:tu.agents,mitm_active:rule.is_mitm,req_errors,src:opt.src,page_load,clean_cookie:opt.clean_cookie},underscore__WEBPACK_IMPORTED_MODULE_0___default().pick(rule,"name","type"))}E.send_fix_it_report=opt=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*send_fix_it_report_(){if(!E.get("inited"))return;let log,info=get_report(opt);if(opt.send_logs&&be_bg_main){let root_url=get_root_url(info.tab_id);if(CG("debug_logs.domains",[]).includes(root_url)||Math.random()*100<CG("debug_logs.all_domains_perc",0)){log=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().get_log()}}_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_ui_vpn_click_no_fix_it_multi",info,{err:true});const res=yield _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_ui_vpn_click_no_fix_it",info,{err:true,filehead:log,rate_limit:{count:10}});if(be_bg_main&&_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().get(res,"bug_id"))be_bg_main.set_bug_id(res.bug_id)}));E.send_vpn_work_report=function(opt){var tab_id=get_tab_id(),rule=opt.rule||{};var user=_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_21__["default"].get("user");_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_vpn_ok",assign({src_country:(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_17__["default"].get("country")||"").toLowerCase(),url:_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default().get("active.url"),root_url:get_root_url(tab_id),proxy_country:rule.country&&rule.country.toLowerCase(),hola_uid:user&&user.hola_uid,mitm_active:rule.is_mitm,src:opt.src},underscore__WEBPACK_IMPORTED_MODULE_0___default().pick(rule,"name","type")))};var fix_tasks={};E.fix_vpn=opt=>{if(!E.get("inited"))return;opt=opt||{};let ts=Date.now(),tab_id=opt.tab_id;if(fix_tasks[tab_id])fix_tasks[tab_id].return();set_tab_state(tab_id,"fix_vpn");return fix_tasks[tab_id]=_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({cancel:true,async:true},(function*fix_vpn_(){this.finally((()=>{delete fix_tasks[tab_id];set_tab_state(tab_id,"idle")}));try{let agent;let tu=_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_7___default().get_tab_unblocker(tab_id);if(tu&&(agent=tu.last_agent)){yield _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_7___default()._set_req_err("fix_vpn",agent,{url:opt.url,tab_id,status:-1,peer:!agent.pool,country:opt.rule.country,rule:opt.rule})}_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_7___default().reauth_rule_agents(opt.rule);yield E.change_proxy_wait({rule:opt.rule,desc:"not_working",root_url:opt.root_url,user_not_working:true,tab_id,clean_cookie:opt.clean_cookie});_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().notice("tab:%d reloading tab on fix_vpn",tab_id);_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default().reload(tab_id);if(_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().is_mocha()||Date.now()-ts>=10*SEC)return;while(true){const trace=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default().get_trace(tab_id);const last_trace=trace&&trace.length&&trace[trace.length-1];const status=_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().get(last_trace,"status");if(status){let page_load=_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().get(last_trace,"duration");return page_load<20*SEC&&!["4","5"].includes(status[0])}this.fix_waiting=true;yield this.wait(20*SEC);this.fix_waiting=false}}catch(e){set_tab_state(tab_id,"fix_vpn_err");this.fix_waiting=false;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("be_fix_vpn_err",opt,{err:e})}}))};function get_root_url(tab_id){var url;return tab_id>=0&&(url=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default().get_url(tab_id))&&_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().get_root_url(url)}E.change_proxy=(details,reason,route_opt,agent)=>{if(!E.get("inited"))return;let tu=_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_7___default().get_tab_unblocker(details.tabId);if(!tu)return{error:"no_tub_unblocker"};let exclude=agent||_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().get_chosen_agent(route_opt,tu.rule);let root_url=get_root_url(details.tabId);if(!exclude){let route=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().gen_route_str(route_opt,{no_algo:true});_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().debug("tab:%d no agents for %s route, root_url: %s",details.tabId,route,root_url);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("debug_null_agents",{agents:_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().get_active_agents(tu.rule),details},{err:true})}exclude=_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().omit(exclude,"rtt");const host=exclude&&exclude.host;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr("change_proxy_on_err",{reason,bad_agent:host});_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().debug("tab:%d change agent on %s, bad agents: [%s], root_url: %s",details.tabId,reason,host,root_url);return E._change_proxy({rule:tu.rule,exclude:exclude?[exclude]:[],root_url:root_url||"",agent_not_working:true})};E.disable_premium=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({cancel:true},(function*disable_premium(){E.set_rule({name:"all_browser",country:"us",del:true,enabled:false});let urules,rules=_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().get_rules();if(!rules||!(urules=rules.unblocker_rules))return;for(let name in urules){let site_conf,r=urules[name];if(!r.enabled||r.src=="trial"||!_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_21__["default"].get_force_premium_rule(r.name)&&!((site_conf=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().get_site_conf(r.name))&&site_conf.require_plus)&&!_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().is_google(r.name)){continue}r.enabled=false;E.set_rule({name:r.name,country:r.country,enabled:r.enabled})}yield E.update_rules(rules)}));E.disable_trial_on_logout=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({cancel:true},(function*disable_trial_on_logout(){let urules,rules=_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().get_rules();if(!rules||!(urules=rules.unblocker_rules))return;for(let name in urules){let r=urules[name];if(!r.enabled||r.src!="trial"||!_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_18__["default"].need_signin(r.name))continue;r.enabled=false;E.set_rule({name:r.name,country:r.country,enabled:r.enabled})}yield E.update_rules(rules)}));E.disable_trial_on_grace_end=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({cancel:true},(function*disable_trial_on_grace_end(){let urules,rules=_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().get_rules();if(!rules||!(urules=rules.unblocker_rules))return;for(let name in urules){let r=urules[name];if(!r.enabled||r.src!="trial")continue;r.enabled=false;E.set_rule({name:r.name,country:r.country,enabled:r.enabled})}yield E.update_rules(rules,{reload:false})}));E.disable_stubs=()=>E.set("tabs_stub_rules",{});E.disable_trial=domains=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({cancel:true},(function*disable_trial(){let update,rules=_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_12___default().get_rules();if(!rules)return;domains.forEach((domain=>{let rule=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_6___default().get_rules(rules,"http://"+domain+"/",true);if(!(rule=rule&&rule[0])||!rule.enabled||rule.src!="trial")return;let unblockers=_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_7___default().tab_unblockers||{};for(let tabid in unblockers){let uri,u=unblockers[tabid];if(!u.rule||u.rule.name!=rule.name||!(tabid=+tabid))continue;if(uri=_util_url_js__WEBPACK_IMPORTED_MODULE_8___default().parse(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_14___default().get_url(tabid))){chrome.tabs.update(tabid,{url:uri.protocol+"//"+uri.hostname})}}rule.enabled=false;E.set_rule({name:domain,country:rule.country,enabled:rule.enabled,src:"trial"});update=true}));if(update)yield E.update_rules(rules)}));E.change_proxy_wait=opt=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()({cancel:true},(function*change_proxy_wait_(){this.finally((()=>set_tab_state(opt.tab_id,"idle")));if(E.get("status")!="busy")return yield E._change_proxy(opt);E.once("change:status",(()=>this.continue(E._change_proxy(opt))));return yield this.wait()}));E.set_stub_rule=(tab_id,rule)=>{let tabs_stub_rules=assign({},E.get("tabs_stub_rules"));if(_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().get(rule,"enabled"))tabs_stub_rules[tab_id]=rule;else delete tabs_stub_rules[tab_id];E.set("tabs_stub_rules",tabs_stub_rules)};E.get_stub_rule=tab_id=>(E.get("tabs_stub_rules")||{})[tab_id];E.set_per_tab_rule=(tab_id,rule)=>{let per_tab_rules=assign({},E.get("per_tab_rules"));if(_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().get(rule,"enabled"))per_tab_rules[tab_id]=rule;else delete per_tab_rules[tab_id];E.set("per_tab_rules",per_tab_rules)};E.get_per_tab_rule=tab_id=>(E.get("per_tab_rules")||{})[tab_id];if(_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().is_mocha())E.t={on_max_redirects};const __WEBPACK_DEFAULT_EXPORT__=E},2955:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_0__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_1__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2__);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(843);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_3__);var conf__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9641);
// LICENSE_CODE ZON
const assign=Object.assign;const E={};function start_monitor_worker(){var worker=new Worker(new URL(__webpack_require__.p+__webpack_require__.u(881),__webpack_require__.b),{type:undefined});worker.onmessage=e=>{let data=e.data||{};switch(data.type){case"ping":var opt={val:data.val,url:conf__WEBPACK_IMPORTED_MODULE_4__.url_perr,perr:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_0___default().perr_opt("be_main_thread_stuck",{},{level:_util_zerr_js__WEBPACK_IMPORTED_MODULE_1___default().L.ERR,rate_limit:{count:1}})};var config=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_2___default().get("bext_config");if(config&&config.monitor_worker)assign(opt,config.monitor_worker);worker.postMessage({type:"pong",opt});break;case"push_event":if(data.name=="<stuck_end"){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_0___default().perr("be_main_thread_stuck_end_log",{},{rate_limit:{count:1},with_log:true})}_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_3___default().push_event(data.name,{duration:data.duration,ts:data.ts});break;default:break}}}E.start_monitor_worker=start_monitor_worker;const __WEBPACK_DEFAULT_EXPORT__=E},737:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_1__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_2__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3__);var _util_util_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_4__);var underscore__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(8763);var underscore__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_5__);var _util_date_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_6__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_7__);var _svc_hola_pub_svc_monitor_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(9946);var _svc_hola_pub_svc_monitor_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_svc_hola_pub_svc_monitor_js__WEBPACK_IMPORTED_MODULE_8__);var _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(9651);var conf__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(9641);
// LICENSE_CODE ZON
const chrome=self.chrome;const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0___default().task_model.extend({model_name:"svc",_defaults:function(){this.on("destroy",(()=>E.uninit()))}}));function firefox_origin_fix(details){let fix={name:"Origin",value:"resource://ff_ext-at-hola-dot-org"};return{requestHeaders:[fix].concat(details.requestHeaders)}}E.init=be_vpn=>{if(E.inited)return;E.inited=true;if(conf__WEBPACK_IMPORTED_MODULE_10__.firefox_web_ext){chrome.webRequest.onBeforeSendHeaders.addListener(firefox_origin_fix,{urls:["*://127.0.0.1/*","*://localhost.h-local.org/*"]},["blocking","requestHeaders"])}E.svc_mon.init();E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default(),"change:is_premium",(()=>E.update_info()));if(!(E.be_vpn=be_vpn))return};E.uninit=()=>{E.inited=false;if(conf__WEBPACK_IMPORTED_MODULE_10__.firefox_web_ext){chrome.webRequest.onBeforeSendHeaders.removeListener(firefox_origin_fix)}E.stopListening();E.svc_mon.uninit();E.clear()};E.svc_mon=(EE=>{EE.init=()=>{if(EE.inited)return;_svc_hola_pub_svc_monitor_js__WEBPACK_IMPORTED_MODULE_8___default().init({components:["vpn","client"],detecting_start_interval:1,detecting_start_retries:10,detecting_interval:600,monitoring_interval:60,log:str=>_util_zerr_js__WEBPACK_IMPORTED_MODULE_7___default().notice("svc_monitor: "+str),perr:(id,info)=>_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_2___default().perr(id,info),watch:data=>E.update_info((()=>transform_callback_data(data)))});EE.inited=true};EE.reset=()=>_svc_hola_pub_svc_monitor_js__WEBPACK_IMPORTED_MODULE_8___default().refresh_info();EE.watch_vpn_status=()=>{if(EE.vs_sp)return;return EE.vs_sp=_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()({name:"watch_vpn_status",cancel:true},(function*watch_vpn_status_loop_(){let status=yield EE.query_api("vpn_status",undefined,{timeout:30*_util_date_js__WEBPACK_IMPORTED_MODULE_6___default().ms.SEC});status=_util_util_js__WEBPACK_IMPORTED_MODULE_4___default().get(status,"ret");yield parse_vpn_status(status||{});const idle=!status||status.idle;if(idle&&!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().get("is_premium"))return;_svc_hola_pub_svc_monitor_js__WEBPACK_IMPORTED_MODULE_8___default().reconf({monitoring_interval:idle?60:1})}))};EE.stop_watch_vpn_status=()=>{if(!EE.vs_sp)return;EE.vs_sp=void EE.vs_sp.return();_svc_hola_pub_svc_monitor_js__WEBPACK_IMPORTED_MODULE_8___default().reconf({monitoring_interval:60})};EE.query_api=(cmd,params)=>_svc_hola_pub_svc_monitor_js__WEBPACK_IMPORTED_MODULE_8___default().exec(cmd,params);EE.uninit=()=>{if(!EE.inited)return;_svc_hola_pub_svc_monitor_js__WEBPACK_IMPORTED_MODULE_8___default().uninit();EE.inited=false};return EE})({});const transform_callback_data=data=>{if(!data)throw"no data";let ret={status:{}};ret.raw=data;if(data.connected)ret.proxyjs_connected=true;if(data.full_vpn)ret.status.full_vpn=data.full_vpn;return Object.assign(ret,{appid:data.appid||"",campaign:data.campaign||"",uuid:data.uuid||"",version:data.ver||"0.0.0",os_ver:data.os_ver,is_hola_svc:data.exe=="hola_svc.exe"||data.exe=="hola_svc",user_token:data.user_token,sync_token:data.sync_token||"",svc:1})};E.update_info=provider=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()("update_info",(function*update_info_(){try{const info=provider?provider():yield E.callback();if(underscore__WEBPACK_IMPORTED_MODULE_5___default().isEqual(info,E.get("info")))return info;let change={};change.info=info;change.proxyjs_connected=info.proxyjs_connected;change.version=info.version;change.is_hola_svc=info.is_hola_svc;change.user_token=info.user_token;change.sync_token=info.sync_token||"";change.callback_raw=info.raw;change.callback_ts=_util_date_js__WEBPACK_IMPORTED_MODULE_6___default()();change.appid=info.appid;change.campaign=info.campaign;change.uuid=info.uuid;E.safe_set(change);return info}catch(e){E.safe_set({info:null,sync_token:"",callback_raw:null,callback_ts:null,version:null,appid:"",campaign:"",uuid:""})}}));E.callback=function(opt){opt=opt||{};self.disable_svc_polling=self.disable_svc_polling||0;return _util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()("callback",[function try_catch$(){if(self.disable_svc_polling||_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().is_disabled())return this.return(_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default().err("not running"));return E.svc_mon.query_api("callback",opt.full_vpn&&{vpn:1})},function(ret){let data=ret&&ret.ret;if(this.error||!data){console.log("Use self.disable_svc_polling = 1 to stop polling");return this.return(_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default().err("not running"))}if(opt.raw)return this.return(data);data=transform_callback_data(data);return this.return(data)}])};const ensure_vpn_info=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()({name:"ensure_vpn_info"},[function try_catch$(){return _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_9__.Z.hola_api_call("users/ensure_vpn_info")},function(info){if(this.error||!info){return void _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_2___default().perr("ensure_vpn_info_fail",{},{err:this.error})}var vpn_info=_util_util_js__WEBPACK_IMPORTED_MODULE_4___default().pick(info,"login","password");E.set("vpn_info",vpn_info);return vpn_info}]);const parse_vpn_status=status=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()((function*_parse_vpn_status(){let connecting=!!status.connecting_to;let connected=!!status.connected_to;let country=status.connecting_to||status.connected_to||"";let active=(connecting||status.disconnecting)&&!connected;if(E.get("status")!="ready"&&connected)yield update_location();set_status(active?"busy":"ready",country.toLowerCase())}));const set_status=(status,country)=>{if(country!==undefined){if(country=="uk")country="gb";E.set("vpn_country",country)}E.set("status",status||"ready");E.trigger("update_vpn_status")};E.vpn_connect=opt=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()((function*vpn_connect_(){try{opt=opt||{};const country=(opt.country||"").toLowerCase();const vpn_info=E.get("vpn_info")||(yield ensure_vpn_info());if(!vpn_info)return void set_status("ready","");set_status("busy",country,"vpn_connect");let res=yield E.svc_mon.query_api("vpn_connect",{host:country+".vpn.hola.org",username:vpn_info.login,password:vpn_info.password,country});E.svc_mon.reset();return res}catch(e){set_status("ready","");_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_2___default().perr("vpn_connect",{},{err:e})}}));E.vpn_disconnect=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()((function*vpn_disconnect_(){this.finally((()=>set_status()));try{set_status("busy","");let res=yield E.svc_mon.query_api("vpn_disconnect");E.svc_mon.reset();return res}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_2___default().perr("vpn_disconnect",{},{err:e})}}));E.vpn_change_agent=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()((function*vpn_change_agent_(){this.finally((()=>set_status()));try{set_status("busy");let res=yield E.svc_mon.query_api("vpn_change_agent");E.svc_mon.reset();return res}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_2___default().perr("vpn_change_agent",{},{err:e})}}));if(false){}let ul_sp;function update_location(){if(ul_sp)return ul_sp;return ul_sp=_util_etask_js__WEBPACK_IMPORTED_MODULE_1___default()({name:"update_location"},(function*call_myip_(){let res;for(let i=0;i<5;i++){try{res=yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_9__.Z.hola_api_call("myip.json",{timeout:5*_util_date_js__WEBPACK_IMPORTED_MODULE_6___default().ms.SEC});break}catch(e){yield _util_etask_js__WEBPACK_IMPORTED_MODULE_1___default().sleep(_util_date_js__WEBPACK_IMPORTED_MODULE_6___default().ms.SEC)}}ul_sp=undefined;return res}))}const __WEBPACK_DEFAULT_EXPORT__=E},228:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0__);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4130);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_1__);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_2__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4__);var _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2227);var _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_5__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_6__);var _util_url_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(5305);var _util_url_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_util_url_js__WEBPACK_IMPORTED_MODULE_7__);var _util_util_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_8__);
// LICENSE_CODE ZON
const chrome=self.chrome;_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_2___default().assert_bg("be_tab_perr");const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_0___default().model.extend({_defaults:function(){this.on("destroy",(()=>E.uninit()))}}));const cb_wrapper=_util_zerr_js__WEBPACK_IMPORTED_MODULE_6___default().catch_unhandled_exception;const google_host=hostname=>{var host_split=hostname.split(".").reverse();return host_split[1]=="google"||host_split[2]=="google"};const enabled_google_rule=()=>_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_5___default().has_rule((r=>google_host(r.name)));const google_captcha_send_perr=_url=>{if(!E.inited)return;let url=_util_url_js__WEBPACK_IMPORTED_MODULE_7___default().parse(_url),id;if(!google_host(url.hostname))return;if(/\/sorry\//.test(url.pathname))id="google_cap_sorry";else if(/\/websearch\/answer\/86640$/.test(url.pathname))id="google_cap_support";else if(/\/recaptcha$/.test(url.pathname))id="google_cap_support2";else return;if(enabled_google_rule())id+="_enabled_google_rule";if(be_vpn.be_mode.get("svc.detected"))id+="_svc";if(!be_vpn.get_enabled_rule({url:_url}))_url=null;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_4___default().perr(id,{url:_url},{err:true,rate_limit:{count:1,disable_drop_count:true}})};const on_tab_created=cb_wrapper((o=>{const tab=o.tab;if(!tab.url)return;google_captcha_send_perr(tab.url)}));const on_tab_updated=cb_wrapper((o=>{const info=(o||{}).info;if(!_util_util_js__WEBPACK_IMPORTED_MODULE_8___default().get(info,"url"))return;google_captcha_send_perr(info.url)}));const on_tab_replaced=cb_wrapper((o=>{const added=o.added;chrome.tabs.get(added,(tab=>{if(!_util_util_js__WEBPACK_IMPORTED_MODULE_8___default().get(tab,"url"))return;google_captcha_send_perr(tab.url)}))}));const update_state=()=>{const is_active=!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default().is_disabled();if(is_active==E.is_active)return;E.is_active=is_active;E.stopListening(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_1___default());if(!E.is_active)return;E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_1___default(),"created",on_tab_created);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_1___default(),"updated",on_tab_updated);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_1___default(),"replaced",on_tab_replaced)};E.uninit=()=>{if(!E.inited)return;E.inited=0;E.stopListening();be_vpn=null};let be_vpn;E.init=_be_vpn=>{if(E.inited)return;be_vpn=_be_vpn;E.inited=1;E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_3___default(),"change:ext.active change:ext.suspended",update_state)};const __WEBPACK_DEFAULT_EXPORT__=E},4130:(module,exports,__webpack_require__)=>{"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(8763),__webpack_require__(6386),__webpack_require__(6969),__webpack_require__(1211),__webpack_require__(9824),__webpack_require__(843),__webpack_require__(932),__webpack_require__(5305),__webpack_require__(3727),__webpack_require__(7345),__webpack_require__(5250),__webpack_require__(1291)],__WEBPACK_AMD_DEFINE_RESULT__=function(_,etask,be_backbone,B,zerr,vpn_util,date,zurl,be_ext,be_util,be_vpn_util,zutil){be_vpn_util.assert_bg("be_tabs");const chrome=self.chrome;const E=new(be_backbone.model.extend({model_name:"tabs",_defaults:function(){this.on("destroy",(()=>{E.uninit()}))}}));const max_redirects=10;const tabs={};const v3=be_util.is_v3;function active_cb(){etask({name:"active_cb",cancel:true},(function*active_cb_(){try{let tab=yield E.get_tab(E.get("active.real.id"));if(tab===undefined)tab=tabs[E.get("active.real.id")];if(tab&&chrome){if(/^(chrome-)?devtools:\/\/devtools\//.test(tab.url||""))return}E.set({"active.id":tab?tab.id:undefined,"active.url":tab?E.get_loading_tab_url(tab.id)||tab.url:"","active.status":tab?tab.status:"","active.incognito":tab?tab.incognito:false})}catch(err){zerr("be_tabs_active_cb_err: "+err)}}))}function is_active(id){return id==E.get("active.real.id")}var tab_trace={};function page_trace(details,msg,clear){if(!details)return;var is_main=chrome?!details.frameId&&(!details.type||details.type=="main_frame"):details.is_main;if(!is_main&&msg!="autoreload")return;var tab_id=details.tabId;if(clear)page_trace_del(tab_id);var trace=tab_trace[tab_id]=tab_trace[tab_id]||[];var ts=details.timeStamp;var from_start=trace[0]?ts-trace[0].ts:0;var prev=trace.length?trace[trace.length-1]:null;if(prev)prev.duration=ts-prev.ts;var status=details.statusCode||prev&&prev.status||"0";trace.push({ts,real_ts:Date.now(),from_start,msg,status,error:details.error});zerr.debug("tab:%d navigation %s %s",tab_id,msg,details.url.slice(0,200))}function page_trace_del(tab_id){delete tab_trace[tab_id]}E.page_trace=page_trace;E.get_trace=tab_id=>{var trace=tab_trace[tab_id];if(!trace||!trace.length)return trace;trace[trace.length-1].duration=Date.now()-trace[trace.length-1].real_ts;return trace};function on_created(tab){tabs[tab.id]=tab;set_url(tab.id,tab.url);E.trigger("created",{tab})}function on_updated(id,info,tab){if(!info.url&&!info.status)return;tabs[tab.id]=tab;set_url(id,info.url);if(is_active(id))E.sp.spawn(active_cb());E.trigger("updated",{id,info,tab})}E.update_active_tab_url=()=>E.sp&&E.sp.spawn(active_cb());function on_activated(info){E.set("active.real.id",info.tabId)}function on_removed(id,info){if(payment_tabs[id]){delete payment_tabs[id];be_util.perr("be_open_payment_page_closed",{tab_id:info.tabId,url:info.url})}const url=E.get_url(id);del_tab(id);track_redirect_del(id);page_trace_del(id);E.trigger("removed",{id,info,url})}function on_replaced(added,removed){del_tab(removed);track_redirect_del(removed);page_trace_del(removed);if(is_active(removed))E.set("active.real.id",added);E.trigger("replaced",{added,removed})}var chrome_error_list=["ACCESS_DENIED","BLOCKED_BY_ADMINISTRATOR","CONNECTION_REFUSED","CONNECTION_FAILED","NAME_NOT_RESOLVED","ADDRESS_UNREACHABLE","CERT_ERROR_IN_SSL_RENEGOTIATION","NAME_RESOLUTION_FAILED","NETWORK_ACCESS_DENIED","SSL_HANDSHAKE_NOT_COMPLETED","SSL_SERVER_CERT_CHANGED","CERT_COMMON_NAME_INVALID","CERT_AUTHORITY_INVALID","CERT_CONTAINS_ERRORS","CERT_INVALID","INVALID_RESPONSE","EMPTY_RESPONSE","INSECURE_RESPONSE","DNS_MALFORMED_RESPONSE","DNS_SERVER_FAILED","DNS_SEARCH_EMPTY","TIMED_OUT","CONNECTION_CLOSED","ABORTED","CONNECTION_RESET","CERT_SYMANTEC_LEGACY"];function on_error_occured(info){if(info.frameId!=0)return;if(payment_tabs[info.tabId]){delete payment_tabs[info.tabId];be_util.perr("be_open_payment_page_error",{tab_id:info.tabId,error:info.error,url:info.url})}var err=info.error||"";err=err.split("::ERR_")[1];if(chrome&&(!err||!chrome_error_list.includes(err)))return;info.http_status_code=0;E.trigger("error_occured",{id:info.tabId,info})}const WINDOW_ID_NONE=chrome?-1:null;function on_focused(id){if(id===WINDOW_ID_NONE)return;E.set("active.window.id",id);E.trigger("on_focused");chrome.tabs.query({active:true,windowId:id},(_tabs=>{if(_tabs&&_tabs.length)E.set("active.real.id",_tabs[0].id)}))}const nav_tabs={};function on_before_navigate(info){if(!info.frameId)nav_tabs[info.tabId]=info.url;var trace,clear=true;if(!info.frameId&&(trace=tab_trace[info.tabId])){var i,now=Date.now();for(i=trace.length-1;i>=0&&trace[i].msg!="autoreload";i--);if(i>=0&&now-trace[i].real_ts<2*date.ms.SEC)clear=false}page_trace(info,"before_navigate",clear);if(!info.frameId&&is_active(info.tabId))active_cb();E.trigger("before_navigate",info)}function on_completed(info){if(payment_tabs[info.tabId]&&!info.frameId){delete payment_tabs[info.tabId];be_util.perr("be_open_payment_page_completed",{tab_id:info.tabId,url:info.url})}page_trace(info,"completed");if(is_active(info.tabId))active_cb();E.trigger("completed",info)}function on_committed(details){page_trace(details,"committed");E.trigger("committed",{id:details.tabId,info:details});if(!details.frameId&&details.tabId&&details.url){var qualifiers=details.transitionQualifiers;if(qualifiers&&qualifiers.includes("client_redirect")){track_redirect({id:details.tabId,url:details.url,info:details})}else if(!qualifiers.includes("server_redirect"))delete tabs_redirect[details.tabId];last_committed[details.tabId]=get_root_url(details.url)}if(false){}}function get_root_url(url){url=zurl.parse(url);if(!url.hostname||!url.protocol)return;url=url.protocol+"//"+url.hostname+"/";return vpn_util.get_root_url(url)}var tabs_redirect={},last_committed={};function track_redirect(tab){let url;if(!E.inited||!chrome||!tab||tab.id===undefined||!(url=tab.url||E.get_url(tab.id))){return}let list=tabs_redirect[tab.id]=tabs_redirect[tab.id]||{redirects:[]};let last_url=last_committed[tab.id],from_url=get_root_url(url);let to_url,headers;if(headers=tab.info&&tab.info.responseHeaders){let h;if(h=headers.find((e=>e.name.toLowerCase()=="location")))to_url=h.value;to_url=to_url&&get_root_url(to_url)}if(!to_url&&tab.info&&tab.info.transitionQualifiers){to_url=get_root_url(url);from_url=last_url}const redirects=list.redirects;if(!from_url||!to_url||from_url==to_url||redirects.length&&redirects[redirects.length-1].from==from_url){return}redirects.push({to:to_url,from:from_url,url,ts:Date.now()});if(redirects.length==max_redirects){if(!list.is_max&&E.get_redirect_list(tab.id,max_redirects,true).length==max_redirects){let urls=list.redirects.map((e=>e.url));be_util.perr("be_max_redirect_sequence",{},{err:true,rate_limit:{count:1}});E.trigger("max_redirect_sequence",from_url,to_url,urls);list.is_max=true}redirects.shift()}if(list.to)be_vpn_util.clear_timeout(list.to);list.to=be_vpn_util.set_timeout((()=>list.redirects=[]),2*date.ms.MIN)}function get_redirect_sequence(tab_id,url,ts_limit,limit){var list;if(!(list=tabs_redirect[tab_id]))return[];list=ts_limit?list.redirects.filter((e=>e.ts>ts_limit)):list.redirects;if(!list.length||list.some((e=>e.from=="hola.org")))return[];var ts,parent_url,i,root_urls=[];for(i=0,parent_url=list.find((e=>e.to==url));parent_url&&i<max_redirects;i++){if(ts&&ts<=parent_url.ts)break;root_urls.unshift(parent_url.from);if(!ts)ts=parent_url.ts;list.splice(0,list.indexOf(parent_url)+1);parent_url=list.find((e=>e.to==parent_url.from))}return root_urls.splice(0,limit||4)}function track_redirect_del(tab_id){if(tab_id===undefined)return;if(last_committed[tab_id])delete last_committed[tab_id];if(tabs_redirect[tab_id]){if(tabs_redirect[tab_id].to)be_vpn_util.clear_timeout(tabs_redirect[tab_id].to);delete tabs_redirect[tab_id]}}E.track_redirect=track_redirect;E.get_redirect_list=(tab_id,limit)=>{var time_limit=Date.now()-120*date.ms.SEC;var active_url=E.get("active.url");active_url=active_url&&get_root_url(active_url);return get_redirect_sequence(tab_id,active_url,time_limit,limit)};E.get_loading_tab_url=tab_id=>{if(be_util.CG("disable_loading_tabs_tracker"))return;let site_req=E.be_tab_unblocker.loading_sites[tab_id];if(site_req)return site_req.url};const init_listeners=()=>{chrome.tabs.onCreated.addListener(on_created);chrome.tabs.onUpdated.addListener(on_updated);chrome.tabs.onActivated.addListener(on_activated);chrome.tabs.onRemoved.addListener(on_removed);chrome.tabs.onReplaced.addListener(on_replaced);if(chrome.windows)chrome.windows.onFocusChanged.addListener(on_focused);set_navigation_listeners()};E.init=be_tab_unblocker=>{if(E.inited)return;E.be_tab_unblocker=be_tab_unblocker;E.sp=be_vpn_util.new_etask("be_tabs");E.listen_to(be_ext,"change:ext.active change:ext.suspended",update_state);E.urls={};chrome.tabs.query({},(_tabs=>{if(!_tabs)return;for(var i=0;i<_tabs.length;i++){tabs[_tabs[i].id]=_tabs[i];set_url(_tabs[i].id,_tabs[i].url)}}));chrome.windows.getLastFocused({},(win=>{if(win)on_focused(win.id)}));if(!v3)init_listeners();E.on_init("change:active.real.id",active_cb);E.inited=true};E.uninit=()=>{if(!E.inited)return;E.sp.return();chrome.tabs.onCreated.removeListener(on_created);chrome.tabs.onUpdated.removeListener(on_updated);chrome.tabs.onActivated.removeListener(on_activated);chrome.tabs.onRemoved.removeListener(on_removed);chrome.tabs.onReplaced.removeListener(on_replaced);if(chrome.windows)chrome.windows.onFocusChanged.removeListener(on_focused);E.off("change:active.real.id",active_cb);del_navigation_listeners();E.stopListening();E.inited=false;E.urls=undefined;E.clear()};function set_navigation_listeners(){if(E.nav_listening)return;E.nav_listening=true;if(zutil.get(chrome,"webNavigation.onBeforeNavigate"))chrome.webNavigation.onBeforeNavigate.addListener(on_before_navigate);if(zutil.get(chrome,"webNavigation.onCompleted"))chrome.webNavigation.onCompleted.addListener(on_completed);if(zutil.get(chrome,"webNavigation.onErrorOccurred"))chrome.webNavigation.onErrorOccurred.addListener(on_error_occured);if(zutil.get(chrome,"webNavigation.onCommitted"))chrome.webNavigation.onCommitted.addListener(on_committed)}function del_navigation_listeners(){if(!E.nav_listening)return;E.nav_listening=false;if(zutil.get(chrome,"webNavigation.onBeforeNavigate")){chrome.webNavigation.onBeforeNavigate.removeListener(on_before_navigate)}if(zutil.get(chrome,"webNavigation.onCompleted"))chrome.webNavigation.onCompleted.removeListener(on_completed);if(zutil.get(chrome,"webNavigation.onErrorOccurred"))chrome.webNavigation.onErrorOccurred.removeListener(on_error_occured);if(zutil.get(chrome,"webNavigation.onCommitted"))chrome.webNavigation.onCommitted.removeListener(on_committed)}E.get_tab=tab_id=>{if(tab_id>0)return etask.cb_apply(chrome.tabs,".get",[tab_id])};E.get_nav_tab_url=id=>nav_tabs[id];E.get_nav_tabs=()=>nav_tabs;function del_tab(id){delete tabs[id];delete nav_tabs[id];if(!E.urls[id])return;delete E.urls[id];E.trigger("url_updated",id)}function set_url(id,url){if(!url||url==E.urls[id])return;E.urls[id]=url;E.trigger("url_updated",id,url)}function update_state(){let is_active=!be_ext.is_disabled();if(E.is_active==is_active)return;E.is_active=is_active;del_navigation_listeners();if(!E.is_active)return;set_navigation_listeners()}E.get_url=tab_id=>E.get_loading_tab_url(tab_id)||E.urls&&E.urls[tab_id];E.active=()=>E.get_tab(E.get("active.id"));E.update=(tab_id,opt)=>etask((function*update(){try{if(!+tab_id)throw new Error("invalid tab_id");yield etask.cb_apply(chrome.tabs.update,[+tab_id,opt])}catch(e){be_util.perr("be_tab_update_err",{tab_id,opt},{err:e,rate_limit:{count:1}})}}));E.reload=tab_id=>etask((function*reload(){try{if(!+tab_id)throw new Error("invalid tab_id");yield etask.cb_apply(chrome.tabs.reload,[+tab_id,{bypassCache:true}])}catch(e){be_util.perr("be_tab_reload_err",{tab_id},{err:e,rate_limit:{count:1}})}}));var tabs_suggestions={};E.set_force_suggestion=(tab_id,val)=>{tabs_suggestions[tab_id]=val};E.is_force_suggestion=tab_id=>tabs_suggestions[tab_id];const payment_tabs={};E.open_payment_page=url=>etask((function*open_payment_page(){let tab;try{tab=yield etask.cb_apply(chrome.tabs.create,[{url,active:true}]);if(chrome.runtime.lastError)throw new Error(chrome.runtime.lastError);payment_tabs[tab.id]=1;be_util.perr("be_open_payment_page_created",{tab_id:tab.id,url})}catch(e){be_util.perr("be_open_payment_page_error",{url},{err:e});return}}));E.t={get_redirect_sequence,tabs_redirect};if(v3)init_listeners();return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},4968:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var underscore__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8763);var underscore__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_0__);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_2__);var _util_url_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(5305);var _util_url_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_util_url_js__WEBPACK_IMPORTED_MODULE_3__);var _util_storage_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1032);var _util_storage_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_util_storage_js__WEBPACK_IMPORTED_MODULE_4__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5__);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4130);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_6__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7__);var _bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(1211);var _bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_8__);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(843);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_9__);var _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(897);var _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_10__);var _bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(7148);var _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(6210);var _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(8076);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_14__);var _bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(9265);var _util_util_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_16__);var _util_escape_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(4336);var _util_escape_js__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(_util_escape_js__WEBPACK_IMPORTED_MODULE_17__);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18__);var _util_version_util_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(6262);var _util_version_util_js__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(_util_version_util_js__WEBPACK_IMPORTED_MODULE_19__);var _bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(7666);var _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(8552);var _bext_vpn_bg_tpopup_script_js__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(9568);var _util_user_agent_js__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(901);var _util_user_agent_js__WEBPACK_IMPORTED_MODULE_22___default=__webpack_require__.n(_util_user_agent_js__WEBPACK_IMPORTED_MODULE_22__);
// LICENSE_CODE ZON
_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18___default().assert_bg("be_tpopup");const{chrome}=self,{assign}=Object;const CG=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().CG;const v3=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().is_v3;const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_1___default().model.extend({model_name:"tpopup",_defaults:function(){this.on("destroy",(()=>this.uninit()))}}));const popup_showing=()=>{if(v3)return _bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_8___default().msg.is_connected(-1);let views=chrome.extension.getViews({type:"popup"});return views&&views.length>0};const min_suggest_rate=.3;let forced_urls={},connected_tpopups={},loading_tpopups={};let tpopup_windows={};E.is_connected=(tab_id,tpopup_type)=>{if(!_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_8___default().tabs.is_connected(tab_id))return false;return tpopup_type?connected_tpopups[tab_id]==tpopup_type:connected_tpopups[tab_id]};const is_never_show_popup=(root_url,url)=>_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18___default().is_skip_url(url)||_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18___default().is_google(root_url)&&!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().check_min_ver(CG("tpopup.allow_google_min_ver"))||_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18___default().is_youtube(root_url)&&!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().check_min_ver(CG("tpopup.allow_youtube_min_ver"));const is_never_show_popup_by_rating=root_url=>_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18___default().is_google(root_url)&&!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().check_min_ver(CG("tpopup.allow_rule_rating_google_min_ver"))||_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18___default().is_youtube(root_url)&&!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().check_min_ver(CG("tpopup.allow_rule_rating_youtube_min_ver"));const is_old_mac=()=>{try{const ua=navigator.userAgent;const hola_br_i=ua.indexOf("Hola/");const is_macos=_util_user_agent_js__WEBPACK_IMPORTED_MODULE_22___default().guess().os=="macos";let hola_br_ver="";if(hola_br_i>-1&&is_macos){hola_br_ver=ua.substring(hola_br_i+5);if(!!hola_br_ver&&_util_version_util_js__WEBPACK_IMPORTED_MODULE_19___default().cmp(hola_br_ver,"1.198.611")<0){return true}}}catch(e){return false}return false};const get_rule=url=>{const rules=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18___default().get_rules(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_13__.Z.get("rules"),url);return underscore__WEBPACK_IMPORTED_MODULE_0___default().first(rules)};const is_protect=url=>{if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().full_browser_mode())return false;let rule=get_rule(url)||{};return rule.enabled&&_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18___default().is_all_browser(rule)||rule.mode=="protect"};const is_tpopup_disabled=()=>{let popup_conf=(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().get("bext_config")||{}).popup||{};return popup_conf.disable||_util_version_util_js__WEBPACK_IMPORTED_MODULE_19___default().cmp(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().version(),popup_conf.disable_max_ver)<0};E.do_tpopup=(tab,root_url,tpopup_opt,opt)=>loading_tpopups[tab&&tab.id]||_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*do_tpopup(){let url=tab&&tab.url,tab_id=tab&&tab.id;root_url=root_url||url&&_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_9___default().get_root_url(url);if(!url||!root_url||_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().is_disabled()||is_tpopup_disabled())return;loading_tpopups[tab_id]=this;this.finally((()=>delete loading_tpopups[tab_id]));this.catch((err=>{_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().perr("be_tpopup_err",{},{err,with_log:true});delete connected_tpopups[tab_id]}));_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_11__.Z.trace(tab_id,url,"do_tpopup start");tpopup_opt=tpopup_opt||(yield get_tpopup_opt({tab_id,url,root_url,tab_change:opt&&opt.tab_change}));if(!tpopup_opt)return;yield render_tpopup(assign({tab_id,root_url,url},tpopup_opt))}));const check_unblockig_rate=root_url=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){let unblocking_rate=yield _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].get_unblocking_rate(200);if(!unblocking_rate)return false;let min_rate=CG("debug.disable_min_unblocking_rate_check")?0:min_suggest_rate;let rate;for(let i=0,r;!rate&&(r=unblocking_rate[i]);i++){if(r.root_url==root_url&&r.unblocking_rate>min_rate)rate=r;else if(root_url=="bbc.com"&&r.root_url=="bbc.co.uk"&&r.unblocking_rate>min_rate){rate=r}}return!!rate}));const get_tpopup_opt=({tab_id,url,root_url,tab_change})=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){if(need_welcome_popup(root_url,url))return{tpopup_type:"welcome"};if(tab_change)return;let premium_rule=_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_15__["default"].get_force_premium_rule(root_url,{tab_url:url});if(is_old_mac()&&(url||"").indexOf("chrome://")==0)return{tpopup_type:"browser_update"};if(_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().get(premium_rule,"blacklist")){_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d no tpopup - blacklist %s",tab_id,root_url);return}if(is_protect(url)){_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d hide tpopup when protect browser/pc is enabled",tab_id);return}if(is_never_show_popup(root_url,url)){return _util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d tpopup not allowed on %s",tab_id,root_url)}let proxy_country=is_rule_enabled(url)?get_rule(url).country:null;if(need_watermark_popup(tab_id,url,proxy_country)){_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d need watermark popup",tab_id);return{tpopup_type:"watermark"}}if(_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_11__.Z.is_popup_needed(root_url)&&_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].need_trial(root_url)){_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d need mitm_trial watermark popup",tab_id);return{tpopup_type:"watermark",fallback_tab_url:_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_11__.Z.get_confirm_tab_url(root_url,tab_id)}}if(_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_11__.Z.is_popup_needed(root_url)){_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_11__.Z.trace(tab_id,url,"do_tpopup mitm popup should be shown");_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d mitm popup should be shown",tab_id);return{tpopup_type:"watermark",fallback_tab_url:_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_11__.Z.get_confirm_tab_url(root_url,tab_id)}}if(need_force_suggestion(tab_id,url)){_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d need forced suggestion popup",tab_id);_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_6___default().set_force_suggestion(tab_id,null);_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_13__.Z.set_stub_rule(tab_id,null);return{tpopup_type:"suggestion",prefix:"suggest"}}if(need_stub_rule_popup(tab_id,url)){let tpopup_country=(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_13__.Z.get_stub_rule(tab_id)||{}).country||"";_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d need last rule popup",tab_id);_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_6___default().set_force_suggestion(tab_id,null);_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_13__.Z.set_stub_rule(tab_id,null);return{tpopup_type:"suggestion",tpopup_country:tpopup_country.toUpperCase(),prefix:"stub_rule"}}let another_tab_suggestion_opt=yield need_another_tab_suggestion(root_url,url);if(another_tab_suggestion_opt){return{tpopup_type:"another_tab_suggestion",tpopup_country:another_tab_suggestion_opt.country.toUpperCase()}}let forced;if(forced=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].is_force_tpopup(root_url)){_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].unset_force_tpopup(root_url);_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d popup was forced",tab_id);if(forced=="rule_rating")return{tpopup_type:"suggestion",prefix:"rule_rating"};if(typeof forced=="string")return{tpopup_type:forced};forced_urls[root_url]=forced;return{tpopup_type:"suggestion",prefix:"forced"}}if(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].is_dont_show(root_url))return _util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d tab is don't show",tab_id);let smode=get_suggestion_mode(root_url);if(["always","never"].includes(smode)||smode=="by_popular"&&_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].is_dont_show(root_url,"suggestion")){_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d skip tpopup, site has suggestion conf",tab_id);return}if(forced=forced_urls[root_url]){_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d popup was forced2",tab_id);return typeof forced=="string"?{tpopup_type:forced}:{}}if(premium_rule||is_rule_enabled(url))return;if(is_never_show_popup_by_rating(root_url)){_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d skip tpopup, %s tpopup by rating is not allowed",tab_id,root_url);return}_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d checking if site has high unblocking rate",tab_id);if(!(yield check_unblockig_rate(root_url))){_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d skip tpopup, unblocking rate is too low",tab_id);return}if(get_suggestion_mode(root_url)=="by_popular"&&!_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].is_dont_show(root_url,"suggestion")){_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d need watermark popup (by_popular)",tab_id);return{tpopup_type:"watermark"}}if(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].is_dont_show(root_url,"suggestion"))return;return{tpopup_type:"suggestion",prefix:"rule_rating"}}));const render_tpopup=({tab_id,tpopup_type,root_url,tpopup_country,url,fallback_tab_url,prefix})=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){if(popup_showing()&&!tpopup_type)return _util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d extension popup is opened",tab_id);let tab=yield _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_6___default().get_tab(tab_id);if(!tab)return _util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default()("tab:%d tpopup tab disappeared",tab_id);if(tab.url!=url){_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default()("tab:%d tpopup tab changed url %s -> %s",tab_id,url,tab.url);return}if(E.is_connected(tab_id,tpopup_type))return;let win_id=tpopup_windows[tab_id];if(win_id&&(yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().cb_apply(chrome.windows,".get",[win_id])))return;_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d applying tpopup to tab",tab_id);let opt={tab_id,connection_id:tab_id+":tpopup:"+underscore__WEBPACK_IMPORTED_MODULE_0___default().random(Number.MAX_SAFE_INTEGER),root_url,url,ext_url:chrome.runtime.getURL("")+"js"};if(tpopup_type){opt.type=tpopup_type;opt.style=tpopup_type=="welcome"?{top:"5px",right:"20px",width:"335px",height:"560px","box-shadow":"0px 4px 16px 0px rgba(50, 48, 47, 0.11)"}:{top:"0",right:"0",width:"0",height:"0"}}else{opt.style=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().check_min_ver(CG("new_design_min_ver"))?{top:"5px",right:"20px",width:"366px",height:"320px"}:{top:"5px",right:"20px",width:"274px",height:"377px"}}if(tpopup_country)opt.country=tpopup_country;if(prefix)opt.prefix=prefix;try{if(CG("debug.fail_trial_tpopup")&&_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_21__["default"].get_site_storage(root_url,"force_trial")||CG("debug.fail_all_tpopup")){throw new Error("test fail_tpopup")}yield inject_iframe(tab_id,opt);connected_tpopups[tab_id]=tpopup_type||true}catch(e){if(e.message.match(/(tab was closed)|(no tab)/i))return;if(fallback_tab_url){_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_21__["default"].open_be_tab({url:fallback_tab_url,force_active:true});return}_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().perr("be_tpopup_inject_err",{tab_url:tab.url,tab_id,tpopup_type,tab},{err:e,with_log:true});if(_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_21__["default"].get_site_storage(root_url,"force_trial")&&_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().check_min_ver(CG("tpopup_window_min_ver"))){opt.mode="window";let win=yield create_window(opt);if(win)tpopup_windows[tab_id]=win.id}}}));const inject_iframe=(tab_id,opt)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){let site_conf=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().get_site_conf(opt.root_url)||{};opt=Object.assign({},opt,{tpopup_parent:site_conf.tpopup_parent||CG("tpopup_parent")});let tabapi=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_21__["default"].tabid2api(tab_id);let code=`(${_bext_vpn_bg_tpopup_script_js__WEBPACK_IMPORTED_MODULE_23__.Z.toString()})(${JSON.stringify(opt)})`;_util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d inject tpopup iframe",tab_id);let res;if(v3){res=yield chrome.scripting.executeScript({target:{tabId:+tabapi},func:_bext_vpn_bg_tpopup_script_js__WEBPACK_IMPORTED_MODULE_23__.Z,args:[opt]})}else{res=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().cb_apply(chrome.tabs,".executeScript",[tabapi,{code,matchAboutBlank:true}])}let err=chrome.runtime.lastError||res&&res[0]&&res[0].err;if(err)throw new Error(err);else _util_zerr_js__WEBPACK_IMPORTED_MODULE_14___default().notice("tab:%d tpopup iframe injected",tab_id)}));const create_window=opt=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){let url=opt.ext_url+"/popup.html?"+_util_escape_js__WEBPACK_IMPORTED_MODULE_17___default().qs(opt);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().perr("be_tpopup_create_window",{opt});return yield _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_21__["default"].create_window({width:360,height:550,url})}));const is_trial_expired=(url,root_url)=>{let rule_country=(get_rule(url)||{}).country;return _bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].is_trial_expired(root_url)&&!_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_15__["default"].is_active()&&!!rule_country};const need_trial_ended=(url,root_url,proxy_country)=>proxy_country&&is_trial_expired(url,root_url)&&!_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_21__["default"].get_site_storage(root_url,"trial.dont_show_ended");const get_suggestion_mode=root_url=>{const site_conf=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().get_site_conf(root_url);const c=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().get_suggestion_conf(site_conf,_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].get("country"));return c&&(c.mode||"by_popular")};const is_rule_enabled=url=>(get_rule(url)||{}).enabled;const need_geo_suggestion=(tab_id,url,root_url)=>{if(!_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_15__["default"].is_active()&&_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_21__["default"].get_site_storage(root_url,"force_trial")){return true}return get_suggestion_mode(root_url)=="always"&&!is_rule_enabled(url)&&!_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_trial_active(root_url)&&!is_trial_expired(url,root_url)&&!_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].is_dont_show(root_url,"suggestion")};const need_geo_watermark=(tab_id,url,root_url)=>{const allow_hide=_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_15__["default"].is_active()&&!_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_15__["default"].is_dunning()||_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().get(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().get("bext_config"),"geo_popup.watermark.allow_hide");return is_rule_enabled(url)&&(!allow_hide||!_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].is_dont_show(root_url,"watermark"))};const need_force_suggestion=(tab_id,url)=>{const root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_9___default().get_root_url(url);let post_install=E.get("post_install_redirect");post_install=post_install&&_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_9___default().get_root_url(post_install);return _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_21__["default"].is_vpn_allowed(url,true)&&!_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18___default().is_google(root_url)&&(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_6___default().is_force_suggestion(tab_id)||root_url==post_install)&&!_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].is_dont_show(root_url,"suggestion")};const need_proxy_error_dialog=tab_id=>_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().proxy_error_ui_enabled("dialog")&&!!_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_10___default().get_tab_load_err(tab_id);const need_watermark_popup=(tab_id,url,proxy_country)=>{if(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().is_disabled())return false;let root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_9___default().get_root_url(url);return need_geo_watermark(tab_id,url,root_url)||need_trial_ended(url,root_url,proxy_country)||need_geo_suggestion(tab_id,url,root_url)||need_proxy_error_dialog(tab_id)};const need_stub_rule_popup=(tab_id,url)=>{if(!_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_21__["default"].is_vpn_allowed(url,true)||_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18___default().is_skip_url(url)||_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_13__.Z.get_per_tab_rule(tab_id)){return false}const rule=_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_13__.Z.get_stub_rule(tab_id);const root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_9___default().get_root_url(url);return rule&&!_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].is_dont_show(root_url,"suggestion")};const need_welcome_popup=(root_url,url)=>_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_trial_conf("splash_anim")&&_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_trial_conf("auto_show_ui")&&!_util_storage_js__WEBPACK_IMPORTED_MODULE_4___default().get("splash_done")&&!_util_url_js__WEBPACK_IMPORTED_MODULE_3___default().is_hola_domain(root_url)&&!_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18___default().is_skip_url(url)&&!is_never_show_popup(root_url,url);const need_another_tab_suggestion=(root_url,url)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){if(!_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_trial_conf("another_tab_suggestion")||get_rule(url)||_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18___default().is_skip_url(url)||_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_12__["default"].is_dont_show(root_url,"another_tab_suggestion")){return null}const tabs=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().cb_apply(chrome.tabs,".query",[{}]);for(let tab of tabs){let tu=_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_10___default().get_tab_unblocker(tab.id);if(tu&&tu.rule&&!_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_18___default().is_all_browser(tu.rule))return{country:tu.rule.country}}return null}));const tpopup_on_create=o=>E.do_tpopup(o.tab);const tpopup_on_updated=o=>E.do_tpopup(o.tab);const tpopup_on_tab_change=o=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){let tab=yield _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_6___default().active();E.do_tpopup(tab,null,null,{tab_change:true})}));const tpopup_on_replaced=o=>chrome.tabs.get(o.added,(tab=>E.do_tpopup(tab)));const tpopup_on_removed=o=>o&&E.close_tab_tpopup(o.id);const tpopup_msg=(c_id,name,opt)=>{let tab_id=+c_id.split(":")[0];chrome.tabs.sendMessage(tab_id,assign({id:"tpopup."+name,_type:"tpopup",_connection_id:c_id},opt))};E.show=c_id=>{tpopup_msg(c_id,"show")};E.hide=c_id=>{tpopup_msg(c_id,"hide")};E.close=c_id=>{tpopup_msg(c_id,"close")};E.pause_videos=c_id=>{tpopup_msg(c_id,"pause_videos")};E.resume_videos=c_id=>{tpopup_msg(c_id,"resume_videos")};let resize_et={};E.resize=(c_id,opt)=>{if(resize_et[c_id])resize_et[c_id].return();return _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*resize_(){this.finally((()=>delete resize_et[c_id]));resize_et[c_id]=this;tpopup_msg(c_id,"resize",opt);return yield this.wait()}))};E.close_tab_tpopup=tab_id=>{let connections=_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_8___default().tabs.get_tab_connections(tab_id);if(connections)connections.forEach((c_id=>E.close(c_id)));if(connected_tpopups[tab_id])connected_tpopups[tab_id]=false};const on_resize_end=e=>{if(resize_et[e.connection_id])resize_et[e.connection_id].continue()};const enabled_cb=()=>{if(!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().is_disabled())return;Object.keys(connected_tpopups).forEach((tab_id=>E.close_tab_tpopup(tab_id)))};const on_trial_end=trial=>{Object.keys(connected_tpopups).forEach((tab_id=>{if(!_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].match_url(trial,_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_6___default().get_url(tab_id)))return;const connections=_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_8___default().tabs.get_tab_connections(tab_id);if(connections)connections.forEach((c_id=>E.pause_videos(c_id)))}))};const on_iframe_disappeared=data=>_util_etask_js__WEBPACK_IMPORTED_MODULE_2___default()((function*(){if(!_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].is_trial_expired(data.root_url))return;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_5___default().perr("be_tpopup_trial_end_disappeared",data,{with_log:true});yield _util_etask_js__WEBPACK_IMPORTED_MODULE_2___default().sleep(1e3);_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_10___default().reauth_all_agents()}));E.uninit=()=>{if(!E.inited)return;E.inited=0;E.off("resize_end",on_resize_end);E.off("iframe_disappeared",on_iframe_disappeared);E.stopListening()};E.init=()=>{if(E.inited)return;E.inited=1;E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_6___default(),"created",tpopup_on_create);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_6___default(),"updated",tpopup_on_updated);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_6___default(),"replaced",tpopup_on_replaced);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_6___default(),"removed",tpopup_on_removed);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_6___default(),"change:active.id",tpopup_on_tab_change);E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default(),"change:ext.active change:ext.suspended",enabled_cb);E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default(),"trial_end",on_trial_end);E.on("resize_end",on_resize_end);E.on("iframe_disappeared",on_iframe_disappeared)};E.t={need_watermark_popup,need_force_suggestion,get_tpopup_opt};const __WEBPACK_DEFAULT_EXPORT__=E},9568:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});
// LICENSE_CODE ZON
const __WEBPACK_DEFAULT_EXPORT__=tpopup_opt=>{const b=window.chrome||typeof browser!="undefined"&&browser;const assign=Object.assign;let port,inited=false;let frame,fade,arrow_anim;let{url,type,root_url,connection_id,ext_url,tab_id,country,prefix,style,tpopup_parent}=tpopup_opt;let expected_style={};const max_zindex=2147483647;const v3=b.runtime.getManifest().manifest_version==3;const auto_px={width:1,height:1,top:1,left:1,right:1,bottom:1,"max-width":1,"max-height":1,"min-width":1,"min-height":1};const is_number=n=>!isNaN(parseFloat(n))&&isFinite(n);const set_css=(el,css_styles)=>{Object.entries(css_styles).forEach((prop=>{let name=prop[0],value=prop[1];if(value&&is_number(value)&&auto_px[name])value+="px";el.style.setProperty(name,value,"important");if(el==frame)expected_style[name]=value}));return el};const rm_element=el=>el&&el.parentNode&&el.parentNode.removeChild(el);const append_element=el=>frame&&frame.parentNode&&frame.parentNode.appendChild(el);const rm_fade=()=>{rm_element(fade);fade=undefined};const set_fade=show=>{if(!show){if(!fade)return;if(fade.animate){fade.animate([{opacity:"1"},{opacity:"0"}],{duration:300,easing:"ease-in"}).addEventListener("finish",rm_fade)}else rm_fade();return}if(fade)return;fade=set_css(document.createElement("div"),{position:"fixed",border:"none",top:"0",left:"0",width:"100%",height:"100%","background-color":"#7d7d7d8f",visibility:"visibile","z-index":max_zindex-1,"backdrop-filter":"blur(2px)","color-scheme":"normal"});append_element(fade);if(fade.animate){fade.animate([{opacity:"0"},{opacity:"1"}],{duration:300,easing:"ease-in"})}};const animate=(el,css,time,cb)=>{if(!el.animate){set_css(el,css);if(cb)cb();return}let first=el.getBoundingClientRect();set_css(el,assign({"transform-origin":"top left"},css));let last=el.getBoundingClientRect();let scale_x=first.width/last.width;let scale_y=first.height/last.height;let dx=first.left-last.left;let dy=first.top-last.top;if(!dx&&!dy&&scale_x==1&&scale_y==1)return void cb&&cb();let translate="translate("+dx+"px, "+dy+"px)";let scale="scale("+scale_x+", "+scale_y+")";el.animate([{transform:translate+" "+scale},{transform:"translate(0, 0) scale(1, 1)"}],{duration:time||200,easing:"ease-in"}).addEventListener("finish",(()=>{if(cb)cb()}))};const resize_iframe=opt=>{if(!frame)return;let css={width:opt.width,height:opt.height,margin:opt.margin||""};if(opt.top!==undefined)css.top=opt.top;if(opt.left!==undefined)css.left=opt.left;if(opt.right!==undefined)css.right=opt.right;if(opt.bottom!==undefined)css.bottom=opt.bottom;if(opt.animate)animate(frame,css,opt.animation_time);else set_css(frame,opt);if(opt.fade!==undefined)set_fade(opt.fade)};const rm_iframe=()=>{try{if(!frame)return;rm_fade();rm_element(frame);frame=undefined}catch(e){console.error("rm_iframe error: "+e)}};const get_iframe_parent=()=>{const el=document.fullscreenElement;const parent=tpopup_parent||"documentElement";if(!el||type!="watermark")return document[parent];if(el.tagName=="IFRAME")return el.contentDocument?el.contentDocument.body:document[parent];if(el.shadowRoot)return el.shadowRoot;if(el.tagName=="VIDEO"||el.tagName=="IMG")return document[parent];return el};const must_exit_fullscreen=()=>{let el=document.fullscreenElement;return el&&(el.tagName=="IFRAME"&&!el.contentDocument||frame&&frame.parentElement!=el)};const exit_fullscreen=()=>document.exitFullscreen();const is_playing=video=>{if(video.tagName=="VIDEO")return!video.paused&&!video.ended};const is_paused=video=>{if(video.tagName=="VIDEO")return video.paused&&!video.ended};const play_video=video=>{if(video.tagName=="VIDEO")return void video.play()};const pause_video=video=>{if(video.tagName=="VIDEO")return void video.pause()};const add_iframe=()=>{if(frame)return;if(document.getElementById("_hola_popup_iframe__"))return void console.error("frame already exists");if(!document.body)return void console.error("document not ready");let styles=assign({position:"fixed","max-width":"100%","max-height":"100%","background-color":"transparent","z-index":max_zindex,overflow:"hidden",visibility:"hidden",border:"none",display:"block","color-scheme":"normal"},style);frame=document.createElement("iframe");set_css(frame,styles);get_iframe_parent().appendChild(frame);frame.setAttribute("src",ext_url+"/popup.html?tab_id="+tab_id+"&connection_id="+connection_id);frame.setAttribute("id","_hola_popup_iframe__")};const trigger=(name,data)=>b.runtime.sendMessage({type:"be_msg_req",_type:"tpopup",_tab_id:tab_id,context:{rmt:true},msg:{msg:"call_api",obj:"tpopup",func:"trigger",args:[name,assign({tab_id,connection_id},data)]}});const ext_send_msg=msg=>b.runtime.sendMessage({type:"be_msg_req",_type:"tpopup",_tab_id:tab_id,context:{rmt:true},msg:{msg:"call_api",obj:"tpopup",func:"send_tpopup_msg",args:[tab_id,msg]}});const perr=(id,info,perr_opt)=>b.runtime.sendMessage({type:"be_msg_req",_type:"tpopup",_tab_id:tab_id,context:{rmt:true},msg:{msg:"call_api",obj:"tpopup",func:"perr",args:[tab_id,id,assign({root_url,url},info),perr_opt]}});const on_ext_msg=msg=>{if(msg._connection_id!=connection_id)return;switch(msg.id){case"tpopup.init":ext_send_msg({id:"cs_tpopup.init",_type:"tpopup",_connection_id:connection_id,data:{tab_id,connection_id,url,root_url,country,prefix,type,fullscreen:!!document.fullscreenElement}});break;case"tpopup.show":set_css(frame,{visibility:"visible"});break;case"tpopup.hide":set_css(frame,{visibility:"hidden"});break;case"tpopup.resize":if(msg.fade&&must_exit_fullscreen())exit_fullscreen();resize_iframe({width:msg.width,height:msg.height,top:msg.top,left:msg.left,right:msg.right,bottom:msg.bottom,fade:msg.fade,animate:msg.animate,animation_time:msg.animation_time,margin:msg.margin});trigger("resize_end");break;case"tpopup.pause_videos":pause_videos();break;case"tpopup.resume_videos":resume_videos();break;case"tpopup.close":uninit();break}};let paused_videos=[];const pause_videos=()=>{const paused=[];let videos=Array.from(document.querySelectorAll("video"));let iframes=Array.from(document.querySelectorAll("iframe"));iframes.forEach((i=>{if(!i.contentDocument)return;videos=videos.concat(Array.from(i.contentDocument.querySelectorAll("video")))}));videos.forEach((v=>{try{if(!is_playing(v))return;pause_video(v);paused.push(v)}catch(e){perr("geo_trial_ended_pause_video_err",{err:e.message});console.error("pause video error: "+e)}}));if(paused.length)perr("geo_trial_ended_pause_video",{count:paused.length});paused_videos=paused_videos.concat(paused)};const resume_videos=()=>{const resumed=[];paused_videos.forEach((v=>{try{if(!is_paused(v))return;play_video(v);resumed.push(v)}catch(e){perr("geo_trial_ended_resume_video_err",{err:e.message});console.error("play video error: "+e)}}));if(resumed.length)perr("geo_trial_ended_resume_video",{count:resumed.length});paused_videos=[]};const move_frame=parent=>{parent.appendChild(frame);set_css(frame,{visibility:"hidden"})};const on_fullscreen=()=>{const parent=get_iframe_parent();if(frame&&frame.parentElement!==parent)move_frame(parent)};const on_body_mousedown=()=>trigger("body_click");const on_mouseenter=()=>trigger("mouseenter");const on_mouseleave=()=>trigger("mouseleave");let overlapping_int;const start_overlapping_detector=()=>{overlapping_int=setInterval((()=>{if(!frame)return;let el=frame;while(el=el.nextElementSibling){if(+window.getComputedStyle(el).zIndex!=max_zindex)continue;move_frame(frame.parentElement);stop_overlapping_detector();return}}),1e3)};const stop_overlapping_detector=()=>clearInterval(overlapping_int);const is_disappeared=()=>{if(!frame)return false;let expected_hidden=expected_style.visibility=="hidden"||expected_style.display=="none"||Number.parseInt(expected_style.width)==0||Number.parseInt(expected_style.height)==0;if(expected_hidden||window.innerHeight<100||window.innerWidth<100)return false;if(!frame.isConnected)return true;let cstyle=window.getComputedStyle(frame);let rect=frame.getBoundingClientRect();return cstyle.visibility=="hidden"||cstyle.display=="none"||rect.width==0||rect.height==0||rect.x+rect.width<0||rect.y+rect.height<0||rect.x>window.innerWidth||rect.y>window.innerHeight};const cleanup_style=s=>{let temp_el=document.createElement("div");document.body.appendChild(temp_el);let def_style=window.getComputedStyle(temp_el);s=assign({},s);for(let key in s){if(s[key]==""||s[key]==def_style[key])delete s[key]}temp_el.remove();return s};const start_iframe_monitor=()=>{monitor_int=setInterval((()=>{if(!is_disappeared())return;let fs_el=document.fullscreenElement;let info={root_url,removed:!frame.isConnected,style:frame.getAttribute("style"),expected_style,computed_style:cleanup_style(window.getComputedStyle(frame)),rect:frame.getBoundingClientRect(),windown_width:window.innerWidth,window_height:window.innerHeight,fullscreenEl:fs_el&&fs_el.tagName};perr("tpopup_iframe_disappeared",info);trigger("iframe_disappeared",info);stop_iframe_monitor()}),5e3)};let monitor_int;const stop_iframe_monitor=()=>clearInterval(monitor_int);const connect_to_bg=()=>{try{port=b.runtime.connect({name:connection_id});if(v3){port._timer=setInterval((()=>port.postMessage({msg:"ping"})),25e3)}}catch(e){uninit();return}port.onDisconnect.addListener((()=>{port=null;if(v3)setTimeout((()=>connect_to_bg()),100);else uninit()}))};const init=()=>{try{if(inited)return;if(url!=location.href&&!(location.href=="chrome://new-tab-page/"&&url=="chrome://newtab/")){console.error("expected url: "+url+" actual: "+location.href);return}if(!(document instanceof window.HTMLDocument))throw new Error("wrong document type");inited=true;add_iframe();if(!frame)return;if(document.body)document.body.addEventListener("mousedown",on_body_mousedown);frame.addEventListener("mouseenter",on_mouseenter);frame.addEventListener("mouseleave",on_mouseleave);document.addEventListener("fullscreenchange",on_fullscreen);document.addEventListener("webkitfullscreenchange",on_fullscreen);document.addEventListener("mozfullscreenchange",on_fullscreen);start_overlapping_detector();start_iframe_monitor();connect_to_bg();b.runtime.onMessage.addListener(on_ext_msg);window.addEventListener("beforeunload",uninit)}catch(e){return{err:e.message}}return{err:null}};const uninit=()=>{if(!inited)return;paused_videos=[];if(frame){frame.removeEventListener("mouseenter",on_mouseenter);frame.removeEventListener("mouseleave",on_mouseleave)}if(document.body)document.body.removeEventListener("mousedown",on_body_mousedown);rm_iframe();document.removeEventListener("fullscreenchange",on_fullscreen);document.removeEventListener("webkitfullscreenchange",on_fullscreen);document.removeEventListener("mozfullscreenchange",on_fullscreen);stop_overlapping_detector();stop_iframe_monitor();b.runtime.onMessage.removeListener(on_ext_msg);if(port){port.onDisconnect.removeListener(uninit);port.disconnect();clearInterval(port._timer);port=null}inited=false};return init()}},7666:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var conf__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9641);var underscore__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8763);var underscore__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_1__);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_2__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_3__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_4__);var _util_date_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_5__);var _util_storage_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(1032);var _util_storage_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_util_storage_js__WEBPACK_IMPORTED_MODULE_6__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7__);var _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(9651);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(4130);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9__);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(843);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_10__);var _svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(8033);var _svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12__);var _bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(9265);var _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(6210);var _util_util_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_15__);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_16__);var _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(8552);var _bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(1002);var _bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(7676);var _pub_state_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(7619);
// LICENSE_CODE ZON
_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().assert_bg("be_trial");const assign=Object.assign;const{SEC,DAY}=_util_date_js__WEBPACK_IMPORTED_MODULE_5___default().ms;let is_user_updated;let state,monitor_state;let activation_tracker;const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_2___default().task_model.extend({model_name:"trial",_defaults:function(){this.on("destroy",(()=>E.uninit()))}}));let perr=(name,info,opt)=>{opt=opt||{};let trial_info=E.get_trial_perr_info();if(trial_info.timeline)opt.filehead=trial_info.timeline+"\n\n"+(opt.filehead||"");_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr(name,assign({cycle_stats:trial_info.cycle_stats,state:trial_info.state},info),opt)};let fetch_trials=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*fetch_trials_states_(){try{const auth=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().auth();if(!auth||!auth.uuid||!auth.session_key){log_timeline("missing_session");perr("be_empty_user_session");return}let qs=assign(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(),auth,{min_conf_ver:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().CG("reset_trial.min_conf_ver")});return yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.ccgi_ajax({url:conf__WEBPACK_IMPORTED_MODULE_0__.url_ccgi+"/trial_get3",qs,retry:2,timeout:7*SEC})}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().warn("get_trial failed %s",_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().e2s(e))}}));let refresh_trials=is_init=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){if(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().get("is_premium"))return;log_timeline("refresh trials");let states=is_init?state.get("trial_states"):null;if(!states){states=yield fetch_trials();state.set("trial_states",states)}_first_start_ts=_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().find_first_start_ts(states,_first_start_ts);user_trials=new(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().User_trials)(states,_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params());monitor_active_trial()}));let update_active_tab_trial_ui=()=>{let url=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9___default().get("active.url");if(!url)return;let root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().get_root_url(url);if(!root_url)return;let client_params=_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url);let trial;if(trial=user_trials.check_ui_conf_change(client_params)){log_timeline(`trial ui change detected: ${root_url}`);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_change",trial.get_obj())}};E.get_watch_time_ms=()=>{if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().check_min_install_ver(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().CG("ext_trial_watch_time_min_ver"))){return _util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().get_int("trial_watch_time_ms")}};const get_active_sites=()=>{let sites={};let urls=Object.values(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9___default().urls);for(let url of urls){let rules=E.be_rule.get_rules(url);if(!rules.length)continue;let root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().get_root_url(url);if(root_url)sites[root_url]=1}return Object.keys(sites)};const get_site_stats_obj=(trial,site)=>{const cycle_n=trial.state.cycle_n||0;let cycle_stats=state.get("cycle_stats");if(!cycle_stats||cycle_stats.cycle_n!=cycle_n)cycle_stats={cycle_n,sites:{}};if(!cycle_stats.sites[site]){cycle_stats.sites[site]={watching_ms:0,waiting_ms:0,idle_ms:0,interruptions_n:0}}state.set("cycle_stats",cycle_stats);return cycle_stats.sites[site]};const record_site_usage=(trial,site,duration)=>{if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().CG("trial_disable_per_site_activity_tracker"))return;let site_stats=get_site_stats_obj(trial,site);if(trial.is_running()){site_stats.watching_ms+=duration;if(site!="total")activation_tracker.count_watch(site,duration)}else{if(trial.is_wait_ended()||trial.can_start_new_cycle())site_stats.idle_ms+=duration;else site_stats.waiting_ms+=duration}state.set(["cycle_stats","sites",site],site_stats)};const record_site_interruption=(trial,site)=>{if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().CG("trial_disable_per_site_activity_tracker"))return;let site_stats=get_site_stats_obj(trial,site);site_stats.interruptions_n++;state.set(["cycle_stats","sites",site],site_stats)};let _trial_monitor;let monitor_active_trial=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){if(_trial_monitor)return;state.set("cycle_stats",{});log_timeline(`monitor_active_trial start`);E.sp.spawn(_trial_monitor=this);this.finally((()=>{log_timeline(`monitor_active_trial finish`);_trial_monitor=null}));const interval_ms=SEC;let watch_time_ms=E.get_watch_time_ms();let trial_usage=0,it=0;const monitor_perr=(id,info)=>{if(info&&info.trial_obj&&info.trial_obj.conf){info.trial_obj=Object.assign({},info.trial_obj);info.trial_obj.conf=underscore__WEBPACK_IMPORTED_MODULE_1___default().omit(info.trial_obj.conf,"_conf2ab_test_")}perr(it>0?id:id+"_delayed",info)};return yield _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().interval(interval_ms,(()=>{if(!user_trials.is_enabled(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params()))return;let active_sites=get_active_sites();if(active_sites.length)active_sites=active_sites.concat("total");update_active_tab_trial_ui();let is_active;for(let tkey in user_trials.trials){let trial=user_trials.trials[tkey];for(let site of active_sites)record_site_usage(trial,site,interval_ms);let trial_obj=trial.get_obj();if(trial.is_running()){if(watch_time_ms!==undefined){_util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().set_json("trial_watch_time_ms",watch_time_ms+=interval_ms)}is_active=true;monitor_state.delete(`ended${tkey}`);continue}if(trial.is_wait_ended()){if(!monitor_state.get(`wait_ended${tkey}`)){log_timeline(`trial_wait_end ${tkey}`);if(!trial_obj.conf.autostart_after_wait)monitor_perr("be_trial_cycle_wait_ready",{trial_obj});_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_wait_end",trial_obj);monitor_state.set(`wait_ended${tkey}`,true);E.send_trial_times_perr("trial_wait_end",trial_obj)}}else monitor_state.delete(`wait_ended${tkey}`);if(!monitor_state.get(`ended${tkey}`)){_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_end",trial_obj);let remaining_time=E.get_remaining_cycle_time(trial.state.root_url);log_timeline(`trial_end ${tkey} `+`remaining time ${remaining_time}ms (monitor)`);if(remaining_time>0)monitor_perr("be_trial_cycle_wait",{trial_obj});else monitor_perr("be_trial_cycle_end",{trial_obj});E.send_trial_times_perr("trial_watch_end",trial_obj);monitor_perr("be_trial_end",{type:"site",entity:trial.state.root_url});for(let site of active_sites)record_site_interruption(trial,site);monitor_state.set(`ended${tkey}`,true)}if(trial.is_grace_ended(true)){if(!monitor_state.get(`grace_ended${tkey}`)){_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_grace_end",trial_obj);monitor_state.set(`grace_ended${tkey}`,true);monitor_perr("be_trial_grace_end",{trial_obj})}}else monitor_state.delete(`grace_ended${tkey}`)}if(is_active)trial_usage++;else{if(trial_usage>0)perr("be_trial_usage",{sec:trial_usage});trial_usage=0}it++}))}));let _set_trial_et;E.set_trial=root_url=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*set_trial_(){log_timeline(`set_trial ${root_url}`);this.finally((()=>{_set_trial_et=null}));if(_set_trial_et)yield this.wait_ext(_set_trial_et);let alredy_started=E.get_trial_active(root_url);if(alredy_started)return alredy_started;try{_set_trial_et=this;const auth=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().auth();if(!auth||!auth.uuid||!auth.session_key){log_timeline("missing_session");perr("be_empty_user_session",{type:"trial_start",root_url});return}const qs=assign(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(),auth,{domain:root_url});perr("be_trial_start",{type:"site",entity:root_url});let prev_trial=E.get_trial_active(root_url,true);let res=yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.ccgi_ajax({url:conf__WEBPACK_IMPORTED_MODULE_0__.url_ccgi+"/trial_set3",qs,retry:2,timeout:4*SEC});if(!res||!res.key){log_timeline(`set_trial: ${root_url}. empty response`);perr("be_trial_start_no_trial",{type:"site",entity:root_url});return}_first_start_ts=_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().find_first_start_ts(res.states,_first_start_ts);state.delete("skipped_signin_ts");user_trials=new(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().User_trials)(res.states,_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params());let trial=user_trials.trials[res.key];if(!trial)throw new Error("missing conf during trial start");if(trial.state.interval_n==0){perr("be_trial_cycle_start",{domain:root_url});if(!prev_trial||!prev_trial.start_ts)perr("be_trial_cycle_start_first",{domain:root_url})}perr("be_trial_start_got_trial",{type:"site",entity:root_url,state:trial.state});monitor_active_trial();log_timeline(`set_trial: ${root_url}. start trial`);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_start",trial.get_obj());E.send_trial_times_perr("trial_watch_start",trial.get_obj());return trial.get_obj()}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().warn("trial_start failed %s",_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().e2s(e));log_timeline(`set_trial failed: ${root_url}. ${_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().e2s(e)}`);perr("be_trial_start_error",{type:"site",entity:root_url},{err:e});throw new Error(_util_util_js__WEBPACK_IMPORTED_MODULE_15___default().get(e,"hola_info.data.err","unknown"))}}));let trial_reset=(root_url,full_reset)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*trial_reset_(){log_timeline(`reset_trial ${root_url}`);let user_id=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().get("user_id");let qs=assign(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(),{user_id},_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().auth());if(full_reset)qs.full_reset=1;else qs.domain=root_url;try{yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.ccgi_ajax({url:conf__WEBPACK_IMPORTED_MODULE_0__.url_ccgi+"/trial_reset3",qs});state.delete("skipped_signin_ts");yield refresh_trials(false);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_change")}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().warn("trial_reset failed %s",_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().e2s(e));log_timeline(`trial_reset failed ${root_url} ${_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().e2s(e)}`);throw new Error(_util_util_js__WEBPACK_IMPORTED_MODULE_15___default().get(e,"hola_info.data.err","unknown"))}}));E.is_trial_expired=root_url=>user_trials.is_expired(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url));E.get_trial_active=(root_url,ignore_ts)=>user_trials.get_trial_active(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url),ignore_ts,!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().CG("trial_disable_stub_instances_v2"));E.get_trials_info=cur_root_url=>user_trials.get_trials_info(cur_root_url);E.get_next_trial_ts=(root_url,subtract_wait)=>{let client_params=_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url);let ret=user_trials.get_next_interval_ts(client_params,subtract_wait);let delay=ret-client_params.now;if(delay){perr("be_trial_next_ts",{delay,subtract_wait},{rate_limit:{count:1}})}return ret};E.get_last_trial_end_ts=root_url=>user_trials.get_last_interval_end_ts(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url));E.get_trial_wait=root_url=>user_trials.get_trial_wait(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url));E.reset_trial=(root_url,full_reset)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){yield trial_reset(root_url,full_reset);_first_start_ts=null}));E.need_trial=root_url=>user_trials.need_trial(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url));E.get_trial_reason=root_url=>user_trials.get_trial_reason(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url));E.is_unlimited_trial=root_url=>{if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().CG("debug.force_plus_mode"))return true;return user_trials.is_unlimited_trial(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url))};E.need_ext_pin_tip=root_url=>{if(_util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().get("ext_pin_tip_shown"))return;return user_trials.need_ext_pin_tip(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url))};E.shown_ext_pin_tip=root_url=>{_util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().set("ext_pin_tip_shown",_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_17__["default"].now())};E.need_signin=root_url=>user_trials.need_signin(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url));E.move_trial_time=(root_url,time,count)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){let user_id=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().get("user_id");if(!E.get_trial_active(root_url,true))return;log_timeline(`move trial time ${root_url} for ${time}ms count: ${count}`+"(debug)");try{perr("be_trial_move_trial_time",{type:"site",root_url,time,count});let client_params=_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url);const qs=assign({},client_params,_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().auth(),{domain:root_url,time,user_id,count});let old_t=user_trials.get_trial(client_params,true);const res=yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.ccgi_ajax({method:"POST",url:conf__WEBPACK_IMPORTED_MODULE_0__.url_ccgi+"/move_trial_time3",qs});if(old_t){if(+time)old_t.move_time(+time);else if(+count)old_t.move_count(+count)}user_trials=new(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().User_trials)(res.states,_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params());let new_t=user_trials.get_trial(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url),true);if(old_t&&new_t)assign(new_t.state,old_t.state,new_t.state);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_change",new_t&&new_t.get_obj())}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().warn("move_trial_time failed %s",_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().e2s(e));log_timeline(`move_trial_time failed ${_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().e2s(e)}`);throw new Error(_util_util_js__WEBPACK_IMPORTED_MODULE_15___default().get(e,"hola_info.data.err","unknown"))}}));E.match_url=(trial_obj,url)=>{if(!trial_obj.conf)return;let root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().get_root_url(url);let t=user_trials.get_trial(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url),true);return t&&t.get_conf().key==trial_obj.conf.key};E.get_trial_period=root_url=>user_trials.get_interval_dur(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url));E.get_total_cycle_time=(root_url,for_wait_screen)=>user_trials.get_total_cycle_time(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url),for_wait_screen);E.get_used_cycle_time=(root_url,subtract_current)=>user_trials.get_used_cycle_time(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url),subtract_current);E.get_used_trial_time=(root_url,subtract_current)=>user_trials.get_used_trial_time(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url),subtract_current);E.is_wait_ended=root_url=>user_trials.is_wait_ended(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url));let _set_close_watermark_et;let set_close_watermark=root_url=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*set_close_watermark_(){log_timeline(`set_close_watermark ${root_url}`);this.finally((()=>{_set_close_watermark_et=null}));if(_set_close_watermark_et)yield this.wait_ext(_set_close_watermark_et);try{_set_close_watermark_et=this;const auth=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().auth();if(!auth||!auth.uuid||!auth.session_key){log_timeline("missing_session");perr("be_empty_user_session",{type:"set_close_watermark",root_url});return}const qs=assign(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(),auth,{domain:root_url});perr("be_trial_close_watermark",{type:"site",entity:root_url});let res=yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.ccgi_ajax({url:conf__WEBPACK_IMPORTED_MODULE_0__.url_ccgi+"/trial_set_close_watermark",qs});if(!res||!res.key){log_timeline(`set_close_watermark: ${root_url}. empty response`);perr("be_trial_close_watermark_no_trial",{type:"site",entity:root_url});return}user_trials=new(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().User_trials)(res.states,_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params());let trial=user_trials.trials[res.key];if(!trial)throw new Error("missing conf during close watermark");log_timeline(`set_close_watermark: ${root_url}. success`);monitor_active_trial();return trial.get_obj()}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().warn("set_close_watermark failed %s",_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().e2s(e));log_timeline(`set_close_watermark failed: ${root_url} ${_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().e2s(e)}`);perr("be_trial_close_watermark_error",{type:"site",entity:root_url},{err:e});throw new Error(_util_util_js__WEBPACK_IMPORTED_MODULE_15___default().get(e,"hola_info.data.err","unknown"))}}));let _start_wait;let start_wait=root_url=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*start_wait_(){log_timeline(`start wait ${root_url}`);this.finally((()=>{_start_wait=null}));if(_start_wait)yield this.wait_ext(_start_wait);try{_start_wait=this;const auth=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().auth();if(!auth||!auth.uuid||!auth.session_key){log_timeline("missing_session");perr("be_empty_user_session",{type:"trial_start_wait",root_url});return}const qs=assign(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(),auth,{domain:root_url});perr("be_trial_close_watermark",{type:"site",entity:root_url});let res=yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.ccgi_ajax({url:conf__WEBPACK_IMPORTED_MODULE_0__.url_ccgi+"/trial_start_wait",qs,retry:2,timeout:7*SEC});if(!res||!res.key){log_timeline(`start_wait: ${root_url}. empty response`);perr("be_trial_start_wait_no_trial",{type:"site",entity:root_url});return}user_trials=new(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().User_trials)(res.states,_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params());let trial=user_trials.trials[res.key];if(!trial)throw new Error("missing conf during trial_start");log_timeline(`start_wait: ${root_url}. success`);monitor_active_trial();return trial.get_obj()}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().warn("start_wait failed %s",_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().e2s(e));log_timeline(`start_wait failed: ${root_url} ${_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().e2s(e)}`);perr("be_trial_start_wait_error",{type:"site",entity:root_url},{err:e});throw new Error(_util_util_js__WEBPACK_IMPORTED_MODULE_15___default().get(e,"hola_info.data.err","unknown"))}}));E.close_bonus_tooltip=root_url=>{let client_params=_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url);user_trials.close_bonus_tooltip(client_params);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_change")};E.hide_watermark=root_url=>{let client_params=_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url);if(!user_trials.can_hide_watermark(client_params))return;set_close_watermark(root_url);user_trials.close_watermark(client_params);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_change");return true};E.can_hide_watermark=root_url=>user_trials.can_hide_watermark(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url));E.skip_signin=root_url=>{let trial=user_trials.get_trial(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url));if(trial)trial.skip_signin();else state.set("skipped_signin_ts",_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_17__["default"].now());_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_change")};E.can_skip_signin=root_url=>user_trials.can_skip_signin(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url));E.get_remaining_cycle_time=root_url=>Math.max(E.get_total_cycle_time(root_url)-E.get_used_cycle_time(root_url),0);E.get_trial_perr_info=()=>({timeline:get_timeline(),state:get_trial_state(),cycle_stats:state.get("cycle_stats")});E.start_wait=root_url=>{let trial=user_trials.get_trial(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url));if(!trial)return;if(trial.is_wait_ended()){log_timeline("attempt to start ended wait");_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_wait_end",trial.get_obj());return}if(!trial.start_wait(root_url)){log_timeline("no need to start wait");_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_wait_end",trial.get_obj());return}start_wait();monitor_active_trial();let trial_obj=trial.get_obj();_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_wait_start",trial_obj);E.send_trial_times_perr("trial_wait_start",trial_obj);if(!trial.get_conf().autostart_after_wait)perr("be_trial_cycle_wait_waiting",{trial_obj})};E.stop_wait=root_url=>{let trial=user_trials.get_trial(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params(root_url));if(!trial)return;log_timeline("stop wait");trial.stop_wait();_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_wait_stop",trial.get_obj())};let _fetch_server_ts=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*__fetch_server_ts(){log_timeline("fetch new /server_ts");try{yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_8__.Z.ccgi_ajax({url:conf__WEBPACK_IMPORTED_MODULE_0__.url_ccgi+"/server_ts"})}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().warn("fetch_server_ts failed %s",_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().e2s(e))}}));let fetch_server_ts=underscore__WEBPACK_IMPORTED_MODULE_1___default().throttle(_fetch_server_ts,SEC,{trailing:false});let reset_trial_conf;let update_reset_trial=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){let prev=reset_trial_conf;reset_trial_conf=_util_util_js__WEBPACK_IMPORTED_MODULE_15___default().get(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().get("bext_config"),"reset_trial");if(prev&&reset_trial_conf&&prev.min_conf_ver!=reset_trial_conf.min_conf_ver){log_timeline("reset trial due to conf version change");yield refresh_trials(false);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default().trigger("trial_change")}}));let user_trials=new(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().User_trials);let get_timeline=()=>{let timeline=state.get("timeline");if(!timeline||_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().CG("trial_timeline.disable"))return;return timeline.log.map((l=>_util_date_js__WEBPACK_IMPORTED_MODULE_5___default().to_sql(l.ts)+": "+l.msg)).join("\n")};let get_trial_state=()=>{if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().CG("trial_timeline.disable_perr_state"))return;return E.get_trials_info()};let log_timeline=msg=>{_util_zerr_js__WEBPACK_IMPORTED_MODULE_4___default().notice(msg);let timeline=state.get("timeline");if(!timeline)return;let cfg=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().CG("trial_timeline",{});if(cfg.disable)return;timeline.log.push({ts:_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_17__["default"].now(),msg});let max_size=cfg.max_size||500;if(max_size<timeline.log.length)timeline.log=timeline.log.slice(max_size>>1);state.set("timeline",timeline)};let _first_start_ts;let get_first_start_ts=()=>{let min_ts=_first_start_ts;let ts=user_trials.get_first_start_ts(min_ts);if(ts&&(!min_ts||ts<min_ts))min_ts=ts;return min_ts};E.get_param_from_state=param=>{if(param=="first_start_ts")return get_first_start_ts();if(param=="skipped_signin_ts"&&state.get("skipped_signin_ts"))return state.get("skipped_signin_ts");let states=user_trials.get_states();for(let key in states){if(states[key][param])return states[key][param]}};E.can_start_trial_silently=root_url=>{if(E.need_signin(root_url)||E.get_trial_wait(root_url)&&!E.is_wait_ended(root_url)){return false}let next_ts=E.get_next_trial_ts(root_url);return!next_ts||next_ts<_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_17__["default"].now()};E.start_trial=root_url=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){let trial=E.get_trial_active(root_url)||(yield E.set_trial(root_url));_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_17__["default"].set_site_storage(root_url,"trial",{dont_show_ended:false});return trial}));const before_request=e=>{let root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().get_root_url(e.url);if(!E.need_trial(root_url)||E.is_trial_expired(root_url))return;if(E.can_start_trial_silently(root_url)){perr("be_trial_autostart");E.start_trial(root_url)}else perr("be_trial_unexpected_request")};E.init=(be_rule,be_tpopup,be_tab_unblocker)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){state=new _pub_state_js__WEBPACK_IMPORTED_MODULE_20__["default"]("be_trial_state",{trial_states:null,cycle_stats:{},timeline:{log:[]},activation_tracker:{},skipped_signin_ts:null},{persistent:false});yield state.load();monitor_state=new _pub_state_js__WEBPACK_IMPORTED_MODULE_20__["default"]("be_trial_monitor",{ended:{},wait_ended:{},grace_ended:{}},{persistent:true,ttl:Infinity});yield monitor_state.load();user_trials=new(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().User_trials);activation_tracker=new(_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().Activation_tracker)(state);E.be_rule=be_rule;E.sp=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().new_etask("be_trial");_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().init({conf_get:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().CG,perr,be_util:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default(),now:_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_17__["default"].now,get_uuid_md5:_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_17__["default"].get_uuid_md5,be_ext:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default(),be_mode:_bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_18__.Z,is_user_updated:()=>is_user_updated,must_verify_email:()=>_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_16___default().must_verify_email(_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_13__["default"].get("user")),get_ab_test:()=>_bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_19__.Z.get_ab_tests(),get_param_from_state:E.get_param_from_state,be_info:_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_14__["default"]});E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default(),"change:session_key",(()=>refresh_trials(true)));E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default(),"change:user_id",(()=>{monitor_active_trial()}));E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_7___default(),"change:bext_config",update_reset_trial);update_reset_trial();E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9___default(),"change:active.id on_focused",(()=>{let url=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9___default().get_url(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_9___default().get("active.id"));let root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().get_root_url(url);if(!root_url||!state.get("trial_states")||!E.get_trial_active(root_url,true)){return}update_active_tab_trial_ui();if(_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_17__["default"].need_date_sync())fetch_server_ts()}));E.listenTo(be_tpopup,"mouseenter body_click",(()=>{if(!state.get("trial_states")||!E.get_trial_active(null,true))return;if(_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_17__["default"].need_date_sync())fetch_server_ts()}));E.listenTo(_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_13__["default"],"user_updated",(()=>is_user_updated=true));E.listenTo(be_tab_unblocker,"change:activity",underscore__WEBPACK_IMPORTED_MODULE_1___default().debounce((function(){let sites=activation_tracker.flush();if(!sites||_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().CG("activation_tracker_disable"))return;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr("be_activation",{sites})}),_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().CG("activation_tracker_debounce_ms")||60*SEC));E.listenTo(be_tab_unblocker,"before_request",before_request)}));E.uninit=()=>{E.sp.return();E.stopListening()};E.get_trial_conf=key=>{const client_params=_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params();const trial=user_trials.get_trial_active(client_params,true,true);return _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().get_trial_conf(trial,key)};E.is_vpn_forbidden=()=>{if(!E.get_trial_conf("client_block_after_grace_time"))return false;const client_params=_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params();return!!user_trials.is_vpn_forbidden(client_params,true)};E.get_suggested_survey_id=()=>{if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().CG("debug.survey"))return"s1";let client_params=_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params();return user_trials.can_start_survey(client_params)&&E.get_trial_conf("suggested_survey_id")};E.notify_survey_suggested=()=>{let client_params=_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params();user_trials.notify_survey_suggested(client_params)};E.notify_survey_done=()=>{perr("be_trial_survey_done");let client_params=_svc_vpn_pub_trial_lib_js__WEBPACK_IMPORTED_MODULE_11___default().get_client_params();user_trials.notify_survey_done(client_params)};E.send_trial_times_perr=(event,trial_obj)=>{let day=monitor_state.get("trial_times_day");let today=Math.floor(_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_17__["default"].now()/DAY);let is_watch=event=="trial_watch_start"||event=="trial_watch_end";let is_wait=event=="trial_wait_start"||event=="trial_wait_end";let count=1,state_time=0,trial_time=0,add_time=0;if(day==today){count=monitor_state.get(`trial_times_${event}_n`,0)+1;if(is_watch)state_time=monitor_state.get(`trial_times_watch_time`,0);else if(is_wait)state_time=monitor_state.get(`trial_times_wait_time`,0);trial_time=monitor_state.get(`trial_times_trial_time`,0)}if(event=="trial_watch_end")add_time=trial_obj.expire_ts-trial_obj.interval_ts;else if(event=="trial_wait_end")add_time=trial_obj.wait_end_ts-trial_obj.wait_start_ts;trial_time+=add_time;state_time+=add_time;monitor_state.set("trial_times_day",today);monitor_state.set(`trial_times_${event}_n`,count);monitor_state.set(`trial_times_trial_time`,trial_time);if(is_watch)monitor_state.set(`trial_times_watch_time`,state_time);else if(is_wait)monitor_state.set(`trial_times_wait_time`,state_time);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr("be_trial_times",{state:event,daily_state_count:count,daily_state_time:state_time,daily_trial_time:trial_time})};E.close_nonblock_slide=slide=>{_util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().set("nonblock_slide_"+slide,_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_17__["default"].now());return true};if(false){}const __WEBPACK_DEFAULT_EXPORT__=E},9370:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var underscore__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8763);var underscore__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_0__);var conf__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9641);var zon_config__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4118);var cookie__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(9813);var cookie__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(cookie__WEBPACK_IMPORTED_MODULE_3__);var _util_util_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_4__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_5__);var _util_date_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_6__);var _util_storage_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1032);var _util_storage_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_util_storage_js__WEBPACK_IMPORTED_MODULE_7__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_8__);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_9__);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_10__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11__);var _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(8552);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(4130);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_13__);var _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(9651);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15__);var _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(8076);var _bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(9265);var _bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(7148);var _bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(1679);var _bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(7666);var _bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(3886);var _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(897);var _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_22___default=__webpack_require__.n(_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_22__);var _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(6210);var _bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(4968);var _bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(737);var _bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(7676);var _bext_vpn_bg_icon_js__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(8084);var _bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(1211);var _bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_28___default=__webpack_require__.n(_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_28__);
// LICENSE_CODE ZON
_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_10___default().assert_bg("bg_ui_api");const chrome=self.chrome;const{CG}=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default();const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_9___default().task_model.extend({model_name:"bg_ui_api",_defaults:function(){this.on("destroy",(()=>E.uninit()))}}));E.init=be_bg_main=>{if(E.inited)return;E.set_enabled=be_bg_main.set_enabled;E.set_agree_ts=be_bg_main.set_agree_ts;E.debug_set_install_ts=be_bg_main.debug_set_install_ts;E.debug_set_install_ver=be_bg_main.debug_set_install_ver;E.bg_main_recover=()=>void be_bg_main.trigger("recover");_util_storage_js__WEBPACK_IMPORTED_MODULE_7___default().set("ui_popup_render_count",0);const attributes={ext_active:{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),key:"ext.active"},ext_suspended:{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),key:"ext.suspended"},ext_conflict:{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),key:"ext.conflict"},no_permission:{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),key:"no_permission"},is_premium:{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default()},is_ultra:{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default()},bext_config:{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default()},uuid:{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default()},user_id:{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default()},uuid_info:{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default()},install_ts:{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default()},install_version:{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default()},is_blocked_by_av:{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default()},active_tab_url:{model:_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_13___default(),key:"active.url"},active_tab_id:{model:_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_13___default(),key:"active.id"},rules:{model:_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__.Z},rule_status:{model:_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__.Z,key:"status"},rule_status_opt:{model:_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__.Z,key:"status_opt"},user:{model:_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_17__["default"]},membership:{model:_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_17__["default"]},vpn_last_rating:{model:_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"]},rate_on_store:{model:_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"]},country:{model:_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"]},location:{model:_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"]},vpn_work_yes:{model:_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"]},rate_us_count:{model:E},info_status:{model:_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"],key:"status"},dev_mode:{model:_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_19__["default"]},vpn_country:{model:_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_25__["default"]},svc_info:{model:_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_25__["default"],key:"info"},svc_version:{model:_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_25__["default"],key:"version"},svc_status:{model:_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_25__["default"],key:"status"},ref_prefix:{model:_bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_26__.Z},vpn_status:{model:_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z,key:"status"},bg_main_status:{model:be_bg_main,key:"status"},bg_main_inited:{model:be_bg_main,key:"inited"},enabled:{model:be_bg_main},agree_ts:{model:be_bg_main},hola_conn_hostname:{model:_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_14__.Z}};Object.keys(attributes).forEach((attr=>{const model=attributes[attr].model;const model_key=attributes[attr].key||attr;E.listen_to(model,"change:"+model_key,(()=>E.set(attr,model.get(model_key))))}));const events=[{model:_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_24__.Z,event:"body_click"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"trial_end"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"trial_start"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"trial_wait_start"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"trial_wait_stop"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"trial_wait_end"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"trial_change"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"mitm_change"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"local_time_change"},{model:_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z,event:"force_trial"},{model:_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_24__.Z,event:"mouseleave"},{model:_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_24__.Z,event:"mouseenter"},{model:_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_13___default(),event:"url_updated",name:"tab_url_updated"},{model:_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_13___default(),event:"change:active.url",name:"active_url_changed"},{model:_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_13___default(),event:"change:active.id",name:"tab_id_changed"},{model:_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"],event:"change:country",name:"country_changed"},{model:_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"],event:"change:location",name:"location_changed"},{model:be_bg_main,event:"change:enabled",name:"enabled_changed"},{model:be_bg_main,event:"change:inited",name:"bg_main_inited"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"change:is_premium change:is_ultra",name:"user_changed"},{model:_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_17__["default"],event:"change:user",name:"user_changed"},{model:_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_17__["default"],event:"change:membership",name:"membership_changed"},{model:_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__.Z,event:"change:rules change:tabs_stub_rules "+"change:per_tab_rules",name:"rule_changed"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"change:ext.active",name:"ext_active_changed"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"change:ext.suspended",name:"ext_suspended_changed"},{model:_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"],event:"change:status",name:"status_changed"},{model:_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"],event:"change:settings",name:"settings_changed"},{model:_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__.Z,event:"change:status set_tab_state",name:"status_changed"},{model:_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_22___default(),event:"change:tab_load_err",name:"tab_load_err"},{model:_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_25__["default"],event:"change:status",name:"status_changed"},{model:_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z,event:"change:status",name:"vpn_status_changed"},{model:_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__.Z,event:"set_tab_state"},{model:_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_25__["default"],event:"change:info",name:"svc_info_changed"},{model:_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_25__["default"],event:"change:version",name:"svc_version_changed"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"change:ext.conflict",name:"ext_conflict_changed"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"change:no_permission",name:"no_permission_changed"},{model:be_bg_main,event:"change:agree_ts",name:"agree_ts_changed"},{model:_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_19__["default"],event:"change:dev_mode",name:"dev_mode_changed"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"change:bext_config",name:"bext_config_changed"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"change:user_message_show",name:"user_message_changed"},{model:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default(),event:"change:is_blocked_by_av",name:"is_blocked_by_av_changed"}];events.forEach((v=>{E.listenTo(v.model,v.event,((...args)=>{if(v.event.startsWith("change:"))args=[];E.trigger(v.name||v.event,...args)}))}));E.on("popup_open",on_popup_open);_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_28___default().backbone.server.start(E,"bg_ui_api");E.inited=true};E.uninit=()=>{if(!E.inited)return;E.inited=false;_bext_pub_browser_js__WEBPACK_IMPORTED_MODULE_28___default().backbone.server.stop("bg_ui_api");E.stopListening();E.off("popup_open",on_popup_open)};const store_urls={chrome:"https://chromewebstore.google.com/detail/"+"hola-vpn-the-website-unbl/gkojfkhlekighikafcpjkiklfbnlmeio/reviews",opera:"https://addons.opera.com/en/extensions/details/"+"hola-better-internet/",firefox:"https://addons.mozilla.org/en-US/firefox/addon/"+"hola-free-vpn-proxy-unblocker/",edge:"https://microsoftedge.microsoft.com/addons/detail/"+"eibinhpjpbkmjeohlclnebmkhdfehpbf"};const review_urls={chrome:store_urls.chrome+"/reviews",opera:store_urls.opera,firefox:store_urls.firefox+"reviews/",edge:store_urls.edge};const get_rate_us_url=()=>{let urls=CG("rate_us.urls");let src_country=(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].get("country")||"").toUpperCase();if(!urls||!urls.length)urls=[{url:"store",rand:1}];urls=urls.sort(((a,b)=>a.rand-b.rand));let random=Math.random();let browser=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().browser();for(let item of urls){if(item.countries&&!item.countries.includes(src_country)||item.browsers&&!item.browsers.includes(browser)){continue}if(random>item.rand){random-=item.rand;continue}return item.url=="store"?review_urls[browser]:item.url}};E.open_rate_us=()=>{let url=get_rate_us_url();if(!url)return;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().perr("be_open_rate_us",{rate_url:url});_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].set_rate_on_store(Date.now());E.open_new_tab({url,force_active:true})};E.open_web_store=()=>E.open_new_tab({url:store_urls[_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().browser()],force_active:true});E.set_rate_us_count=count=>E.set("rate_us_count",count);E.reset_rate_us=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].reset_rate_us;const on_popup_open=rule=>{_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_22___default().reauth_rule_agents(rule);_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_22___default().reverify_rule_agents(rule);if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().CG("debug.force_plus_mode"))_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().perr("be_debug_plus_popup_open")};const dev_info=()=>{const ext_type=(()=>{const types=underscore__WEBPACK_IMPORTED_MODULE_0___default().invert(conf__WEBPACK_IMPORTED_MODULE_1__.ids);return id=>types[id]})();try{var a=[],manifest;if(chrome&&!(manifest=chrome.runtime.getManifest()).update_url&&!_util_util_js__WEBPACK_IMPORTED_MODULE_4___default().get(manifest,"applications.gecko.update_url")){a.push("no update")}if(chrome&&!conf__WEBPACK_IMPORTED_MODULE_1__.browser.firefox&&!ext_type(chrome.runtime.id))a.push("unknown id");if(zon_config__WEBPACK_IMPORTED_MODULE_2__._RELEASE_LEVEL!=2){if(zon_config__WEBPACK_IMPORTED_MODULE_2__._RELEASE_LEVEL==1)a.push("rel1");if(zon_config__WEBPACK_IMPORTED_MODULE_2__.BUILDTYPE_DEBUG)a.push("debug")}if(conf__WEBPACK_IMPORTED_MODULE_1__.arch)a.push(conf__WEBPACK_IMPORTED_MODULE_1__.arch);return a.join(",")}catch(e){_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default()("dev_info %s",_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().e2s(e))}return""};E.get_product_info=()=>{const build=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().build_info(),dev=dev_info();const res=[];const add=(name,value)=>{if(value)res.push({name,value})};add("Ext version",build.ext_version||_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().version());add("WWW version",build.server_version);add("Service",build.svc_version);if(build.svc_mode){let mode=build.svc_mode+" active";if(build.svc_mode_pending)mode+=", "+build.svc_mode_pending+" pending";add("Mode",mode)}add("Product",build.product_type);add("Browser",build.browser);add("Platform",build.platform);add("UUID",_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default().get("uuid"));add("Dev info",dev);return res};E.get_popup_rating_cache=root_url=>{let cache=_util_storage_js__WEBPACK_IMPORTED_MODULE_7___default().get_json("popup_rating_cache");return cache&&root_url==cache.root_url&&cache.rule_ratings||null};E.set_popup_rating_cache=(root_url,rule_ratings)=>_util_storage_js__WEBPACK_IMPORTED_MODULE_7___default().set_json("popup_rating_cache",{rule_ratings,root_url});E.need_upgrade_msg=()=>{if(Date.now()-_util_storage_js__WEBPACK_IMPORTED_MODULE_7___default().get_int("upgrade_msg_ts")<_util_date_js__WEBPACK_IMPORTED_MODULE_6___default().ms.DAY)return false;let browser=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().browser();let min_ver_all=CG("upgrade_msg.min_ver.all");let min_ver_browser=CG(`upgrade_msg.min_ver.${browser}`);return!!min_ver_all&&!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().check_min_ver(min_ver_all)||!!min_ver_browser&&!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().check_min_ver(min_ver_browser)};E.click_upgrade=upgrade=>{_util_storage_js__WEBPACK_IMPORTED_MODULE_7___default().set("upgrade_msg_ts",Date.now());if(upgrade)E.open_web_store()};E.init_monitor_active=()=>{let data=_util_storage_js__WEBPACK_IMPORTED_MODULE_7___default().get_json("monitor_active")||{};data.ui_open_ts=Date.now();_util_storage_js__WEBPACK_IMPORTED_MODULE_7___default().set_json("monitor_active",data)};E.uninit_monitor_active=()=>{let data=_util_storage_js__WEBPACK_IMPORTED_MODULE_7___default().get_json("monitor_active")||{};data.ui_close_ts=Date.now();_util_storage_js__WEBPACK_IMPORTED_MODULE_7___default().set_json("monitor_active",data)};E.set_dbg_conf=(path,value)=>{_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_12__["default"].set_dbg_conf(path,value);_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.set_bext_config()};E.reset_uuid=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*reset_uuid(){const qs=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().qs_ajax(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default().auth());yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_14__.Z.ccgi_ajax({url:conf__WEBPACK_IMPORTED_MODULE_1__.url_ccgi+"/reset_uuid",qs});_util_storage_js__WEBPACK_IMPORTED_MODULE_7___default().clr_all();if(chrome.storage.local)yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.storage.local,".clear",[]);if(chrome.storage.session)yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.storage.session,".clear",[]);cookie__WEBPACK_IMPORTED_MODULE_3___default().remove("install_ts");cookie__WEBPACK_IMPORTED_MODULE_3___default().remove("install_version");yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.cookies,".remove",[{url:conf__WEBPACK_IMPORTED_MODULE_1__.url_ccgi,name:"install_ts"}]);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().reload_ext_native()}));E.fix_ext_conflict=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*fix_ext_conflict(){let id=chrome.runtime.id;let exts=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.management,".getAll",[]);for(let ext of exts){if(!ext.enabled||!ext.permissions.includes("proxy")||ext.id==id)continue;_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().notice(`disable ext ${ext.name}`);yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.management,".setEnabled",[ext.id,false])}return!(yield E.check_ext_conflict())}));E.check_ext_conflict=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*check_ext_conflict(){let res=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.proxy.settings,".get",[{}]);return res.levelOfControl=="controlled_by_other_extensions"}));E.focus_on_tab=tab_id=>_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_13___default().update(tab_id,{active:true});E.get_dbg_conf=path=>_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_12__["default"].get_dbg_conf(path);E.get_storage_locale=()=>_util_storage_js__WEBPACK_IMPORTED_MODULE_7___default().get("locale");E.set_storage_locale=locale=>_util_storage_js__WEBPACK_IMPORTED_MODULE_7___default().set("locale",locale);E.trigger_not_working=opt=>void _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_15___default().trigger("not_working",opt);E.fetch_rules=()=>void _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__.Z.trigger("fetch_rules");E.trigger_force_trial=opt=>void _bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.trigger("force_trial",opt);E.bg_vpn_recover=()=>void _bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.trigger("recover");E.open_new_tab=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_12__["default"].open_new_tab;E.open_be_tab=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_12__["default"].open_be_tab;E.update_tab=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_12__["default"].update_tab;E.perr=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().perr;E.get_log=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_11___default().get_log;E.get_tab_load_err=_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_22___default().get_tab_load_err;E.get_enabled_rule=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.get_enabled_rule;E.get_disabled_rule=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.get_disabled_rule;E.send_vpn_work_report=_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__.Z.send_vpn_work_report;E.send_fix_it_report=_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__.Z.send_fix_it_report;E.set_dont_show_again=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].set_dont_show_again;E.get_dont_show_rules=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].get_dont_show_rules;E.is_dont_show=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].is_dont_show;E.get_rule_ratings=_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__.Z.get_rule_ratings;E.fix_vpn=_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__.Z.fix_vpn;E.set_rule=_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__.Z.set_rule;E.rule_task_cancel_all=_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__.Z.task_cancel_all;E.clean_cookies=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.clean_cookies;E.force_bext_config_update=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.force_bext_config_update;E.stop_vpn=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.stop_vpn;E.pause_videos=_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_24__.Z.pause_videos;E.resume_videos=_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_24__.Z.resume_videos;E.close_tab_tpopup=_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_24__.Z.close_tab_tpopup;E.get_trial_active=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_trial_active;E.set_trial=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].set_trial;E.get_trial_perr_info=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_trial_perr_info;E.move_trial_time=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].move_trial_time;E.trial_hide_watermark=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].hide_watermark;E.close_nonblock_slide=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].close_nonblock_slide;E.close_bonus_tooltip=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].close_bonus_tooltip;E.can_hide_watermark=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].can_hide_watermark;E.get_next_trial_ts=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_next_trial_ts;E.get_last_trial_end_ts=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_last_trial_end_ts;E.can_skip_signin=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].can_skip_signin;E.is_unlimited_trial=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].is_unlimited_trial;E.skip_signin=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].skip_signin;E.get_trials_info=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_trials_info;E.is_trial_expired=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].is_trial_expired;E.get_trial_wait=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_trial_wait;E.get_trial_period=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_trial_period;E.get_total_cycle_time=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_total_cycle_time;E.get_used_cycle_time=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_used_cycle_time;E.get_used_trial_time=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_used_trial_time;E.get_remaining_cycle_time=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_remaining_cycle_time;E.is_trial_wait_ended=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].is_wait_ended;E.need_trial=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].need_trial;E.trial_need_signin=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].need_signin;E.reset_trial=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].reset_trial;E.trial_match_url=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].match_url;E.trial_start_wait=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].start_wait;E.trial_stop_wait=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].stop_wait;E.need_ext_pin_tip=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].need_ext_pin_tip;E.shown_ext_pin_tip=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].shown_ext_pin_tip;E.can_start_trial_silently=root_url=>_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].can_start_trial_silently(root_url);E.start_trial=root_url=>_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].start_trial(root_url);E.get_server_ts=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_12__["default"].now;E.refresh_user=_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_17__["default"].refresh_user;E.refresh_anonymous=_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_17__["default"].refresh_anonymous;E.logout=_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_17__["default"].logout_user;E.resend_verification_email=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].resend_verification_email;E.open_login_popup=_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_17__["default"].open_login_popup;E.is_verified=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].is_verified;E.set_vpn_last_rating=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].set_vpn_last_rating;E.get_redirect_list=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_13___default().get_redirect_list;E.reload_tab_by_id=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_13___default().reload;E.get_mitm_rules=_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_18__.Z.get_rules;E.mitm_remove_rule=_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_18__.Z.remove_rule;E.mitm_set_ignore=_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_18__.Z.set_ignore;E.mitm_set_unblock=_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_18__.Z.set_unblock;E.get_mitm_dialog=_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_18__.Z.get_dialog;E.set_login_redirect=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].set_login_redirect;E.set_email_verify_url=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].set_email_verify_url;E.get_unblocking_rate_url=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].get_unblocking_rate_url;E.get_unblocking_rate=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].get_unblocking_rate;E.set_dev_mode=_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_19__["default"].enable;E.update_svc_info=_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_25__["default"].update_info;E.is_paid=_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_17__["default"].is_paid;E.set_enabled_for_browser=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.set_enabled_for_browser;E.tpopup_is_connected=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.tpopup_is_connected;E.hola_api_call=_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_14__.Z.hola_api_call;E.perr_ajax=_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_14__.Z.perr_ajax;E.show_tpopup=_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_24__.Z.show;E.close_tpopup=_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_24__.Z.close;E.resize_tpopup=_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_24__.Z.resize;E.set_force_suggestion=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_13___default().set_force_suggestion;E.do_tpopup=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.do_tpopup;E.vpn_change_agent=_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_25__["default"].vpn_change_agent;E.unblock_action=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.unblock_action;E.get_force_premium_rules=_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_17__["default"].get_force_premium_rules;E.increment_vpn_work_yes=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].increment_vpn_work_yes;E.get_tab_state=_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_16__.Z.get_tab_state;E.get_force_premium_rule=_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_17__["default"].get_force_premium_rule;E.is_incognito_allowed=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.extension,".isAllowedIncognitoAccess",[]);E.push_event=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.push_event;E.get_site_storage=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_12__["default"].get_site_storage;E.set_site_storage=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_12__["default"].set_site_storage;E.get_tab_url=tab_id=>_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_13___default().get_url(tab_id);E.get_selected_url=opt=>_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_14__.Z.get_selected_url(opt);E.get_debug_peer_info=_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_19__["default"].get_debug_peer_info;E.change_peer=_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_19__["default"].change_peer;E.set_has_opened_popup=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_23__["default"].set_has_opened_popup;E.update_full_browser_vpn_mode=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.update_full_browser_vpn_mode;E.dev_get=name=>_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_19__["default"].get(name);E.dev_set=(name,value)=>_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_19__["default"].set(name,value);E.dev_force_tpopup=type=>_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_19__["default"].force_tpopup(type);E.is_user_geo_blocked=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.is_user_geo_blocked;E.update_user_geo_block=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.update_user_geo_block;E.get_trial_conf=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_trial_conf;E.get_suggested_survey_id=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].get_suggested_survey_id;E.notify_survey_suggested=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_20__["default"].notify_survey_suggested;E.ab_test_report=_bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_26__.Z.report;E.get_ab_states=_bext_vpn_bg_ab_test_js__WEBPACK_IMPORTED_MODULE_26__.Z.get_ab_states;E.refresh_icon=_bext_vpn_bg_icon_js__WEBPACK_IMPORTED_MODULE_27__.Z.refresh;E.unblock_after_login=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.unblock_after_login;E.open_payment_page=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_13___default().open_payment_page;E.enable_full_browser_fallback=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.enable_full_browser_fallback;E.verify_antivirus_block=_bext_vpn_bg_vpn_js__WEBPACK_IMPORTED_MODULE_21__.Z.verify_antivirus_block;if(false){}E.t={get_rate_us_url,review_urls};const __WEBPACK_DEFAULT_EXPORT__=E},897:(module,exports,__webpack_require__)=>{"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(8763),__webpack_require__(6969),__webpack_require__(6386),__webpack_require__(7345),__webpack_require__(4130),__webpack_require__(3727),__webpack_require__(1211),__webpack_require__(843),__webpack_require__(4336),__webpack_require__(5305),__webpack_require__(932),__webpack_require__(9824),__webpack_require__(6069),__webpack_require__(5250),__webpack_require__(1291),__webpack_require__(7957),__webpack_require__(6545),__webpack_require__(2227),__webpack_require__(1032),__webpack_require__(665),__webpack_require__(6210),__webpack_require__(737),__webpack_require__(9265),__webpack_require__(7666),__webpack_require__(6262),__webpack_require__(5317),__webpack_require__(8552),__webpack_require__(1679),__webpack_require__(9641),__webpack_require__(3958),__webpack_require__(7619)],__WEBPACK_AMD_DEFINE_RESULT__=function(_,be_backbone,etask,be_util,be_tabs,be_ext,B,svc_vpn_util,zescape,zurl,date,zerr,browser,be_vpn_util,zutil,be_pac,array,unblocker_lib,storage,ajax,be_info,be_svc,be_premium,be_trial,version_util,rate_limit,bg_util,be_dev_mode,conf,pcountries,State){if(ajax.default)ajax=ajax.default;be_trial=be_trial.default;be_dev_mode=be_dev_mode.default;be_info=be_info.default;be_pac=be_pac.default;be_svc=be_svc.default;be_premium=be_premium.default;bg_util=bg_util.default;State=State.default;be_vpn_util.assert_bg("be_tab_unblocker");function get_bg_main(){return self.be_bg_main}const assign=Object.assign;let chrome=self.chrome;let debug_hooks;let requests_handler;let proxied_hosts;const E=new(be_backbone.model.extend({model_name:"tab_unblocker",tab_unblockers:{},requests:{},loading_sites:{},_defaults:function(){this.on("destroy",(()=>E.uninit()))}}));const CG=(path,def)=>zutil.get(bext_config,path,def);const cb_wrapper=zerr.catch_unhandled_exception;function ff_cb_wrapper(){const args=array.slice(arguments,1);return zerr.catch_unhandled_exception.apply(zerr,args)}let bext_config={};const is_chrome=be_util.browser_guess.browser=="chrome";const load_errors={},tab_loads={};let bw_perr_acc;const err_logs_len=20;const req_types={media:{chrome:{min_ver:58},opera:{min_ver:45}}};const ff_webext=conf.firefox_web_ext;let request_errors={};let request_errors_known={};const main_frame_errors=zutil.bool_lookup(["ERR_DNS_FAILED","ERR_AUTH_REQUIRED","net::ERR_TUNNEL_CONNECTION_FAILED","net::ERR_PROXY_CONNECTION_FAILED"]);let state;const is_main_frame=d=>d&&!d.frameId&&d.type=="main_frame";function loading_sites_set(tab_id,url){if(CG("disable_loading_tabs_tracker"))return;if(!url){if(E.loading_sites[tab_id]){be_vpn_util.clear_timeout(E.loading_sites[tab_id].to);delete E.loading_sites[tab_id];be_tabs.update_active_tab_url()}return}if(E.loading_sites[tab_id]){be_vpn_util.clear_timeout(E.loading_sites[tab_id].to);E.loading_sites[tab_id].url=url}else{E.loading_sites[tab_id]={url};be_tabs.update_active_tab_url()}E.loading_sites[tab_id].to=be_vpn_util.set_timeout((()=>delete E.loading_sites[tab_id]),6e4,{sp:E.sp,name:"del_loading_sites"})}function get_site_verify_conf(req,rule){if(!req||!req.proxy_resp||!rule)return false;if(req.method!="GET")return false;return be_util.get_site_verify_conf(req.root_url,req.url,rule.country)}const is_trial=root_url=>!!be_trial.get_trial_active(root_url);function is_force_proxy(opt){opt=opt||{};const r=opt.rule,tu=opt.tab_unblocker||{};if(!r||!r.name||!be_ext.get("is_premium")&&(!E.rules||(E.rules.blacklist||{})[r.name]||tu.force_premium)){return}return is_trial(r.name)||be_premium.is_active()&&(r.mode=="protect"||tu.force_premium||be_ext.get("is_premium"))}function is_proxy_forbidden(host){return zurl.host_lookup(E.rules&&E.rules.forbidden_host||{},host)||!be_ext.get("is_premium")&&zurl.host_lookup(E.rules&&E.rules.blacklist||{},host)}function on_hooks_err(id,err){be_util.perr(id,{},{err,rate_limit:{count:1}});zerr("on_hooks_err %s %s",err,err&&err.stack);if(zutil.is_mocha())process.exit(1)}function is_redir_status(status,tmp_only){return{302:1,303:1,307:1}[status]||!tmp_only&&+status==301}function is_auth_done_url(url){return/^https?:\/\/hola\.org\/users\/auth\/\w+\/done/.test(url)}class Base_handler{constructor(){this.listener_opt={urls:["<all_urls>"]};this.listener_extra_opt=["requestBody"];this.tab_unblocker_end_cb=cb_wrapper(this._unsafe_tab_unblocker_end_cb.bind(this));this.on_before_send_headers=this.wrap("on_before_send_headers",(d=>{this.tab_unblocker_cb(d=assign({},d,{handler:this._on_before_send_headers.bind(this),cbname:"on_before_send_headers"}))}),true);this.on_headers_received=this.wrap("on_headers_received",(d=>{this.tab_unblocker_cb(d=assign({},d,{handler:this._on_headers_received.bind(this),cbname:"on_headers_received"}))}),true);this.on_completed=this.wrap("on_completed",(d=>{this.tab_unblocker_end_cb(d=assign({},d,{cbname:"on_completed"}))}),true);this.on_error_occurred=this.wrap("on_error_occurred",(d=>{if(!d)return;this.tab_unblocker_end_cb(assign(d,{cbname:"on_error_occurred"}))}));this.on_response_started=cb_wrapper((d=>{const reqid=d.requestId;const req=E.requests[reqid];fix_req_agent(req,d)}));this.on_headers_received_page=cb_wrapper((d=>{if(!d||!is_main_frame(d))return;loading_sites_set(d.tabId,null);let status=d.statusCode||bg_util.http_status_to_node(d.statusCode,d.statusLine).statusCode;if(!status)return;status=d.statusCode=""+status;be_tabs.page_trace(d,"on_headers_received");on_main_frame_headers(d);if(is_auth_done_url(d.url))be_premium.schedule_refresh_user({reason:"auth_done_url"});const res=bg_util.nodify_res(d);const tu=E.get_tab_unblocker(d.tabId);const req=E.requests[d.requestId],agent=req&&req.agent;const site_conf=req&&be_util.get_site_conf(req.root_url);if(is_redir_status(status)){be_tabs.track_redirect({id:d.tabId,info:d,url:d.originUrl||d.url});const location=res.headers.location;const redir=tu&&agent&&(be_util.find_conf_rule_by_url(site_conf,"redirect",location)||be_util.find_conf_rule_by_url(bext_config,"redirect",location));d=assign({error:"redirect"},d);if(redir&&redir.action=="change_agent"&&tu.rule&&track_autoreload(tu,agent,d)){state.set(["resolve_cap",req.root_url],true);ext_on_err(tu.rule,agent,d)}return}if(req&&state.get(["resolve_cap",req.root_url])&&tu&&agent&&!be_util.find_conf_rule_by_url(site_conf,"redirect",d.url)&&!be_util.find_conf_rule_by_url(bext_config,"redirect",d.url)){be_util.perr("be_resolve_cap",{root_url:req.root_url});state.delete(["resolve_cap",req.root_url])}if(!{4:1,5:1}[status[0]])return;be_tabs.trigger("error_occured",{id:d.tabId,info:{type:d.type,http_status_code:status}});d=assign({error:"cf"},d);if(!CG("disable_cf_fix")&&tu&&agent&&d.statusCode==403&&res.headers.server=="cloudflare"&&!res.headers["cf-chl-bypass"]&&tu.rule&&track_autoreload(tu,agent,d)){ext_on_err(tu.rule,agent,d);return}}));this.on_completed_debug_page=this.wrap("on_completed_debug_page",(d=>{let rule_info;if(!d||d.fromCache||!d.ip||!is_main_frame(d)||E.requests[d.requestId]||E.get_tab_unblocker(d.tabId)||(rule_info=get_rule_info_from_url(d.url))&&rule_info.tabs[d.tabId]){return}let agents=unblocker_lib.find_agents({ip:d.ip});if(agents.length){be_util.perr("proxy_req_unexpected",{details:d,agent:agents[0].info()},{rate_limit:{count:1}})}}));this.on_before_send_headers_debug=ff_cb_wrapper("on_before_send_headers_debug",(d=>{d=assign({},d,{});const req=E.requests[d.requestId],agent=req&&req.agent;const store=E.get_tab_unblocker(d.tabId)||this;const last_agent=store.last_agent||{};if(!agent||agent.ip==last_agent.ip&&agent.port==last_agent.port)return;zerr.notice("tab:%d proxy agent selected %O %s",d.tabId,agent,req.url.slice(0,100));let rule;if(rule=req.opt.rule){zerr.notice("tab:%d rule %O",d.tabId,zutil.pick(rule,"id","name","country","description"))}store.last_agent=agent}));this.on_headers_received_debug=ff_cb_wrapper("on_headers_received_debug",(d=>{d=assign({},d,{});let req,res,tu,host;if((req=E.requests[d.requestId])&&req.agent&&(tu=E.get_tab_unblocker(d.tabId))&&(res=bg_util.nodify_res(d))){if(is_hola_agent_auth(res)&&(host=req.agent.host)){host=host.split(".")[0];let rl,debug_auth=tu.debug_auth=tu.debug_auth||{};if(!(rl=debug_auth[host]))rl=debug_auth[host]={total:0};rl.total++}let cc,rule=req.opt.rule;if(CG("debug.cache_control_report")&&!tu._cache_reported&&(cc=res.headers["cache-control"])&&+cc.replace("max-age=","")>0){be_util.perr("be_debug_cache_control",{details:d,rule:be_vpn_util.get_rule_min_fmt(rule)});tu._cache_reported=true}let verify;if(is_redir_status(d.statusCode)&&(verify=get_site_verify_conf(req,rule))&&verify.ret&&verify.ret.status==d.statusCode){be_util.perr("bw_req_err_"+verify.id,{error:d.statusCode,url:req.url,ip:d.ip,method:req.method,rule:be_vpn_util.get_rule_min_fmt(rule),agent:req.agent&&req.agent.info()},{rate_limit:{count:1,ms:date.ms.MIN}})}}}));this.on_completed_debug=ff_cb_wrapper("on_completed_debug",(d=>{let req;if(!d||!(req=E.requests[d.requestId]))return;const rule=be_vpn_util.get_rule_min_fmt(req.opt.rule);const limit={count:1,ms:date.ms.MIN};const info={url:req.url,ip:d.ip,method:req.method,agent:req.agent&&req.agent.info(),rule};let verify;if((verify=get_site_verify_conf(req,rule))&&verify.ret&&verify.ret.status==req.proxy_resp.code){be_util.perr("bw_req_err_"+verify.id,assign({error:req.proxy_resp.code},info),{rate_limit:limit})}const tab_unblocker=E.get_tab_unblocker(d.tabId);const is_proxy_req=tab_unblocker&&rule&&req.agent;let min_ver;if(is_proxy_req&&d.ip&&(min_ver=bext_config.ip_check_min_ver)&&version_util.cmp(be_util.version(),min_ver)>=0&&req.agent.ip!=d.ip&&!d.fromCache){let mismatch_perr_id="req_agent_ip_mismatch";if(unblocker_lib.find_agents({ip:d.ip}).length)mismatch_perr_id+="_agent";be_util.perr(mismatch_perr_id,info,{rate_limit:{count:1}});svc_vpn_util.push_event("pac_miss",{req_ip:d.ip,agent_ip:req.agent.ip,url:req.url})}let dur=Date.now()-req.start_ts;if(is_proxy_req&&!bext_config.disable_monitor_slow&&dur>10*date.ms.SEC){let s;if(!(s=state.get(["proxy_req_slow",rule.name]))){s={10:0,20:0,60:0,max:0};monitor_proxy_req_slow()}let agent=req.agent.host||req.agent.ip;state.set(["proxy_req_slow.agents",agent],state.get(["proxy_req_slow.agents",agent],0)+1);s[dur>60*date.ms.SEC?"60":dur>20*date.ms.SEC?"20":"10"]++;s.max=Math.max(dur,s.max);state.set(["proxy_req_slow",rule.name],s);zerr.debug("tab:%d slow request detected - %d ms, agent %s, "+"url %s",d.tabId,dur,agent,req.url.slice(0,200))}if(!d.error||!tab_unblocker)return;let rl_path="debug_errors."+d.error+"."+!!req.agent,rl;if(!(rl=zutil.get(tab_unblocker,rl_path)))zutil.set(tab_unblocker,rl_path,rl={total:0});rl.total++;if(!rate_limit(rl,limit.ms,limit.count))return;zerr.debug("tab:%d request failed with error %s after %d ms, "+"total cnt %d, rule %s, type %s, method %s, agent %s, url %s",d.tabId,d.error,dur,rl.total,rule&&rule.name,d.type,req.method,req.agent&&req.agent.host,req.url.slice(0,200))}));this.on_headers_received_media=ff_cb_wrapper("on_headers_received_media",(d=>{let media_failure;if(!(media_failure=get_failure_config("media")))return;let req,tab;if(d.tabId<0||!(tab=E.get_tab_unblocker(d.tabId))||!(req=E.requests[d.requestId])){return}const agent=req.agent&&req.agent.host;const rule=zutil.get(req,"opt.rule");if(!/^(4|5)/.test(d.statusCode)||d.statusCode==407||!agent||!rule){return}tab.media_failures=(tab.media_failures||0)+1;const res=bg_util.nodify_res(d);zerr.notice("tab:%d media failure detected: %d, %s%s %s",d.tabId,d.statusCode,agent,res.headers["x-tcp-info"]?" from:"+res.headers["x-tcp-info"]:"",d.url.slice(0,200));return fix_media_req_err(zutil.get(req,"opt.rule"),req.agent,d,tab,media_failure)}));this.on_completed_media=ff_cb_wrapper("on_completed_media",(d=>{let media_failure,req,tab,rule,agent;if(d.tabId<0||!(tab=E.get_tab_unblocker(d.tabId))||!(req=E.requests[d.requestId])||!(rule=zutil.get(req,"opt.rule"))||!(agent=req.agent)||!(media_failure=get_failure_config("media"))||!/^(4|5)/.test(d.statusCode)||d.statusCode==407){return}if(d.ip&&agent.ip!=d.ip){return zerr.debug("tab:%d ignore set_err on agent ip mismatch"+" - expected %s, got %s",d.tabId,agent.ip,d.ip)}let root_url=req.root_url;if(!be_util.get_site_verify_conf(root_url,d.url,rule.country)||media_failure.disable_set_err){return}let limit=assign({ms:5*date.ms.MIN,count:10},media_failure.set_err_rate_limit);let set_err_rl=tab.set_err_rl=tab.set_err_rl||{};let rl=set_err_rl[agent.host]=set_err_rl[agent.host]||{};if(!rate_limit(rl,limit.ms,limit.count)){return zerr.debug("tab:%d set_err limit exeeded: %s",d.tabId,agent.host)}let err_opt={tab_id:d.tabId,url:d.url,status:d.statusCode,peer:!agent.pool,country:rule.country,rule};E._set_req_err("media_failure",agent,err_opt)}))}wrap(name,cb,ff){const cb_wrap=_cb=>ff?ff_cb_wrapper(name,_cb):cb_wrapper(_cb);return cb_wrap(cb)}static get_handler(){return new Chrome_handler}init(){if(this.inited)return;this.inited=true;this.update_hooks();return true}uninit(){if(!this.inited)return;this.inited=false;this.update_hooks();return true}update_hooks(mode){let add_global=()=>{if(!this.global_hooks)this.global_hooks=this.add_hooks("main_frame")};let rm_global=()=>{if(this.global_hooks)this.global_hooks=this.remove_hooks(this.global_hooks)};let add_local=()=>{for(let tabid in E.tab_unblockers){let tab=E.tab_unblockers[tabid];if(!tab.hooks)tab.hooks=this.add_hooks(tabid)}};let rm_local=()=>{for(let tabid in E.tab_unblockers){let tab=E.tab_unblockers[tabid];if(tab.hooks)tab.hooks=this.remove_hooks(tab.hooks)}};let add_debug=()=>{if(!this.debug_hooks)this.debug_hooks=this.add_debug_hooks()};let rm_debug=()=>{if(this.debug_hooks)this.debug_hooks=this.remove_hooks(this.debug_hooks)};if(mode=="all_browser"||mode=="debug_peer")return rm_local();if(!this.inited){rm_global();rm_debug();rm_local()}else{add_global();add_debug();add_local()}}add_debug_hooks(){if(!bext_config.debug_hooks)return;let hooks=new Request_hooks(this);try{hooks.add("onCompleted",this.on_completed_debug_page,{urls:["<all_urls>"],types:["main_frame"]})}catch(e){on_hooks_err("be_add_debug_hooks_err",e)}return hooks}add_hooks(tabid,hooks_wrapper){let hooks=new Request_hooks(this,hooks_wrapper);try{if(tabid=="main_frame"){hooks.add("onHeadersReceived",this.on_headers_received_page,{urls:["<all_urls>"],types:["main_frame"]},["responseHeaders"]);return hooks}tabid=+tabid;let filter=tabid>=0?assign({tabId:tabid},this.listener_opt):this.listener_opt;if(debug_hooks){hooks.add("onCompleted",this.on_completed_debug,filter);hooks.add("onErrorOccurred",this.on_completed_debug,filter)}hooks.add("onBeforeSendHeaders",this.on_before_send_headers,filter,["requestHeaders"]);hooks.add("onHeadersReceived",this.on_headers_received,filter,["responseHeaders"]);hooks.add("onResponseStarted",this.on_response_started,filter);let failure_opt;if(failure_opt=this.get_failure_opt(tabid,"media",filter)){hooks.add("onCompleted",this.on_completed_media,failure_opt);hooks.add("onHeadersReceived",this.on_headers_received_media,failure_opt,["responseHeaders"])}hooks.add("onCompleted",this.on_completed,filter);hooks.add("onErrorOccurred",this.on_error_occurred,filter);if(!debug_hooks)return hooks;hooks.add("onBeforeSendHeaders",this.on_before_send_headers_debug,filter,["requestHeaders"]);hooks.add("onHeadersReceived",this.on_headers_received_debug,filter,["responseHeaders"])}catch(e){on_hooks_err("be_add_hooks_err",e)}return hooks}get_failure_opt(tabid,name,opt){let failure;if(!(failure=get_failure_config(name)))return;let types,ext=failure.extensions||[];if(types=failure.types){const g=be_util.browser_guess;types=types.filter((t=>{let min;return!(min=zutil.get(req_types[t],g.browser+".min_ver"))||g.version>=min}))}let urls=[],root_url;if(root_url=tabid>=0&&be_tabs.get_url(tabid))root_url=svc_vpn_util.get_root_url(root_url);let rules=failure.rules||[];if(root_url)rules=rules.filter((r=>r.domain==root_url));rules.forEach((r=>{if(r.urls)urls=urls.concat(r.urls);if(r.extensions)ext=ext.concat(r.extensions)}));ext=array.unique(ext);ext.forEach((e=>urls.push("*://*/*."+e,"*://*/*."+e+"?*")));urls=array.unique(urls);if(urls.length)return assign({},opt,{urls,types})}remove_hooks(hooks){try{hooks.clear()}catch(e){on_hooks_err("be_rm_hooks_err",e)}}_on_first_request(details,opt){const url=details.url;let req=E.requests[details.requestId];if(req&&req.url==url)return;const tab_id=details.tabId;const host=zurl.get_host(url);let root_url,tab_url=tab_id>=0&&be_tabs.get_url(tab_id);if(tab_url)root_url=svc_vpn_util.get_root_url(tab_url);let expexted_proxy=be_pac.find_proxy(url);let expected_agent=null;let proxy_peer=false;if(expexted_proxy&&expexted_proxy!="DIRECT"){let m=expexted_proxy.match(/[A-Z]+\s([\w\-.]+):(\d+)/);if(m){let agents=unblocker_lib.find_agents({host:m[1]});expected_agent=agents.length>0&&agents[0];proxy_peer=m[2]==22223||m[2]==22226}}req=E.requests[details.requestId]={id:details.requestId,root_url:svc_vpn_util.get_root_url(be_tabs.get_url(tab_id)),url,method:details.method,type:details.type,opt,agent:expected_agent,proxy_peer,start_ts:Date.now(),tab_id};const tu=E.get_tab_unblocker(tab_id);if(tu){tu.req_total_n=(tu.req_total_n||0)+1;tu.req_stats.total_n=(tu.req_stats.total_n||0)+1;if(expected_agent)tu.agents[expected_agent.host]=Date.now();E.set("activity",Date.now())}if(root_url){storage.set("last_root_url",root_url);proxied_hosts.add(root_url,host,details.initiator,tab_id)}if(root_url&&tu&&tu.rule.name!="all_browser"&&!be_pac.find_proxy(url,true)&&proxied_hosts.is_unknown_site(root_url)&&!is_proxy_forbidden(host)){let v=state.get(["local_proxied_hosts",root_url])||[];v.push(host);state.set(["local_proxied_hosts",root_url],v);be_pac.add_v3_rule(root_url,host,get_pac_cmd(get_route_opt("PROXY "+tu.rule.country.toUpperCase(),tu.rule),tu.rule))}}_on_before_send_headers(details){}tab_unblocker_cb(details){let url;if(!(url=details.url))return;let tab_unblocker=E.get_tab_unblocker(details.tabId);const is_main=is_main_frame(details);if(!ff_webext&&!be_pac.has_pac)return;if(is_main&&details.tabId!=-1&&(details.cbname=="on_before_request"||details.cbname=="on_before_send_headers")){loading_sites_set(details.tabId,url)}else loading_sites_set(details.tabId,null);let rule_info,req,handler=details.handler;if(req=E.requests[details.requestId])return handler(details,req.opt);rule_info=get_rule_info_from_url(url);if(is_main){if(rule_info&&details.cbname=="on_before_request")E.trigger("before_request",{url});if(!tab_unblocker){if(rule_info&&details.tabId!=-1){if(!(tab_unblocker=tab_unblocker_add(details.tabId,rule_info,url))){return}}}else if(!rule_info||rule_info.root_url!=tab_unblocker.root_url){tab_unblocker_del(details.tabId,undefined,"rule_missing");if(!rule_info||!(tab_unblocker=tab_unblocker_add(details.tabId,rule_info,url))){return}}}if(!is_vpn_allowed(url,is_main,details))return;let rule=tab_unblocker&&tab_unblocker.rule;if(!tab_unblocker&&details.tabId==-1&&details.frameId==-1){let tab_id=be_tabs.get("active.id");tab_unblocker=E.get_tab_unblocker(tab_id);if(rule_info||(rule_info=get_rule_info_from_url(url)))rule=rule_info.rule;else if(tab_unblocker)rule=tab_unblocker.rule}if(!rule)return;let r;if((r=rule)&&get_bg_main().set_rule_use)get_bg_main().set_rule_use(r);this._on_first_request(details,{rule,no_rule:!rule,tab_unblocker});if((req=E.requests[details.requestId])&&details.cbname=="on_headers_received"){return handler(details,req.opt)}}_on_headers_received(details){let req;const res=bg_util.nodify_res(details),req_id=details.requestId;if(!(req=E.requests[req_id]))return;const proxy_auth_required=is_hola_agent_auth(res);const url=req.url;const resp=get_strategy_resp(res);if(req.agent){if(proxy_auth_required){if(/Auth Failed suspicious/.test(res.reasonPhrase)){get_bg_main().suspend_client(/permanent/.test(res.reasonPhrase))}else if(req.opt.rule&&!bext_config.disable_407_reauth)E.reauth_rule_agents(req.opt.rule,3*date.ms.MIN);return void be_util.perr("req_header_proxy_auth",{url,agent:req.agent&&req.agent.info()},{err:true,rate_limit:{count:5}})}req.proxy_resp=resp}}_unsafe_tab_unblocker_end_cb(details){const reqid=details.requestId;const req=E.requests[reqid];const error=get_req_error(req,details);if(req){delete E.requests[reqid];let resp;if(error)resp={code:0,error};else{if(details.responseHeaders)resp=get_strategy_resp(bg_util.nodify_res(details))}if(resp){if(req.agent)req.proxy_resp=resp}}let tabid=details.tabId,tab_unblocker=E.get_tab_unblocker(tabid);const is_main=is_main_frame(details);if(tab_unblocker&&!req&&!details.fromCache&&details.documentLifecycle!="prerender"&&details.frameId!=-1&&is_vpn_allowed(details.url,is_main,details)&&error!="net::ERR_ABORTED"){be_util.perr("be_missing_req",{details,rule:tab_unblocker?.rule?.name},{err:true})}if(!tab_unblocker&&req){be_util.perr("be_missing_tab_unblocker",{details,rule:req?.opt?.rule?.name})}if(tab_unblocker){tab_unblocker.last_req_ts=Date.now();if(req){if(req.proxy_resp&&is_main&&req.proxy_resp.code==200&&!req.proxy_resp.error){inc_not_working("req_main_n",tab_unblocker)}if(req.agent&&!error){tab_unblocker.req_stats.succ_n=(tab_unblocker.req_stats.succ_n||0)+1}if(tab_unblocker.tab_reload_ts&&tab_unblocker.rule&&is_main&&error&&error!="net::ERR_ABORTED"){be_util.perr("tab_reload_failed",{dur:Date.now()-tab_unblocker.tab_reload_ts,rule:tab_unblocker.rule.name,info:"end_cb",country:tab_unblocker.country,error},{rate_limit:{count:5}});tab_unblocker.tab_reload_ts=undefined}}}let verify;if(req&&(verify=get_site_verify_conf(req,req.opt.rule))&&req.proxy_resp.code==200&&!req.proxy_resp.error){bw_perr_acc.push(verify,req);inc_not_working("bw_media_n",tab_unblocker)}const is_proxy_req=tab_unblocker&&req&&req.opt.rule&&req.agent;if(!is_proxy_req||!error){if(is_proxy_req&&tab_unblocker&&is_main)set_tab_load_err(tabid,null);return}const info={url:req.url,type:details.type,method:req.method,error,agent:req.agent&&req.agent.info(),rule:be_vpn_util.get_rule_min_fmt(req.opt.rule)};tab_unblocker.err_logs.push({ts:Date.now(),method:req.method,error,agent:zutil.get(req.agent,"host"),url:req.url.slice(0,100)});if(tab_unblocker.err_logs.length>err_logs_len)tab_unblocker.err_logs.shift();tab_unblocker.req_err_total_n=(tab_unblocker.req_err_total_n||0)+1;tab_unblocker.req_stats.err_n=(tab_unblocker.req_stats.err_n||0)+1;if(!is_err_handled(error,is_main)){if(request_errors_known[error])return;let reported;if(!(reported=load_errors[tabid]))reported=load_errors[tabid]={};if(reported[error])return;reported[error]=true;return void be_util.perr("req_err_unhandled",info,{err:error,rate_limit:{count:5}})}fix_req_err(tab_unblocker,req,details.error?details:assign({},details,{error}))}add_web_worker_hooks(){if(this.web_worker_hooks)return;let hook_wrapper=(d,cb)=>{if(d.tabId!=-1||!d.initiator||d.initiator.startsWith("chrome-extension:")){return}let rule=E.get_enabled_rule(d.initiator);if(!rule)return;for(let tab_id in E.tab_unblockers){let tab_rule=E.tab_unblockers[tab_id].rule;if(!tab_rule||tab_rule.id!=rule.id)continue;if(CG("debug.web_worker_requests_detector")){zerr(`Detected web worker request. Rule: ${rule.name}, `+`url: ${d.url}, initiator: ${d.initiator}`)}return cb(assign({},d,{tabId:tab_id}))}};this.web_worker_hooks=this.add_hooks(-1,hook_wrapper)}rm_web_worker_hooks(){if(!this.web_worker_hooks)return;this.web_worker_hooks.clear();this.web_worker_hooks=null}update_web_worker_hooks(){let need_hook=CG("debug.web_worker_requests_detector");for(let id in E.tab_unblockers){let tab=E.tab_unblockers[id];if(!tab.rule)continue;let enabled=tab.rule.name=="all_browser"?Object.values(bext_config.sites||{}).find((v=>v&&v.web_worker_proxy)):be_util.get_site_conf(tab.rule.name,"web_worker_proxy");if(enabled){need_hook=true;break}}if(need_hook)this.add_web_worker_hooks();else this.rm_web_worker_hooks()}}const is_err_handled=(err,is_main)=>!CG("main_frame_errors_only")&&!is_main&&request_errors[err]||is_main&&(request_errors[err]||main_frame_errors[err]);const get_req_error=(req,details)=>{if(details.error||!is_main_frame(details))return details.error;if(!req||!req.url||!req.url.startsWith("http:"))return;const s=details.statusLine||"";if(details.statusCode==502&&s.includes("DNS Failed"))return"ERR_DNS_FAILED";if(details.statusCode==407&&s.includes("Proxy Authentication"))return"ERR_AUTH_REQUIRED"};class Chrome_handler extends Base_handler{constructor(){super();let on_before_request=d=>{d=d||{};this.tab_unblocker_cb(assign(d,{cbname:"on_before_request",handler:this._on_first_request.bind(this)}))};this.on_before_request=this.wrap("on_before_request",on_before_request,true);this.on_before_request_tab=this.wrap("on_before_request_tab",(d=>{if(!is_main_frame(d))return on_before_request(d)}),true)}add_hooks(tabid,hook_wrapper){let hooks=super.add_hooks(tabid,hook_wrapper);try{let extra_opt=this.listener_extra_opt.slice();if(is_extra_headers_supported())extra_opt.push("extraHeaders");if(tabid=="main_frame"){hooks.add("onBeforeRequest",this.on_before_request,assign({types:["main_frame"]},this.listener_opt),extra_opt);return hooks}tabid=+tabid;let filter=tabid>=0?{tabId:tabid}:{};hooks.add("onBeforeRequest",this.on_before_request_tab,assign(filter,this.listener_opt),extra_opt);return hooks}catch(e){on_hooks_err("be_add_hooks_err",e)}}}class Request_hooks{constructor(ctx,hook_wrapper){this._hooks=[];this.intervals=[];this._ctx=ctx;this._hook_wrapper=hook_wrapper}_get_handler(cb_name){return cb_name=="onRequest"?self.browser.proxy.onRequest:chrome.webRequest[cb_name]}_t_find_cb(cb_name){return this._hooks.filter((([name])=>cb_name==name)).map((h=>h[1]))}add(cb_name,cb,filter,opt){if(this._ctx)cb=cb.bind(this._ctx);let _cb=this._hook_wrapper?d=>this._hook_wrapper(d,cb):cb;this._hooks.push([cb_name,_cb]);if(opt===undefined)this._get_handler(cb_name).addListener(_cb,filter);else this._get_handler(cb_name).addListener(_cb,filter,opt)}add_interval(cb,t,opt){this.intervals.push(be_vpn_util.set_interval(cb,t,opt))}clear(){for(let[cb_name,cb]of this._hooks){let handler=this._get_handler(cb_name);handler.removeListener(cb)}for(let interval of this.intervals)be_vpn_util.clear_interval(interval)}}const regex_url2host=/^(?:https?|wss?):\/\/([^/]+)/;const url2host=url=>{let n=url.match(regex_url2host);return n?n[1]:url};E.get_tab_load_err=tab_id=>(E.get("tab_load_err")||{})[tab_id];function get_strategy_resp(res){let resp;if(res.headers["x-hola-response"]){resp={hdrs_only:true,code:res.headers["x-hola-status-code"],len:res.headers["x-hola-content-length"],te:res.headers["x-hola-transfer-encoding"],lmod:res.headers["x-hola-last-modified"],etag:res.headers["x-hola-etag"],type:res.headers["x-hola-content-type"],error:res.headers["x-hola-error"]}}else{resp={code:res.statusCode,len:res.headers["content-length"],te:res.headers["transfer-encoding"],lmod:res.headers["last-modified"],etag:res.headers.etag,type:res.headers["content-type"],error:res.headers["x-hola-error"]}}resp.policy=res.headers["x-hola-policy"];return resp}function is_vpn_allowed(_url,is_main,details){let protocol,hostname,url=zurl.parse(_url);if(!(protocol=url.protocol)||!(hostname=url.hostname)){if(protocol!="file:")be_util.perr("url_parsing_failed");return false}if(_url.match(/^(chrome|opera|firefox|edge|about)(-extension)?:/))return false;if(hostname.startsWith("__hola__."))return false;if(is_all_browser_rule_active()||is_debug_peer_rule_active()){return!bg_util.is_private_network(hostname,browser.isInNet)&&!unblocker_lib.is_agent(hostname)&&!/zagent\d+\.hola\.org/.test(hostname)&&(is_debug_peer_rule_active()||!zurl.is_hola_domain(hostname))}if(unblocker_lib.is_agent(hostname))return false;return bg_util.is_vpn_allowed(_url,is_main,browser.isInNet)}function get_proxy_agent(opt,proxy){const{rule,route_opt,agent}=opt;if(!agent){const route=svc_vpn_util.gen_route_str(route_opt,{no_algo:true});zerr.debug("no agents for %s route, rule: %s",route,zutil.get(rule,"name","unknown"));be_util.perr("be_debug_no_agents",{route_opt,agents:unblocker_lib.get_active_agents(rule),rule:be_vpn_util.get_rule_min_fmt(rule)},{err:true,rate_limit:{count:2}});return}if(agent.is_fallback){be_util.perr("be_fallback_agent",{route_opt,agent,rule:be_vpn_util.get_rule_min_fmt(rule)},{err:true,rate_limit:{count:2}})}let port,plist;const trial=rule&&is_trial(rule.name);if(rule&&(plist=agent.port_list)){if(be_vpn_util.is_debug_peer(rule))port=agent.port==plist.direct?25333:+agent.port+1e3;else if(agent.is_fallback&&agent.port==25500){let country=route_opt.country.toLowerCase();port=+agent.port+(pcountries.ports[country]||{}).port||0}else{let key=[];if(agent.port==plist.direct){if(trial)key.push("trial");if(proxy.peer)key.push("peer")}port=plist[key.join("_")]||agent.port}}port=port||agent.port;if(!agent.is_fallback&&agent.vendor!="force_agent"&&route_opt.pool&&!agent.pool){be_util.perr("be_wrong_agent",{agent,route_opt,rule:be_vpn_util.get_rule_min_fmt(rule),trial},{rate_limit:{count:1}})}return{ip:agent.ip,port,host:agent.host}}function get_rule_info_from_url(url){let rule_info,r,res=null;if(E.url_to_rule_infos.all_browser)return E.url_to_rule_infos.all_browser;if(!url)return E.url_to_rule_infos.debug_peer||null;for(r in E.url_to_rule_infos){rule_info=E.url_to_rule_infos[r];if(rule_info.url_re&&rule_info.url_re.test(url)){res=rule_info;break}}if(!is_debug_peer_rule_active())return res;return is_debug_peer_proxy_traffic()&&res||is_debug_peer_def_traffic()&&!res?E.url_to_rule_infos.debug_peer:res}const is_all_browser_rule_active=()=>!!E.url_to_rule_infos.all_browser;const is_debug_peer_rule_active=()=>!!E.url_to_rule_infos.debug_peer;const is_debug_peer_def_traffic=()=>is_debug_peer_rule_active()&&E.url_to_rule_infos.debug_peer.rule.def_traffic;const is_debug_peer_proxy_traffic=()=>is_debug_peer_rule_active()&&E.url_to_rule_infos.debug_peer.rule.proxy_traffic;const get_debug_peer=e=>is_debug_peer_rule_active()&&E.url_to_rule_infos.debug_peer.rule[e];E.get_tab_unblocker=tabid=>{if(E.tab_unblockers.debug_peer&&+tabid&&(is_debug_peer_def_traffic()&&!E.tab_unblockers[tabid]||is_debug_peer_proxy_traffic()&&E.tab_unblockers[tabid])){return E.tab_unblockers.debug_peer}if(E.tab_unblockers.all_browser)return E.tab_unblockers.all_browser;return tabid&&E.tab_unblockers[tabid]};const set_tab_load_err=(tab_id,err)=>{let tab_load_err=assign({},E.get("tab_load_err"));const is_all_browser=tab_id=="all_browser";if(err&&tab_load_err[tab_id]||!err&&!tab_load_err[tab_id])return;if(err)tab_load_err[tab_id]={err};else{be_util.perr("tab_load_direct_on_err",is_all_browser?tab_load_err:tab_load_err[tab_id],{rate_limit:{count:1}});if(is_all_browser)tab_load_err={};else delete tab_load_err[tab_id]}E.set("tab_load_err",tab_load_err)};function tab_unblocker_del(tabid,refresh,reason){const tab_unblocker=E.tab_unblockers[tabid];zerr.notice("tab:%d tab_unblocker_del: %s",+tabid,zutil.get(tab_unblocker,"country","not_found"));if(!tab_unblocker)return;if(tab_unblocker.not_working)E.send_not_working(tab_unblocker,"unblocker_del");if(tab_unblocker.tab_reload_ts&&tab_unblocker.rule){be_util.perr("tab_reload_unblock_stop",{dur:Date.now()-tab_unblocker.tab_reload_ts,reason,rule:tab_unblocker.rule.name,country:tab_unblocker.country},{rate_limit:{count:5}});tab_unblocker.tab_reload_ts=undefined}const is_all_browser=tabid=="all_browser"||tabid=="debug_peer";set_tab_load_err(tabid,null);if(requests_handler&&tab_unblocker.hooks)requests_handler.remove_hooks(tab_unblocker.hooks);const rule_info=E.url_to_rule_infos[tab_unblocker.root_url];delete E.tab_unblockers[tabid];state.delete(`pages.${tabid}`);unblocker_lib.del_ctx(tabid);if(is_all_browser)requests_handler.update_hooks();if(!rule_info){be_util.perr("be_rule_info_missing",{tabid,tab_unblocker,rule_infos:E.url_to_rule_infos})}else{be_pac.del_active_rule(rule_info.rule.name);delete rule_info.tabs[tabid]}requests_handler.update_web_worker_hooks();if(refresh&&is_all_browser)tabid=be_tabs.get("active.id");if(!refresh||be_tabs.get("active.id")!=tabid)return;try{chrome.tabs.get(bg_util.tabid2api(tabid),(tab=>{if(tab&&!be_vpn_util.is_browser_internal_url(tab.url))be_tabs.update(tab.id,{url:tab.url})}))}catch(e){on_hooks_err("be_tab_unblocker_del_err",e)}}E.tab_reload=(tabid,tab_url)=>etask((function*tab_reload(){yield be_tabs.update(tabid,{url:tab_url});try{chrome.tabs.get(tabid,(tab=>{if(!tab||tab.status!="complete")return;be_tabs.reload(tabid)}))}catch(e){on_hooks_err("be_tab_reload_err",e)}}));const get_force_premium_rule=tab_url=>be_premium.get_force_premium_rule(svc_vpn_util.get_root_url(tab_url),{tab_url});const monitor_proxy_req_slow=()=>{if(monitor_proxy_req_slow.et)return;monitor_proxy_req_slow.et=etask({cancel:true,async:true},(function*_monitor_req_slow_proxy(){this.finally((()=>{monitor_proxy_req_slow.et=undefined;state.set("proxy_req_slow",{agents:{}})}));yield etask.sleep(date.ms.HOUR);let proxy_req_slow=state.get("proxy_req_slow");for(let root in proxy_req_slow){if(proxy_req_slow[root]["20"]||proxy_req_slow[root]["60"])return void be_util.perr("proxy_req_slow",proxy_req_slow)}}))};const monitor_page_load=()=>{if(monitor_page_load.et)return;monitor_page_load.et=etask({cancel:true,async:true},(function*_monitor_page_load(){this.finally((()=>monitor_page_load.et=undefined));for(;;){const pages=state.get("pages");if(!Object.keys(pages).length)return;let now=Date.now(),slow={};for(let id in pages){if(now-pages[id].start_ts<10*date.ms.SEC)continue;slow[id]=[]}if(Object.keys(slow).length){for(let reqid in E.requests){const req=E.requests[reqid];if(!req||!slow[req.tab_id]||!req.agent||now-req.start_ts<6*date.ms.SEC){continue}slow[req.tab_id].push(req)}for(let id in slow){let tu;if(slow[id].length<3||!(tu=E.get_tab_unblocker(id)))continue;const req=slow[id][0];const d={url:req.url,type:req.type,tabId:+id,error:"slow"};if(track_autoreload(tu,req.agent,d)){state.delete(`pages.${id}`);be_util.perr("page_load_slow",d,{rate_limit:{count:5}});yield ext_on_err(tu.rule,req.agent,d,true)}}}yield etask.sleep(date.ms.SEC)}}))};const tab_unblocker_add=cb_wrapper(((tabid,rule_info,tab_url,opt)=>{if(!rule_info||rule_info.tabs[tabid])return;opt=opt||{};const is_all_browser=be_vpn_util.is_all_browser(rule_info.rule)||be_vpn_util.is_debug_peer(rule_info.rule);const id=is_all_browser?rule_info.rule.name:tabid;let tab_unblocker=E.tab_unblockers[id];const root_url=svc_vpn_util.get_root_url(tab_url);if(tab_unblocker&&tab_unblocker.rule)return;be_pac.add_active_rule(rule_info.rule.name);tab_unblocker={country:rule_info.rule.country,rule:rule_info.rule,root_url:rule_info.root_url,log:tab_unblocker?tab_unblocker.log:[],force_premium:get_force_premium_rule(tab_url),err_logs:[],agents:{},site_conf:be_util.get_site_conf(root_url||rule_info.rule.name)||{},req_stats:{}};E.tab_unblockers[id]=tab_unblocker;zerr.notice("tab:%d tab_unblocker_add: %s %s",tabid,rule_info.rule.name,tab_unblocker.country);if(requests_handler){if(is_all_browser)requests_handler.update_hooks(id);tab_unblocker.hooks=requests_handler.add_hooks(id)}rule_info.tabs[tabid]=true;unblocker_lib.add_ctx(tabid,tab_unblocker.rule,{src:tab_url});requests_handler.update_web_worker_hooks();if(opt.reload&&(be_tabs.get("active.id")==tabid||is_all_browser)){if(opt.fix_url)tab_url=bg_util.get_root_link(rule_info.rule,tab_url)||tab_url;if(be_trial.get_trial_active(root_url)){let site_conf=be_util.get_site_conf(root_url);tab_url=zutil.get(site_conf,"trial.trial_redirect",tab_url)}let sug_url=bg_util.get_site_storage(root_url,"suggestion_redirect_url");if(sug_url){bg_util.set_site_storage(root_url,"suggestion_redirect_url",null);tab_url=sug_url}if(is_all_browser){tab_url=be_tabs.get("active.url");tabid=be_tabs.get("active.id")}if(tab_url&&!be_vpn_util.is_browser_internal_url(tab_url)){zerr.notice("tab:%d reloading tab",tabid);tab_unblocker.tab_reload_ts=Date.now();be_util.perr("tab_reload_start",{rule:rule_info.rule.name,country:tab_unblocker.country},{rate_limit:{count:5}});return etask((function*(){if(opt.reload_delay)yield etask.sleep(opt.reload_delay);return E.tab_reload(tabid,tab_url)}))}}E.set("activity",Date.now());return tab_unblocker}));const on_tab_created=cb_wrapper((o=>{const tab=o.tab;if(!tab.url)return;const rule_info=get_rule_info_from_url(tab.url);tab_unblocker_add(tab.id,rule_info,be_tabs.get_loading_tab_url(tab.id)||tab.url)}));const on_tab_updated=cb_wrapper((o=>{o=o||{};let id=o.id,info=o.info;if(!info)return;let tab_unblocker=E.tab_unblockers[id];if(info.url){const rule_info=get_rule_info_from_url(info.url);if(!tab_unblocker||!rule_info||tab_unblocker.root_url!=rule_info.root_url){if(tab_unblocker)tab_unblocker_del(id,undefined,"rule_replaced");tab_unblocker=tab_unblocker_add(id,rule_info,be_tabs.get_loading_tab_url(id)||info.url)}}if(!tab_unblocker||!info.status)return;switch(info.status){case"complete":state.delete(`pages.${id}`);break;case"loading":if(!CG("disable_slow_load_monitor")){state.set(`pages.${id}`,{start_ts:Date.now()});monitor_page_load()}break}}));const on_tab_removed=cb_wrapper((o=>{if(o){proxied_hosts.send({tab_id:o.tab_id});tab_unblocker_del(o.id,undefined,"tab_removed")}}));const on_tab_replaced=cb_wrapper((o=>{if(!o)return;let added=o.added,removed=o.removed;tab_unblocker_del(removed,undefined,"tab_replaced");try{chrome.tabs.get(added,(tab=>{if(!tab||!tab.url)return;const rule_info=get_rule_info_from_url(tab.url);tab_unblocker_add(added,rule_info,be_tabs.get_loading_tab_url(added)||tab.url)}))}catch(e){on_hooks_err("be_on_tab_replaced_err",e)}}));function unset_rule_for_url(root_url,refresh){let rule_info=E.url_to_rule_infos[root_url];if(!rule_info)return;for(let tab in rule_info.tabs)tab_unblocker_del(tab,refresh,"rule_disabled");if(root_url=="all_browser"||root_url=="debug_peer")tab_unblocker_del(root_url,refresh,"rule_disabled");delete E.url_to_rule_infos[root_url]}const set_rule_for_url=(root_url,rule,opt)=>etask((function*(){let rule_info=E.url_to_rule_infos[root_url];if(rule_info)unset_rule_for_url(root_url,0);rule_info=E.url_to_rule_infos[root_url]={rule,root_url,tabs:{},url_re:new RegExp(root_url)};if(be_vpn_util.is_debug_peer(rule)){return void tab_unblocker_add("debug_peer",rule_info,"debug_peer",opt)}const is_all_browser=be_vpn_util.is_all_browser(rule);const url=is_all_browser?`*://*/*`:`*://*.${rule.name}/*`;try{let tabs=(yield chrome.tabs.query({url}))||[];for(let tab of tabs){tab_unblocker_add(tab.id,rule_info,be_tabs.get_loading_tab_url(tab.id)||tab.url,opt)}}catch(e){on_hooks_err("be_set_rule_for_url_err",e)}}));const update_rules=(url_to_rule_infos,opt)=>etask((function*(){opt=opt||{};let url,rule;for(url in E.url_to_rule_infos){rule=url_to_rule_infos[url];if(!rule)unset_rule_for_url(url,opt.reload);else if(rule.id!=E.url_to_rule_infos[url].rule.id)yield set_rule_for_url(url,rule,opt)}for(url in url_to_rule_infos){rule=url_to_rule_infos[url];if(!E.url_to_rule_infos[url])yield set_rule_for_url(url,rule,assign({},opt,{fix_url:1}))}}));E.get_rule_route=rule=>{const country=rule.country,proxy_country=country.toUpperCase();return unblocker_lib.get_rule_strategy({},null,{root_url:rule.name,premium:is_force_proxy({rule}),country:proxy_country,proxy_country,src_country:be_info.get("country"),is_trial:is_trial(rule.name)})};const update_declarative_rules=enabled_rules=>etask((function*update_declarative_rules_(){if(!chrome.declarativeNetRequest||be_util.browser_guess.version<91)return;const current_rules=yield chrome.declarativeNetRequest.getSessionRules();const ids=current_rules.map((v=>v.id));if(!enabled_rules||!enabled_rules.length){if(ids.length){yield chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:ids})}return}let enabled_root_urls=new Set;enabled_rules.forEach((r=>enabled_root_urls.add(r.name)));let is_all_browser=enabled_root_urls.has("all_browser");let headers_conf=[];for(const site_conf of Object.values(bext_config.sites||{})){let root_urls=site_conf.root_url;if(!is_all_browser&&!root_urls.some((r=>enabled_root_urls.has(r))))continue;for(const v of site_conf.headers_conf||[])headers_conf.push(assign({root_url:root_urls},v))}headers_conf=headers_conf.concat(bext_config.headers_conf2||[]);const add_rules=[];for(let val of headers_conf){const condition={};if(val.type)condition.resourceTypes=val.type;if(val.url)condition.urlFilter=val.url;if(val.root_url){if(be_util.browser_guess.version>=101)condition.initiatorDomains=val.root_url;else condition.domains=val.root_url}const action={type:"modifyHeaders",requestHeaders:[{header:val.name,value:val.value,operation:"set"}]};add_rules.push({id:add_rules.length+1,condition,action})}yield chrome.declarativeNetRequest.updateSessionRules({addRules:add_rules,removeRuleIds:ids})}));const set_rules=(enabled_rules,pac_rules,opt)=>etask((function*set_rules_(){let active_root_urls;if(enabled_rules){const all_browser=enabled_rules.some((r=>be_vpn_util.is_all_browser(r)||be_vpn_util.is_debug_peer(r)));active_root_urls=all_browser?["all_browser"]:(yield chrome.tabs.query({url:`*://*/*`})).map((tab=>svc_vpn_util.get_root_url(tab.url))).filter((root_url=>enabled_rules.some((r=>r.name==root_url))))}yield be_pac.set_v3_rules(pac_rules,active_root_urls);try{yield update_declarative_rules(enabled_rules)}catch(e){be_util.perr("be_update_declarative_rules_err",{},{err:e,rate_limit:{count:3}})}yield update_rules(get_url_to_rule_map(enabled_rules||[]),opt)}));const check_rules_conflits=rules=>{const map={};for(let[rule_name,hosts_map]of Object.entries(rules)){for(let[host,cmd]of Object.entries(hosts_map)){if(map[host]&&map[host].cmd!=cmd){let prev=map[host];zerr(`rule conflict ${host}: ${prev.rule_name} ${prev.cmd} ->`+` ${rule_name} ${cmd}`)}map[host]={cmd,rule_name}}}};const get_url_to_rule_map=enabled_rules=>{const res={};for(const rule of enabled_rules){if(be_vpn_util.is_all_browser(rule)||be_vpn_util.is_debug_peer(rule)){res[rule.name]=rule}else{for(const root_url of rule.root_url)res[root_url]=rule}}return res};const get_rules_map=enabled_rules=>etask((function*get_rules_map_(){const rules_map=unblocker_lib.get_global_rules(enabled_rules,be_ext.get("is_premium"))||{};const all_browser=enabled_rules.some((r=>be_vpn_util.is_all_browser(r)||be_vpn_util.is_debug_peer(r)));if(!all_browser){let proxied_hosts_map=yield proxied_hosts.get(enabled_rules);for(const rule of enabled_rules){rules_map[rule.name]=rules_map[rule.name]||{};const hosts_map=rules_map[rule.name];let hosts=proxied_hosts_map[rule.name]||[];if(!hosts.length)hosts=[rule.name];let local_proxied=state.get(["local_proxied_hosts",rule.name]);if(local_proxied)hosts=hosts.concat(local_proxied);for(let host of hosts){if(is_proxy_forbidden(host))continue;host=host.replace(/^\*\./,"");let index=-1,has_parent_rule;for(;;){if(hosts_map[host.substr(index+1)]){has_parent_rule=true;break}if((index=host.indexOf(".",index+1))<0)break}if(!has_parent_rule)hosts_map[host]="PROXY "+rule.country.toUpperCase()}}}check_rules_conflits(rules_map);return rules_map}));const get_pac_cmd=(route_opt,rule)=>{route_opt=_.omit(route_opt,"rule");let agent=unblocker_lib.get_chosen_agent(_.omit(route_opt,"peer"),rule);let{host,port}=get_proxy_agent({agent,rule,route_opt},{peer:route_opt.peer});if(E.be_bg_ajax&&E.be_bg_ajax.need_agent_domain_fallback())host=E.be_bg_ajax.get_agent_fallback_host(host);return`HTTPS ${host}:${port}`};const get_route_opt=(proxy_cmd,rule)=>{let country=rule.country.toUpperCase();let strategy=unblocker_lib.get_strategy({},proxy_cmd,{country});return{country,link:rule.link,name:rule.name,pool:strategy.pool,peer:strategy.peer,rule}};const get_pac_rules=(route_to_route_opt,rules_map)=>{let route_to_pac_rule={};for(let[route,route_opt]of Object.entries(route_to_route_opt))route_to_pac_rule[route]=get_pac_cmd(route_opt,route_opt.rule);let pac_rules={};for(const[rule_name,hosts_map]of Object.entries(rules_map)){pac_rules[rule_name]={};for(let[host,route]of Object.entries(hosts_map)){pac_rules[rule_name][host]=route=="DIRECT"?route:route_to_pac_rule[route]}}return pac_rules};const get_agent_key=()=>etask((function*get_agent_key_(){let key=be_ext.get("agent_key");if(key)return key;let ret=yield bg_util.storage_local_get("agent_key");return ret&&ret.agent_key}));let update_rule_urls_et;E.update_rule_urls=(rules,opt)=>etask((function*update_rule_urls(){opt=opt||{};if(!E.inited)return;if(update_rule_urls_et)return update_rule_urls_et;update_rule_urls_et=this;this.finally((()=>update_rule_urls_et=null));let enabled_rules=rules&&Object.values(rules.unblocker_rules).filter((r=>r.enabled))||[];if(enabled_rules.some((r=>be_vpn_util.is_all_browser(r))))enabled_rules=enabled_rules.filter((r=>be_vpn_util.is_all_browser(r)));be_ext.set("has_active_rules",!!enabled_rules.length);E.rules=rules;if(!be_ext.is_disabled())requests_handler.init();if(!enabled_rules.length)return yield set_rules(enabled_rules,null,opt);unblocker_lib.unblocker_json_set(rules||{},{by_rules:1,ext:1});const rules_to_hosts_map=yield get_rules_map(enabled_rules);let route_to_route_opt={};for(const[rule_name,hosts_map]of Object.entries(rules_to_hosts_map)){let rule=enabled_rules.find((r=>r.name==rule_name));for(let value of Object.values(hosts_map)){if(value!="DIRECT"&&rule&&!route_to_route_opt[value])route_to_route_opt[value]=get_route_opt(value,rule)}}if(opt.resolve){let ag_rules=_.uniq(Object.values(route_to_route_opt).map((v=>JSON.stringify(assign({},_.omit(v,"peer","rule"),{peer:false}))))).map((v=>JSON.parse(v)));yield unblocker_lib.resolve_agents(ag_rules)}if(!(yield get_agent_key())){be_util.perr("be_no_agent_key2",{},{err:true,rate_limit:{count:2}});yield set_rules([],null,opt);return}let pac_rules=get_pac_rules(route_to_route_opt,rules_to_hosts_map);yield set_rules(enabled_rules,pac_rules,opt)}));const on_tab_completed=cb_wrapper((o=>{if(o.frameId)return;let start_ts,load_perr;if(E.get_tab_load_err(o.tabId))set_tab_load_err(o.tabId,null);const tab=E.get_tab_unblocker(o.tabId);const _url=zurl.parse(o.url),_path=_url.path.toLowerCase();let root_url=svc_vpn_util.get_root_url(o.url),rule,path;if(tab&&tab.tab_reload_ts&&tab.rule){be_util.perr("tab_reload_success",{rule:tab.rule.name,dur:Date.now()-tab.tab_reload_ts,country:tab.country},{rate_limit:{count:5}});tab.tab_reload_ts=undefined}if(!tab||!tab.rule||!o.url||!(start_ts=tab_loads[o.tabId])||!(load_perr=zutil.get(bext_config,"load_perr"))){return}if(!(rule=load_perr.find((r=>r.domain==root_url)))||(path=rule.paths.find((p=>_path.startsWith("/"+p))))===undefined){return}const info={id:rule.id,path:path||"root",ms:Date.now()-start_ts,loc:(zutil.get(be_info.get("location"),"country")||"").toLowerCase()};if(tab&&(rule=tab.rule))assign(info,{country:rule.country,trial:rule.src=="trial"});else info.local=true;be_util.perr("tab_load_completed",info)}));const on_before_navigate=cb_wrapper((o=>{if(o.frameId)return;svc_vpn_util.push_event("navgiate",{tab_id:o.tabId,url:o.url});load_errors[o.tabId]={};tab_loads[o.tabId]=Date.now()}));const test_rules={};E.get_enabled_rule=url=>{const key="http://"+svc_vpn_util.get_root_url(url)+"/";if(zutil.is_mocha()&&test_rules[key])return test_rules[key];const rules=E.be_rule.get_rules(key);const r=rules&&rules[0];return r&&r.enabled?r:undefined};E.get_rule_agents=rule=>etask((function*get_rule_agents_(){yield unblocker_lib.get_agents(null,rule);return unblocker_lib.get_agents_by_route(rule.country)}));E.uninit=()=>{if(!E.inited)return;E.stopListening(be_ext,"change:ext.active change:ext.suspended",update_state);E.stopListening(be_ext,"change:bext_config",update_config);be_ext.off("not_working",on_not_working);E.sp.return();E.update_rule_urls();be_ext.set("has_active_rules",0);E.rules=null;E.inited=0;E.is_enabled=false;if(monitor_proxy_req_slow.et)monitor_proxy_req_slow.et=void monitor_proxy_req_slow.et.return();if(monitor_page_load.et)monitor_page_load.et=void monitor_page_load.et.return();agent_auth_listener_del();requests_handler.uninit();E.update_pac();E.requests={};for(let k in E.loading_sites)be_vpn_util.clear_timeout(E.loading_sites[k].to);E.loading_sites={};E.stopListening();E.clear()};E.update_pac=force=>be_pac.update_pac_file_state(force);const is_hola_agent_auth=res=>res.statusCode==407&&(res.headers["proxy-authenticate"]=='Basic realm="Hola Unblocker"'||zutil.is_mocha()&&res.headers["proxy-authenticate"]=="hola_unblocker");E.send_not_working=(tab,reason)=>{let rate=be_ext.get("gen.dbg_log_rate");if(rate===undefined)rate=100;const with_log=reason&&!Math.floor(Math.random()*rate)/rate;be_util.perr("be_not_working_stats",assign({reason},tab.not_working),{err:true,with_log,rate_limit:{count:5,ms:date.ms.MIN}});delete tab.not_working};function monitor_not_working(tab_id){let e,period=2*date.ms.MIN,n=period,now=Date.now();for(let id in E.tab_unblockers){let diff,tab=E.tab_unblockers[id];if(!(e=tab.not_working)||(diff=now-e.ts)<period){if(diff&&id!=tab_id)n=Math.min(n,diff);continue}E.send_not_working(tab)}monitor_not_working.to=be_vpn_util.clear_timeout(monitor_not_working.to);if(n<period||tab_id){monitor_not_working.to=be_vpn_util.set_timeout(monitor_not_working,n,{sp:E.sp,name:"monitor_not_working"})}}function inc_not_working(id,tab){let e;if(!tab||!(e=tab.not_working))return;e.stats[id]=(e.stats[id]||0)+1}function on_not_working(e){let tab;if(!(tab=E.get_tab_unblocker(e.tab_id))){return void be_util.perr("be_not_working_tab_not_found",e,{err:true,rate_limit:{count:1}})}let rule=be_vpn_util.get_rule_min_fmt(tab.rule);zerr.notice("tab:%d not working trigger, src %s, current agent %s, %O",e.tab_id,e.src,tab.last_agent&&tab.last_agent.host,{rule,agents:tab.agents});e=assign({err_logs:tab.err_logs},e);unblocker_lib.trigger("not_working",e.tab_id,e);if(tab.not_working)E.send_not_working(tab,"not_working_"+e.src);tab.not_working={ts:Date.now(),info:e,stats:{},rule};monitor_not_working(e.tab_id);if(!["ui","watermark"].includes(e.src)||!debug_hooks)return;let errors={},total;for(let err in tab.debug_errors){if(total=zutil.get(tab.debug_errors,err+".true.total"))errors[err]=total}if(tab.debug_auth)errors.auth=tab.debug_auth;if(tab.media_failures)errors.media=tab.media_failures;if(tab.browse_failures)errors.browse=tab.browse_failures;get_bg_main().dump_errors(e.tab_id,errors)}const ext_on_err=(rule,agent,details,retry)=>etask((function*ext_on_err_(){if(rule.changing_proxy)return;if(!E.get_tab_unblocker(details.tabId)){return zerr.notice("tab:%d ignore agent change for closed tab",details.tabId)}if(!retry&&bext_config.report_tab_load_on)be_tabs.page_trace(details,"autoreload");let min_rule=be_vpn_util.get_rule_min_fmt(rule);const req=E.requests[details.requestId];if(req&&req.proxy_peer){let err_opt={tab_id:details.tabId,url:details.url,status:details.statusCode,peer:true,country:rule.country,rule};yield E._set_req_err("ext_err",agent,err_opt)}const res=yield E.be_rule.change_proxy(details,details.error||(retry?"retry":"unknown"),null,agent);if(res&&res.error)return;if(!retry&&details.tabId>=0){zerr.notice("tab:%d reloading tab on error %s",details.tabId,details.error);if(details.error=="redirect"){be_tabs.update(details.tabId,{url:details.originUrl||details.url})}else be_tabs.reload(details.tabId)}be_ext.trigger("not_working",{tab_id:details.tabId,src:"agent",agent:agent&&agent.info(),rule:min_rule})}));const check_retry=(rule,agent,d,tab)=>etask((function*_check_retry(){let retry_conf;if(!agent||!(retry_conf=CG("request_errors.retry")))return;let url=d.url;let retry=reason=>etask((function*(){if(!reason)return;zerr.notice("tab:%d allow retry for %s failed request, %s %s",d.tabId,reason,d.error||d.statusCode,url.slice(0,200));be_util.perr("req_err_retry_"+reason,{url,status:d.statusCode,error:d.error,agent,type:d.type,rule:be_vpn_util.get_rule_min_fmt(rule)},{rate_limit:{count:1}});yield ext_on_err(rule,agent,d,true);return true}));let m;if(!retry_conf.disable_url_ip_check&&(m=url.match(/=(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})/))&&unblocker_lib.find_agents({ip:m[1]}).length){zerr.notice("tab:%d %s ignore retry for url %s, agent ip %s found",d.tabId,d.error,url.slice(0,200),m[1]);be_util.perr("req_err_ignore_retry",{url,status:d.statusCode,error:d.error,agent,type:d.type,rule:be_vpn_util.get_rule_min_fmt(rule)},{rate_limit:{count:1}});return}let ret=retry_conf.sporadic_perc&&tab.req_err_total_n/tab.req_total_n*100<retry_conf.sporadic_perc&&"sporadic";let mf=bext_config.media_failure;if(!mf||retry_conf.disable_media_failure)return yield retry(ret);let urls=tab.retry_urls=tab.retry_urls||{};if(urls[url]>=(retry_conf.max||5)){zerr.notice("tab:%d max retry %d for media request failed exceeded, "+"%s, %s",d.tabId,urls[url],d.error,url.slice(0,200));return}let check_ext=ext=>url.includes("."+ext);let root_url=svc_vpn_util.get_root_url(d.initiator||d.url);let verify=be_util.get_site_verify_conf(root_url,url,rule.country);if(mf.extensions.some(check_ext)||verify&&verify.url){urls[url]=(urls[url]||0)+1;ret="media"}return yield retry(ret)}));E.reauth_rule_agents=(rule,period)=>{if(rule&&rule.enabled)unblocker_lib.reauth_country_agents(rule.country,period)};E.reauth_all_agents=()=>unblocker_lib.reauth_all_agents();E.reverify_rule_agents=rule=>{if(rule&&rule.enabled)unblocker_lib.reverify_country_agents(rule.country)};const track_autoreload=(tab,agent,d)=>{let now=Date.now(),limit=bext_config.autoreload_limit||3;let per=bext_config.autoreload_ms||date.ms.MIN;if(tab.req_err_n==limit){if(now-tab.req_err_ts<per)return;tab.req_err_sent=tab.req_err_n=0}if(!tab.req_err_n)tab.req_err_ts=now;tab.req_err_n=(tab.req_err_n||0)+1;let info={url:d.url,type:d.type,error:d.error,agent:agent.info(),rule:be_vpn_util.get_rule_min_fmt(tab.rule)};if(tab.req_err_n==limit){be_util.perr("req_err_autoreload_max",info);if(is_main_frame(d)&&is_err_handled(d.error,true)){if(main_frame_errors[d.error])set_tab_load_err(d.tabId,d.error);be_util.perr("req_err_main_frame",info)}}be_util.perr("req_err",info);return true};const fix_req_agent=(req,d)=>{if(!req||!d||!d.ip||d.fromCache)return;let actual=unblocker_lib.find_agents({ip:d.ip});let exp=req.agent;if(!exp&&actual.length||exp&&!actual.length||exp&&actual&&!actual.find((a=>a.ip==exp.ip))){req.agent=actual[0];be_util.perr("be_wrong_req_agent",{expected:exp&&exp.info(),actual:actual.map((a=>a.info())),url:d.url},{err:true})}};const fix_req_err=(tab,req,d)=>etask((function*_fix_req_err(){let rule;if(!E.inited||!(rule=tab.rule))return;const site_conf=be_util.get_site_conf(req.root_url);if(site_conf&&site_conf.skip_fix_req_err&&site_conf.skip_fix_req_err.includes(d.error)){be_util.perr("skip_fix_req_err",{},{rate_limit:{count:1}});return}if(!is_main_frame(d)&&(yield check_retry(rule,req.agent,d,tab))){return}E.reauth_rule_agents(rule);if(track_autoreload(tab,req.agent,d))yield ext_on_err(rule,req.agent,d)}));E._set_req_err=(id,agent,opt)=>etask((function*_set_req_err_(){if(!opt.peer&&opt.rule&&agent.pool&&!E.get_rule_route(opt.rule).pool){return}let endpoint=opt.peer?"/set_err_peer":"/set_err";let domain=zurl.parse(opt.url).host;zerr.notice("tab:%d %s set_err: %s domain=%s",opt.tab_id,id,agent.host,domain);try{const ret=yield ajax.json({url:zescape.uri("https://"+agent.host+":"+agent.port+endpoint,{domain,err_code:opt.status,country:opt.country,uuid:be_ext.get("uuid")}),perr:_opt=>be_util.perr(_opt.id,_opt.info,opt)});be_vpn_util.assert(zutil.get(ret,"res"),new Error("empty res"));return ret.res}catch(e){zerr("tab:%d %s set_err failed: %s domain=%s err=%s",opt.tab_id,id,agent.host,domain,e);return{err:e}}}));const fix_media_req_err=(rule,agent,d,tab,opt)=>{const tab_url=d.initiator||d.url;const root_url=svc_vpn_util.get_root_url(tab_url);let verify=be_util.get_site_verify_conf(root_url,d.url);if(!opt.disable_perr){be_util.perr("media_failure_detected",{url:d.url,code:d.statusCode,page_url:tab_url,root_url,agent:agent&&agent.info(),rule:verify,headers:d.requestHeaders},{rate_limit:{count:1}})}if(verify)check_retry(rule,agent,d,tab)};function get_credentials(){var key=be_ext.get("agent_key");if(!key){be_util.perr("be_no_agent_key",{},{err:true,rate_limit:{count:2}})}let opt={uuid:be_ext.get("uuid"),asnum:get_debug_peer("asnum"),cid:get_debug_peer("cid"),peer_country:get_debug_peer("peer_country"),is_premium:be_ext.get("is_premium")};return{username:be_vpn_util.get_user_name(opt),password:key||"cccccccccccc"}}const agent_auth_listener=ff_cb_wrapper("agent_auth_listener",(details=>{if(details.isProxy&&details.realm=="Hola Unblocker"){if(/Auth Failed suspicious/.test(details.statusLine)){get_bg_main().suspend_client(/permanent/.test(details.statusLine));return{cancel:true}}return{authCredentials:get_credentials()}}be_util.perr("auth_listener_not_proxy",_.pick(details,"realm"),{rate_limit:{count:2}});return{}}));function agent_auth_listener_del(){if(!agent_auth_listener.inited)return;try{chrome.webRequest.onAuthRequired.removeListener(agent_auth_listener)}catch(e){on_hooks_err("be_rm_hooks_err",e)}agent_auth_listener.inited=false}const is_extra_headers_supported=()=>!ff_webext&&is_chrome&&!be_util.browser_guess.android&&be_util.browser_guess.version>=79;function agent_auth_listener_add(){if(zutil.is_mocha()||!chrome.webRequest.onAuthRequired||is_chrome&&be_util.browser_guess.version<108){return}agent_auth_listener_del();try{let extra=["blocking"];if(is_extra_headers_supported())extra.push("extraHeaders");chrome.webRequest.onAuthRequired.addListener(agent_auth_listener,{urls:["<all_urls>"]},extra)}catch(e){on_hooks_err("be_add_hooks_err",e)}agent_auth_listener.inited=true}E.init=()=>etask((function*(){if(E.inited)return;state=new State("be_unblocker_state",{local_proxied_hosts:{},proxy_req_slow:{agents:{}},resolve_cap:{},pages:{},bw_perr_acc:{}},{persistent:false});yield state.load();bw_perr_acc=new bg_util.Bw_perr_acc(state);chrome=self.chrome;if(!requests_handler)requests_handler=Base_handler.get_handler();E.sp=be_vpn_util.new_etask("be_tab_unblocker");E.url_to_rule_infos=E.url_to_rule_infos||{};proxied_hosts=new bg_util.Proxied_hosts(E.sp);agent_auth_listener_add();E.inited=1;E.listen_to(be_ext,"change:ext.active change:ext.suspended",update_state);E.listen_to(be_ext,"change:bext_config",update_config);be_ext.on("not_working",on_not_working);if(zutil.is_mocha())E.t.requests_handler=requests_handler;update_config();if(self&&self.hola){self.hola.get_log=()=>be_util.get_log().join("\n");self.hola.dump_unittest=unblocker_lib.dump_unittest}}));function update_state(){let is_enabled=!be_ext.is_disabled();E.update_pac(true);if(is_enabled==E.is_enabled)return;E.is_enabled=is_enabled;E.stopListening(be_tabs);if(requests_handler)requests_handler.uninit();if(monitor_proxy_req_slow.et)monitor_proxy_req_slow.et=void monitor_proxy_req_slow.et.return();if(monitor_page_load.et)monitor_page_load.et=void monitor_page_load.et.return();if(monitor_not_working.to){monitor_not_working.to=be_vpn_util.clear_timeout(monitor_not_working.to)}if(!E.is_enabled)return;if(requests_handler)requests_handler.init();E.listenTo(be_tabs,"created",on_tab_created);E.listenTo(be_tabs,"updated",on_tab_updated);E.listenTo(be_tabs,"removed",on_tab_removed);E.listenTo(be_tabs,"replaced",on_tab_replaced);E.listenTo(be_tabs,"completed",on_tab_completed);E.listenTo(be_tabs,"before_navigate",on_before_navigate)}function update_config(){const prev=bext_config;bext_config=be_ext.get("bext_config")||{};debug_hooks=!zutil.is_mocha()&&!zutil.get(bext_config,"debug_logs.disable")||zutil.get(bext_config,"debug_logs.enable");request_errors=zutil.bool_lookup(zutil.get(bext_config,"request_errors.handle",[]));request_errors_known=zutil.bool_lookup(zutil.get(bext_config,"request_errors.ignore_known",["net::ERR_ABORTED","net::ERR_BLOCKED_BY_CLIENT","net::ERR_CACHE_MISS"]));if(requests_handler&&prev.debug_hooks!=bext_config.debug_hooks)requests_handler.update_hooks();if(CG("disable_slow_load_monitor2")&&monitor_page_load.et)monitor_page_load.et=void monitor_page_load.et.return();be_util.convert_url2regex(bext_config,"redirect");proxied_hosts.set_conf(zutil.get(bext_config,"collect_proxied_hosts"))}function get_failure_config(type){const failure=be_util.CG(type+"_failure");if(failure&&!failure.disable&&(!failure.min_ver||version_util.cmp(be_util.version(),failure.min_ver)>=0)){return failure}}const on_main_frame_headers=d=>{let failure;if(!(failure=get_failure_config("browse")))return;if(d.tabId<0||!/^(4|5)/.test(d.statusCode)||d.statusCode==407)return;let tab_url=d.url||d.initiator,root_url;if(tab_url)root_url=svc_vpn_util.get_root_url(tab_url);let info={url:d.url,code:d.statusCode,page_url:tab_url,root_url,details:d};let is_hola_domain=zurl.is_hola_domain(root_url);let tab=E.get_tab_unblocker(d.tabId),req=E.requests[d.requestId];let no_unblock=!tab||!req&&!is_hola_domain;if(!CG("disable_google_caps_oops")&&be_vpn_util.is_google(root_url)&&tab_url.includes("/sorry/")){be_util.perr("google_caps_oops",{info:assign({no_unblock},info)},{rate_limit:{count:1}})}else if(!CG("disable_hola_err")&&is_hola_domain)be_util.perr("hola_browse_failure",{info},{rate_limit:{count:1}});if(no_unblock)return;let agent;if(tab&&req&&(agent=req.agent))tab.browse_failures=(tab.browse_failures||0)+1;zerr.notice("tab:%d browse failure detected: %d %s",d.tabId,d.statusCode,d.url.slice(0,200));if(failure.disable_perr)return;info.agent=agent&&agent.host;be_util.perr("browse_failure_detected",info,{rate_limit:{count:1}})};E.get_all_agents=function(){let agents=[];if(!E.rules)return agents;for(let r in E.rules.unblocker_rules){let rule=E.rules.unblocker_rules[r];for(let route of unblocker_lib.get_rule_routes(rule))agents=agents.concat(unblocker_lib.get_agents_by_route(route))}return agents};if(zutil.is_mocha()){E.t={Base_handler,is_force_proxy,on_not_working,tab_unblocker_del,test_rules,on_before_navigate,on_tab_created,on_tab_updated,on_tab_removed,requests_handler,is_vpn_allowed,url2host,be_pac,fix_req_err,check_retry}}return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},8552:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var underscore__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8763);var underscore__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_0__);var md5__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2033);var md5__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(md5__WEBPACK_IMPORTED_MODULE_1__);var cookie__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(9813);var cookie__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(cookie__WEBPACK_IMPORTED_MODULE_2__);var _util_util_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_3__);var _util_url_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5305);var _util_url_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_util_url_js__WEBPACK_IMPORTED_MODULE_4__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_5__);var _util_storage_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(1032);var _util_storage_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_util_storage_js__WEBPACK_IMPORTED_MODULE_6__);var _util_date_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_7__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_8__);var _util_version_util_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(6262);var _util_version_util_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_util_version_util_js__WEBPACK_IMPORTED_MODULE_9__);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(843);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_10__);var _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(2227);var _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_11__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12__);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_13__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_14__);var conf__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(9641);
// LICENSE_CODE ZON
const E={};const chrome=self.chrome,assign=Object.assign;const{www_host}=conf__WEBPACK_IMPORTED_MODULE_15__;const{CG}=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default();const v3=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().is_v3;E.is_private_network=(hostname,is_in_net)=>{if(_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().get_top_level_domain(hostname)=="localhost")return true;if(is_in_net&&_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().is_ip(hostname)){if(is_in_net(hostname,"10.0.0.0","255.0.0.0")||is_in_net(hostname,"172.16.0.0","255.240.0.0")||is_in_net(hostname,"192.168.0.0","255.255.0.0")||is_in_net(hostname,"127.0.0.0","255.0.0.0")){return true}}return false};E.is_vpn_allowed=(_url,is_main,is_in_net,rule)=>{let protocol,hostname,url=_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().parse(_url),port=url.port;if(!(protocol=url.protocol)||!(hostname=url.hostname))return false;if(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().is_all_browser(rule))return true;if(!hostname.includes("."))return false;const protocols={"http:":1,"https:":1,"wss:":1,"ws:":1};if(!protocols[protocol])return false;if(port&&!{"http:80":1,"https:443":1,"ws:80":1,"wss:443":1}[protocol+port]){return false}if(E.is_private_network(hostname,is_in_net)||_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().is_ip(hostname)&&(is_main||!is_in_net)){return false}return CG("allow_hola_domain_vpn",true)||_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().is_hola_domain(hostname)};E.get_root_link=(rule,href)=>{if(!href)return rule.link;let proto=_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().get_proto(href)||"http";return proto+"://"+_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().get_host(href)};const add_rule_ratings=opt=>{const proxy_country=opt.proxy_country,rules=opt.rules;const rule_ratings=opt.rule_ratings||[];const groups=opt.groups;const country_ratings=underscore__WEBPACK_IMPORTED_MODULE_0___default().find(rule_ratings,(cr=>cr.proxy_country==proxy_country));if(country_ratings){_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().forEach(country_ratings.rules,(r=>{if(r.rating<=0)return;let r_rule=_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().clone(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().find_rule(rules,r)||_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().find_rule(groups&&groups.unblocker_rules,r));if(!r_rule){r_rule=_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_11___default().gen_rule({name:r.name,type:r.type,country:r.country,supported:true})}let rule=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_10___default().find_rule(rules,r_rule);if(!rule){if(!r_rule.root_url)return;rule=_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().clone(r_rule);rules.push(rule)}rule.ratings=r}))}rules.forEach((r=>{if(!r.ratings)r.ratings={rating:0,vote_up:0,vote_down:0}}));rules.sort(((r1,r2)=>r1.ratings.rating-r2.ratings.rating>0?-1:1));return rules};E.get_all_rules=opt=>{const proxy_country=opt.proxy_country.toLowerCase();const rule_ratings=opt.rule_ratings;const all_rules=opt.rules,url=opt.url,root_url=opt.root_url;let rules=_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().clone(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_rules(all_rules,url)||[]);rules=underscore__WEBPACK_IMPORTED_MODULE_0___default().filter(rules,(r=>r.country==proxy_country));rules=add_rule_ratings({proxy_country,rules,root_url,url,rule_ratings,groups:opt.groups});if(!underscore__WEBPACK_IMPORTED_MODULE_0___default().find(rules,(r=>r.type=="url"&&r.name==root_url&&r.md5!="premium"))){rules.push(_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_11___default().gen_rule({name:root_url,mitm:opt.mitm,country:proxy_country,supported:true,ratings:{rating:0,vote_up:0,vote_down:0}}))}return rules};const open_tab=opt=>{const create_tab=url=>chrome.tabs.create({url,active:!!opt.force_active});const url=opt.url;if(opt.force_new)return create_tab(url);chrome.tabs.query(assign({lastFocusedWindow:true},opt.tab_match),(tabs=>{if(!tabs||!tabs.length)return create_tab(url);if(opt.exclude_re&&opt.exclude_re.exec(tabs[0].url)){chrome.tabs.create({url,active:opt.force_active||false});return chrome.tabs.reload(tabs[0].id)}chrome.tabs.update(tabs[0].id,{url,active:true},(tab=>{if(!tab)create_tab(url)}))}))};E.update_tab=(tab_id,url)=>chrome.tabs.update(tab_id,{url,active:true});E.open_new_tab=opt=>{const _opt=_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().clone(opt);_opt.force_new=1;return open_tab(_opt)};E.open_hola_tab=opt=>{const _opt=_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().clone(opt);const www_host_esc=www_host.replace(/\./g,"\\.");_opt.tab_match=chrome?{url:"*://"+www_host+"/*"}:{url_re:"^https?:\\/\\/"+www_host_esc+"\\/"};_opt.exclude_re=new RegExp(www_host_esc+"/access/([^/]*)/using/vpn-"+"([^?/]*)$","gi");if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().browser()=="chrome"){_opt.tab_match.url=[_opt.tab_match.url,"*://chrome.google.com/*/"+chrome.runtime.id+"*"]}return open_tab(_opt)};E.open_be_tab=opt=>{opt=_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().clone(opt);const url=chrome.runtime.getURL("").slice(0,-1);opt.tab_match={url:url+"/*"};if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().browser()!="firefox")opt.url="js/"+opt.url;return open_tab(opt)};E.Rules_set=class Rules_set{constructor(host,invert){this._data={};this._invert=!!invert;if(!host)return;this.add(host);let id,sets_map=_util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().get_json("be_rules_sets")||{};if(!(id=sets_map[host]))return;Object.entries(sets_map).forEach((e=>{if(e[1]==id)this.add(e[0])}))}add(host){if(!host)return;this._data[host]=1}to_array(){let data=this._data;return Object.keys(data).filter((k=>data[k]))}save(){let sets_map=_util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().get_json("be_rules_sets")||{};let id=+_util_date_js__WEBPACK_IMPORTED_MODULE_7___default()();Object.keys(this._data).forEach((host=>{if(!!this._data[host]^this._invert)sets_map[host]=id;else delete sets_map[host]}));_util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().set_json("be_rules_sets",sets_map)}};E.tabid2api=tabid=>{if(chrome&&typeof tabid=="string")tabid=+tabid;return tabid};E.upgrade_ext=function upgrade_ext(){_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().notice("upgrade_ext");if(!_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().get(chrome,"runtime.requestUpdateCheck"))return;chrome.runtime.requestUpdateCheck((status=>_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().notice("update check: "+status)))};const storage_get_fn=area=>items=>_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*_storage_get_fn(){try{const data=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.storage[area],".get",[items]);if(chrome.runtime.lastError){storage_err("storage_"+area+"_get",items,chrome.runtime.lastError)}return data||{}}catch(e){storage_err("storage_"+area+"_get_catch",items,e)}}));const storage_set_fn=area=>items=>_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*_storage_set_fn(){try{yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.storage[area],".set",[items]);if(chrome.runtime.lastError){storage_err("storage_"+area+"_set",items,chrome.runtime.lastError)}return items}catch(e){storage_err("storage_"+area+"_set_catch",items,e)}}));const storage_remove_fn=area=>items=>_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*_storage_remove_fn(){yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.storage[area],".remove",[items]);if(chrome.runtime.lastError){storage_err("storage_"+area+"_remove",items,chrome.runtime.lastError)}}));let perr_sent;const storage_err=(name,items,err)=>{const s=_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().get(err,"message");const msg=name+" "+_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().json(items)+" failed "+s+" "+(err&&err.stack);if(!perr_sent){perr_sent=true;const id=s=="The browser is shutting down."?"storage_browser_shutdown":"storage_lib_err";_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr(id,{name,items,err_str:err instanceof Error?_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().e2s(err):_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default().json(err)},{err})}_util_zerr_js__WEBPACK_IMPORTED_MODULE_5___default()(msg);throw new Error(msg)};let _uuid_md5;E.get_uuid_md5=()=>{let uuid=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_14___default().get("uuid");if(!uuid)return;if(!_uuid_md5||_uuid_md5.uuid!=uuid)_uuid_md5={uuid,md5:md5__WEBPACK_IMPORTED_MODULE_1___default()(uuid)};return _uuid_md5.md5};E.storage_local_get=storage_get_fn("local");E.storage_local_set=storage_set_fn("local");E.storage_local_remove=storage_remove_fn("local");E.storage_session_get=storage_get_fn("session");E.storage_session_set=storage_set_fn("session");E.storage_session_remove=storage_remove_fn("session");E.get_site_storage=(root_url,path,def)=>{const key=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().get_site_key(root_url)||root_url;const data=_util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().get_json("site_storage")||{};return _util_util_js__WEBPACK_IMPORTED_MODULE_3___default().get(data[key],path,def)};E.set_site_storage=(root_url,path,val)=>{const key=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().get_site_key(root_url)||root_url;const data=_util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().get_json("site_storage")||{};data[key]=data[key]||{};_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().set(data[key],path,val);_util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().set_json("site_storage",data)};E.set_dbg_conf=(path,value)=>{const _conf=_util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().get_json("hola_conf")||{};_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().set(_conf,path,value);_util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().set_json("hola_conf",_conf)};E.get_dbg_conf=path=>_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().get(_util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().get_json("hola_conf"),path);const status_regex=/^HTTP\/(\d\.\d) (0|\d{3})( (.*))?$/;E.http_status_to_node=(code,line)=>{let n=(line||"").match(status_regex);if(!n){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr("bad_status_line",{code,line},{rate_limit:{count:2}});n=[null,"1.1",code," ",""]}return{httpVersion:n[1],statusCode:+n[2]||0,reasonPhrase:n[4]||"",headers:{}}};E.nodify_res=details=>{let ret=E.http_status_to_node(details.statusCode,details.statusLine);if(!details.responseHeaders)return ret;details.responseHeaders.forEach((hdr=>{ret.headers[hdr.name.toLowerCase()]=hdr.value}));return ret};E.Bw_perr_acc=class Bw_perr_acc{constructor(state){if(state)this.state=state;else this.data={}}_send(acc){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr("req_bw",{len:acc.len,ms:acc.ms,bw:acc.len*1e3/acc.ms,id:acc.id,country:acc.country,agent:acc.agent});if(this.state)this.state.delete(["bw_perr_acc",acc.id]);else delete this.data[acc.id]}push(bw_rule,req){const agent=_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().get(req,"agent.host");const country=_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().get(req,"opt.rule.country");const id=bw_rule.id+(bw_rule.sid?"_"+bw_rule.sid:"");let acc=this.state?this.state.get(["bw_perr_acc",id]):this.data[id];if(acc&&acc.country!=country){this._send(acc);acc=null}acc=acc||{len:0,ms:0,country,agent,id};acc.len+=+req.proxy_resp.len||0;acc.ms+=Date.now()-req.start_ts;if(this.state)this.state.set(["bw_perr_acc",id],acc);else this.data[id]=acc;if(acc.len>(bw_rule.sample_size||10*1024*1024)||acc.agent!=agent||bw_rule.sid){this._send(acc)}}};E.create_window=({url,width,height})=>_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*(){let cur_win=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.windows,".getCurrent",[]);if(!cur_win)return;if(cur_win.state=="fullscreen"&&_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().os_mac()){yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.windows,".update",[cur_win.id,{state:"normal"}]);yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().sleep(1e3);cur_win=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.windows,".getCurrent",[])}let opt={url,top:Math.round((cur_win.height-height)/2+cur_win.top),left:Math.round((cur_win.width-height)/2+cur_win.left),width,height,type:"popup",state:"normal"};if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().browser()!="firefox")opt.focused=true;return yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.windows,".create",[opt])}));let _date;E.now=()=>{if(!_date||!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().check_min_ver(CG("use_server_ts_min_ver")))return Date.now();return Math.round(performance.now())+_date.perf_diff};E.update_ts=server_ts=>{if(!E.need_date_sync(server_ts))return;let local_ts=Math.round(performance.now());let perf_diff=server_ts-local_ts;let prev_perf_diff=_date&&_date.perf_diff;_date={server_ts,local_ts,perf_diff,date_diff:server_ts-Date.now()};if(!prev_perf_diff||50<Math.abs(_date.perf_diff-prev_perf_diff))_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_14___default().trigger("local_time_change",server_ts)};E.check_conf_ver=conf_ver=>{if(conf_ver==CG("version"))return;if(!CG("disable_conf_ver_update"))_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_14___default().trigger("conf_ver_change",conf_ver)};E.need_date_sync=server_ts=>{if(!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().check_min_ver(CG("use_server_ts_min_ver")))return;if(!_date)return true;let perf_diff=Math.abs(server_ts-E.now());let date_diff=E.now()-Date.now();let date_drift=Math.abs(_date.date_diff-date_diff);let threshold=CG("force_server_ts_update_threshold");let threshold_crossed=threshold&&threshold<date_drift;if(server_ts)return 1e3<perf_diff||threshold_crossed;return threshold_crossed};E.Proxied_hosts=class Proxied_hosts{constructor(sp){this.sp=sp;this.data={};this.server_data={}}set_conf(ph_conf){this.conf=ph_conf||{};if(this.conf.enabled&&!this.et)this.init();else if(!this.conf.enabled&&this.et)this.uninit()}init(){const _this=this;this.sp.spawn(this.et=_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()({name:"proxied_hosts",cancel:true},(function*_proxied_hosts(){this.finally((()=>_this.et=null));while(true){const{interval,threshold}=_this.conf;yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().sleep(interval);const root_urls=Object.keys(_this.data).filter((r=>Date.now()-_this.data[r].first_ts>=threshold));if(root_urls.length)yield _this.send({root_urls})}})))}uninit(){if(this.et)this.et.return();this.et=null;this.data={}}send(opt){const _this=this;_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*proxied_hosts_send(){const{tab_id,root_url,root_urls}=opt||{};if(!_this.conf.enabled)return;const data={};for(const[r,o]of Object.entries(_this.data)){if(o&&!o.sent&&(!root_url||root_url==r||!root_urls||root_urls.includes(r)||!tab_id||o.tab_id==tab_id)&&Object.keys(o.hosts).length){o.sent=Date.now();data[r]=o.hosts}}if(!Object.keys(data).length)return;yield E.be_bg_ajax.ccgi_ajax({url:conf__WEBPACK_IMPORTED_MODULE_15__.url_ccgi+"/proxied_hosts?be_ver="+_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().version(),method:"POST",data,timeout:10*_util_date_js__WEBPACK_IMPORTED_MODULE_7___default().ms.SEC})}))}add(root_url,host,initiator,tab_id){if(!this.conf.enabled)return;if(!_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().is_valid_domain(root_url)||_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().is_hola_domain(root_url)||!_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().is_valid_domain(host)||_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().is_hola_domain(host)){return}initiator=initiator?_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().get_host_gently(initiator):host;const initiator_root_url=_util_url_js__WEBPACK_IMPORTED_MODULE_4___default().get_root_domain(initiator);if(!this.data[root_url]&&initiator_root_url!==root_url)return;const o=this.data[root_url]=this.data[root_url]||{first_ts:Date.now(),hosts:{},tab_id};if(o.sent)return;if(initiator_root_url!==root_url&&!o.hosts[initiator])return;o.hosts[host]=o.hosts[host]||Date.now()}get(rules){let _this=this;return _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*proxied_hosts_load(){if(!rules||!rules.length||CG("debug.disable_proxied_hosts"))return _this.server_data={};const url=conf__WEBPACK_IMPORTED_MODULE_15__.url_ccgi+"/proxied_hosts?root_url=";const tasks={};for(const r of rules){if(!_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().is_all_browser(r)&&!_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_13___default().is_debug_peer(r)){tasks[r.name]=E.be_bg_ajax.ccgi_ajax({url:url+r.name})}}return _this.server_data=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().all(tasks)}))}is_unknown_site(root_url){return!this.server_data[root_url]}};E.collect_errors=ret=>{var arr=[];underscore__WEBPACK_IMPORTED_MODULE_0___default().each(ret,((v,k)=>{if(!_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().is_err(v))return;var e={};e[k]=""+v.error;arr.push(e)}));return arr};E.get_param=(name,read_cookies)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*get_param(){try{const ret=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().all({allow_fail:true},{local:E.storage_local_get(name),local_storage:v3?null:_util_storage_js__WEBPACK_IMPORTED_MODULE_6___default().get(name),cookie:!_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().is_mocha()&&read_cookies&&_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*(){return yield cookie__WEBPACK_IMPORTED_MODULE_2___default().get(name)})),ccgi:!_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().is_mocha()&&read_cookies&&_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().cb_apply(chrome.cookies,".get",[{url:conf__WEBPACK_IMPORTED_MODULE_15__.url_ccgi,name}])});const ext_storage_value=_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().get(ret,["local",name]);const res_value=ext_storage_value||ret.local_storage||ret.cookie||_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().get(ret,"ccgi.value");if(res_value&&!ext_storage_value){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr("persist_param_in_ext_storage",{[name]:res_value});E.persist_param(name,res_value)}return res_value}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr("unreachable",`get_${name}`,{err:e})}}));E.persist_param_errors={};E.persist_param=(name,value,set_cookie)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*persist_param(){try{const ret=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_8___default().all({allow_fail:true},{local:E.storage_local_set({[name]:value}),localStorage:_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*persist_param_ls_(){if(!v3)yield localStorage.setItem(name,value)})),cookie:set_cookie&&_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*persist_param_cookie_(){yield cookie__WEBPACK_IMPORTED_MODULE_2___default().set(name,value,{expires:36500,path:"/"})}))});E.persist_param_errors[name]=E.collect_errors(ret);return underscore__WEBPACK_IMPORTED_MODULE_0___default().isEmpty(ret)}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr("unreachable",`persist_${name}`,{err:e})}}));E.fixup_install_data=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*fixup_install_data(){if(_util_util_js__WEBPACK_IMPORTED_MODULE_3___default().is_mocha())return;let install_ver=yield E.get_param("install_version",true);if(!install_ver||!_util_version_util_js__WEBPACK_IMPORTED_MODULE_9___default().valid(install_ver)){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr("be_fixup_install_ver",{install_ver});yield E.persist_param("install_version",_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().version(),true);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_14___default().set("install_version",_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().version())}let install_ts=+(yield E.get_param("install_ts",true));let now=E.now();if(!install_ts||install_ts>now){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr("be_fixup_install_ts",{install_ts});yield E.persist_param("install_ts",now,true);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_14___default().set("install_ts",now)}let last_install_ts=+(yield E.get_param("last_install_ts"));if(!last_install_ts||last_install_ts>now){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr("be_fixup_last_install_ts",{last_install_ts});yield E.persist_param("last_install_ts",now);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_14___default().set("last_install_ts",now)}}));E.verify_install_ts=uuid_info=>_util_etask_js__WEBPACK_IMPORTED_MODULE_8___default()((function*verify_install_ts(){if(!uuid_info)return;if(uuid_info.install_version){const install_ver=yield E.get_param("install_version",true);if(!install_ver||!_util_version_util_js__WEBPACK_IMPORTED_MODULE_9___default().valid(install_ver)||_util_version_util_js__WEBPACK_IMPORTED_MODULE_9___default().cmp(uuid_info.install_version,install_ver)<0){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr("be_install_ver_server_fix",{install_ver,uuid_info});yield E.persist_param("install_version",uuid_info.install_version,true);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_14___default().set("install_version",uuid_info.install_version)}}if(uuid_info.first_install_ts){const install_ts=+(yield E.get_param("install_ts",true));if(!install_ts||uuid_info.first_install_ts<install_ts){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr("be_install_ts_server_fix",{install_ts,uuid_info});yield E.persist_param("install_ts",uuid_info.first_install_ts,true);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_14___default().set("install_ts",uuid_info.first_install_ts)}}if(uuid_info.install_ts){const last_install_ts=+(yield E.get_param("last_install_ts"));const wrong_last_install_ts=last_install_ts>uuid_info.install_ts&&last_install_ts>17142624e5&&last_install_ts<17149536e5;if(!last_install_ts||wrong_last_install_ts){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_12___default().perr("be_last_install_ts_server_fix",{last_install_ts,uuid_info});yield E.persist_param("last_install_ts",uuid_info.install_ts);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_14___default().set("last_install_ts",uuid_info.install_ts)}}}));const __WEBPACK_DEFAULT_EXPORT__=E},3886:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var underscore__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8763);var underscore__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_0__);var conf__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9641);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6969);var _bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_2__);var _util_etask_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_3__);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3727);var _bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4__);var _util_util_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_5__);var _util_array_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6545);var _util_array_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_util_array_js__WEBPACK_IMPORTED_MODULE_6__);var _util_rand_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(4135);var _util_rand_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_util_rand_js__WEBPACK_IMPORTED_MODULE_7__);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(7345);var _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_9__);var _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(8076);var _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(6210);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(4130);var _bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12__);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(843);var _svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13__);var _bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(4968);var _util_url_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(5305);var _util_url_js__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(_util_url_js__WEBPACK_IMPORTED_MODULE_15__);var _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(897);var _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_16__);var _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(9651);var _util_storage_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(1032);var _util_storage_js__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(_util_storage_js__WEBPACK_IMPORTED_MODULE_18__);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(5250);var _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19__);var _bext_vpn_util_no_log_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(2181);var _util_date_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_21___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_21__);var _bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(737);var _bext_vpn_bg_pac_js__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(7957);var _bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(1002);var _bext_vpn_bg_tab_perr_js__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(228);var _bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(9265);var _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(2227);var _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_27___default=__webpack_require__.n(_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_27__);var _bext_vpn_bg_force_lib_js__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(7310);var _bext_vpn_bg_force_lib_js__WEBPACK_IMPORTED_MODULE_28___default=__webpack_require__.n(_bext_vpn_bg_force_lib_js__WEBPACK_IMPORTED_MODULE_28__);var _protocol_pub_countries_js__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(3958);var _protocol_pub_countries_js__WEBPACK_IMPORTED_MODULE_29___default=__webpack_require__.n(_protocol_pub_countries_js__WEBPACK_IMPORTED_MODULE_29__);var _bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(7666);var _bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(7148);var _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(8552);var _bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(1679);var _pub_state_js__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(7619);
// LICENSE_CODE ZON
_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().assert_bg("be_vpn");function get_bg_main(){return self.be_bg_main}let chrome=self.chrome,assign=Object.assign;let state;const v3=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().is_v3;const E=new(_bext_pub_backbone_js__WEBPACK_IMPORTED_MODULE_2___default().model.extend({tabs:{},active_tab_id:0,unblocked_urls:{},history:{},_defaults:function(){this.on("destroy",(()=>E.uninit()))}}));var active_tab_timer_ms=_util_date_js__WEBPACK_IMPORTED_MODULE_21___default().ms.HOUR;E.be_tab_unblocker=_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_16___default();let{SEC}=_util_date_js__WEBPACK_IMPORTED_MODULE_21___default().ms;function is_stub_unblock(domain){return domain&&(!_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_26__["default"].is_active()&&_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().is_google(domain)||_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().is_skip_url(_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().root2url(domain)))}function is_av_error(err){return(err||"").match(/antivirus/)}function on_lib_event(o){switch(o.id){case"set_agent_key":_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().set("agent_key",o.data);break;case"before_rule_set":const rule=o.data;if(!is_stub_unblock(rule.name)&&rule.name!="all_browser"&&!rule.keep_cookies){clean_cookies(rule.name)}if(_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(chrome,"webRequest.handlerBehaviorChanged"))chrome.webRequest.handlerBehaviorChanged();break;case"proxy_auth_err":if(is_av_error(o.data.err_desc)&&!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("is_blocked_by_av")){_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set("is_blocked_by_av_ts",Date.now());_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().set("is_blocked_by_av",true);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_vpn_blocked_by_av",o.data)}break;case"proxy_auth":if(_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_int("is_blocked_by_av_ts")){_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().clr("is_blocked_by_av_ts");_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_vpn_blocked_by_av_auth_success",o.data)}}}function get_root_urls(root_url){var site,root_urls=[root_url];if(!(site=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().get_site_conf(root_url))||!site.root_url)return root_urls;for(var i=0;i<site.root_url.length;i++){if(root_url!=site.root_url[i])root_urls.push(site.root_url[i])}return root_urls}function clean_cookies(domain,force){if(!_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(chrome,"cookies.getAll")||!_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(chrome,"cookies.remove")){return}var site;if(!force&&((site=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().get_site_conf(domain))&&site.keep_cookies||_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_int("keep_cookies"))){return}E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*clean_cookies_domain_(){const domains=get_root_urls(domain);let cookies=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().all(domains.map((v=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().cb_apply(chrome.cookies.getAll,[{domain:v}]))));cookies=_util_array_js__WEBPACK_IMPORTED_MODULE_6___default().flatten_shallow(cookies||[]);cookies.forEach((cookie=>{if(!cookie)return;chrome.cookies.remove({name:cookie.name,url:(cookie.secure?"https":"http")+"://"+cookie.domain+cookie.path})}))})));E.sp.spawn(_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*clean_cookies_all_(){let cookies=yield _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().all([_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().cb_apply(chrome.cookies.getAll,[{name:"DS"}]),_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().cb_apply(chrome.cookies.getAll,[{name:"DE2"}])]);cookies=_util_array_js__WEBPACK_IMPORTED_MODULE_6___default().flatten_shallow(cookies);const filtered=underscore__WEBPACK_IMPORTED_MODULE_0___default().filter(cookies,(cookie=>cookie&&/^\.g[a-z]{1}\.com$/.test(cookie.domain)));filtered.forEach((cookie=>{chrome.cookies.remove({url:"http://yep"+cookie.domain,name:cookie.name})}));if(filtered.length){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_clean_cookies2",{rule:domain,cookies:filtered.map((c=>underscore__WEBPACK_IMPORTED_MODULE_0___default().pick(c,"domain","name","path")))},{rate_limit:{count:1}})}})))}const on_premium_change=()=>{const tasks=_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_27___default().set_user_plus(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("is_premium"));if(_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(tasks,"length")&&E.active_tab_id)_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default().reload(E.active_tab_id)};function CG(id,def){return _util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("bext_config"),id,def)}function uninit_unblocker_lib(){_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_27___default().uninit();_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_27___default().off("lib_event",on_lib_event);init_unblocker_lib.inited=false;E.stopListening(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default(),"change:is_premium",on_premium_change)}const init_unblocker_lib=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*_init_unblocker_lib(){if(init_unblocker_lib.inited)return;init_unblocker_lib.inited=true;_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_27___default().on("lib_event",on_lib_event);yield _svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_27___default().init({be_dev_mode:_bext_vpn_bg_dev_mode_js__WEBPACK_IMPORTED_MODULE_33__["default"],perr:(opt,err)=>err?_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr(opt.id,opt.info,assign({err},opt)):_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr(opt.id,opt.info,opt),ajax:_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.ajax,ajax_via_proxy:_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.ajax_via_proxy,storage:{get:id=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*get(){let ret;try{ret=yield _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_32__["default"].storage_local_get(id)}catch(e){}return ret&&ret[id]})),set:(id,val)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*set(){try{yield _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_32__["default"].storage_local_set({[id]:val})}catch(e){}}))},conf_get:(id,def)=>{var v=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get(id);return/^gen\./.test(id)?v!==undefined?v:def:CG(id,def)},get_auth:()=>_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().auth({is_premium:+!!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("is_premium")}),get_prod_info:()=>_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().qs_ajax({uuid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("uuid")}),get_user_info:()=>({hola_uid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("hola_uid"),country:(_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__["default"].get("location"),"country")||"").toLowerCase()}),suspend_client:permanent=>get_bg_main().suspend_client(permanent),get_verify_url:(agent,force_ip)=>{let res;if(_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.need_agent_domain_fallback()){res="https://"+_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.get_agent_fallback_host(agent.host)}else if(force_ip||_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.is_agent_fallback())res="http://"+agent.ip;else res="https://"+agent.host;return res+":"+agent.port+"/verify_proxy"},get_rule_routes:rule=>{let routes=[],s=_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().pick(rule,"country");let route=_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_16___default().get_rule_route(rule);routes.push(s);if(route.pool||rule.pool)routes.push(assign({pool:route.pool||rule.pool},s));return routes},get_fallback_agent:country=>{let a;if(!(a=_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(conf__WEBPACK_IMPORTED_MODULE_1__,"fallback_agents.agents"))||!a.length)return;a=_util_rand_js__WEBPACK_IMPORTED_MODULE_7___default().rand_element(a);return{host:a.name+".hola.org",port:25500,ip:a.ip,port_list:conf__WEBPACK_IMPORTED_MODULE_1__.fallback_agents.ports,is_fallback:true}},is_proxy_auth_supported:()=>conf__WEBPACK_IMPORTED_MODULE_1__.type=="cws"||_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().is_mocha(),use_proxy_preauth:()=>!CG("disable_proxy_preauth")&&v3&&_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().browser_guess.browser!="firefox"&&_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().browser_guess.version<122,get_auth_url:agent=>{let host=_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.need_agent_domain_fallback()?_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.get_agent_fallback_host(agent.host):agent.host;return`https://${host}:${agent.port}/auth`},get_agent_fallback_host:host=>_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.need_agent_domain_fallback()?_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.get_agent_fallback_host(host):host,check_agent_domain_fallback:force=>_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.check_agent_domain_fallback(force)});E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default(),"change:is_premium",on_premium_change);if(_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_26__["default"].get("updated"))E.listen_hola_uid_change();else _bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_26__["default"].once("change:updated",E.listen_hola_uid_change)}));E.listen_hola_uid_change=()=>{E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default(),"change:hola_uid",E.update_user_geo_block);if(!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().is_bg_reinited())E.update_user_geo_block()};E.uninit=function(){if(!E.get("inited"))return;E.sp.return();status_cb.timer=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().clear_timeout(status_cb.timer);E.off("recover",on_recover);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().off("change:is_premium",set_gen_conf_cb);_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_26__["default"].off("change:updated",E.listen_hola_uid_change);proxy_settings_monitor.uninit();monitor_active_uninit();monitor_sites_uninit();uninit_unblocker_lib();bext_config_init.et=bext_ping.et=undefined;if(_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().is_mocha()){E.be_tpopup.uninit();_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.uninit();_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_16___default().uninit();_bext_vpn_bg_tab_perr_js__WEBPACK_IMPORTED_MODULE_25__.Z.uninit();_bext_vpn_bg_pac_js__WEBPACK_IMPORTED_MODULE_23__["default"].uninit();_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_31__.Z.uninit();E.be_svc.uninit();E.be_mode.uninit();E.be_info.uninit()}else{E.be_tpopup._destroy();_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z._destroy();_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_16___default()._destroy();_bext_vpn_bg_tab_perr_js__WEBPACK_IMPORTED_MODULE_25__.Z._destroy();_bext_vpn_bg_pac_js__WEBPACK_IMPORTED_MODULE_23__["default"]._destroy();_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_31__.Z._destroy();E.be_svc._destroy();E.be_mode._destroy();E.be_info._destroy()}E.stopListening();E.clear()};var proxy_settings_monitor={};proxy_settings_monitor.init=function(){if(this.inited||!chrome||conf__WEBPACK_IMPORTED_MODULE_1__.firefox_web_ext||_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().is_mocha())return;this.inited=true;try{chrome.proxy.settings.get({},this.changed_cb);chrome.proxy.settings.onChange.addListener(this.changed_cb)}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("proxy_settings_init_err",{},{e,rate_limit:{count:1}})}};proxy_settings_monitor.uninit=function(){if(!this.inited)return;try{chrome.proxy.settings.onChange.removeListener(this.changed_cb)}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("proxy_settings_uninit_err",{},{e,rate_limit:{count:1}})}};proxy_settings_monitor.changed_cb=function(details){if(!details)return _util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default()("proxy_changed no details");var conflict=details.levelOfControl=="controlled_by_other_extensions";_util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default()[conflict?"err":"debug"]("proxy changed: %s control: %s",!details.value.pacScript||details.value.pacScript.url?_util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default().json(details.value):"pacScript-data",details.levelOfControl);let prev=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("ext.conflict");_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().set({"proxy.effective.control_level":details.levelOfControl,"proxy.effective.value":details.value,"ext.conflict":conflict});if(!!prev==!!conflict)return;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr(conflict?"ext_conflict":"ext_conflict_resolved",{proxy_level:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("proxy.effective.control_level"),proxy_value:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("proxy.effective.value")},{rate_limit:{count:1,ms:_util_date_js__WEBPACK_IMPORTED_MODULE_21___default().ms.DAY}})};function on_recover(){if(E.get("need_recover"))return;E.set("need_recover",true);status_cb()}function update_state(){let is_enabled=!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().is_disabled();if(is_enabled==E.is_enabled)return;E.is_enabled=is_enabled;if(!is_enabled){if(bext_config_init.et)bext_config_init.et=void bext_config_init.et.return();if(bext_ping.et)bext_ping.et=void bext_ping.et.return();monitor_active_uninit();_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_27___default().reset();_bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.reset();_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_22__["default"].uninit()}else{_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_22__["default"].init(E);bext_config_init();bext_ping();monitor_active_init();E.force_bext_config_update()}}E.init=function(){return _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*init(){if(E.get("inited"))return;state=new _pub_state_js__WEBPACK_IMPORTED_MODULE_34__["default"]("be_vpn_state",{sites_stat:{all:{},proxy:{},start_ts:Date.now()}},{persistent:false});yield state.load();chrome=self.chrome;E.sp=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().new_etask("be_vpn");E.set("inited",true);E.on("recover",on_recover);E.be_rule=_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z;E.be_tpopup=_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_14__.Z;E.be_info=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__["default"];E.be_svc=_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_22__["default"];E.be_mode=_bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_24__.Z;yield _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__["default"].init();_bext_vpn_bg_svc_js__WEBPACK_IMPORTED_MODULE_22__["default"].init(E);_bext_vpn_bg_mode_js__WEBPACK_IMPORTED_MODULE_24__.Z.init();_bext_vpn_bg_pac_js__WEBPACK_IMPORTED_MODULE_23__["default"].init();yield init_unblocker_lib();yield _bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_16___default().init();_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_31__.Z.init(E);_bext_vpn_bg_tab_perr_js__WEBPACK_IMPORTED_MODULE_25__.Z.init(E);_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.init();_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_14__.Z.init();proxy_settings_monitor.init();E.listenTo(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z,"change:status",status_cb);E.listenTo(E.be_info,"change:status",status_cb);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default(),"change:active.id",tab_vpn_on_change_active);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default(),"created",tab_vpn_on_created);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default(),"updated",tab_vpn_on_updated);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default(),"committed",tab_vpn_on_comitted);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default(),"removed",tab_vpn_on_removed);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default(),"replaced",tab_vpn_on_replaced);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default(),"error_occured",tab_vpn_on_error_occured);E.listenTo(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default(),"before_navigate",on_before_navigate);E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default(),"trial_end",trial_end_cb);E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default(),"trial_grace_end",trial_grace_end_cb);E.listenTo(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default(),"conf_ver_change",(new_ver=>E.force_bext_config_update(false,new_ver)));E.listenTo(_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_26__["default"],"login_done",on_login_done);E.listen_to(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default(),"change:ext.active change:ext.suspended",update_state);chrome.tabs.query({},(tabs=>{for(var i=0;i<tabs.length;i++)tab_vpn_on_created({tab:tabs[i]})}));_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().on_init("change:is_premium",set_gen_conf_cb);bext_config_init();monitor_active_init();monitor_sites_init();bext_ping();yield E.update_full_browser_vpn_mode();let bump_ts;if(!(bump_ts=_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_int("bump_ts")))return;_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().clr("bump_ts");_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_bump_done",{bump:_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_int("bump"),ms:Date.now()-bump_ts})}))};function ts_in_range(begin_ts,ts_ar,end_ts){return ts_ar.some((ts=>ts&&begin_ts<ts&&ts<=end_ts))}function update(info,data,ts,pref,expire_ts){if(!info||!info.last_req_ts)return;ts[pref+"req_ts"]=Math.max(ts[pref+"req_ts"],info.last_req_ts);const to_remove=[];for(let host in info.agents){if(info.agents[host]>expire_ts)data[pref+"agents"][host]=info.agents[host];else to_remove.push(host)}for(let i=0;i<to_remove.length;i++)delete data[pref+"agents"][to_remove[i]];if(!info.req_stats)return;const p=pref+(pref?"_":"")+"req_";for(let n in info.req_stats){if(info.req_stats[n])data[p+n]=(data[p+n]||0)+info.req_stats[n]}info.req_stats={}}function get_active_agents(agents,begin_ts,end_ts){const res=[];for(let host in agents){if(ts_in_range(begin_ts,[agents[host]],end_ts))res.push(host)}return res}var monitor_active={};function monitor_active_init(){if(monitor_active.sp)return;const get_data=()=>{let data=_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_json("monitor_active");if(!data||typeof data!="object")data={};return data};let ts=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("last_install_ts");const install_period=5,max_period=60;let period=ts==self.hola.t.l_start?install_period:max_period;E.sp.spawn(monitor_active.sp=_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()({name:"monitor_active",cancel:true},(function*monitor_active_init_loop_(){this.finally((()=>delete monitor_active.sp));let period_ms=period*_util_date_js__WEBPACK_IMPORTED_MODULE_21___default().ms.MIN;for(let n=1;;n++){if(n>=period){let data=get_data();let ts=Date.now(),end_ts=ts;let begin_ts=end_ts-period_ms;let active_ts_ar=[data.unblocker_tab_ts,data.ui_close_ts,data.ui_open_ts,data.req_ts,data.mitm_tab_ts,data.mitm_req_ts];if(n<max_period){period=max_period;period_ms=period*_util_date_js__WEBPACK_IMPORTED_MODULE_21___default().ms.MIN}n=0;if(ts_in_range(begin_ts,active_ts_ar,end_ts)){let agents=get_active_agents(data.agents,begin_ts,end_ts);let mitm_agents=get_active_agents(data.mitm_agents,begin_ts,end_ts);let memory=performance.memory?{jsHeapSizeLimit:performance.memory.jsHeapSizeLimit,totalJSHeapSize:performance.memory.totalJSHeapSize,usedJSHeapSize:performance.memory.usedJSHeapSize}:null;const tabs=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default().get_nav_tabs();let connected_tabs_n=0;Object.keys(tabs).forEach((tab_id=>{if(E.tpopup_is_connected(tab_id))connected_tabs_n++}));_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_active",assign({agents,connected_tabs_n,mitm_agents,begin:begin_ts,end:end_ts,memory},_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().pick(data,"req_ts","unblocker_tab_ts","ui_close_ts","ui_open_ts","mitm_tab_ts","mitm_req_ts","req_total_n","req_succ_n","req_err_n","mitm_req_total_n","mitm_req_succ_n","mitm_req_err_n")))}data.agents={};data.mitm_agents={};["total_n","succ_n","err_n"].forEach((n=>{delete data["req_"+n];delete data["mitm_req_"+n]}));_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set_json("monitor_active",data)}yield _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().sleep(_util_date_js__WEBPACK_IMPORTED_MODULE_21___default().ms.MIN);const tabs=Object.keys(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default().get_nav_tabs());if(!tabs.length)continue;let now=Date.now(),tu=_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_16___default().tab_unblockers||{};let data=get_data();let expire_ts=now-period_ms,ts={req_ts:0,mitm_req_ts:0};data.agents=data.agents||{};data.mitm_agents=data.mitm_agents||{};tabs.forEach((id=>{let u;if((u=tu[id])&&data.unblocker_tab_ts!=now)data.unblocker_tab_ts=now;update(u,data,ts,"",expire_ts)}));data.req_ts=ts.req_ts||undefined;data.mitm_req_ts=ts.mitm_req_ts||undefined;_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set_json("monitor_active",data)}})))}function monitor_active_uninit(){if(monitor_active.sp)monitor_active.sp=void monitor_active.sp.return();monitor_active={}}function sites_stat_add(root_url){if(!root_url)return;state.set(["sites_stat","all",root_url],1);const rules=E.be_rule.get_rules(`http://${root_url}/`);if(E.is_enabled_for_browser()||rules&&rules.some((r=>r.enabled)))state.set(["sites_stat","proxy",root_url],1)}function send_site_stat(){let count=Object.keys(state.get("sites_stat.all"||0)).length;let count_proxy=Object.keys(state.get("sites_stat.proxy"||0)).length;let interval=Date.now()-state.get("sites_stat.start_ts");_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_sites_stat",{count,count_proxy,interval});state.set("sites_stat",{all:{},proxy:{},start_ts:Date.now()})}let monitor_sites_et;function monitor_sites_init(){if(monitor_sites_et)return;E.sp.spawn(monitor_sites_et=_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()({name:"monitor_sites",cancel:true},(function*monitor_sites(){this.finally((()=>monitor_sites_et=null));while(true){let ms_since_start=Date.now()-state.get("sites_stat.start_ts");let wait_time=24*_util_date_js__WEBPACK_IMPORTED_MODULE_21___default().ms.HOUR-ms_since_start;if(wait_time>0)yield _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().sleep(wait_time);send_site_stat()}})))}function monitor_sites_uninit(){if(!monitor_sites_et)return;monitor_sites_et.return();monitor_sites_et=null}function check_bump(bext_config){if(E.bump_active||!bext_config.bump)return;var bump;if(!(bump=_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_int("bump"))||config_stats.n==1)return void _util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set("bump",bext_config.bump);if(bext_config.bump<=bump)return;E.bump_active=true;_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set("bump",bext_config.bump);if(_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_int("bump")!=bext_config.bump)return;E.listen_to(_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_16___default(),"change:activity",underscore__WEBPACK_IMPORTED_MODULE_0___default().debounce((function(){if(_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get("bump_ts"))return;["agent_key","agent_key_ts","popup_rating_cache"].concat(bext_config.bump_clear||[]).forEach((function(k){_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().clr(k)}));_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set("bump_ts",Date.now());_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_reload_ext_bump");if(!bext_config.bump_enabled)return _util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default().notice("bump reload extension not allowed");_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().reload_ext_native()}),bext_config.bump_idle||5*_util_date_js__WEBPACK_IMPORTED_MODULE_21___default().ms.MIN))}const set_gen_conf=(_conf,key)=>{const get_conf=(c,k,keys)=>{const res={};keys.forEach((n=>res[n]=_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(c,k+"."+n,_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(c,n))));return res};const gen=get_conf(_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(_conf,"gen",{}),key,["name","dbg_log_rate","is_zgettunnels_post","name","dbg_log_rate","is_etask_perf_on"]);const features={};for(let e in gen){if(gen[e]&&e.endsWith("_on"))gen[e]=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().is_conf_allowed(gen[e]);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().set("gen."+e,gen[e]);if(gen[e])features["test_"+e]=e!="name"?1:gen[e]}_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().unset("features",features);if(Object.keys(features).length)_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().set("features",features)};E.set_user_message=function(bext_config){if(!bext_config)return;if(!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("uuid"))return;let user_message=bext_config.user_message||[];let listen=false;let init_user_msg=()=>{const country=(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__["default"].get("country")||"").toUpperCase();if(!country)return;if(listen)E.stopListening(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__["default"],"change:country",init_user_msg);let query={src_country:country,uuid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("uuid")};let valid_user_messages=[];let user_message_for_show_old=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("user_message_show")||[];let user_message_for_show=[];let user_message_shown=_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_json("user_message_shown")||[];let pushed_msg={};for(let one_message of user_message){if(one_message.enable===false)continue;let user_saw=user_message_shown.indexOf(user_message.id)>-1;if(user_saw)continue;if(one_message.filter&&_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().match_filter(query,one_message.filter)||!one_message.filter){valid_user_messages.push(one_message);if(!one_message.trigger){user_message_for_show.push(one_message);pushed_msg[one_message.id]=true}}}for(let um of user_message_for_show_old){if(pushed_msg[um.id])continue;if(um.valit_till&&um.valit_till>-1&&um.valit_till<Date.now()){continue}let is_valid=valid_user_messages.find((m=>m.id==um.id));if(is_valid)user_message_for_show.push(um)}_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set_json("user_message_show",user_message_for_show);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().set("valid_user_message",valid_user_messages);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().set("user_message_show",user_message_for_show)};let src_country=(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__["default"].get("country")||"").toUpperCase();if(src_country)init_user_msg();else{listen=true;E.listenTo(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__["default"],"change:country",init_user_msg)}};E.set_bext_config=function(bext_config){if(!bext_config){if(!(bext_config=_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_json("bext_config_last")))return _util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default()("set bext_config: missing config")}else if(bext_config.stamp)_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set_json("bext_config_last",bext_config);var hola_conf=_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_json("hola_conf")||{};if(hola_conf)bext_config=_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().extend_deep(bext_config,hola_conf);_bext_vpn_bg_force_lib_js__WEBPACK_IMPORTED_MODULE_28___default().convert_blob2check(bext_config,"force_premium");_bext_vpn_bg_force_lib_js__WEBPACK_IMPORTED_MODULE_28___default().convert_blob2check(bext_config,"get_privacy");for(let site in bext_config.sites||{}){let verify=bext_config.sites[site].verify||{};for(let country in verify)_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().convert_url2regex(verify,country);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().convert_url2regex(bext_config.sites[site],"redirect");if(!v3)_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().convert_url2regex(bext_config.sites[site],"headers_conf")}if(!v3)_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().convert_url2regex(bext_config,"headers_conf2");_util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default().notice(`set bext_config ver ${bext_config.version} `+`stamp ${bext_config.stamp}`);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().set("bext_config",bext_config);_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().set("debug.zerr",_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(hola_conf,"debug.zerr",{}));_bext_vpn_util_no_log_js__WEBPACK_IMPORTED_MODULE_20__["default"].set_config(bext_config);set_gen_conf_cb();E.update_full_browser_vpn_mode();E.set_user_message(bext_config)};const request_bext_config=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*request_bext_config_(){let src_country=(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__["default"].get("country")||"").toLowerCase();let qs={browser:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().browser(),ver:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().version(),src_country};if(config_update_no_cache){qs.ts=Date.now();config_update_no_cache=false}if(config_update_ver_change){qs.conf_ver=config_update_ver_change;config_update_ver_change=false}let prev_etag=E.get("last_bext_config_etag");let headers={};if(prev_etag&&!CG("disable_bext_config_etag_usage"))headers["if-none-match"]=prev_etag;let opt={timeout:20*SEC,method:"GET",headers,full_response:true};try{return yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.ccgi_cdn_ajax(assign({url:_util_url_js__WEBPACK_IMPORTED_MODULE_15___default().qs_add(conf__WEBPACK_IMPORTED_MODULE_1__.url_ccgi_cdn+"/bext_config.json",qs)},opt))}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_bext_config_origin_fallback",{},{err:e});return yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.ccgi_ajax(assign({url:_util_url_js__WEBPACK_IMPORTED_MODULE_15___default().qs_add(conf__WEBPACK_IMPORTED_MODULE_1__.url_ccgi+"/bext_config.json",qs)},opt))}}));var config_update_sleep;var config_update_no_cache=false;var config_update_ver_change=false;var config_stats={n:0,err:false,attempt:0};const set_gen_conf_cb=()=>set_gen_conf(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("bext_config"),_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("is_premium")?"prem":"free");function bext_config_init(){var pause;if(bext_config_init.et)return;bext_config_init.et=_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()({cancel:true,name:"bext_config_init"},[function try_catch$loop(){config_update_sleep=null;return request_bext_config()},function(resp){let{data,etag,status}=resp||{};if(resp&&resp.stamp){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_bext_config_invalid_return");data=resp}config_stats.n++;config_stats.attempt++;pause=2*_util_date_js__WEBPACK_IMPORTED_MODULE_21___default().ms.HOUR;var err=this.error||resp&&resp.err||data&&data.err,err_info;if(!data&&status==304&&etag==E.get("last_bext_config_etag"))_util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default().notice("bext_config etag hit");else if(err||!data||!data.stamp){if(config_stats.attempt==1)E.set_bext_config();err_info=(err?err.hola_info:undefined)||{};_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_bext_config_err",{n:config_stats.n,after_err:config_stats.err,status:err_info.status,exists:!!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("bext_config"),err_info,attempt:config_stats.attempt,stamp:CG("stamp"),resp_status:status,data},{err});pause=((E.t||{}).bext_config_err_to||5)*_util_date_js__WEBPACK_IMPORTED_MODULE_21___default().ms.MIN}else if(data.stamp&&CG("stamp",0)>data.stamp){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_bext_config_old",{n:config_stats.n,after_err:config_stats.err,attempt:config_stats.attempt})}else{E.set_bext_config(data);E.set("last_bext_config_etag",etag);check_bump(data);config_stats.attempt=0}config_stats.err=!!err;if(!config_stats.attempt)_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_27___default().trigger("conf_change");this.set_state("loop");return config_update_sleep=_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().sleep(pause)}]);E.sp.spawn(bext_config_init.et);return bext_config_init.et}function bext_ping(){if(bext_ping.et)return;bext_ping.et=_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()({cancel:true},(function*_bext_ping(){for(let n=0;;n++){let period=CG("ping.period",_util_date_js__WEBPACK_IMPORTED_MODULE_21___default().ms.DAY);let now=Date.now(),ping_ts=_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_int("ping_ts");if(!ping_ts&&n*_util_date_js__WEBPACK_IMPORTED_MODULE_21___default().ms.HOUR>=period||ping_ts&&now-ping_ts>=period){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_ping",{n});_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set("ping_ts",now)}yield _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().sleep(_util_date_js__WEBPACK_IMPORTED_MODULE_21___default().ms.HOUR)}}));E.sp.spawn(bext_ping.et);return bext_ping.et}E.force_bext_config_update=function(no_cache,new_ver){if(!config_update_sleep)return;config_update_no_cache=!!no_cache;config_update_ver_change=new_ver;config_update_sleep.return()};function status_cb(){var script=_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get("status");var info=E.be_info.get("status");var status=[script,info];if(status.includes("error"))E.set("status","error");else if(status.includes("busy"))E.set("status","busy");else{E.set("status","ready");tabs_update()}if(status.includes("busy")||!E.get("need_recover"))return;if(E.get("status")=="ready")return E.set("need_recover",false);_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().clear_timeout(status_cb.timer);status_cb.timer=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().set_timeout((()=>{_util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default().notice("be_vpn try recover");E.set("need_recover",false);if(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get("status")=="error")_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.recover();if(E.be_info.get("status")=="error")E.be_info.recover()}),0,{sp:E.sp})}function active_stop_measure(tab){if(!tab.active_ts)return;tab.active_time+=Date.now()-tab.active_ts;tab.active_ts=0;active_timer_clr(tab)}function active_reset(tab){active_stop_measure(tab);tab.active_time=0}function active_start_measure(tab){if(tab.active_ts)return;tab.active_ts=Date.now();active_timer_add(tab,active_tab_timer_ms)}function active_timer_clr(tab){if(!tab.active_timer)return;tab.active_timer=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().clear_timeout(tab.active_timer)}function active_timer_add(tab,ms){active_timer_clr(tab);tab.active_timer=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().set_timeout((()=>{tab.active_timer=null;total_active_report(tab)}),ms,{sp:E.sp})}function total_active_report(tab){active_stop_measure(tab);if(tab.active_reported)return;tab.active_reported=true;var rule;var loc_country=(_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__["default"].get("location"),"country")||"").toLowerCase();if(rule=tab.rule){var first_per_time=Date.now()-(E.unblocked_urls[tab.root_url]||0)>24*36e5;var stats=assign(underscore__WEBPACK_IMPORTED_MODULE_0___default().pick(rule,"name","type"),{proxy_country:(rule.country||"").toLowerCase()});_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_vpn_total_active_time",JSON.stringify(assign(stats,{root_url:tab.root_url,src_country:loc_country,total_active_time:tab.active_time/1e3,first_per_time})),{rate_limit:{count:20}});if(first_per_time)E.unblocked_urls[tab.root_url]=Date.now();return}if(!tab.root_url||tab.had_rule||Math.random()*50>=1)return;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_total_active_time",JSON.stringify({root_url:tab.root_url,src_country:loc_country,total_active_time:tab.active_time/1e3}),{rate_limit:{count:20}})}function tab_vpn_add(tab,rule){tab.had_rule=true;tab.rule=_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().clone(rule);active_reset(tab);sites_stat_add(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(tab.url));if(E.active_tab_id==tab.id)active_start_measure(tab)}function tab_add(tabid,url){var tab=E.tabs[tabid];var rule=E.rule_get(url);if(tab)return;_util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default().debug("tab:%d add url %s root %s",tabid,url.slice(0,200),_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(url));tab={url,root_url:_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(url),active:0,active_time:0,rule,id:tabid};E.tabs[tabid]=tab;if(E.active_tab_id==tabid)active_start_measure(tab);if(rule)tab_vpn_add(tab,rule)}function tab_vpn_del(tab){if(!tab.rule)return;total_active_report(tab);tab.rule=tab.storage_updated=tab.tz_spoof_inited=tab.geo_spoof_inited=null}function tab_del(tabid){var tab=E.tabs[tabid];if(!tab)return;total_active_report(tab);tab_vpn_del(tab);delete E.tabs[tabid]}function tab_update(tab){var rule=E.rule_get(tab.url);_util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default().debug("tab:%d update url %s is_vpn %O",tab.id,tab.root_url,!!rule);if(rule&&!tab.rule)tab_vpn_add(tab,rule);else if(!rule&&tab.rule)tab_vpn_del(tab)}function tabs_update(){for(var tab in E.tabs)tab_update(E.tabs[tab])}E.rule_get=function(url){var rule;if(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().is_disabled())return null;if((rule=_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get_rules(url)[0])&&rule.enabled)return rule;return null};var MAX_HISTORY=5;function tab_history_update(id,url,del){var tab=E.history[id];if(!tab){if(del)return;tab=E.history[id]={history:[]}}else if(del)return void delete E.history[id];var host=_util_url_js__WEBPACK_IMPORTED_MODULE_15___default().get_host(url);if(!host)return;if(tab.history.length&&host==tab.history[0])return;tab.history.unshift(host);if(tab.history.length>MAX_HISTORY)tab.history.pop()}E.tab_history_get=function(id){if(!(id=id||_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default().get("active.id")))return;var t=E.history[id];if(!t)return;return t.history};function tab_vpn_on_created(o){var tab=o.tab;if(!tab.url)return;tab_history_update(tab.id,tab.url);tab_add(tab.id,tab.url)}const execute_in_page_context=(tab_id,fn,args)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){tab_id=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_32__["default"].tabid2api(tab_id);if(v3){if(_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().browser_guess.version<95)return;yield chrome.scripting.executeScript({target:{tabId:tab_id},func:fn,args,world:"MAIN"});return}const inject=(fn,args_arr)=>{const script=document.createElement("script");const args_str=args_arr.map((a=>JSON.stringify(a))).join(" ");script.textContent="("+fn.toString()+")("+args_str+")";(document.head||document.documentElement).appendChild(script);script.remove()};const params=[fn,JSON.stringify(args)];const code="("+inject.toString()+")("+params+")";if(_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().is_mocha())return;yield _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().cb_apply(chrome.tabs,".executeScript",[tab_id,{code,runAt:"document_start"}])}));const tz_spoof_fn=offset=>{Date.prototype.getTimezoneOffset=()=>offset};const tz_spoof_inject=o=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()({cancel:true},(function*_tz_spoof_inject(){var tab=E.tabs[o.id];if(!tab||tab.tz_spoof_inited||!tab.rule||!chrome||!chrome.runtime||!chrome.runtime.getURL){return}var site,url=_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(o,"info.url");if(!(site=E.get_site_conf(url))||!site.tz_spoof)return;yield execute_in_page_context(o.id,tz_spoof_fn,[site.tz_spoof]);tab.tz_spoof_inited=true}));const geo_spoof_fn=(latitude,longitude)=>{if(!navigator.geolocation)return;navigator.geolocation.getCurrentPosition=function(succ,err,opt){succ({coords:{accuracy:10,altitude:null,altitudeAccuracy:null,heading:null,latitude:+latitude,longitude:+longitude,speed:null},timestamp:Date.now()})};navigator.geolocation.watchPosition=function(succ,err,opt){this.getCurrentPosition(succ,err,opt);return Math.floor(Math.random()*1e4)};navigator.geolocation.clearWatch=function(){}};const geo_spoof_inject=o=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()({cancel:true},(function*_geo_spoof_inject(){let tab=E.tabs[o.id];if(!tab||tab.geo_spoof_inited||!tab.rule||!chrome||!chrome.runtime||!chrome.runtime.getURL){return}let site,conf,url=_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(o,"info.url");if(!(site=E.get_site_conf(url))||!(conf=site.geo_spoof))return;const rand_range=val=>_util_rand_js__WEBPACK_IMPORTED_MODULE_7___default().rand_range(Math.min(val.from,val.to),Math.max(val.from,val.to));const latitude=rand_range(conf.latitude);const longitude=rand_range(conf.longitude);yield execute_in_page_context(o.id,geo_spoof_fn,[latitude,longitude]);tab.geo_spoof_inited=true}));const storage_spoof_fn=ls=>Object.keys(ls).forEach((key=>{const set=()=>{if(ls[key]==null){delete localStorage[key];delete sessionStorage[key];return}localStorage.setItem(key,ls[key]);sessionStorage.setItem(key,ls[key])};if(!key.includes("*"))return set();key=new RegExp(key.replace(/\./g,"\\.").replace(/\*/g,".*"));key=Object.keys(localStorage).find((e=>key.test(e)));if(key)set()}));const update_site_storage=o=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()({cancel:true},(function*_update_site_storage(){const tab=E.tabs[o.id];if(!tab||!tab.rule||tab.storage_updated||!chrome||!chrome.runtime)return;const url=_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(o,"info.url"),site=E.get_site_conf(url);if(!site||!site.site_storage)return;yield execute_in_page_context(o.id,storage_spoof_fn,[site.site_storage]);tab.storage_updated=true}));const tab_vpn_on_comitted=o=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()({cancel:true},(function*_tab_vpn_on_comitted(){yield tz_spoof_inject(o);yield geo_spoof_inject(o);yield update_site_storage(o)}));function tab_vpn_on_updated(o){var id=o.id,info=o.info;var tab=E.tabs[id];if(tab){delete tab.tz_spoof_inited;delete tab.geo_spoof_inited}if(!info||!info.url){if(info&&info.status=="complete"&&tab)sites_stat_add(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(tab.url));return}update_per_tab_rule(id);tab_history_update(id,info.url);var root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(info.url);sites_stat_add(root_url);if(tab&&tab.root_url==root_url){tab.url=info.url;tz_spoof_inject(o);geo_spoof_inject(o);return}if(tab)tab_del(id);tab_add(id,info.url);tz_spoof_inject(o);geo_spoof_inject(o)}function tab_vpn_on_removed(tab){let root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(tab.url);tab_history_update(tab.id,null,true);tab_del(tab.id);if(E.get_enabled_rule({tab_id:tab.id,url:tab.url})&&_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].is_trial_expired(root_url)){_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].send_trial_times_perr("trial_stop_close_tab")}}function tab_vpn_on_replaced(o){var added=o.added,removed=o.removed;tab_history_update(removed,null,true);tab_vpn_del(removed);chrome.tabs.get(added,(function(tab){if(!tab||!tab.url)return;tab_history_update(added,tab.url);var root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(tab.url);if(!root_url)return;tab_add(added,tab.url)}))}function tab_vpn_on_change_active(){var id=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default().get("active.id");if(!id)return;var tab=E.active_tab_id?E.tabs[E.active_tab_id]:null;if(tab)active_stop_measure(tab);E.active_tab_id=id;if(tab=E.tabs[id])active_start_measure(tab);update_per_tab_rule(id)}function update_per_tab_rule(tab_id){if(!is_per_tab_mode())return;const t=_bext_vpn_bg_tab_unblocker_js__WEBPACK_IMPORTED_MODULE_16___default().get_tab_unblocker(tab_id);const rule=t&&t.rule;if(rule&&!_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().is_all_browser(rule)&&!_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get_per_tab_rule(tab_id)){_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.set_per_tab_rule(tab_id,rule)}}function tab_vpn_on_error_occured(o){var info=o.info||{};if(info.http_status_code!=0)return;var last=tab_vpn_on_error_occured.info||{};if(last.error==info.error&&last.url==info.url&&last.tabId==info.tabId)return;tab_vpn_on_error_occured.info=info;var domain=_util_url_js__WEBPACK_IMPORTED_MODULE_15___default().get_host(""+info.url);if(!_util_url_js__WEBPACK_IMPORTED_MODULE_15___default().is_valid_domain(domain))return;var rule,perr_info={domain,err:info.error||""};if(!(rule=E.rule_get(info.url))||info.error=="net::ERR_ABORTED")return;_util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default().debug("tab:%d tab_vpn_on_error_occured rule %s error %s url %s",info.tabId,rule.name||"undefined",info.error,info.url);perr_info.proxy_country=rule.country;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_webrequest_error",perr_info,{err:true,rate_limit:{count:5}})}function is_per_tab_mode(){return!E.is_enabled_for_browser()&&_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].get_trial_conf("per_tab_rule")}function on_before_navigate(o){if(o.frameId||_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().is_skip_url(o.url)||!is_per_tab_mode()||!get_bg_main().get("enabled")){return}const rules=_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get_rules(o.url);if(rules&&rules[0])return;let tab_rule=_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get_per_tab_rule(o.tabId);if(!tab_rule)return;unblock_enable({url:o.url,country:tab_rule.country,keep_cookies:true})}E.set_enabled=function(on){try{on=!!on;get_bg_main().set_enabled(on);if(!!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("ext.active")!=on&&!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("ext.conflict")){var attributes=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().attributes;_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_set_enabled_mismatch",{on,attributes},{err:true,rate_limit:{count:1}})}}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_set_enabled_err",{},{err:e});throw e}};E.script_set=(rule,val)=>{_util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default().debug("set rule %s %d %s",rule.name,+val.enabled,val.root_url);return _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()({name:"script_set",cancel:true},(function*script_set_(){yield E.set_enabled(true);let _suffix=val.page=="welcome"?`_from_welcome`:"";_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_32__["default"].set_site_storage(val.root_url,"is_onboarding_flow",val.is_onboarding_flow);_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_32__["default"].set_site_storage(val.root_url,"onboarding_flow_country",val.country);if(val.enabled&&!val.stub&&!val.mitm&&!val.skip_trial&&(_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].need_trial(val.root_url)||false&&0)){const reason=_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].get_trial_reason(val.root_url);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr(`be_enable_root_url_fail_${reason}${_suffix}`,{src_country:val.country});let src=val.src=="ui"?"popular_page":val.src;_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_32__["default"].set_site_storage(val.root_url,"force_trial",{country:val.country||rule.country,src});return this.return()}if(rule&&+val.enabled&&rule.enabled&&rule.src==val.src&&rule.mode==val.mode&&(rule.country&&!val.country||rule.country==val.country)){return this.return()}const new_rule={name:val.host||val.name||rule.name,enabled:+val.enabled,root_url:val.host||val.root_url,country:(val.country||rule.country||"").toLowerCase(),type:rule.type,mode:val.mode,tab_id:val.tab_id,stub:val.stub,no_reload:val.no_reload,mitm:val.mitm,per_tab:val.per_tab,keep_cookies:val.keep_cookies,reload_delay:val.is_onboarding_flow?1500:0};if(val.src)new_rule.src=val.src;_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.trigger("set_rule",new_rule);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr(`be_enable_root_url_success${_suffix}`,{src_country:val.country});if(E.get("status")=="ready")return;E.once("change:status",(()=>this.continue()));return yield this.wait(15*SEC)}))};E.enable_root_url=opt=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()({cancel:true},(function*enable_root_url(){const src_country=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__["default"].get("country");let rule_ratings,rule,root_url=opt.root_url,enabled=true,page=opt.page;let _suffix=page=="welcome"?`_from_welcome`:"";if(E.is_user_geo_blocked()){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr(`be_enable_root_url_user_geo_blocked${_suffix}`,{src_country});return void _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__["default"].set_force_tpopup(root_url)}if(!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("is_premium")&&_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_26__["default"].get_force_premium_rule(root_url)){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr(`be_enable_root_url_need_premium${_suffix}`,{src_country});return void _bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__["default"].set_force_tpopup(root_url)}if(opt.rule&&opt.rule.name&&opt.rule.country){rule=opt.rule;if(rule.enabled!==undefined)enabled=rule.enabled}else{if(opt.rule){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_enable_root_url_invalid_rule",assign(opt,{hola_uid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("hola_uid")}))}const _rule_ratings=yield _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get_rule_ratings({root_url,src_country,limit:20,proxy_country:opt.country,vpn_only:true});let groups;if(_rule_ratings){rule_ratings=_rule_ratings.filter((r=>{const country=r.proxy_country.toUpperCase();return _protocol_pub_countries_js__WEBPACK_IMPORTED_MODULE_29___default().proxy_countries.bext.includes(country)}));groups=yield _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get_groups_from_ratings(rule_ratings)}let url="http://"+root_url+"/",host=_util_url_js__WEBPACK_IMPORTED_MODULE_15___default().get_host(url);let popular=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().get_popular_country({host,rule_ratings});let proxy_country=(opt.country||popular[0].proxy_country||"").toLowerCase();let all_rules=_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_32__["default"].get_all_rules({proxy_country,rules:_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get("rules"),url,root_url,rule_ratings,groups,mitm:opt.mitm});rule=all_rules[0]}if(E.is_enabled_for_browser()||_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().full_browser_mode()){yield E.set_browser_country({country:enabled?rule.country:null,root_url,tab_id:_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default().get("active.id"),src:"popular_page"})}else{yield E.script_set(rule,{enabled,root_url,src:opt.src,country:rule.country,mitm:opt.mitm||rule.mitm,no_reload:opt.no_reload,is_onboarding_flow:opt.is_onboarding_flow||false,page})}_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr(`be_enable_root_url${_suffix}`,{name:rule.name,root_url,country:rule.country,hola_uid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("hola_uid"),src_country:(src_country||"").toLowerCase()});return rule}));E.tpopup_is_connected=(id,tpopup_type)=>E.be_tpopup&&E.be_tpopup.is_connected(id,tpopup_type);E.stop_vpn=function(url,tab_id){_util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default().notice("stop vpn "+url);let root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(url);if(_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_31__.Z.is_popup_needed(root_url))return void _bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_31__.Z.set_ignore(root_url,tab_id);const rule=E.rule_get(url);if(!rule)return;_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.trigger("set_rule",{name:rule.name,root_url,enabled:0,country:rule.country,type:rule.type,tab_id});if(_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].is_trial_expired(root_url))_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].send_trial_times_perr("trial_stop_ui")};E.get_site_conf=url=>{if(!url)return;const root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(url);return _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().get_site_conf(root_url)};E.do_tpopup=(tab_id,root_url,opt)=>{_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_14__.Z.do_tpopup(E.tabs[tab_id],root_url,opt)};E.get_all_browser_rule=()=>{const rules=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().get_rules(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get("rules"));if(_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().is_disabled())return false;return _bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().is_all_browser(rules[0])&&rules[0]};E.is_enabled_for_browser=()=>!!E.get_all_browser_rule();E.set_enabled_for_browser=(enable,opt)=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*set_enabled_for_browser(){opt=opt||{};_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_ui_vpn_protect_browser",{enable});let rule=E.get_all_browser_rule();if(!enable){if(!rule)return;yield E.script_set(rule,{enabled:false})}else{if(rule&&rule.country==opt.country)return;yield E.script_set({country:opt.country,type:"url"},{enabled:true,host:"all_browser",mode:"protect"})}}));E.set_browser_country=({country,tab_id,root_url,src})=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*set_browser_country(){if(!country){yield E.set_enabled_for_browser(false);return true}if(!root_url&&tab_id)root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default().get_url(tab_id));if(!_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].need_trial(root_url)){yield E.set_enabled_for_browser(true,{country});return true}if(_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].can_start_trial_silently(root_url)){try{if(yield _bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].start_trial(root_url)){yield E.set_enabled_for_browser(true,{country});return true}}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_vpn_silent_trial_start_err",{root_url,country},{err:e})}}_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_32__["default"].set_site_storage(root_url,"force_trial",{country,tab_id,src});if(src=="new_tab"){_bext_vpn_bg_tpopup_js__WEBPACK_IMPORTED_MODULE_14__.Z.do_tpopup(E.tabs[tab_id],root_url,{tpopup_type:"watermark"})}return false}));E.get_disabled_rule=opt=>{if(!E.get("inited"))return;let{url}=opt;let is_premium=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("is_premium");if(is_premium&&E.is_enabled_for_browser())return;let rules=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().get_rules(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get("rules"),url);let rule=rules&&rules[0];if(rule&&!rule.enabled)return rule};const is_browser_vpn_allowed=()=>_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("is_premium")||_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().full_browser_mode();E.get_enabled_rule=opt=>{if(!E.get("inited"))return;let{url,tab_id}=opt;let is_premium=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("is_premium");if(E.is_enabled_for_browser())return assign({protect:"browser"},E.get_all_browser_rule());let stub_rule=(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get("tabs_stub_rules")||{})[tab_id];if(stub_rule&&stub_rule.enabled&&_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().is_stub_url(url,is_premium)){return stub_rule}let rules=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().get_rules(_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get("rules"),url);let rule=rules&&rules[0]||_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().is_stub_url(url,is_premium)&&_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.get_per_tab_rule(tab_id)||{};if(!rule.enabled||_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().is_disabled())return null;return rule};E.unblock_disable=({url,tab_id,skip_dont_show,no_reload})=>{let rule=E.get_enabled_rule({url,tab_id});let root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(url);if(!skip_dont_show&&(_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].get_trial_active(root_url)||_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].is_trial_expired(root_url))){_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_32__["default"].set_site_storage(root_url,"trial.dont_show_ended",true)}if(!rule)return;if(rule.protect=="browser")E.set_enabled_for_browser(false,{tab_id,url});_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.trigger("set_rule",{name:root_url,root_url,enabled:0,country:rule.country,type:rule.type,tab_id,stub:rule.stub,per_tab:is_per_tab_mode(),no_reload})};let unblock_enable=opt=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*unblock_enable_(){let{url,tab_id,mitm,protect,country}=opt;let root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(url);let rule=E.get_enabled_rule({url,tab_id})||{};let is_premium=_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("is_premium");const set_site_rule=changes=>E.script_set(rule,assign({name:root_url,root_url,enabled:1,country:country||rule.country,mode:rule.mode,tab_id,mitm,stub:!mitm&&_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().is_skip_url(url)||!is_premium&&_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().is_google(root_url),per_tab:is_per_tab_mode(),no_reload:opt.no_reload,skip_trial:opt.skip_trial,keep_cookies:opt.keep_cookies},changes));if(!is_premium&&(_bext_vpn_bg_premium_js__WEBPACK_IMPORTED_MODULE_26__["default"].get_force_premium_rule(root_url)||protect))return _util_zerr_js__WEBPACK_IMPORTED_MODULE_9___default()("user not premium");if(protect=="browser"||protect===undefined&&rule.protect=="browser"||protect===undefined&&rule.protect===undefined&&_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().full_browser_mode()){return yield E.set_enabled_for_browser(true,{country:country||rule.country,tab_id,url})}if(protect===false){if(rule.protect=="browser")yield E.set_enabled_for_browser(false,{tab_id,url});if(!_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().is_skip_url(url))yield set_site_rule({mode:"unblock",country});return}yield set_site_rule({country})}));E.unblock_action=opt=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*unblock_action(){const src_country=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__["default"].get("country");let{url,tab_id}=opt;let redirects,root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(url);let rules_set=new _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_32__["default"].Rules_set(null,opt.disable);let no_reload=_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_int("no_reload");if(opt.disable){redirects=new _bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_32__["default"].Rules_set(root_url).to_array().map((r=>_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().root2url(r)));for(let u of[url,...redirects]){rules_set.add(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(u));E.unblock_disable({url:u,tab_id,no_reload})}if(redirects&&redirects.length)rules_set.save();if(!CG("mitm2.disable_rule_removal_on_vpn_stop"))_bext_vpn_bg_mitm_js__WEBPACK_IMPORTED_MODULE_31__.Z.remove_rule(root_url);return}if(E.is_user_geo_blocked()){return void _bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_unblock_action_user_geo_blocked",{src_country})}redirects=opt.redirects&&opt.redirects.filter((u=>u!=url))||[];let site;let reload_after=redirects.length&&(!(site=_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().get_site_conf(root_url))||!_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().get(site,"trial.trial_redirect"));for(let u of[url,...redirects]){rules_set.add(_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(u));yield unblock_enable(assign({},opt,{url:u,no_reload:reload_after||no_reload}))}if(redirects&&redirects.length)rules_set.save();if(reload_after&&!no_reload)_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default().update(tab_id,{url,active:true});_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set("unblock_action_n",(_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_int("unblock_action_n")||0)+1)}));const on_login_done=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){let opt=unblock_after_login_opt;unblock_after_login_opt=null;if(!opt||opt.tab_id!=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default().get("active.id"))return;let{disable,url,skip_trial,country,tab_id,src}=opt;let root_url=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(url);let is_stub=_bext_vpn_util_util_js__WEBPACK_IMPORTED_MODULE_19___default().is_stub_url(url,_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("is_premium"))&&!_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().full_browser_mode();if(disable||is_stub||skip_trial||!_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].need_trial(root_url))return void E.unblock_action(opt);if(E.tpopup_is_connected(tab_id)){E.trigger("force_trial",{country,tab_id});return this.return()}if(_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].can_start_trial_silently(root_url)){try{if(yield _bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].start_trial(root_url))return void E.unblock_action(opt)}catch(e){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_vpn_login_done_trial_start_err",{root_url},{err:e})}}let redirects=[root_url];if(opt.redirects){for(let u of opt.redirects){let r=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(u);if(r!=root_url)redirects.push(r)}}for(let r of redirects){_bext_vpn_bg_util_js__WEBPACK_IMPORTED_MODULE_32__["default"].set_site_storage(r,"force_trial",{country,tab_id,src,autostart:true})}let active=_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_root_url(_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default().get("active.url")||"");if(redirects.some((r=>_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().is_same_site(r,active)))){return yield E.do_tpopup(tab_id,root_url)}_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default().update(tab_id,{url,active:true})}));let unblock_after_login_opt;E.unblock_after_login=opt=>{unblock_after_login_opt=opt};E.force_full_browser_mode=enable=>{_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set("force_full_browser_mode",enable);E.update_full_browser_vpn_mode()};E.set_browser_ab=test=>{_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set_json("test_from_browser_ab",test)};E.update_full_browser_vpn_mode=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){let force=_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_json("force_full_browser_mode");if(force===true||force===false)_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().set_full_browser_mode(force);else if(CG("full_browser"))_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().set_full_browser_mode(true);else if(v3){let per_tab=CG("debug.v3_per_tab")||_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().check_min_ver(CG("v3_per_tab_min_ver"));if(CG("v3_full_browser_fallback")&&_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_int("full_browser_fallback_enable_ts")){per_tab=false}_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().set_full_browser_mode(!per_tab)}if(!is_browser_vpn_allowed()&&E.is_enabled_for_browser())yield E.set_enabled_for_browser(false)}));E.enable_full_browser_fallback=value=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){if(value)_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set("full_browser_fallback_enable_ts",Date.now());else _util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().clr("full_browser_fallback_enable_ts");yield E.update_full_browser_vpn_mode();let tab_id=E.active_tab_id;if(!tab_id)return;let url=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default().get_url(tab_id);let rule=E.get_enabled_rule({url,tab_id});if(!rule)return;if(!value)yield _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().sleep(1e3);yield E.unblock_action({country:rule.country,url,tab_id})}));E.update_user_geo_block=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){const src_country=_bext_vpn_bg_info_js__WEBPACK_IMPORTED_MODULE_11__["default"].get("country");let qs={browser:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().browser(),ver:_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().version(),src_country,uuid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("uuid"),hola_uid:_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("hola_uid")||""};const opt=(yield _bext_vpn_bg_bg_ajax_js__WEBPACK_IMPORTED_MODULE_17__.Z.ccgi_ajax({url:_util_url_js__WEBPACK_IMPORTED_MODULE_15___default().qs_add(conf__WEBPACK_IMPORTED_MODULE_1__.url_ccgi+"/is_user_geo_blocked",qs)}))||{};const prev_opt=_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_json("user_geo_block")||{};if(!opt.blocked&&!prev_opt.blocked||opt.blocked&&prev_opt.blocked)return;if(opt.blocked){_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_user_geo_block_enabled",opt);yield _bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.update_rules({enable:false});return void _util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set_json("user_geo_block",opt)}_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_user_geo_block_disabled",assign({current_src_country:src_country},prev_opt));_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().set_json("user_geo_block",{blocked:false})}));E.is_user_geo_blocked=()=>{const opt=_util_storage_js__WEBPACK_IMPORTED_MODULE_18___default().get_json("user_geo_block")||{};return opt&&opt.blocked?opt:null};E.verify_antivirus_block=()=>_util_etask_js__WEBPACK_IMPORTED_MODULE_3___default()((function*(){if(!_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().get("is_blocked_by_av"))return;let need_wait;const agents=_svc_vpn_pub_unblocker_lib_js__WEBPACK_IMPORTED_MODULE_27___default().get_all_agents();for(let agent of agents){if(!is_av_error(agent.auth_error&&agent.auth_error.desc))continue;agent.auth_err_timer=500;agent.last_proxy_authed=0;if(agent.proxy_auth_sp)agent.proxy_auth_sp.return();agent.proxy_auth();need_wait=true}if(need_wait)yield _util_etask_js__WEBPACK_IMPORTED_MODULE_3___default().sleep(7*SEC);if(agents.some((a=>is_av_error(a.auth_error&&a.auth_error.desc))))return;_bext_pub_ext_js__WEBPACK_IMPORTED_MODULE_4___default().set("is_blocked_by_av",false);_bext_pub_util_js__WEBPACK_IMPORTED_MODULE_8___default().perr("be_vpn_blocked_by_av_fixed")}));E.get_events=()=>_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().events;E.events_to_str=()=>_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().events_to_str();E.get_event_n=e=>_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().get_event_n(e);E.reset_events=()=>_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().reset_events();E.push_event=(name,opt)=>_svc_vpn_pub_util_js__WEBPACK_IMPORTED_MODULE_13___default().push_event(name,opt);E.clean_cookies=clean_cookies;const trial_end_cb=trial=>{const tabs=_bext_vpn_bg_tabs_js__WEBPACK_IMPORTED_MODULE_12___default().get_nav_tabs();Object.keys(tabs).forEach((tab_id=>{let url=tabs[tab_id];if(!_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].match_url(trial,url))return;if(!E.tpopup_is_connected(tab_id))E.do_tpopup(+tab_id)}))};const trial_grace_end_cb=()=>{if(_bext_vpn_bg_trial_js__WEBPACK_IMPORTED_MODULE_30__["default"].is_vpn_forbidden())_bext_vpn_bg_rule_js__WEBPACK_IMPORTED_MODULE_10__.Z.disable_trial_on_grace_end()};if(_util_util_js__WEBPACK_IMPORTED_MODULE_5___default().is_mocha()){E.t={init_unblocker_lib,uninit_unblocker_lib,update_site_storage,clean_cookies,monitor_active_init,monitor_active_uninit,unblock_enable}}const __WEBPACK_DEFAULT_EXPORT__=E},665:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _util_etask_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6386);var _util_etask_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_util_etask_js__WEBPACK_IMPORTED_MODULE_0__);var _util_date_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(932);var _util_date_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_util_date_js__WEBPACK_IMPORTED_MODULE_1__);var _util_escape_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4336);var _util_escape_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_util_escape_js__WEBPACK_IMPORTED_MODULE_2__);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(9824);var _util_zerr_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_util_zerr_js__WEBPACK_IMPORTED_MODULE_3__);var events__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(8425);var events__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(events__WEBPACK_IMPORTED_MODULE_4__);
// LICENSE_CODE ZON
const E=do_fetch;const assign=Object.assign;E.events=new(events__WEBPACK_IMPORTED_MODULE_4___default().EventEmitter);E.json=function(opt){return do_fetch(assign({},opt,{json:1}))};E.abort=function(aj){aj.goto("abort")};function do_fetch(opt){let{retry,data,url,perr,qs,method="GET",timeout=20*_util_date_js__WEBPACK_IMPORTED_MODULE_1___default().ms.SEC,slow=2*_util_date_js__WEBPACK_IMPORTED_MODULE_1___default().ms.SEC}=opt;let response_etag,response_status;let t0=Date.now();let response;let controller=new self.AbortController;return _util_etask_js__WEBPACK_IMPORTED_MODULE_0___default()([function(){const tout_id=setTimeout((()=>controller.abort("timeout")),timeout);if(method=="GET"&&data){qs=data;data=undefined}const headers=new self.Headers(opt.headers);url=_util_escape_js__WEBPACK_IMPORTED_MODULE_2___default().uri(opt.url,_util_escape_js__WEBPACK_IMPORTED_MODULE_2___default().qs(qs));let body;if(data&&!headers.has("Content-Type")&&!(data instanceof FormData)&&typeof data=="object"){body=JSON.stringify(data);headers.append("Content-Type","application/json; charset=UTF-8")}else body=data;fetch(url,{method,body,signal:controller.signal,headers,credentials:opt.with_credentials?"include":"same-origin"}).then((res=>{clearTimeout(tout_id);response=res;if(!res.ok){this.throw(new Error(`${res.status} ${res.statusText}`));return}response_etag=res.headers.get("etag");response_status=res.status;let server_ts=+res.headers.get("x-hola-ts");if(server_ts)E.events.emit("server_ts",server_ts);let conf_ver=+res.headers.get("x-hola-conf-ver");if(conf_ver)E.events.emit("conf_ver",conf_ver);const cont_type=response.headers.get("content-type");this.continue(opt.json||cont_type&&cont_type.includes("application/json")?res.json():res.text())})).catch((err=>{clearTimeout(tout_id);this.throw(err instanceof Error?err:new Error(""+err))}));return this.wait()},function catch$(err){response=response||{};let status=response.status;let status_text=response.statusText;let response_text=response.responseText;_util_zerr_js__WEBPACK_IMPORTED_MODULE_3___default()("fetch failed url "+url+" data "+_util_zerr_js__WEBPACK_IMPORTED_MODULE_3___default().json(data).substr(0,200)+" status: "+status+" "+status_text+"\nresponseText: "+(response_text||"").substr(0,200));if(retry)return this.return(do_fetch(assign({},opt,{retry:retry-1})));if(err instanceof Error&&err.hola_info)throw err;if(status_text=="timeout")E.events.emit("timeout",this);if(opt.no_throw)return this.return({err,status});err.hola_info={url,method,status};throw err},function(respose_data){let t=Date.now()-t0;_util_zerr_js__WEBPACK_IMPORTED_MODULE_3___default()[t>slow?"err":"debug"]("fetch "+(t>slow?"SLOW ":"ok ")+t+"ms url "+url);if(t>slow&&perr&&!url.includes("client_cgi/perr")){perr({id:"be_ajax_slow",info:`${t}ms ${url}`,rate_limit:{count:1}})}if(opt.full_response){return this.return({data:respose_data,etag:response_etag,status:response_status})}return this.return(respose_data)},function abort(){controller.abort()}])}const __WEBPACK_DEFAULT_EXPORT__=E},2181:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _util_storage_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1032);var _util_storage_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_util_storage_js__WEBPACK_IMPORTED_MODULE_0__);var _util_util_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1291);var _util_util_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_1__);
// LICENSE_CODE ZON
const E={};let status_cb,no_log_for_plus,no_log_for_uid={};let allowed_perrs={be_install:true,be_update:true};let cached=_util_storage_js__WEBPACK_IMPORTED_MODULE_0___default().get_json("no_log")||{};let enabled=cached.enabled;let is_plus=cached.is_plus;let uuid=cached.uuid;const invalidate=()=>{let no_log=!!(uuid&&uuid in no_log_for_uid?no_log_for_uid[uuid]:is_plus&&no_log_for_plus);if(enabled!==no_log){enabled=no_log;if(status_cb)status_cb(enabled)}_util_storage_js__WEBPACK_IMPORTED_MODULE_0___default().set_json("no_log",{enabled,is_plus,uuid})};E.set_plus=_is_plus=>{if(_is_plus===undefined||_is_plus===is_plus)return;is_plus=_is_plus;invalidate()};E.set_config=conf=>{no_log_for_plus=conf.no_log_for_plus;no_log_for_uid=conf.no_log_for_uid||{};allowed_perrs=_util_util_js__WEBPACK_IMPORTED_MODULE_1___default().bool_lookup(conf.no_log_perrs||[]);invalidate()};E.set_uuid=_uuid=>{if(_uuid===undefined||_uuid===uuid)return;uuid=_uuid;invalidate()};E.set_status_cb=cb=>{status_cb=cb;cb(enabled)};E.enabled=perr_id=>enabled&&!(perr_id&&allowed_perrs[perr_id]);const __WEBPACK_DEFAULT_EXPORT__=E},1032:(module,exports,__webpack_require__)=>{"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(6386)],__WEBPACK_AMD_DEFINE_RESULT__=(etask=>{const E={},{chrome}=self;let init_et,inited,data={};const storage_get=arg=>etask.cb_apply(chrome.storage.local,".get",[arg]);const storage_set=arg=>etask.cb_apply(chrome.storage.local,".set",[arg]);const storage_remove=arg=>etask.cb_apply(chrome.storage.local,".remove",[arg]);const storage_clear=()=>etask.cb_apply(chrome.storage.local,".clear",[]);E.init=()=>{if(inited)return;if(init_et)return init_et;chrome.storage.onChanged.addListener(((changes,namespace)=>{if(namespace!="local")return;for(let[key,val]of Object.entries(changes))data[key]=val.newValue}));init_et=etask((function*(){this.finally((()=>{init_et=null;inited=true}));yield migrate();data=(yield storage_get(null))||{}}));return init_et};const migrate=()=>etask((function*(){if(!self.localStorage)return;let current_data=(yield storage_get(null))||{};if(current_data._storage_migrated)return;let keys=Object.keys(localStorage);let migrared_data={};for(let key of keys){if(!(key in current_data))migrared_data[key]=localStorage.getItem(key)}migrared_data._storage_migrated=true;yield storage_set(migrared_data)}));E.on_err=()=>{};E.set=(key,val)=>{if(data[key]==val)return;data[key]=val;return storage_set({[key]:val})};E.get=key=>data[key];E.get_int=key=>+E.get(key)||0;E.clr=key=>{delete data[key];return storage_remove(key)};E.clr_all=()=>{data={};return storage_clear()};E.set_json=(key,val)=>{try{return E.set(key,JSON.stringify(val||null))}catch(e){E.on_err("storage_set_json",key,e)}};E.get_json=key=>{var val=E.get(key);if(!val)return val;try{val=JSON.parse(val)}catch(e){console.log("err "+e)}return val};E.init();return E}).apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},5250:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){const is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(6386),__webpack_require__(5305),__webpack_require__(1291),__webpack_require__(3958),__webpack_require__(9824),__webpack_require__(843),__webpack_require__(1889)],__WEBPACK_AMD_DEFINE_RESULT__=function(etask,zurl,zutil,pcountries,zerr,svc_util,hash){const E={};let conf;E.assert=(exp,err,msg)=>{if(exp)return;zerr("assert failed exp %s err %s msg %s",exp,err,msg);err=err||exp;throw err instanceof Error?err:new Error(err)};E.assert_bg=f=>zerr.assert(E.is_bg(),`file ${f} can only be included in background`);E.assert_ui=f=>zerr.assert(!E.is_bg(),`file ${f} can only be included in ui`);E.new_etask=n=>etask(n,(function*new_etask(){yield this.wait()}));E.set_timeout=(cb,t,opt)=>{opt=opt||{};const name="set_timeout_"+(opt.name||cb.name||"unknown");const sp=etask((function*set_timeout(){this.name=name;yield etask.sleep(t);cb()}));if(opt.sp)opt.sp.spawn(sp);return sp};E.set_interval=(cb,t,opt)=>{opt=opt||{};const name="set_interval_"+(opt.name||cb.name||"unknown");const sp=etask((function*set_interval(){this.name=name;while(true){yield etask.sleep(t);cb()}}));if(opt.sp)opt.sp.spawn(sp);return sp};E.clear_timeout=E.clear_interval=et=>{if(et)et.return()};E.is_all_browser=rule=>rule&&rule.name=="all_browser";E.is_debug_peer=rule=>rule&&rule.name=="debug_peer";E.set_conf=c=>conf=c;E.is_skip_url=url=>{if(!url)return true;const protocol=zurl.get_proto(url),host=zurl.get_host(url);if(zurl.is_ip_port(host)||protocol.search(/^(http|https)$/)==-1||host=="localhost"||!zurl.is_valid_domain(host)){return true}return zurl.is_hola_domain(host)&&!/(access|unblock)\/([^/]*)\/using\/.*/.test(url)};E.is_google=root_url=>root_url&&(root_url.split(".")[0]=="google"||root_url.split(".")[1]=="google");E.is_stub_url=(url,is_premium)=>E.is_skip_url(url)||!is_premium&&E.is_google(svc_util.get_root_url(url));E.is_youtube=root_url=>root_url&&(root_url.split(".")[0]=="youtube"||root_url.split(".")[1]=="youtube");E.get_rules=(_rules,url,ignore)=>{url=url||"";var _r,rules,ret=[],r_enabled=null;if(!_rules||!(rules=_rules.unblocker_rules))return[];for(_r in rules){var r=rules[_r];if(!r.supported)continue;if(!ignore&&r.enabled&&E.is_all_browser(r))return[r];var urls=r.root_url;if(urls&&urls.some((rurl=>{try{return url.match(rurl)}catch(e){}}))){if(r.enabled)r_enabled=r;else ret.push(r)}}if(r_enabled)ret.unshift(r_enabled);return ret};E.get_tld_country=(host,strict_match)=>{if(!host)return"";var tld=zurl.get_top_level_domain(host);if(!tld)return"";tld=tld.toUpperCase();if(!strict_match&&tld=="COM")return"US";if(tld=="UK")tld="GB";var skip_domain=["TV","FM","IO","AM"];if(skip_domain.includes(tld))return"";if(!pcountries.proxy_countries.bext.includes(tld))return"";return tld};E.get_popular_country_old=opt=>{var c0,c1,tld=E.get_tld_country(opt.host);var p={};c0=tld||"US";c1=c0=="US"?"GB":"US";p[c0]={proxy_country:c0,rating:.02};p[c1]={proxy_country:c1,rating:.01};var rule_ratings=opt.rule_ratings||[];rule_ratings.forEach((country_ratings=>{if(country_ratings.rating<.1)return;var country=country_ratings.proxy_country.toUpperCase();var ratings={proxy_country:country,rating:country_ratings.rating};p[country]=ratings}));var popular_array=[];zutil.forEach(p,(r=>{popular_array.push(r)}));popular_array.sort(((a,b)=>a.rating-b.rating>0?-1:1));return popular_array};E.get_popular_country=opt=>{let domain_country=E.get_tld_country(opt.host,true);let popular_obj={};(opt.rule_ratings||[]).forEach((country_ratings=>{if(country_ratings.rating<.1)return;const proxy_country=country_ratings.proxy_country.toUpperCase();popular_obj[proxy_country]={proxy_country,rating:country_ratings.rating}}));if(domain_country){popular_obj[domain_country]={proxy_country:domain_country,rating:1.01};const c1=domain_country=="US"?"GB":"US";if(!popular_obj[c1])popular_obj[c1]={proxy_country:c1,rating:.01}}else{const c0="US",c1="GB";if(!popular_obj[c0]||popular_obj[c0].rating<1)popular_obj[c0]={proxy_country:c0,rating:.99};if(!popular_obj[c1])popular_obj[c1]={proxy_country:c1,rating:.01}}let popular_array=Object.values(popular_obj);popular_array.sort(((a,b)=>a.rating-b.rating>0?-1:1));return popular_array};E.must_verify_email=user=>user&&user.emails&&!user.verified;E.get_rule_min_fmt=rule=>zutil.pick(rule||{},"name","country");E.is_tpopup=()=>{if(E.is_bg())return false;if(E.get_tpopup_mode()=="window")return true;try{return self!=self.top}catch(e){return true}};E.is_bg=()=>location.pathname=="/js/bg.html"||location.pathname=="/js/bg.bg.bundle.js";E.is_new_tab=url=>url=="chrome://newtab/";E.is_browser_internal_url=url=>!!url.match("^(chrome|opera|edge|hola|about):");E.root2url=root_url=>"http://"+root_url+"/";E.get_tpopup_type=()=>zutil.get(self,"hola.tpopup_opt.type");E.get_tpopup_mode=()=>zutil.get(self,"hola.tpopup_opt.mode");E.get_peer_filter_opt=s=>{if(!s)return;let res={},g={};let allowed={country:{match:/[a-z]{2}/,group:1},asn:{match:/\d+(-\d+)*/,group:1},cid:{match:/\w+_\d+\.\d+\.\d+\.\d+_\d+/,group:2},ip:{match:/\d+\.\d+\.\d+\.\d+/,group:3}};s=s.split(",");for(let e of s){let o=e.split(":");if(!allowed[o[0]]||!o[1]||!allowed[o[0]].match.test(o[1]))return;res[o[0]]=o[1];g[allowed[o[0]].group]=true}return Object.keys(g).length==1&&res};E.get_user_name=opt=>{let res="user-uuid-"+opt.uuid+(opt.asnum&&opt.peer_country?"-asnum-"+opt.asnum+"-peer_country-"+opt.peer_country:opt.asnum?"-asnum-"+opt.asnum:opt.cid?"-peer_cid-"+opt.cid:opt.peer_ip?"-peer_ip-"+opt.peer_ip:"");if(opt.is_premium!==undefined)res+="-is_prem-"+(opt.is_premium?"1":"0");return res};E.get_cookies=domain=>etask((function*(){if(!self.chrome||!self.chrome.cookies)return null;return(yield etask.cb_apply(self.chrome.cookies,".getAll",[{domain}]))||[]}));E.get_cookie=(domain,name)=>etask((function*(){if(!self.chrome||!self.chrome.cookies)return null;let res=yield etask.cb_apply(self.chrome.cookies,".get",[{url:`https://${domain}`,name}]);return(res||{}).value}));E.get_hola_cookie=name=>etask((function*(){for(const d of zurl.hola_domains){const cookie=yield E.get_cookie(d,name);if(cookie)return cookie}}));E.get_hola_cookies=names=>etask((function*(){const res={},cookies={};for(const name of names){for(let d of zurl.hola_domains){d="."+d;if(!cookies[d]){cookies[d]={};const _cookies=yield E.get_cookies(d);if(_cookies){for(const c of _cookies)cookies[d][c.name]=c.value}}if(cookies[d]&&cookies[d][name]&&!res[name])res[name]=cookies[d][name]}}return res}));E.get_www_tests=()=>etask((function*(){let ui_testing=yield E.get_hola_cookie("ui_testing");try{ui_testing=JSON.parse(decodeURIComponent(ui_testing))}catch(e){ui_testing={}}const res={};for(let[k,v]of Object.entries(ui_testing)){if(k.endsWith("_conf"))continue;const conf=ui_testing[`${k}_conf`];if(conf&&conf.ext&&conf.on>0&&conf.on<1){res[k]=v;if(conf.name)res[conf.name]=v}}return res}));return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},3958:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1291)],__WEBPACK_AMD_DEFINE_RESULT__=function(zutil){var E={};E.ports_offset=24e3;E.ports={af:{port:0},ax:{port:1},al:{port:2},dz:{port:3},as:{port:4},ad:{port:5},ao:{port:6},ai:{port:7},aq:{port:8},ag:{port:9},ar:{port:10},am:{port:11},aw:{port:12},au:{port:13},at:{port:14},az:{port:15},bs:{port:16},bh:{port:17},bd:{port:18},bb:{port:19},by:{port:20},be:{port:21},bz:{port:22},bj:{port:23},bm:{port:24},bt:{port:25},bo:{port:26},bq:{port:27},ba:{port:28},bw:{port:29},bv:{port:30},br:{port:31},io:{port:32},bn:{port:33},bg:{port:34},bf:{port:35},bi:{port:36},kh:{port:37},cm:{port:38},ca:{port:39},cv:{port:40},ky:{port:41},cf:{port:42},td:{port:43},cl:{port:44},cn:{port:45},cx:{port:46},cc:{port:47},co:{port:48},km:{port:49},cg:{port:50},cd:{port:51},ck:{port:52},cr:{port:53},ci:{port:54},hr:{port:55},cu:{port:56},cw:{port:57},cy:{port:58},cz:{port:59},dk:{port:60},dj:{port:61},dm:{port:62},do:{port:63},ec:{port:64},eg:{port:65},sv:{port:66},gq:{port:67},er:{port:68},ee:{port:69},et:{port:70},fk:{port:71},fo:{port:72},fj:{port:73},fi:{port:74},fr:{port:75},gf:{port:76},pf:{port:77},tf:{port:78},ga:{port:79},gm:{port:80},ge:{port:81},de:{port:82},gh:{port:83},gi:{port:84},gr:{port:85},gl:{port:86},gd:{port:87},gp:{port:88},gu:{port:89},gt:{port:90},gg:{port:91},gn:{port:92},gw:{port:93},gy:{port:94},ht:{port:95},hm:{port:96},va:{port:97},hn:{port:98},hk:{port:99},hu:{port:100},is:{port:101},in:{port:102},id:{port:103},ir:{port:104},iq:{port:105},ie:{port:106},im:{port:107},il:{port:108},it:{port:109},jm:{port:110},jp:{port:111},je:{port:112},jo:{port:113},kz:{port:114},ke:{port:115},ki:{port:116},kp:{port:117},kr:{port:118},kw:{port:119},kg:{port:120},la:{port:121},lv:{port:122},lb:{port:123},ls:{port:124},lr:{port:125},ly:{port:126},li:{port:127},lt:{port:128},lu:{port:129},mo:{port:130},mk:{port:131},mg:{port:132},mw:{port:133},my:{port:134},mv:{port:135},ml:{port:136},mt:{port:137},mh:{port:138},mq:{port:139},mr:{port:140},mu:{port:141},yt:{port:142},mx:{port:143},fm:{port:144},md:{port:145},mc:{port:146},mn:{port:147},me:{port:148},ms:{port:149},ma:{port:150},mz:{port:151},mm:{port:152},na:{port:153},nr:{port:154},np:{port:155},nl:{port:156},nc:{port:157},nz:{port:158},ni:{port:159},ne:{port:160},ng:{port:161},nu:{port:162},nf:{port:163},mp:{port:164},no:{port:165},om:{port:166},pk:{port:167},pw:{port:168},ps:{port:169},pa:{port:170},pg:{port:171},py:{port:172},pe:{port:173},ph:{port:174},pn:{port:175},pl:{port:176},pt:{port:177},pr:{port:178},qa:{port:179},re:{port:180},ro:{port:181},ru:{port:182},rw:{port:183},bl:{port:184},sh:{port:185},kn:{port:186},lc:{port:187},mf:{port:188},pm:{port:189},vc:{port:190},ws:{port:191},sm:{port:192},st:{port:193},sa:{port:194},sn:{port:195},rs:{port:196},sc:{port:197},sl:{port:198},sg:{port:199},sx:{port:200},sk:{port:201},si:{port:202},sb:{port:203},so:{port:204},za:{port:205},gs:{port:206},ss:{port:207},es:{port:208},lk:{port:209},sd:{port:210},sr:{port:211},sj:{port:212},sz:{port:213},se:{port:214},ch:{port:215},sy:{port:216},tw:{port:217},tj:{port:218},tz:{port:219},th:{port:220},tl:{port:221},tg:{port:222},tk:{port:223},to:{port:224},tt:{port:225},tn:{port:226},tr:{port:227},tm:{port:228},tc:{port:229},tv:{port:230},ug:{port:231},ua:{port:232},ae:{port:233},gb:{port:234},us:{port:235},um:{port:236},uy:{port:237},uz:{port:238},vu:{port:239},ve:{port:240},vn:{port:241},vg:{port:242},vi:{port:243},wf:{port:244},eh:{port:245},ye:{port:246},zm:{port:247},zw:{port:248}};E.init=function(){var pc=E.proxy_countries={bext:[]};for(var key in E.ports)pc.bext.push(key.toUpperCase());var no_flag=zutil.bool_lookup("AX BL BQ BV IO CX CC CW FK "+"GF TF HM YT NU NF MP PN SH MF PM "+"SX GS SS SJ TK UM WF ZW GP RE AQ");E.proxy_countries.bext=E.proxy_countries.bext.filter((function(c){return!no_flag[c]}))};E.init();return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},6467:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){let is_node=typeof module=="object"&&module.exports;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(932),__webpack_require__(2569),__webpack_require__(1291)],__WEBPACK_AMD_DEFINE_RESULT__=((date,zcountry,zutil)=>{const E={t:{}};const{ms}=date;E.desktop_gateways=["paypal","paymill","avangate","bluesnap","paypal2","coupon","stripe"];E.mobile_gateways=["android","apple"];E.gateways=E.desktop_gateways.concat(E.mobile_gateways);E.grace=1;E.periods=["1 D","1 W","1 M","3 M","6 M","1 Y","2 Y","3 Y"];E.period_unit_to_ms={D:ms.DAY,W:7*ms.DAY,M:ms.MONTH,Y:ms.YEAR};E.period_unit_names={D:"day",W:"week",M:"month",Y:"year"};E.type2name={plus:"premium",ultra:"ultra"};E.get_country_code=membership=>{if(!membership)return;const country_name=membership.geo_country||membership.country;return zcountry.mixed2code(country_name)||country_name};E.get_gateways=type=>{if(!type)return[];switch(type){case"desktop":return E.desktop_gateways;case"mobile":return E.mobile_gateways;case"paypal":return["paypal","paypal2"]}return E.gateways.includes(type)?[type]:[]};E.get_period_ms=period=>{const{count,unit}=E.parse_period(period)||{};return count*E.period_unit_to_ms[unit]};E.get_offsets=d=>{const offsets={};for(const p of E.periods)offsets[p]=E.offset_by_period(d,p,-1);return offsets};E.offset_by_period=(d,period,factor=1)=>{d=date(d,true);const{count,unit}=E.parse_period(period)||{};switch(unit){case"D":d.setUTCDate(d.getUTCDate()+count*factor);return d;case"W":d.setUTCDate(d.getUTCDate()+7*count*factor);return d;case"M":{const day=d.getUTCDate();d.setUTCMonth(d.getUTCMonth()+count*factor);if(d.getUTCDate()!=day)d.setUTCDate(0);return d}case"Y":d.setUTCFullYear(d.getUTCFullYear()+count*factor);return d}};const get_end_by_period=(m,opt)=>{opt=opt||{};const test_iap=m.test&&is_app_store_iap(m);let end=m.period&&!test_iap?E.offset_by_period(opt.start||m.start,m.period):m.end||m.trial_end||m.grace_end;if(!end){throw new Error("Unexpected period: "+m.period+" ("+JSON.stringify(m)+")")}end=date(end);if(!opt.disable_grace){if(test_iap)end.setUTCMinutes(end.getUTCMinutes()+E.grace);else end.setUTCDate(end.getUTCDate()+E.grace)}return end};E.get_length_by_period=period=>{const start=Date.now();return get_end_by_period({period},{start})-start};E.get_dur=m=>get_end_by_period(m,{disable_grace:true})-date(m.start);E.get_end_by_period=get_end_by_period;E.get_end_date=m=>{const ends=[];if(m&&m.trial_end)ends.push(date(m.trial_end));if(m&&m.grace_end)ends.push(date(m.grace_end));if(m&&m.end)ends.push(date(m.end));if(m&&m.start&&m.period&&(!m.cancelled||!m.end)&&!E.is_trial(m)){const _end=get_end_by_period(m);if(_end)ends.push(_end)}if(!ends.length)return null;const res=date(Math.max.apply(null,ends));return res};E.is_active=m=>{const now=Date.now();if(!m)return false;if(m.trial_end&&now<=date(m.trial_end))return true;if(m.grace_end&&now<=date(m.grace_end))return true;if(m.end&&now<=date(m.end))return true;if(m.start&&m.period&&now<=get_end_by_period(m)&&!E.is_trial(m))return!m.cancelled||!m.end;return false};E.is_ultra=m=>E.is_active(m)&&m&&m.type=="ultra";E.is_lifetime=m=>m&&m.period=="100 Y";E.is_in_trial=m=>E.is_trial(m)&&Date.now()<date(m.trial_end||m.end);E.is_trial=(m,type)=>!!(m&&(m.trial_end&&(!type||type==(m.type||"start"))||m.plan=="trial"&&m.end));E.is_in_grace=m=>E.is_grace(m)&&Date.now()<date(m.grace_end);E.is_grace=(m,type)=>!!m&&!!m.grace_end&&(!type||type==(m.type||"start"));E.is_manual=m=>!!m&&m.plan=="manual";E.had_premium=history=>!!history&&history.some((m=>!E.is_trial(m)));E.had_trial=(history,type)=>!!history&&history.some((h=>E.is_trial(h,type)));E.had_grace=(history,type)=>!!history&&history.some((h=>E.is_grace(h,type)));E.trial_forbidden=(m,history,type)=>{if(E.is_in_trial(m))return"trial exists";if(E.is_trial(m,type))return"trial expired";if(E.is_active(m))return"already premium";if(E.had_premium(history))return"had premium";if(E.had_trial(history,type))return"had trial";return false};E.grace_period_forbidden=(m,history,type)=>{if(E.is_in_grace(m))return"grace exists";if(E.is_grace(m,type))return"grace expired";if(E.is_active(m))return"already premium";if(E.had_grace(history,type))return"had grace";return false};E.is_paid=m=>!!m&&!!m.gateway;E.is_paid_amount=m=>E.is_paid(m)&&(m.amount||m.amount_usd);E.is_expired=m=>{const end_date=E.get_end_date(m);return!!end_date&&Date.now()>end_date};E.classify=m=>{if(E.is_active(m))return E.is_in_trial(m)?"trial":"premium";if(E.is_expired(m))return E.is_trial(m)?"trial_expired":"premium_expired";return"free"};E.gen_email_hash=(email,md5)=>md5("hola unsubscribe "+email).substr(0,8);E.fmt_date=(d,fmt)=>d?date.strftime(fmt||"%o %B %Y",date(d)):"-";E.is_ios=m=>m.gateway=="apple"||m.product=="ios";E.is_mobile=m=>E.is_ios(m)||!!m.gateway&&!E.desktop_gateways.includes(m.gateway);E.is_desktop=m=>E.desktop_gateways.includes(m.gateway);E.get_plan_short_name=period=>{const{count,unit}=E.parse_period(period)||{};const period_name=E.period_unit_names[unit];let short_name={"1 D":"Daily","1 W":"Weekly","1 M":"Monthly","1 Y":"Yearly"}[period];if(!short_name){short_name=count+" "+period_name[0].toUpperCase()+period_name.substr(1);if(count>1)short_name+="s"}return short_name};E.get_period_with_price=m=>{if(m.plan=="signup_bonus")return"Signup bonus";if(m.period=="100 Y")return"Lifetime";const{count,unit}=E.parse_period(m.period)||{};if(m.gateway=="coupon"&&count)return count+"-"+E.period_unit_names[unit];const end=E.get_end_date(m);if(m.cancelled)return"Till "+E.fmt_date(end);const show_price=name=>{if(!m.amount)return name;const price=m.amount;const currency=m.currency;const vat=m.vat;const p=+(price/count).toFixed(2);const price_string=zcountry.format_price(currency,p);return name+", "+price_string+"/"+E.period_unit_names[unit]+(vat&&vat.percent?" (includes VAT "+vat.percent+"% "+zcountry.format_price(currency,vat.amount)+")":"")};switch(unit){case"W":if(count==1)return show_price("Weekly");return show_price(count+"-week");case"M":if(count==1)return show_price("Monthly");if(count==6)return show_price("Half-yearly");return show_price(count+"-month");case"Y":if(count==1)return show_price("Yearly");return show_price(count+"-year");case"D":return show_price(count+"-day")}if(!m.end)return m.grace_end?"updating":"-";return(m.gateway?"Till ":"Manual till ")+E.fmt_date(end)};E.get_per=(period,full)=>{const{count,unit}=E.parse_period(period)||{};const name=E.period_unit_names[unit];return count==1?(full?count+" ":"")+name:count+" "+name+"s"};E.sum_period=(p1,p2)=>{const{count:c1,unit:u1}=E.parse_period(p1)||{};const{count:c2,unit:u2}=E.parse_period(p2)||{};if(u1==u2)return`${c1+c2} ${u1}`;let c_min,c_max,u_min,u_max;const ums=E.period_unit_to_ms;if(ums[u1]>ums[u2]){c_max=c1;u_max=u1;c_min=c2;u_min=u2}else{c_max=c2;u_max=u2;c_min=c1;u_min=u1}if(u_min=="D")return c_min+c_max*ums[u_max]/ums.D+" D";if(u_min=="W")return c_min*7+c_max*ums[u_max]/ums.D+" D";if(u_min=="M")return c_min+c_max*12+" M"};E.period_start_str=m=>E.fmt_date(m.start);E.period_end_str=(m,fmt)=>{if(E.is_in_trial(m))return"Trial valid until "+E.fmt_date(m.trial_end);if(m.next_renewal_date)return E.fmt_date(m.next_renewal_date);if(m.cancelled||!m.period)return m.grace_end?"updating":"-";return E.fmt_date(m.end||E.offset_by_period(m.start,m.period),fmt)};E.is_unassoc_trial=m=>E.is_trial(m)&&E.is_ios(m);E.is_bonus=m=>m&&m.plan=="signup_bonus";E.payment_label=m=>{if(E.is_unassoc_trial(m)||E.is_bonus(m))return"-";switch(m.gateway){case"paypal":case"paypal2":return"PayPal";case"coupon":return"Coupon";case"paymill":return"Credit card ************"+(((m.paymill|{}).payment||{}).last4||"****");case"avangate":case"stripe":case"bluesnap":return"Credit card";case"apple":return"App Store";case"android":return"Google Play";default:return m.grace_end?"updating":m.plan=="manual"?"Other":"Google Play"}};E.gateway_id_path=gateway=>{switch(gateway){case"paypal":case"paypal2":return"paypal.subscr_id";case"coupon":return"coupon.code";case"bluesnap":return"bluesnap.subscr_id";case"stripe":return"stripe.subscr_id";case"apple":return"apple_ios.original_transaction_id";case"android":return"google_apk.purchase_token";case"avangate":return"avangate.subscr_ref";case"paymill":return"paymill.subscription_id";case"adyen":return"adyen.reference"}};E.get_paypal_id=m=>zutil.get(m,"paypal.subscr_id")||zutil.get(m,"paypal2.subscr_id")||zutil.get(m,"paypal.txn_id");E.parse_id=(subscr_id,gateway)=>{if(gateway=="bluesnap"&&subscr_id)return+subscr_id;return subscr_id};E.get_id=(m,gateway)=>{if(!m)return;if(m&&m.plan=="manual")return+date(m.start);gateway=gateway||m.gateway;switch(gateway){case"paypal":case"paypal2":return E.get_paypal_id(m);case"bluesnap_gpay":case"bluesnap_apm":case"bluesnap_applepay":case"bluesnap":return m.bluesnap&&(m.bluesnap.subscr_id||m.bluesnap.ref);case"apple":return zutil.get(m,"apple_ios.original_transaction_id")||zutil.get(m,"apple_ios.transaction_id");case"coupon":case"android":case"avangate":case"stripe":case"paymill":case"adyen":return zutil.get(m,E.gateway_id_path(gateway))}};E.get_gateway_name=(m,gateway)=>{gateway=gateway||m&&m.gateway;switch(gateway){case"bluesnap":if(zutil.get(m,"bluesnap.gpay"))gateway="bluesnap_gpay";else if(zutil.get(m,"bluesnap.applepay"))gateway="bluesnap_applepay";else if(!zutil.get(m,"bluesnap.subscr_id")&&zutil.get(m,"bluesnap.ref")){gateway="bluesnap_apm"}break;case"paypal":case"paypal2":gateway="paypal";break;case"avangate":case"stripe":case"apple":case"android":case"coupon":case"paymill":case"bluesnap_gpay":case"bluesnap_apm":case"bluesnap_applepay":case"adyen":break;default:if(m&&m.plan=="trial")gateway="trial";else if(m&&m.plan=="grace")gateway="grace";else if(m&&m.plan=="manual")gateway="manual";else gateway="unknown"}return gateway};E.get_full_id=(m,gateway,id)=>{id=id||E.get_id(m);if(!id)return;return E.get_gateway_name(m,gateway)+"-"+id};E.is_cancellable_mobile=m=>E.is_mobile(m)&&!E.is_unassoc_trial(m)&&(m.cancelled||m.cancellation_reason);E.is_cancellable=m=>!m.cancelled&&!E.is_cancellable_mobile(m)&&!E.is_unassoc_trial(m)&&!m.grace_end&&!E.is_bonus(m);E.get_plan_currency=(plan,currency)=>{if(!currency||!plan)return"USD";currency=currency.toUpperCase();if(currency=="USD")return"USD";if(!plan.currency||!plan.currency[currency.toLowerCase()])return"USD";return currency};E.get_price_plan=(plan,currency)=>{currency=(""+currency).toLowerCase();return currency=="usd"||!plan.currency||!plan.currency[currency]?plan:plan.currency[currency]};E.is_better=(m1,m2)=>{if(!m1)return false;if(!m2)return true;if(m1.type=="ultra"&&m2.type!="ultra")return true;if(m2.type=="ultra"&&m1.type!="ultra")return false;if(!m1.period&&m1.plan!="manual"&&m2.period)return false;if(!m2.period&&m2.plan!="manual"&&m1.period)return true;const start=Date.now();const end1=get_end_by_period(m1,{start,disable_grace:true});const end2=get_end_by_period(m2,{start,disable_grace:true});return end1>end2};E.is_more_actual=(m1,m2)=>{if(!m1)return false;if(!m2)return true;if(!m1.period&&m1.plan!="manual")return false;if(!m2.period&&m2.plan!="manual")return true;const end1=E.get_end_date(m1);const end2=E.get_end_date(m2);return end1>end2};E.find_last=(m,history,subscr_id)=>{if(m&&E.get_id(m)==subscr_id)return{m};if(!Array.isArray(history))return{};for(let i=history.length-1;i>=0;i--){if(E.get_id(history[i])==subscr_id)return{m:history[i],index:i}}return{}};const is_app_store_iap=m=>(zutil.get(m,"apple_ios.bundle_id")||"").startsWith("org.hola.hola");E.t.get_exp_date_by_gateway=(m,gateway)=>{gateway=gateway||m.gateway;switch(gateway){case"bluesnap":return zutil.get(m,"bluesnap.exp_date");case"stripe":return zutil.get(m,"stripe.exp_date");case"android":return zutil.get(m,"google_apk.expiry")}if(E.is_ios(m))return is_app_store_iap(m)&&m.test?m.end:undefined};const get_seq_id_by_exp=(exp,m)=>{const period=m.period.split(" ");if(is_app_store_iap(m)&&m.test)return+date.align(exp,"MIN");const align={D:"DAY",W:"WEEK",M:"MONTH",Y:"YEAR"}[period[1]];return+date.align(exp,align)};const get_seq_data=m=>{if(!m||!m.period)return;const exp_date=E.t.get_exp_date_by_gateway(m);let exp=date(exp_date||E.offset_by_period(m.start,m.period));if(m.end&&date(m.end)>exp)exp=date(m.end);return{seq_id:get_seq_id_by_exp(exp,m),exp,persistent:m.persistent||!!exp_date}};E.get_seq_id=m=>{const res=get_seq_data(m);return res&&res.seq_id};E.make_seqs=memberships=>{const ids=new Set;for(const m of memberships){const id=E.get_id(m);if(id)ids.add(id)}const res={};for(const id of ids)res[id]=E.make_seq(memberships,id);return res};E.make_seq=(memberships,subscr_id)=>{const list=[];for(const m of memberships){if(!E.is_paid_amount(m)||{trial:1,grace:1}[m.plan])continue;if(subscr_id&&E.get_id(m)!=subscr_id)continue;list.push(m)}list.sort(((m1,m2)=>{if(date(m1.start)<date(m2.start))return-1;if(date(m1.start)>date(m2.start))return 1;return 0}));let seq=[];for(let i=0;i<list.length;i++){const m=list[i];const start=date(m.start);let{seq_id,exp,persistent}=get_seq_data(m)||{};const last=seq[seq.length-1];if(last&&!(start-date(last.m.start))){if(persistent&&!last.persistent)seq[seq.length-1]={m,seq_id,exp,persistent};seq[seq.length-1].duplicate=true;continue}const end=m.end&&date(m.end);if(last&&end&&start<end&&end<last.exp){last.duplicate=true;continue}const next_seq_id=last&&+E.offset_by_period(last.seq_id,m.period);if(next_seq_id&&seq_id>next_seq_id&&seq_id<=+E.offset_by_period(next_seq_id,m.period)){exp=E.offset_by_period(last.exp,m.period);seq_id=next_seq_id}if(last&&last.seq_id>=seq_id){if(last.seq_id==seq_id&&(!persistent||persistent&&last.persistent)){last.duplicate=true;continue}const new_seq=[{m,seq_id,exp,persistent}];for(let j=seq.length-1;j>=0;j--){const item=seq[j];if(!item.persistent){item.exp=E.offset_by_period(new_seq[0].exp,m.period,-1);item.seq_id=get_seq_id_by_exp(item.exp,m)}if(item.seq_id>=new_seq[0].seq_id||item.exp<date(item.m.start)){if(item.persistent)new_seq[0]=item;new_seq[0].duplicate=true;continue}new_seq.unshift(item)}seq=new_seq;continue}seq.push({m,seq_id,exp,persistent})}return seq};const omit_meta=o=>!o?null:zutil.omit(o,["actual_from","actual_to","update_res","reported","amount_usd","payment_intent_id","is_new","pending_emails"]);E.parse_period=period=>{const m=(""+period).match(/^(\d+)\s?([dwmy])$/i);if(!m)return;return{count:+m[1],unit:m[2].toUpperCase()}};E.is_duplicate=(m1,m2)=>{let omitted_m1=omit_meta(m1);let omitted_m2=omit_meta(m2);if(m1&&m2&&Math.abs(m2.start-m1.start<date.ms.DAY)){omitted_m1=zutil.omit(omitted_m1,["start"]);omitted_m2=zutil.omit(omitted_m2,["start"])}if(m1&&m2&&Math.abs(m2.end-m1.end)<date.ms.DAY){omitted_m1=zutil.omit(omitted_m1,["end"]);omitted_m2=zutil.omit(omitted_m2,["end"])}return zutil.equal_deep(omitted_m1,omitted_m2)};return E}).apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},764:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){var is_node=typeof module=="object"&&module.exports;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(6449),__webpack_require__(1291),__webpack_require__(6386),__webpack_require__(1291),__webpack_require__(901),__webpack_require__(1032)],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,etask,zutil,user_agent,storage){var assign=Object.assign;var port_no_load_from_storage=1;function port_get(){var is_dev;try{is_dev=storage.get_json("hola_opts").developer_mode}catch(err){}if(port_no_load_from_storage||is_dev)return;try{return storage.get_int("svc_ipc_port")}catch(err){}}function port_set(port,up,info){if(up)return void(E.up_port=port||undefined);if(!port){try{storage.clr("svc_ipc_port")}catch(err){}delete E.svc_port;return}try{storage.set("svc_ipc_port",port)}catch(err){}E.svc_port=port;E.svc_has_ssl=port&&info&&info.ssl}var ua=user_agent.guess_browser();var is_ie=ua.browser=="ie";var is_firefox=ua.browser=="firefox";var E={svc_ports:[6880,6881,6882,6883,6884,6885,6886,6887,6888,6889],up_ports:[6890,6891,6892,6893,6894,6895,6896,6897,6898,6899]};E.svc_port=port_get();E.svc_has_ssl=false;E.up_port=undefined;E.load_port_from_storage=function(){port_no_load_from_storage=0;E.svc_port=port_get()};function Eport(up){return up?E.up_port:E.svc_port}function Eports(up){return up?E.up_ports:E.svc_ports}function get_url(cmd,opt){opt=opt||{};var https=location.protocol=="https:"&&opt.https;return(https?"https://localhost.h-local.org":"http://127.0.0.1")+":"+(opt.port||Eport(opt.up))+"/"+cmd}function exe2order(e){if(e.os_ver=="NaCl")return 1;if(/^hola_updater/.test(e.exe))return 1;if(/^hola_svc/.test(e.exe))return 2;if(/^hola_plugin/.test(e.exe))return 3;return 0}function cache_str_fn2(fn){var cache={};return function(s1,s2){var cache2=cache[s1]=cache[s1]||{};if(s2 in cache2)return cache2[s2];return cache2[s2]=fn(s1,s2)}}var version_cmp=cache_str_fn2((function(v1,v2){if(!v1||!v2)return+!!v1-+!!v2;var _v1=v1.split("."),_v2=v2.split("."),i;for(i=0;i<_v1.length&&i<_v2.length&&+_v1[i]==+_v2[i];i++);if(_v1.length==i||_v2.length==i)return _v1.length-_v2.length;return+_v1[i]-+_v2[i]}));var sp_find_port;var disabled_mode=false;try{disabled_mode=storage.get("svc_ipc_enabled")?false:storage.get("svc_ipc_disabled")?true:user_agent.guess().os=="linux"}catch(e){}E.find_port=function(up,appid){var opt={dataType:"json",cache:false,no_throw:1,timeout:is_ie||is_firefox?2e3:500};var q=[];if(disabled_mode)return 0;return etask({cancel:true},[function(){if(sp_find_port)return this.loop(sp_find_port);sp_find_port=this},function try_catch$(){if(Eport(up))return this.return(Eport(up))},function try_catch$(){var _this=this;_.each(Eports(up),(function(port){var sp;_this.spawn(sp=post(get_url("callback.json?find_port=1",{port,up}),opt));sp.data=sp.data?sp.data:{};sp.data.port=port;q.push(sp)}));return etask.all(q)},function(arr){var best,port;_.each(arr,(function(e,i){if(!e.ret||e.ret.error)return;if(appid&&(appid.test?!appid.test(e.ret.appid):appid!=e.ret.appid)){return}if(!best){best=e;port=q[i].data.port;return}var e_order=exe2order(e.ret);var best_order=exe2order(best.ret);if(e_order<best_order||e_order==best_order&&version_cmp(e.ret.ver,best.ret.ver)<=0){return}best=e;port=q[i].data.port}));port_set(port,up,best&&best.ret);if(!best)return this.wait(1e3);return this.return(port)},function finally$(){if(this==sp_find_port)sp_find_port=null}])};E.init=function(port){return etask([function(){if(port){port_set(port);return port}return E.find_port()},function(port){if(!port)return-1;return 0}])};function post(url,opt){opt=opt||{};if(typeof url==="object")opt=url;else if(typeof url==="string"){opt=zutil.clone(opt);opt.url=url}var xhr;if(!$.ajax){var response,t,controller;return etask([function(){if((storage.get_json("hola_opts")||{}).no_svc)throw"svc detection disabled";controller=new self.AbortController;if(opt.timeout)t=setTimeout((()=>controller.abort("timeout")),opt.timeout);return fetch(opt.url,{method:"POST",signal:controller.signal})},function catch$(err){clearTimeout(t);var error=err+"";if(opt.no_throw){return this.return({xhr:{statusText:error},ret:{error}})}throw new Error(error)},function(res){clearTimeout(t);response=res;if(this.error)return this.throw(this.error);if(!res.ok)return this.throw(res.statusText);return res.json()},function(data){return{xhr:{statusText:response.statusText},ret:data}}])}return etask([function(){if((storage.get_json("hola_opts")||{}).no_svc)throw"svc detection disabled";return xhr=$.ajax(assign({method:"POST"},opt))},function catch$(err){var error=(xhr||{}).statusText||"no_status";if(opt.no_throw)return this.return({xhr,ret:{error}});throw new Error(error)},function(ret){if(this.error)return this.throw(this.error);return{xhr,ret}}])}E.ajax=function(_opt){var cmd,timeout=500,up,appid;var opt={dataType:"json",cache:false,no_throw:1};if(typeof _opt=="string")cmd=_opt;else if(typeof _opt=="object"){cmd=_opt.cmd;opt.data=_opt.data;if(_opt.method)opt.method=_opt.method;timeout=_opt.timeout||timeout;up=_opt.up;appid=_opt.appid}var tested;if(timeout>-1)opt.timeout=timeout;return etask([function try_catch$ajax(){if(Eport(up))return post(get_url(cmd,{up}),opt);return this.goto("find_port")},function(res){var error=res?res.ret&&res.ret.error:"empty res";if(error&&tested)throw new Error(error);if(error){port_set(0);return this.goto("find_port")}return this.return(res)},function try_catch$find_port(){return E.find_port(up,appid)},function(port){if(!port)throw new Error("none_found");tested=1;return this.goto("ajax")}])};E.ext={};function test_img(links){return etask([function(){var _this=this,errs=0;_.each(links,(function(e,i){$("<img>").load(function(){this.return()}.bind(_this)).error(function(){errs++;if(errs==links.length)this.throw("ext not found")}.bind(_this)).attr("src",e+"?rc="+Date.now())}));return this.wait(1e3)}])}E.ext.lean_ping=function(){if(!window.chrome){return test_img(["resource://ff_ext-at-hola-dot-org/"+"hola_firefox_ext/data/img/logo.png","resource://jid1-4p0kohsjxu1qgg-at-jetpack/"+"hola_firefox_ext/data/img/logo.png","resource://jid1-4p0kohsjxu1qgg-at-jetpack/icon.png"])}var old="chrome-extension://gkojfkhlekighikafcpjkiklfbnlmeio/icon.png";var _new="chrome-extension://mhcmfkkjmkcfgelgdpndepmimbmkbpfp/icon.png";return etask({name:"lean_check_ext"},[function(){return etask.all({allow_fail:true},{old:test_img([old]),_new:test_img([_new])})},function(e){if(etask.is_err(e.old)&&etask.is_err(e._new))throw e._new.error}])};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},9946:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){var is_node=typeof module=="object"&&module.exports;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(9824),__webpack_require__(6386),__webpack_require__(1291),__webpack_require__(932),__webpack_require__(5678),__webpack_require__(8425),__webpack_require__(5317),__webpack_require__(4336),__webpack_require__(764),__webpack_require__(6262)],__WEBPACK_AMD_DEFINE_RESULT__=function(zerr,etask,zutil,date,zws,zevents,rate_limit,zescape,svc_ipc,version_util){const E={},assign=Object.assign,noop=()=>{};class State_machine{constructor(){}start(opt){if(this.et)return;this.rl_ctx={};this.target=opt.updater?"updater":"svc";this.events=new zevents.EventEmitter;this.events.on("data",(data=>{if(zutil.equal_deep(this.svc_info,data))return;this.svc_info=data;if(data)this.last_svc_info=data;if(opt.watch)opt.watch(data)}));this.events.on("datapart",(part=>this.events.emit("data",assign({},this.last_svc_info,part))));this.opt=assign({components:["client"]},opt,{log:this.proxy_log(opt.log),perr:this.proxy_perr(opt.perr),events:this.events,target:this.target});this.state={name:"polling",opt:assign({startup:true},this.opt)};this.states={polling:this.state_polling,listening:this.state_listening};this.opt.log(`starting ${this.target} detection`);this.et=etask({cancel:true,state0_args:[this]},(function*(_this){this.on("uncaught",(e=>_this.opt.log("exception in main etask:"+zerr.e2s(e))));while(true){let r=yield _this.states[_this.state.name](_this.state.opt);if(!_this.events||!r)break;_this.state=_this.change_state(r)}}));return this.et}stop(){if(!this.et)return;this.opt.log(`${this.target} detection shutdown`);this.state.opt.shutdown=true;this.et.return();if(this.ri_et)this.ri_et.return();this.events.removeAllListeners();this.et=this.events=this.opt=this.state=this.rl_ctx=this.svc_info=this.last_svc_info=undefined}proxy_log(fn){fn=fn||noop;this.log_tail=[];return str=>{this.log_tail.push(str);this.log_tail.splice(0,this.log_tail.length-100);return fn(str)}}proxy_perr(fn){fn=fn||noop;return(id,info)=>{info=assign({log_tail:this.log_tail.join("\n")},info);return fn(id,info)}}reconf(opt){if(!this.et)return;let changes=zutil.pick(opt,"monitoring_interval","detecting_interval","state_toggle_rl_n","state_toggle_rl_sec");if(!Object.keys(changes).find((k=>changes[k]!=this.opt[k])))return;assign(this.opt,changes);assign(this.state.opt,changes);setTimeout((()=>this.events&&this.events.emit("wakeup")),0)}change_state(res){if(this.state.name=="listening"&&res.next=="polling"){let rl_n=this.opt.state_toggle_rl_n||5;let rl_ms=(this.opt.state_toggle_rl_sec||60)*date.ms.SEC;if(!rate_limit(this.rl_ctx,rl_ms,rl_n)){this.opt.log("reconnect loop detected, disabling ws");this.opt.perr("svc_monitor_reconnect_loop");assign(res,{next:"polling",ignore_ws:true})}}this.opt.log(`changing state to ${res.next}`);this.opt.perr("svc_monitor_changeto_"+res.next);return{name:res.next,opt:zutil.omit(res,"next")}}state_polling(opt){return etask({cancel:true},(function*state_polling(){if(!opt||!opt.components)return;this.on("uncaught",(e=>{opt.log("exception in polling state: "+zerr.e2s(e));opt.perr("svc_monitor_etask_err",{err:zerr.e2s(e),source:"state_polling"})}));let data,waiting_sec,fail_count=0;let qs=opt.components.includes("vpn")?"?vpn=1":"";let on_wakeup=()=>waiting_sec&&this.continue();opt.events.on("wakeup",on_wakeup);this.finally((()=>opt.events.off("wakeup",on_wakeup)));while(true){try{data=(yield svc_ipc.ajax({cmd:"callback.json"+qs,appid:opt.appid,up:opt.updater})).ret}catch(e){data=undefined}if(data&&!opt.is_connected||!data&&opt.is_connected){opt.startup=false;opt.is_connected=!!data;opt.log(`${opt.target} ${data?"found":"disappeared"}`)}if(data){opt.events.emit("data",data);if(!opt.ignore_ws&&data.ws_port)break}else{fail_count++;opt.events.emit("data",undefined)}let is_start=opt.startup&&opt.detecting_start_retries&&fail_count<opt.detecting_start_retries;waiting_sec=opt.is_connected?opt.monitoring_interval:is_start?opt.detecting_start_interval:opt.detecting_interval;opt.events.emit("sleep");try{yield this.wait(waiting_sec*date.ms.SEC)}catch(e){}waiting_sec=0}opt.log(`detected ws server on port ${data.ws_port}, switching to `+`listening mode`);return assign(opt,{next:"listening",ws_port:data.ws_port,svc_ver:data.ver})}))}state_listening(opt){return etask({cancel:true},(function*state_listening(){let client,_this=this;this.on("uncaught",(e=>{opt.log("exception in listening state: "+zerr.e2s(e));opt.perr("svc_monitor_etask_err",{err:zerr.e2s(e),source:"state_listening"})}));this.finally((()=>client&&client.close()));let ws_url=version_util.cmp(opt.svc_ver,"1.155.300")<=0?`wss://localhost.h-local.org:${opt.ws_port}`:`ws://127.0.0.1:${opt.ws_port}`;let ipc_client={vpn_connect:"post",vpn_disconnect:"post",vpn_change_agent:"post",vpn_open_link:"post",vpn_status:"call",push_subscribe:"call",request_upgrade:"call",dev_set:"post"};if(false){}client=opt.client=new zws.Client(ws_url,{ipc_client,ipc_server:{push_notify:msg=>{opt.log(msg.init?"received initial status update":"received status update"+((msg.changed||[]).length?" for "+msg.changed.join(","):""));opt.log(JSON.stringify(msg.data));opt.events.emit("datapart",msg.data)}},mux:true});opt.log(`connecting to ${ws_url}`);client.on("connected",(()=>etask((function*on_connected(){opt.log(`connected to ${ws_url}`);let sub_res={},sub_opt={components:opt.components};try{sub_res=yield client.ipc.push_subscribe(sub_opt)}catch(e){}if(sub_res.status!="success"){opt.log("failed to subscribe for push notifications, "+"switching back to polling mode");opt.perr("svc_monitor_subscribe_failed",{ret:sub_res});return _this.continue({next:"polling",ignore_ws:true})}opt.log(`${opt.target} push notifications enabled`);opt.ws_client=client;if(opt.on_ws_connected)opt.on_ws_connected()}))));client.on("disconnected",(()=>{opt.ws_client=null;if(opt.on_ws_disconnected)opt.on_ws_disconnected();if(opt.shutdown)return;opt.log(`disconnected from ${ws_url}, switching to polling mode`);this.continue({next:"polling"})}));return assign(opt,yield this.wait())}))}exec(cmd,params,opt){if(!this.et)return;return etask({state0_args:[this]},(function*exec(_this){if(cmd=="callback"){let data=yield _this.refresh_info();return data?{ret:data}:undefined}let ws_client;if((ws_client=_this.state.opt.ws_client)&&ws_client.ipc[cmd]&&!_this.opt.prefer_http_exec){try{return{ret:yield ws_client.ipc[cmd](params)}}catch(e){_this.opt.perr("svc_monitor_ws_err",{err:zerr.e2s(e),cmd})}}params=params?`?${zescape.qs(params)}`:"";return svc_ipc.ajax(assign({cmd:`${cmd}.json${params}`,appid:_this.opt.appid},opt))}))}get(cmd,params){return this.exec(cmd,params,{method:"GET"})}get_info(){return this.svc_info}get_last_info(){return this.last_svc_info}refresh_info(){if(!this.et)return;if(this.state.name=="listening")return this.get_info();let _this=this;return this.ri_et=etask({cancel:true},(function*refresh_info(){this.finally((()=>_this.ri_et=undefined));if(_this.ri_et)return yield this.wait_ext(_this.ri_et);this.on("uncaught",(e=>{if(!_this.opt)return;_this.opt.log("refresh_info exception: "+zerr.e2s(e));_this.opt.perr("svc_monitor_etask_err",{err:zerr.e2s(e),source:"refresh_info"})}));let continue_fn=()=>this.continue();_this.events.on("data",continue_fn);_this.events.on("sleep",continue_fn);setTimeout((()=>_this.events&&_this.events.emit("wakeup")),0);yield this.wait(60*date.ms.SEC);if(!_this.events)return;_this.events.off("data",continue_fn);_this.events.off("sleep",continue_fn);return _this.get_info()}))}has_capability(name,def){let info=this.get_last_info();if(!info)return def;return!!zutil.get(info,"full_vpn_capabilities."+name)}}let sm=new State_machine;E.init=sm.start.bind(sm);E.exec=sm.exec.bind(sm);E.get=sm.get.bind(sm);E.reconf=sm.reconf.bind(sm);E.uninit=sm.stop.bind(sm);E.get_info=sm.get_info.bind(sm);E.get_last_info=sm.get_last_info.bind(sm);E.refresh_info=sm.refresh_info.bind(sm);E.has_capability=sm.has_capability.bind(sm);E.t={State_machine};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},8033:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){const is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1291),__webpack_require__(932),__webpack_require__(843)],__WEBPACK_AMD_DEFINE_RESULT__=function(zutil,date,svc_vpn_util){const E={},{assign}=Object;let api;let def_api={perr:(id,info,opt)=>{},conf_get:(s,def,prod)=>def,be_util:null,be_info:null,be_mode:null,now:()=>Date.now(),get_param_from_state:()=>{},is_user_updated:()=>true,must_verify_email:()=>{},get_uuid_md5:()=>{},get_ab_test:()=>{}};E.init=_api=>{api=assign({},def_api,_api)};E.find_first_start_ts=(states,min)=>{if(!states)return min;for(let key in states){if(!states[key])continue;let{first_start_ts}=states[key];if(!min||first_start_ts<min)min=first_start_ts}return min};const CG=(s,def,prod)=>api.conf_get(s,def,prod||"ext");E.resolve_conf=(conf,query)=>{let res={};let conf2test={};query=query||{};for(let c of conf){if(c.conf&&c.filter&&c.filter.ab_test){let{ab_test}=c.filter;for(let conf_key of Object.keys(c.conf)){conf2test[conf_key]=conf2test[conf_key]||[];let tests=Array.isArray(ab_test)?ab_test:[ab_test];for(let test of tests)conf2test[conf_key].push(test)}}if(!c.conf||!svc_vpn_util.match_filter(query,c.filter))continue;let key=res.key;if(c.conf.key)key=res.key?res.key+"+"+c.conf.key:c.conf.key;let{watermark}=res;assign(res,c.conf,{key});if(c.conf.watermark)res.watermark=assign({},watermark,c.conf.watermark)}if(Object.keys(conf2test).length)res._conf2ab_test_=conf2test;return res};const detect_product=opt=>{opt=opt||{};if(opt.is_android)return"android";if(opt.is_ios)return"ios";if(opt.is_win)return"win";return"ext"};let last_query_conf_ts;let last_query_conf_cache={};const query_conf=query=>{let root_url=query.root_url||"";let ts=query.now;if(!is_node&&last_query_conf_ts==ts&&last_query_conf_cache[root_url])return last_query_conf_cache[root_url];let conf=CG("trial_rules",[],detect_product(query));let value=E.resolve_conf(conf,query);if(!is_node){last_query_conf_ts=ts;last_query_conf_cache[root_url]=value}return value};E.get_client_params_from_req=req=>{let get_param=p=>{let val=req.zparam(p);return val=="null"?null:val};let domain=get_param("domain");let url=get_param("url");let apk=get_param("apk");let uuid=get_param("uuid");if(url&&!domain)domain=svc_vpn_util.get_root_url(url);let now=api.now();let ext_ver=get_param("ext_ver");let app_ver=get_param("app_ver");let first_start_ts=+get_param("first_start_ts")||now;let is_android=uuid&&uuid.startsWith("apk-");let is_ios=uuid&&uuid.startsWith("ios-");let is_win=uuid&&uuid.startsWith("win-");let client_params={root_url:domain,apk,ext_ver,app_ver,install_build_ver:is_ios&&get_param("install_build_ver"),build_ver:is_ios&&get_param("build_ver"),is_android,is_ios,is_win,hola_apk:get_param("hola_apk"),app_id:is_android&&get_param("app_id"),hola_app:is_ios&&get_param("hola_app"),conf_ver:+get_param("conf_ver"),premium_site:+get_param("premium_site"),premium_apk:+get_param("premium_apk"),browser:get_param("browser"),os:get_param("os"),appid:get_param("appid"),campaign:is_win&&get_param("campaign"),product:is_win&&get_param("product"),user_token:is_win&&get_param("user_token"),user_token_md5:is_win&&api.md5(get_param("user_token")||""),svc_detected:+get_param("svc_detected")||0,hola_svc_detected:+get_param("hola_svc_detected")||0,uuid,uuid_md5:api.md5(uuid),src_country:get_param("src_country"),install_ver:get_param("install_ver")||ext_ver,install_ts:+get_param("install_ts")||now,last_install_ts:+get_param("last_install_ts")||now,first_start_ts,total_interval_n:+get_param("total_interval_n")||0,total_watch_time:+get_param("total_watch_time")||0,cycle_n:+get_param("cycle_n")||0,signed_in:+get_param("signed_in")||0,is_premium:+get_param("is_premium")||0,is_pro_grace_period:+get_param("is_pro_grace_period")||0,skipped_signin_ts:+get_param("skipped_signin_ts")||0,last_survey_suggestion_ts:+get_param("last_survey_suggestion_ts")||0,first_survey_done_ts:+get_param("first_survey_done_ts")||0,tmp_watermark_hide_ts:+get_param("tmp_watermark_hide_ts")||0,ab_test:get_param("ab_test"),ab_tests:get_param("ab_tests")||"",ab_test_name:get_param("ab_test_name"),ab_test_value:get_param("ab_test_value"),last_downloaded_svc_ts:+get_param("last_downloaded_svc_ts")||0,now};if(typeof client_params.ab_test=="string")client_params.ab_test=client_params.ab_test.split(",");if(!query_conf(assign({},client_params,{root_url:domain,apk})).key)return{error:"trial_forbidden_domain"};return client_params};E.get_client_params=root_url=>{let now=api.now();let ext_ver=api.be_util.version();let client_params={now,root_url,ext_ver,conf_ver:CG("version"),uuid:api.be_ext.get("uuid"),uuid_md5:api.get_uuid_md5(),browser:api.be_util.browser(),appid:api.be_mode.get("svc.appid"),svc_detected:+api.be_mode.get("svc.detected")||0,hola_svc_detected:+api.be_mode.get("svc.hola_svc_detected")||0,os:api.be_util.os_guess.os,install_ver:api.be_util.install_version()||ext_ver,install_ts:api.be_util.install_ts()||now,last_install_ts:api.be_util.last_install_ts()||now,first_start_ts:api.get_param_from_state("first_start_ts"),total_watch_time:api.get_param_from_state("total_watch_time"),cycle_n:api.get_param_from_state("cycle_n")||0,cycle_start_ts:api.get_param_from_state("start_ts"),interval_n:api.get_param_from_state("interval_n")||0,interval_start_ts:api.get_param_from_state("interval_ts"),total_interval_n:api.get_param_from_state("total_interval_n")||0,tmp_watermark_hide_ts:+api.get_param_from_state("tmp_watermark_hide_ts")||0,signed_in:+!!api.be_ext.get("user_id"),skipped_signin_ts:+api.get_param_from_state("skipped_signin_ts")||0,last_survey_suggestion_ts:+api.get_param_from_state("last_survey_suggestion_ts")||0,first_survey_done_ts:+api.get_param_from_state("first_survey_done_ts")||0,is_premium:+!!api.be_ext.get("is_premium"),is_pro_grace_period:+!!api.be_ext.get("is_pro_grace_period"),src_country:(api.be_info.get("country")||"").toUpperCase()};let ab_test=api.get_ab_test();if(Array.isArray(ab_test))client_params.ab_test=ab_test;else if(ab_test){client_params.ab_test_name=ab_test.name;client_params.ab_test_value=ab_test.value}client_params.premium_site=+!!svc_vpn_util.get_site_conf(CG(""),client_params,root_url,"premium_site");return client_params};E.get_client_params_win=()=>{let client_params={now:api.now(),app_ver:api.info_get("app_ver"),uuid:api.info_get("uuid"),uuid_md5:api.md5(api.info_get("uuid")||""),user_token:api.info_get("user_token"),user_token_md5:api.md5(api.info_get("user_token")||""),appid:api.info_get("appid"),campaign:api.info_get("campaign"),product:api.info_get("product"),is_premium:api.info_get("premium"),signed_in:api.info_get("signed_in"),ab_test:api.info_get("ab_test"),install_ver:api.info_get("install_ver"),install_ts:api.info_get("install_ts"),first_start_ts:api.get_param_from_state("first_start_ts"),total_interval_n:api.get_param_from_state("total_interval_n"),total_watch_time:api.get_param_from_state("total_watch_time"),cycle_n:api.get_param_from_state("cycle_n")||0};return client_params};class User_trials{constructor(states,client_params){states=states||{};this.trials={};this.ui_conf_tracker={};for(let key in states){let{root_url,apk}=states[key];let conf=query_conf(assign({},client_params,{root_url,apk}));if(!conf.key)continue;this.trials[conf.key]=new Trial(states[key],conf,client_params)}}get_states(){let states={};for(let key in this.trials)states[key]=this.trials[key].get_state();return states}get_trial(client_params,ignore_signin){let conf=query_conf(client_params);if(!this.is_enabled(client_params,conf))return;if(!ignore_signin&&this.need_signin(client_params,conf))return;let trial=this.trials[conf.key];if(!trial)return;trial._conf=conf;return trial}is_enabled(client_params,conf){if(client_params.is_premium)return false;conf=conf||query_conf(client_params);return!!conf.key&&!conf.skip_trial}start_trial(client_params){let conf=query_conf(client_params);if(!conf.key)throw new Error("trial_forbidden_domain");let trial=this.trials[conf.key];if(!trial){return this.trials[conf.key]=new Trial(null,conf,client_params)}trial.state.skipped_signin_ts=client_params.skipped_signin_ts;trial.state.last_survey_suggestion_ts=client_params.last_survey_suggestion_ts;trial.state.first_survey_done_ts=client_params.first_survey_done_ts;trial.start();return trial}start_trial_wait(client_params,ignore_signin){const trial=this.get_trial(client_params,ignore_signin);if(!trial)throw new Error("no_trials_found_before_wait");trial.start_wait();return trial}check_ui_conf_change(client_params){let trial=this.get_trial(client_params);if(!trial)return;let old_conf_str=this.ui_conf_tracker[trial._conf.key];let new_conf_str=trial.get_ui_conf_str();let was_updated;if(old_conf_str&&old_conf_str!=new_conf_str)was_updated=true;this.ui_conf_tracker[trial._conf.key]=new_conf_str;if(was_updated)return trial}is_running(client_params){let trial=this.get_trial(client_params);return trial&&trial.is_running()}is_expired(client_params){let conf=query_conf(client_params);if(!conf.key)return;let trial=this.trials[conf.key];return trial&&this.need_trial(client_params,conf)&&!trial.is_running()}is_ended(client_params){let trial=this.get_trial(client_params);return trial&&trial.is_ended()}can_hide_watermark(client_params){let trial=this.get_trial(client_params);if(trial)return trial.can_hide_watermark()}can_skip_signin(client_params){let conf=query_conf(client_params);if(!conf.key)return false;if(conf.skip_signin)return true;let type=(conf.signin_opt||{}).type||"force";if(type=="force")return false;return true}has_skipped_signin(client_params,conf){conf=conf||query_conf(client_params);if(!conf.key)return;let type=(conf.signin_opt||{}).type||"force";if(type=="force")return;let trial=this.trials[conf.key];if(trial&&type=="cycle_start"&&trial.can_start_new_cycle())return trial.get_next_cycle_ts()<client_params.skipped_signin_ts;return client_params.skipped_signin_ts}need_signin(client_params,conf){if(!api.is_user_updated()||client_params.signed_in&&!api.must_verify_email()){return false}conf=conf||query_conf(client_params);return conf.key&&!conf.skip_signin&&!this.has_skipped_signin(client_params,conf)}close_watermark(client_params){let trial=this.get_trial(client_params);if(trial)return trial.close_watermark()}notify_survey_done(client_params){let trial=this.get_trial(client_params);if(trial)return trial.notify_survey_done()}notify_survey_suggested(client_params){let trial=this.get_trial(client_params);if(trial)return trial.notify_survey_suggested()}can_start_survey(client_params){let trial=this.get_trial(client_params);return trial&&trial.can_start_survey()}close_bonus_tooltip(client_params){let trial=this.get_trial(client_params);if(trial)return trial.close_bonus_tooltip()}need_trial(client_params,conf){if(!this.is_enabled(client_params,conf))return;return!this.get_trial_active(client_params)}get_trial_reason(client_params,conf){conf=conf||query_conf(client_params);if(this.need_signin(client_params,conf))return"signin";return"force_trial"}is_vpn_forbidden(client_params,is_client){if(!this.is_enabled(client_params))return false;let trial=this.get_trial(client_params,true);if(!trial)return"no_trial";if(client_params.trial_popup_abuse_ts>trial.state.expire_ts)return"popup_abuse";return trial.is_grace_ended(is_client)?"expired":false}get_trial_conf(client_params,key){let trial=this.get_trial_active(client_params,true,true);return zutil.get(trial,`conf.${key}`)}get_trial_active(client_params,ignore_ts,allow_stub){let trial=this.get_trial(client_params);if(!trial){if(!ignore_ts||!allow_stub)return;let conf=query_conf(client_params);if(!conf.key)return;let stub_trial=new Trial(null,conf,client_params,true);return stub_trial.get_obj()}if(ignore_ts||trial.is_running())return trial.get_obj()}get_next_cycle_ts(client_params){let trial=this.get_trial(client_params);if(trial)return trial.get_next_cycle_ts()}get_next_interval_ts(client_params,subtract_wait){let trial=this.get_trial(client_params);if(!trial)return;let interval=trial.get_next_interval();if(!interval)return;if(subtract_wait)return interval.min_start_ts||interval.min_ts;return interval.min_ts}get_next_interval_dur(client_params){let trial=this.get_trial(client_params);let interval=trial&&trial.get_next_interval();if(!trial||!interval)return this.get_trial_conf(client_params,"intervals.0.dur");return interval.dur}get_last_interval_start_ts(client_params){let trial=this.get_trial(client_params);if(trial)return trial.state.interval_ts}get_last_interval_end_ts(client_params){let trial=this.get_trial(client_params);if(trial)return trial.state.expire_ts}get_last_interval_dur(client_params){let start_ts=this.get_last_interval_start_ts(client_params);let end_ts=start_ts&&this.get_last_interval_end_ts(client_params);return start_ts&&end_ts&&end_ts-start_ts}get_last_interval_wait_start_ts(client_params){let trial=this.get_trial(client_params);if(trial)return trial.state.wait_start_ts}get_last_interval_wait_end_ts(client_params){let trial=this.get_trial(client_params);if(trial)return trial.state.wait_end_ts}get_last_interval_wait_dur(client_params){let start_ts=this.get_last_interval_wait_start_ts(client_params);let end_ts=start_ts&&this.get_last_interval_wait_end_ts(client_params);return start_ts&&end_ts&&end_ts-start_ts}get_interval_dur(client_params){let trial=this.get_trial(client_params);if(!trial)return 0;let interval=trial.get_current_interval()||trial.get_n_interval(0);return interval.dur}get_total_cycle_time(client_params,for_wait_screen){let trial=this.get_trial(client_params);if(!trial)return 0;let{intervals}=trial.get_conf();let sum=0;for(let i=0;i<intervals.length;i++)sum+=intervals[i].dur;return sum}get_used_cycle_time(client_params,subtract_current){let trial=this.get_trial(client_params);if(!trial)return 0;let interval=trial.get_current_interval();if(!interval)return 0;let{intervals}=trial.get_conf();let sum=subtract_current&&trial.is_running()?0:interval.dur;for(let i=0;i<interval.n&&intervals[i];i++)sum+=intervals[i].dur;return sum}get_used_trial_time(client_params,subtract_current){let trial=this.get_trial(client_params);if(!trial)return 0;let sum=trial.state.total_watch_time||0;if(subtract_current&&trial.is_running()){let interval=trial.get_current_interval();if(interval)sum-=interval.dur}return sum}get_trial_wait(client_params){let trial=this.get_trial(client_params);if(trial)return trial.get_wait()}is_wait_started(client_params){let trial=this.get_trial(client_params);if(trial)return trial.is_wait_started()}is_wait_ended(client_params){let trial=this.get_trial(client_params);if(trial)return trial.is_wait_ended()}get_first_start_ts(min_ts){for(let key in this.trials){let{first_start_ts}=this.trials[key].state;if(!min_ts||first_start_ts<min_ts)min_ts=first_start_ts}return min_ts}get_trials_info(){let info=[];for(let key in this.trials)info.push(this.trials[key].get_info());return info}is_unlimited_trial(client_params){let trial=this.get_trial_active(client_params,true,true);return zutil.get(trial,"conf.unlimited_trial")}need_ext_pin_tip(client_params){let trial=this.get_trial_active(client_params,true,true);return zutil.get(trial,"conf.ext_pin_tip")}get_special_offer_menu(client_params){if(client_params.is_premium)return;let trial=this.get_trial_active(client_params,true,true);return trial&&trial.conf&&!trial.conf.unlimited_trial&&trial.conf.special_offer_menu}}E.User_trials=User_trials;class Trial{constructor(state,conf,client_params,is_stub){this._conf=conf;this._prod=detect_product(client_params);if(state)this.state=state;else this.state=this.init_state(conf,client_params,is_stub)}init_state(conf,client_params,is_stub){client_params=client_params||{};let now=api.now();let interval=this.get_n_interval(0);let first_start_ts=client_params.first_start_ts||now;let state={conf_ver:client_params.conf_ver,cycle_n:1,total_interval_n:1,total_watch_time:interval.dur,skipped_signin_ts:client_params.skipped_signin_ts,last_survey_suggestion_ts:client_params.last_survey_suggestion_ts,first_survey_done_ts:client_params.first_survey_done_ts,first_start_ts,start_ts:now,interval_ts:now,expire_ts:now+interval.dur,interval_n:0,bonus_type:null};if(is_stub){assign(state,{cycle_n:0,total_interval_n:0,total_watch_time:0,first_start_ts:0,start_ts:0,interval_ts:0,expire_ts:0})}if(client_params.root_url)state.root_url=conf.key;if(client_params.apk)state.apk=conf.key;return state}get_state(){let{state}=this;if(this.can_start_new_cycle())this.state.interval_n=0;return state}get_n_interval(n){let{intervals,wait=0}=this._conf;if(!intervals[n])return;let interval=assign({n},intervals[n]);interval.conf=assign({wait},interval.conf);return interval}get_current_interval(){return this.get_n_interval(this.state.interval_n||0)}get_next_cycle_ts(){let{expire_ts,start_ts}=this.state;let{cycle=0,start_new_cycle_from_first_interval=false}=this.get_conf();return start_new_cycle_from_first_interval?start_ts+cycle:expire_ts+cycle}can_start_new_cycle(){return this.get_next_cycle_ts()<=api.now()}get_next_interval(){let{expire_ts}=this.state;let{cycle_restart_after_last_interval}=this.get_conf();let first_interval=this.get_n_interval(0);let res_interval={min_ts:this.get_next_cycle_ts(),n:0,dur:first_interval.dur};if(res_interval.min_ts<=api.now())return res_interval;let cur_interval=this.get_n_interval(this.state.interval_n||0);let min_ts=expire_ts;if(!this.can_skip_wait()&&cur_interval)min_ts+=cur_interval.conf.wait;let next_interval=cur_interval&&this.get_n_interval(cur_interval.n+1);if(next_interval&&min_ts<=res_interval.min_ts){res_interval={min_ts,min_start_ts:expire_ts,n:next_interval.n,dur:next_interval.dur}}else if(!next_interval&&cycle_restart_after_last_interval){res_interval={min_ts,min_start_ts:expire_ts,n:0,dur:first_interval.dur}}let bonus_interval=this.get_bonus_interval();if(bonus_interval&&bonus_interval.min_ts<res_interval.min_ts)return bonus_interval;return res_interval}get_bonus_interval(){}start(){if(this.is_running()){api.perr("trial_start_already_running",this.get_obj());return}const now=api.now();const interval=this.get_next_interval();if(now<interval.min_ts){api.perr("trial_start_must_wait",this.get_obj());if(!CG("skip_trial_must_wait_error",false,this._prod))throw new Error("must_wait")}const{manual_trial_wait_enabled,manual_trial_wait_delta=0}=this.get_conf();if(manual_trial_wait_enabled&&!this.is_wait_ended(manual_trial_wait_delta)){api.perr("manual_trial_start_must_wait",this.get_obj());if(!CG("skip_trial_must_wait_error",false,this._prod))throw new Error("manual_must_wait")}assign(this.state,{cycle_n:(this.state.cycle_n||0)+(interval.n==0?1:0),total_interval_n:(this.state.total_interval_n||0)+1,total_watch_time:(this.state.total_watch_time||0)+interval.dur,interval_ts:now,interval_n:interval.n,expire_ts:now+interval.dur,bonus_type:interval.bonus_type});if(interval.n==0)this.state.start_ts=now}get_wait(){if(this.can_skip_wait())return 0;if(this.can_start_new_cycle())return(this.get_conf().new_cycle||{}).wait;let interval=this.get_current_interval();if(interval)return interval.conf.wait}skip_signin(){this.state.skipped_signin_ts=api.now()}start_wait(){let now=api.now();if(this.can_start_new_cycle()){let wait=(this.get_conf().new_cycle||{}).wait;if(!wait)return;this.state.wait_start_new_cycle=true;this.state.wait_start_ts=now;this.state.wait_end_ts=now+wait;return true}this.state.wait_start_new_cycle=false;this.state.wait_start_ts=now;this.state.wait_end_ts=now+this.get_wait();return true}stop_wait(){this.state.wait_start_new_cycle=undefined;this.state.wait_start_ts=undefined;this.state.wait_end_ts=undefined}is_wait_started(){if(this.can_skip_wait())return true;const interval=this.get_current_interval();return interval&&!interval.conf.wait||this.state.wait_end_ts&&this.state.interval_ts<this.state.wait_end_ts}is_wait_ended(allowed_dt=0){if(this.can_skip_wait())return true;const interval=this.get_current_interval();return interval&&!interval.conf.wait||this.state.wait_end_ts&&this.state.interval_ts<this.state.wait_end_ts&&this.state.wait_end_ts-allowed_dt<=api.now()}can_hide_watermark(){return this.get_conf().allow_tmp_watermark_hide}close_watermark(){this.state.tmp_watermark_hide_ts=api.now()}notify_survey_done(){if(!this.state.first_survey_done_ts)this.state.first_survey_done_ts=api.now()}notify_survey_suggested(){this.state.last_survey_suggestion_ts=api.now()}can_start_survey(){return!this.state.first_survey_done_ts}can_skip_wait(){return this.state.first_survey_done_ts>this.state.expire_ts}get_status(){let now=api.now();if(now<this.state.expire_ts)return"watch";if(this.get_conf().intervals.length-1<=this.state.interval_n)return"end";return"wait"}is_running(){return this.get_status()=="watch"}is_ended(){return this.get_status()=="end"}is_grace_ended(is_client){let now=api.now();let conf=this.get_conf();let grace_ms=(is_client?conf.client_grace_time:conf.server_grace_time)||0;return now>=this.state.expire_ts+grace_ms}move_count(count){for(let i=0;i<count;i++){let next_interval=this.get_next_interval();let diff=next_interval.min_ts-api.now();if(diff>0)this.move_time(diff);this.start()}}move_time(time){for(let k in this.state){if(k.endsWith("_ts")&&this.state[k])this.state[k]-=time}}cur_interval_id(){return`${this.state.interval_n||0}/${this.state.cycle_n||0}`}get_conf(){if(!this.state)return this._conf;let override;let interval=this.get_current_interval();if(interval&&interval.conf)override=zutil.extend_deep({},interval.conf);let conf=zutil.extend_deep({},this._conf,override);if(this.state.wait_start_new_cycle)conf.autostart_after_wait=(conf.new_cycle||{}).autostart;if(conf.watermark&&conf.watermark.open_bonus_tooltip&&this.has_closed_bonus_tooltip()){conf.watermark=assign({},conf.watermark,{open_bonus_tooltip:false})}return conf}get_obj(){return assign({conf:this.get_conf()},this.state)}close_bonus_tooltip(){this.state.closed_bonus_tooltip=this.cur_interval_id()}has_closed_bonus_tooltip(){return this.cur_interval_id()==this.state.closed_bonus_tooltip}get_ui_conf_str(){const conf=this.get_conf();return[`small_watermark: ${!!conf.small_watermark}`,`popcorn_watermark: ${!!conf.popcorn_watermark}`,`can_hide_watermark: ${!!conf.allow_tmp_watermark_hide}`,`is_watermark_hidden: ${!!conf.is_watermark_hidden}`,`watermark: ${JSON.stringify(conf.watermark)}`].join(", ")}get_info(){let{root_url,apk}=this.state;let state=this.get_status();let intervals=this.get_conf().intervals;let n=this.state.interval_n||0;let time=0,sum=0;for(let i=0;i<n&&intervals[i];i++)time+=intervals[i].dur;for(let i=0;i<intervals.length;i++)sum+=intervals[i].dur;if(state=="watch"){let add=intervals[n]&&api.now()+intervals[n].dur-this.state.expire_ts;if(add>0)time+=add}else if(intervals[n])time+=intervals[n].dur;let drop_ms={drop_ms:1};let info=[];info.push(`cycle time: ${date.dur_to_str(time,drop_ms)}`+`/${date.dur_to_str(sum,drop_ms)}`);info.push("total intervals/cycles: "+`${this.state.total_interval_n||0} / ${this.state.cycle_n||0}`);info.push("total watch time: "+date.dur_to_str(this.state.total_watch_time||0,drop_ms));let first_start_ts=api.get_param_from_state("first_start_ts");info.push("since first_start_ts: "+date.dur_to_str(api.now()-first_start_ts||0,drop_ms));info.push(`current interval: ${this.state.interval_n||0}`);return{is_new:true,key:this._conf.key,domain:root_url,apk,state,info}}}class Activation_tracker{constructor(state){this.state=state;this.size=0}count_watch(site,dur_ms){let data=this.state.get(["activation_tracker",site]);if(!data){data={watch_time_ms:0};this.size++}data.watch_time_ms+=dur_ms;this.state.set(["activation_tracker",site],data)}flush(){if(!this.size)return null;let res=this.state.get("activation_tracker");this.state.set("activation_tracker",{});this.size=0;return res}}E.Activation_tracker=Activation_tracker;E.t={match_filter:svc_vpn_util.match_filter,query_conf};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},2227:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){let is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(932),__webpack_require__(6069),__webpack_require__(4336),__webpack_require__(5305),__webpack_require__(1291),__webpack_require__(9824),__webpack_require__(6386),__webpack_require__(843),__webpack_require__(6262),__webpack_require__(8425),__webpack_require__(6545),__webpack_require__(5317),__webpack_require__(4135)],__WEBPACK_AMD_DEFINE_RESULT__=function(date,zbrowser,zescape,zurl,zutil,zerr,etask,svc_vpn_util,version_util,events,array,rate_limit,rand){const E=new events.EventEmitter;const assign=Object.assign,ms=date.ms;const CACHE_TTL=ms.MIN,POLICY_TTL=5*ms.MIN,SEC=ms.SEC;const gen_ping_id=id=>id||(zutil.is_mocha()?"1111":Math.random());const ctx=[];let force_agent_changed;const extensions={archive:zutil.bool_lookup("7z apk arj bin bz deb dmg exe gz iso msi rar rpm tbz tgz xz zip"),media:zutil.bool_lookup("3gp avi f4v flv h264 m4a m4s m4v mkv mov mp3 mp4 ogg ogv swf ts wav "+"webm wmv"),static:zutil.bool_lookup("css eot gif ico jar jpeg jpg png svg svgz ttf webp woff")};const expected_types={archive:/^application\/(?!json$)/,media:/^((audio|video)\/|application\/octet-stream$)/};const CG=(s,def)=>api.conf_get&&api.conf_get(s,def);let cache={};let peer_domain_re;let user_plus=false;let _app_trial_mode=false;let active_reqs=[];let conf_rand_id;let hola_uid;let proxy_rules_engine;function ext_ver(){return(api.get_prod_info()||{}).ext_ver}function product_ver(){let info=api.get_prod_info()||{};return info.ext_ver||info.apk_ver||info.svc_ver}E.get_strategy=(strategy,ex,opt)=>{opt=opt||{};if(!ex)return strategy;if(opt.country){ex=ex.replace(new RegExp("\\b"+zescape.regex(opt.country)+"\\b"),"XX")}let m;if(m=ex.match(/PROXY XX\.POOL_(\w+)/)){m=m[1];ex="PROXY XX.POOL"}switch(ex){case"DIRECT":strategy={name:"direct"};break;case"BLOCK":strategy={name:"block"};break;case"PROXY XX":strategy.name="proxy";break;case"PROXY XX.direct_first":strategy.name="direct_first";break;case"PROXY XX.PEER":strategy.name="proxy";strategy.peer=true;break;case"PROXY XX.POOL":strategy.name="proxy";strategy.pool=m||true;break}return strategy};E.get_rule_strategy=(s,url,opt)=>{if(!url&&(opt.root_url||opt.src_country))url={orig:"",hostname:""};else if(!url||!url.hostname)return s;let ex=null;if(proxy_rules_engine){ex=proxy_rules_engine.find_proxy_for_url_exception(url.orig,url.hostname,opt)}return E.get_strategy(s,ex,opt)};E.handle_request=(url,opt)=>{opt=opt||{};if(opt.premium===undefined)opt.premium=user_plus||_app_trial_mode;if(typeof url=="string")url=zurl.parse(url,true);let top_url=typeof opt.top_url=="string"?zurl.parse(opt.top_url,true):opt.top_url;let strategy,centry=E.cache_access(url.hostname);let policy_key="policy:"+opt.country;let policy=centry.get(policy_key);if(policy=="blocked")strategy={name:"direct"};else if(opt.force=="peer"&&opt.strict)strategy={name:"proxy",peer:true};else if(opt.premium)strategy=E.get_rule_strategy({name:"proxy",peer:false},url,opt);else if(opt.force=="peer")strategy={name:"proxy"};else if(opt.force)strategy={name:opt.force,peer:false};else{strategy=opt.full_vpn?{name:"proxy"}:choose_strategy(url,opt);if(strategy&&strategy.name!="direct")strategy=E.get_rule_strategy(strategy,url,opt)}if(strategy.cache){let cached=centry.get(strategy.cache);if(cached)strategy={name:cached,peer:strategy.peer}}let peer=strategy.peer===true||strategy.peer===undefined&&peer_domain_re&&(peer_domain_re.test(url.hostname)||top_url&&peer_domain_re.test(top_url.hostname));let res=strategies[strategy.name].bind(null,{cache:centry,cache_key:strategy.cache,policy,policy_key,peer,expect_type:strategy.expect_type,strict:opt.strict,pool:strategy.pool,country:opt.country});res.desc=strategy.name;if(strategy.cache)res.desc+=" cache "+strategy.cache;if(peer&&strategy.name!="direct")res.desc+=" peer";if(strategy.name=="proxy"&&strategy.pool){res.desc+=" pool"+(typeof strategy.pool=="string"?"_"+strategy.pool:"")}return res};function choose_strategy(url,opt){let ext=url.ext&&url.ext.toLowerCase();if(opt.method&&opt.method!="GET")return{name:"proxy"};if(opt.type=="stylesheet"||opt.type=="image")return{name:"parallel",cache:"static",peer:false};if(url.query&&zurl.qs_parse(url.query,0,1).callback)return{name:"parallel"};if(extensions.archive[ext]){return{name:"direct_first",cache:"archive",peer:false,expect_type:expected_types.archive}}if(extensions.media[ext]||/=\d+-\d+\.dash/.test(url.file)||/Seg\d+-?Frag\d+/.test(url.pathname)||/\/QualityLevels\(\d+\)\/Fragments\(.+=\d+(,format=.+)?\)/.test(url.pathname)){return{name:"direct_first",cache:"media",peer:false,expect_type:expected_types.media}}if(extensions.static[ext])return{name:"parallel",cache:"static",peer:false};if(!user_plus&&!_app_trial_mode&&ext=="m3u8"){return{name:"direct_first",cache:"media",peer:false,expect_type:/mpegurl/i}}if(opt.type=="main_frame")return{name:"proxy"};if(url.protocol=="https:")return{name:"proxy"};return{name:"parallel"}}let last_user_type_set;E.set_user_plus=flag=>{if(user_plus==flag||Date.now()-last_user_type_set<2*ms.SEC)return;user_plus=flag;last_user_type_set=Date.now();return Object.keys(agents).map((a=>agents[a].reinit()))};E.set_app_trial_mode=mode=>{_app_trial_mode=mode};E.resp_match=(a,b)=>{if(a.code!=b.code)return{match:false,basis:"response code"};if(a.type!=b.type)return{match:false,basis:"content type"};if(a.etag||b.etag)return{match:a.etag==b.etag,basis:"etag"};if(a.len||b.len)return{match:a.len==b.len,basis:"content-length"}};E.unblocker_json_set=function(json,opt){proxy_rules_engine=new Proxy_rules_engine(json.unblocker_rules,{free:json.unblocker_globals,plus:json.unblocker_plus,pool_countries:json.pool_countries},opt||{ext:true});if(json.exceptions)E.set_peer_sites(json.exceptions.peer);E.emit("lib_event",{id:"unblocker_json_set",data:json})};E.is_pool_country=country=>proxy_rules_engine&&proxy_rules_engine.is_pool_country(country);E.get_global_rules=(rules,is_plus)=>proxy_rules_engine?proxy_rules_engine.get_global_rules(rules,is_plus):[];E.set_peer_sites=list=>{if(!list)return;peer_domain_re=new RegExp("(^|\\.)("+list.map(zescape.regex).join("|")+")$","i")};E.gen_rule=opt=>{let rule={name:opt.name,country:opt.country.toLowerCase(),peer:peer_domain_re&&peer_domain_re.test(opt.name)||opt.peer,force_peer:opt.force_peer,link:opt.name,description:opt.country.toUpperCase()+" VPN",type:opt.type||"url",enabled:opt.enabled!==undefined?!!opt.enabled:true,supported:true,root_url_orig:["**."+opt.name],root_url:[zurl.http_glob_url("**."+opt.name,1)],ts:opt.ts||Date.now(),mode:opt.mode||"unblock"};zutil.if_set(opt.src,rule,"src");zutil.if_set(opt.src_country,rule,"src_country");zutil.if_set(opt.ratings,rule,"ratings");zutil.if_set(opt.def_traffic,rule,"def_traffic");zutil.if_set(opt.proxy_traffic,rule,"proxy_traffic");zutil.if_set(opt.asnum,rule,"asnum");zutil.if_set(opt.cid,rule,"cid");zutil.if_set(opt.peer_country,rule,"peer_country");zutil.if_set(opt.peer_ip,rule,"peer_ip");zutil.if_set(opt.mitm,rule,"mitm");let pref=[];["def_traffic","proxy_traffic"].forEach((e=>opt[e]&&pref.push(e)));["asnum","cid","peer_country","peer_ip"].forEach((e=>opt[e]&&pref.push(opt[e])));rule.id=rule.name+"_"+rule.country+"_vpn"+(pref.length?"_"+pref.join("_"):"");return rule};class Cache_entry{constructor(){this.timers={}}get(key){return this[key]}put(key,value,ttl){this[key]=value;if(this.timers[key])clearTimeout(this.timers[key]);this.timers[key]=ttl&&setTimeout((()=>{delete this[key];delete this.timers[key]}),ttl);return this}put_weak(key,value,ttl){if(!this[key])this.put(key,value,ttl);return this}del(key){delete this[key];delete this.timers[key];return this}}E.cache_access=domain=>{let entry=cache[domain];if(!entry)entry=cache[domain]=new Cache_entry;return entry};E.cache_purge=()=>{cache={}};let strategies={direct:(opt,direct,proxy)=>{let res={direct:{}};if(!direct){res.direct.start=true;return res}if(direct.code||direct.error)res.direct.serve=true;return res},block:()=>({block:true}),proxy:(opt,direct,proxy)=>{if(opt.policy=="blocked"&&!opt.strict)return strategies.direct(opt,direct,proxy);let res={direct:{},proxy:{country:opt.country}};if(!proxy){res.proxy.start=true;res.proxy.peer=opt.peer;res.proxy.pool=opt.pool;res.proxy.allowed=opt.policy=="allowed";return res}if(opt.strict){res.proxy.abort=true;return res}if(handle_policy(proxy.policy,opt)=="blocked"){res.direct.start=true;return res}if(proxy.code||proxy.error)res.proxy.serve=true;zutil.if_set(opt.peer,res.proxy,"peer");zutil.if_set(opt.pool,res.proxy,"pool");return res},parallel:(opt,direct,proxy)=>{if(opt.policy=="blocked")return strategies.direct(opt,direct,proxy);let res={direct:{},proxy:{country:opt.country}};function serve_proxy(){if(proxy.hdrs_only){res.proxy.start=true;res.proxy.peer=opt.peer;res.proxy.pool=opt.pool;res.proxy.allowed=opt.policy=="allowed"}else res.proxy.serve=true;return!proxy.hdrs_only}if(!direct){res.direct.start=true;res.direct.timeout=true}if(!proxy){res.proxy.start=true;res.proxy.peer=opt.peer;res.proxy.pool=opt.pool;res.proxy.allowed=opt.policy=="allowed";res.proxy.hdrs_only=true}if(!direct||!proxy)return res;if(handle_policy(proxy.policy,opt)=="blocked")return strategies.direct(opt,direct,proxy);if(proxy.error){if(direct.code||direct.error)res.direct.serve=true;if(direct.error)res.proxy.serve=true;return res}if(!proxy.code)return res;if(!direct.code){if(!serve_proxy())return res;if(opt.cache_key&&direct.slow&&is_ok(proxy,opt.expect_type)){res.log="cache put weak proxy";opt.cache.put_weak(opt.cache_key,"proxy",CACHE_TTL)}else if(!opt.cache_key)res.direct.abort=true;return res}let m=E.resp_match(direct,proxy);if(!m){serve_proxy();return res}res.log=m.basis+(m.match?" match":" mismatch");if(m.match){res.direct.serve=true;if(!proxy.hdrs_only)res.proxy.serve=true;if(opt.cache_key){res.log+="; cache put direct";opt.cache.put(opt.cache_key,"direct",CACHE_TTL)}}else{if(!serve_proxy())return res;if(opt.cache_key){res.log+="; cache put proxy";opt.cache.put(opt.cache_key,"proxy",CACHE_TTL)}}return res},direct_first:(opt,direct,proxy)=>{if(opt.policy=="blocked")return strategies.direct(opt,direct,proxy);let res={direct:{},proxy:{country:opt.country}};if(!direct){res.direct.start=true;res.direct.timeout=true;return res}if(is_ok(direct,opt.expect_type)){res.direct.serve=true;if(opt.cache_key){res.log="cache del";opt.cache.del(opt.cache_key)}return res}if(!proxy){if(direct.slow||direct.code||direct.error){res.proxy.start=true;res.proxy.peer=opt.peer;res.proxy.pool=opt.pool;res.proxy.allowed=opt.policy=="allowed"}return res}if(handle_policy(proxy.policy,opt)=="blocked")return strategies.direct(opt,direct,proxy);if(proxy.code){if(opt.cache_key&&(is_ok(proxy,opt.expect_type)||!direct.code)){res.log="cache put proxy";opt.cache.put(opt.cache_key,"proxy",CACHE_TTL)}else if(proxy.code==302&&direct.code==302){if(proxy.location==direct.location)res.direct.serve=true;else{let p=zurl.parse(proxy.location,true);let d=zurl.parse(direct.location,true);if(p.path==d.path)res.direct.serve=true}}if(!res.direct.serve)res.proxy.serve=true;return res}if(proxy.error&&!direct.slow){res.direct.serve=true;if(direct.error)res.proxy.serve=true;return res}}};function is_ok(resp,expect_type){var res=resp.code>=200&&resp.code<300||resp.code==304;if(res&&expect_type)res=expect_type.test(resp.type);return res}function handle_policy(policy,opt){var m=/^(allowed|blocked)( domain)?$/.exec(policy);if(!m)return"allowed";opt.policy=m[1];if(opt.policy_key&&m[2])opt.cache.put(opt.policy_key,opt.policy,POLICY_TTL);return opt.policy}E.is_conf_allowed=on=>{if(!on)return;if(!conf_rand_id)api.storage.set("conf_rand_id",conf_rand_id=Math.random());return conf_rand_id<on};var api={},agents={},mem_storage={};var def_api={perr:opt=>{zerr("agent.perr not set, discarding "+opt.id)},ajax:opt=>{zerr("agent.ajax not set, discarding "+opt.url)},storage:{get:id=>mem_storage[id],set:(id,val)=>mem_storage[id]=val},get_auth:()=>void zerr("agent.get_auth not set"),get_prod_info:()=>({}),get_user_info:()=>({}),suspend_client:()=>({}),url_ccgi:"https://client.hola.org/client_cgi",get_url_ccgi:suffix=>api.url_ccgi+suffix,trigger:(ev,val)=>{},conf_get:(s,def)=>def,get_rule_routes:rule=>{var routes=[],s=zutil.pick(rule,"country");routes.push(s);if(rule.peer)routes.push(assign({peer:true},s));if(rule.pool)routes.push(assign({pool:rule.pool},s));return routes},get_fallback_agent:()=>{},is_proxy_auth_supported:()=>false,get_agent_fallback_host:host=>host,use_proxy_preauth:()=>false,check_agent_domain_fallback:()=>{}};const ERR_TIMER=500;const MAX_ERR_TIMER=15*ms.MIN;let lib_sp;E.init=set=>{E.sp=etask((function*unblocker_lib(){yield this.wait()}));return etask("init",(function*init(){assign(api,def_api,set);lib_sp=etask("lib_sp",(function*(){conf_rand_id=yield api.storage.get("conf_rand_id");hola_uid=yield api.storage.get("hola_uid");yield this.wait()}));E.sp.spawn(lib_sp);yield init_rules();const key=yield api.storage.get("agent_key");if(key)E.emit("lib_event",{id:"set_agent_key",data:key});E.on("not_working",on_not_working)}))};E.reset=()=>{active_reqs.forEach((e=>e.return()));active_reqs=[];Object.keys(agents).forEach((a=>agents[a].uninit()));agents={}};E.trigger=E.emit;E.uninit=()=>{lib_sp.return();E.reset();E.removeAllListeners();api={};rules=null};function Agent(o,parent){if(!(this instanceof Agent))return new Agent(o,parent);this.host=o.host;this.ip=o.ip;this.port=o.port;this.vendor=o.vendor;if(o.pool)this.pool=o.pool;if(o.port_list)this.port_list=o.port_list;this.parents=[];this.last_traffic=0;this.last_verified=0;this.err_timer=ERR_TIMER;this.auth_err_timer=ERR_TIMER;this.waiting=[];this.add_parent(parent);this.verify();this.proxy_auth()}Agent.prototype.is_verified=function(period){if(this.last_verified&&get_verify_conf("disable_verify"))return true;const ts=Math.max(this.last_traffic,this.last_verified);period=period||get_verify_conf("period_ms",10*ms.MIN)+5*ms.MIN;return Date.now()-ts<period};Agent.prototype.is_verify_err=function(){return this.error&&(this.error.err||"").startsWith("verify_")};Agent.prototype.parent_to_ctx=function(parent){return this.parents.find((p=>p.up==parent))};Agent.prototype.is_usable=function(parent){return!this.is_not_usable(parent)};Agent.prototype.err_ts=function(parent){parent=parent&&this.parent_to_ctx(parent);return this.error&&this.error.ts||parent&&parent.error&&parent.error.ts};Agent.prototype.is_not_usable=function(parent){parent=parent&&this.parent_to_ctx(parent);return this.error&&"error"||this.busy&&"busy"||this.bw_busy&&"bw_busy"||!this.is_verified()&&this.is_verify_running()&&"verifying"||!this.is_verified()&&!this.is_verify_running()&&"unverified"||!this.proxy_authed&&(this.proxy_auth_sp||{}).auth_running&&"authing"||!this.proxy_authed&&!(this.proxy_auth_sp||{}).auth_running&&"not_authed"||parent&&parent.error&&"parent error"};Agent.prototype.to_string=function(parent){return this.host+":"+this.port+"\t"+(this.pool||"reg")+"\t"+(this.is_not_usable(parent)||"usable")};Agent.prototype.is_verify_running=function(){return this.verify_sp&&this.verify_sp.verify_running};Agent.prototype.reverify=function(period){if(period&&(this.is_verify_running()||this.last_verified&&Date.now()-this.last_verified<=period)){return}this.last_verified=this.last_traffic=0;if(this.verify_sp)this.verify_sp.return();this.verify()};Agent.prototype.reauth=function(period){if(!this.last_proxy_authed||Date.now()-this.last_proxy_authed<=period)return;this.last_proxy_authed=0;if(this.proxy_auth_sp)this.proxy_auth_sp.return();this.proxy_auth()};Agent.prototype.add_parent=function(parent){this.parents.push({up:parent})};Agent.prototype.unset_error=function(){var _this=this;this.error=undefined;this.err_timer=ERR_TIMER;this.verify_error_n=0;this.parents.forEach((function(p){if(!p.error)p.up.unset_exclude(_this)}))};Agent.prototype.set_error=function(err,desc,rule,forget){var _this=this;if(rule)rule=zutil.pick(rule,"name","country");else this.error={err,desc,ts:Date.now()};if(this.is_verify_err())this.verify_error_n++;let c=get_verify_conf("verify_err",{period:2*ms.HOUR,count:10});forget=forget||!this.is_verified(c.period)&&this.verify_error_n>c.count;this.parents.forEach((function(p){if(rule&&!svc_vpn_util.find_rule(p.up.rules,rule))return;if(rule)p.error={err,desc,ts:Date.now()};if(forget)p.up.forget(_this,forget?"disabled":"verify_err");else p.up.set_exclude(_this)}));if(forget)this.uninit()};Agent.prototype.info=function(){var ret={host:this.host,ip:this.ip,port:this.port,vendor:this.vendor};zutil.if_set(this.version,ret,"version");zutil.if_set(this.bw_available,ret,"bw_available");zutil.if_set(this.rtt,ret,"rtt");zutil.if_set(this.country,ret,"country");zutil.if_set(this.pool,ret,"pool");zutil.if_set(this.error,ret,"error");zutil.if_set(this.port_list,ret,"port_list");return ret};Agent.prototype.wait_verified=function(){var _this=this;return etask((function*_wait_verified(){this.finally((()=>array.rm_elm(_this.waiting,this)));_this.waiting.push(this);return yield this.wait()}))};Agent.prototype.next_verify=function(){return this._next_verify};Agent.prototype.next_auth=function(){return this._next_auth};Agent.prototype.get_rule=function(){return this.parents[0].up.rules[0]};Agent.prototype.verify=function(){let _this=this,rule=this.get_rule();let ping_id=this.ip+"_"+gen_ping_id();let qs=assign({proxy_country:this.parents[0].up.country,ping_id,root_url:rule.link||rule.name},api.get_prod_info());this.verify_error_n=0;E.sp.spawn(etask({name:"verify_"+(this.host||this.ip)},(function*(){qs.key=yield api.storage.get("agent_key");let force_ip,force_post;let verify_err=(err,desc,url)=>{let info={url,host:_this.host,ip:_this.ip,err,err_desc:desc};unittest_resp_by_route(_this.parents.map((p=>p.up.route)),"ea",`<resp(fail=${err})`,this.req_id);svc_vpn_util.push_event("<verify_err",info);E.emit("lib_event",{id:"verify_done",data:info});_this.perr("verify_err",info);force_ip=!CG("disable_verify_fallback")&&_this.err_timer>ERR_TIMER&&err!="agent_err";force_post=force_ip;_this.err_timer=Math.min(_this.err_timer*4,MAX_ERR_TIMER);if(_this.err_timer==MAX_ERR_TIMER)force_ip=false;_this.set_error("verify_"+err,desc,undefined,err=="agent_err");_this.waiting.forEach((et=>et.continue()))};this.finally((()=>{delete _this.verify_sp}));for(;;){if(this.verify_running){svc_vpn_util.push_event("<verify",{host:_this.host,ip:_this.ip,rtt:_this.rtt})}this.verify_running=false;_this.verify_sp=this;if(_this.error){_this._next_verify=Date.now()+_this.err_timer;yield etask.sleep(_this.err_timer)}if(_this.last_verified&&get_verify_conf("disable_verify"))return;let ts=Math.max(_this.last_traffic||0,_this.last_verified||0);let now=Date.now();let period=get_verify_conf("period_ms",10*ms.MIN);if(ts&&now-ts<period){let timer=ts+period-now;_this._next_verify=now+timer;yield etask.sleep(timer);continue}this.verify_running=true;svc_vpn_util.push_event(">verify",{host:_this.host,ip:_this.ip});_this._next_verify=0;let url=api.get_verify_url?api.get_verify_url(_this,force_ip):"https://"+(_this.host||_this.ip)+":"+_this.port+"/verify_proxy";this.req_id=unittest_req_by_route(_this.parents.map((p=>p.up.route)),"ea",">req(url="+url+")");let ret,t0=Date.now();let method=force_post?"POST":"GET";try{if(api.be_dev_mode&&api.be_dev_mode.get("verify_ajax_fail")){yield etask.sleep(SEC);svc_vpn_util.push_event(">verify_ajax_fail");throw new Error("DEBUG_FORCE_FAIL")}ret=yield api.ajax({timeout:7*SEC,url,qs,method})}catch(e){verify_err(/timeout/.test(e)?"timeout":"unknown",""+e,url);continue}if(!ret||!ret.version){verify_err("empty","empty ret",url);continue}if(ret.error)return verify_err("agent_err",ret.error,url);_this.bw_available=ret.bw_available;_this.rtt=Date.now()-t0;_this.country=ret.country;_this.busy=ret.busy;_this.bw_busy=ret.bw_busy;_this.version=ret.version;_this.last_verified=Date.now();_this.unset_error();E.emit("lib_event",{id:"verify_done",data:{host:_this.host,ip:_this.ip,rtt:_this.rtt,url}});if(_this.busy||_this.bw_busy)_this.parents.forEach((p=>p.up.set_busy()));unittest_resp_by_route(_this.parents.map((p=>p.up.route)),"ea","<resp(data="+JSON.stringify(ret)+")",this.req_id);_this.waiting.forEach((et=>et.continue()));if(get_verify_conf("disable_periodic"))return}})))};Agent.prototype.proxy_auth=function(){if(!api.is_proxy_auth_supported()||get_proxy_auth_conf("disable"))return void(this.proxy_authed=true);let _this=this,rule=this.get_rule();let auth=api.get_auth()||{};let method=_this.last_method||"GET";let url,fallback_host;let on_auth_error=(err,desc)=>{_this.perr("proxy_auth_err",{host:_this.host,ip:_this.ip,err,err_desc:desc,method,fallback_host});_this.auth_err_timer=Math.min(_this.auth_err_timer*4,15*ms.MIN);_this.auth_error={err,desc};E.emit("lib_event",{id:"proxy_auth_err",data:{host:_this.host,ip:_this.ip,err,err_desc:desc}})};return etask({name:"proxy_auth_"+(this.host||this.ip)},(function*(){this.finally((()=>{delete _this.proxy_auth_sp}));this.auth_running=false;_this.proxy_auth_sp=this;while(true){if(_this.auth_error){_this._next_auth=Date.now()+_this.auth_err_timer;yield etask.sleep(_this.auth_err_timer)}let now=Date.now(),ts=_this.last_proxy_authed;let period=get_proxy_auth_conf("period_ms",4*ms.HOUR);if(ts&&now-ts<period){let timer=ts+period-now;_this._next_auth=now+timer;yield etask.sleep(timer);continue}this.auth_running=true;_this._next_auth=0;fallback_host=api.get_agent_fallback_host(_this.host);let force_pac;if(api.use_proxy_preauth()){let prem=auth.is_premium?"1":"0";let data={user:`user-uuid-${auth.uuid}-is_prem-${prem}`,key:yield api.storage.get("agent_key")};url=api.get_auth_url(_this)+"?"+zurl.qs_str(data)}else{let ping_id=_this.ip+"_"+gen_ping_id();force_pac=true;let data={ping:"proxy_auth",proxy_country:_this.parents[0].up.country,uuid:auth.uuid,root_url:rule.link||rule.name,ping_id};let h=fallback_host.replace(/\./g,"_")+"-"+_this.port;url=`http://${h}.proxy_auth.trigger.hola.org/hola_trigger?`+zurl.qs_str(data)}this.req_id=unittest_req_by_route(_this.parents.map((p=>p.up.route)),"ea",">req(url="+url+")");let ret;try{ret=yield api.ajax({timeout:7*SEC,url,full_response:true,json:false,force_pac})}catch(e){on_auth_error(/timeout/.test(e)?"timeout":"unknown",""+e);continue}if(!ret||ret.status!=200){unittest_resp_by_route(_this.parents.map((p=>p.up.route)),"ea","<resp(fail=empty)",this.req_id);if(!ret||!ret.status)method={GET:"POST",POST:"GET"}[method];on_auth_error("fail","empty ret");continue}_this.last_method=method;_this.proxy_authed=true;_this.last_proxy_authed=Date.now();_this.auth_error=undefined;unittest_resp_by_route(_this.parents.map((p=>p.up.route)),"ea","<resp(status="+ret.status+")",this.req_id);E.emit("lib_event",{id:"proxy_auth",data:{host:_this.host,ip:_this.ip}});if(get_proxy_auth_conf("disable_periodic"))return}}))};Agent.prototype.perr=function(id,info,err){let rule=zutil.pick(this.get_rule(),"name","country");info=assign({rule,proxy_country:rule.country,hola_uid},info);api.perr({info,id,err,rate_limit:{count:2}})};Agent.prototype.to_str=function(){let s=zutil.pick(this,"host","bw","bw_busy","busy","error","last_verified","last_traffic","ip","pool");return JSON.stringify(s)};Agent.prototype.uninit=function(){if(this.verify_sp)this.verify_sp.return();if(this.proxy_auth_sp)this.proxy_auth_sp.return();this.waiting.forEach((et=>et.return()))};function Agents(rule,route){if(!(this instanceof Agents))return new Agents(rule);this.rule=rule;this.rules=[rule];this.route=route.toLowerCase();var m;if(m=this.route.match(/\.pool_?(\w+)?/))this.pool=m[1]||true;this.exclude=[];this.agents=[];this.deselect={};this.deselected={};this.exclude_vendor={};this._log=[];this.limit=CG("verify_proxy.agent_num",3);this.country=rule.country;this.get_best_agent_waiting=[];this.rl={};agents[this.route]=this;this.init_key_monitor(12*ms.HOUR)}Agents.prototype.init_key_monitor=function(monitor_interval){if(!CG("enable_agent_key_monitor"))return;if(this.agent_key_monitor_sp)this.agent_key_monitor_sp.return();let _this=this;this.agent_key_monitor_sp=E.sp.spawn(etask((function*agent_key_monitor_sp(){yield etask.sleep(monitor_interval);for(;;){try{let ts=yield api.storage.get("agent_key_ts");let diff=Date.now()-ts;if(ts&&diff<monitor_interval){yield etask.sleep(monitor_interval-diff);continue}let{agent_key}=yield _this.zgettunnels(null,{agent_key_only:1});if(!agent_key)throw new Error("missing agent_key");yield api.storage.set("agent_key",agent_key);E.emit("lib_event",{id:"set_agent_key",data:agent_key});yield api.storage.set("agent_key_ts",Date.now())}catch(e){api.perr({id:"agent_key_update_err",rate_limit:{count:2}},e);yield etask.sleep(10*ms.MIN)}}})))};Agents.prototype.reverify=function(period){this.agents.forEach((a=>a.reverify(period)));this.exclude.forEach((a=>a.reverify(period)))};Agents.prototype.reauth=function(period){this.agents.forEach((a=>a.reauth(period)));this.exclude.forEach((a=>a.reauth(period)))};Agents.prototype.uninit=function(){if(this.agent_key_monitor_sp)this.agent_key_monitor_sp.return();this.uninited=true;this.agents.forEach((function(a){a.uninit()}));this.agents=[];this.exclude.forEach((function(a){a.uninit()}));this.exclude=[];this.deselect={};this.deselected={};this.exclude_vendor={};delete agents[this.route];if(this.load_agents_info_et)this.load_agents_info_et=void this.load_agents_info_et.return()};Agents.prototype.zgettunnels=function(ping_id,opt){opt=opt||{};let _this=this,fa;if((fa=api.be_dev_mode&&api.be_dev_mode.get("force_agent"))&&!api.be_dev_mode.get("force_until_change")){zerr.info("using force_agent %O instead of /zgettunnels req",fa);return{ip_list:{[fa.host]:fa.ip},protocol:{[fa.host]:"https"},vendor:{[fa.host]:"force_agent"},ztun:{[this.route]:[`HTTP ${fa.host}:${fa.port}`]},agent_types:{[this.route]:"hola"}}}let exclude=array.unique(this.exclude.concat(opt.exclude||[]).map((e=>e.host)));let ex_limit;if(ex_limit=CG("exclude_limit",9)){if(this.country=="us")ex_limit+=3;if(exclude.length>ex_limit)exclude=rand.rand_subset(exclude,ex_limit)}let deselect=[];for(let host in this.deselect){if(!this.deselected[host]){deselect.push(host);this.deselected[host]=true}}const auth=api.get_auth()||{};const data_params=["uuid","session_key","install_ts","install_ver","identity"];let data=zutil.pick(auth,...data_params);zutil.if_set(ping_id,data,"ping_id");let qs=assign({country:this.route,limit:opt.limit||this.limit},zutil.omit(auth,data_params));zutil.if_set(opt.agent_key_only,qs,"agent_key_only");let params={exclude,deselect};for(let p in params){if(params[p].length>1){data[p]=params[p].join(",");qs[p]=1}else if(params[p].length)qs[p]=params[p][0]}return etask((function*_zgettunnels(){this.on("uncaught",(e=>{api.perr({id:"zgettunnel_err",info:{country:_this.route,exclude,ping_id,hola_info:(e||{}).hola_info},rate_limit:{count:2}},e);throw e}));this.req_id=unittest_req_by_route(_this.route,"ec",">req(url="+api.get_url_ccgi("/zgettunnels?"+zurl.qs_str(assign({},qs,data))+")"));svc_vpn_util.push_event(">zgettunnels",{country:qs.country,exclude});if(api.be_dev_mode&&api.be_dev_mode.get("zgettunnel_ajax_slow")){svc_vpn_util.push_event(">zgettunnel_ajax_slow");yield etask.sleep(15*SEC)}if(api.be_dev_mode&&api.be_dev_mode.get("zgettunnel_ajax_fail")){svc_vpn_util.push_event(">zgettunnel_ajax_fail");throw new Error("DEBUG_FORCE_FAIL")}if(zutil.is_mocha())api.perr({id:"zgettunnel_req"});let res=yield api.ajax({url:api.get_url_ccgi("/zgettunnels"),method:CG("is_zgettunnels_post4")?"POST":"GET",qs,data,retry:3});if(!res)throw new Error("empty /zgettunnels res");svc_vpn_util.push_event("<zgettunnels",{country:qs.country,ip_list:res.ip_list});try{unittest_resp_by_route(_this.route,"ec","<resp(data="+JSON.stringify(res)+")",this.req_id)}catch(e){zerr("failed to generate test %s",e&&e.stack)}return res}))};Agents.prototype.add_agents=function(_agents,zgettunnels){this.type=zgettunnels.agent_types[this.route];for(let proxy_str of _agents){let[,host,port]=proxy_str.match(/^.* (.*):(.*)$/);let a={host,port,ip:zgettunnels.ip_list[host],vendor:zgettunnels.vendor&&zgettunnels.vendor[host]};zutil.if_set(zgettunnels.pool&&zgettunnels.pool[host],a,"pool");zutil.if_set(zgettunnels.port,a,"port_list");if(!a.pool)this.push(a);else if(this.pool==true){let route=svc_vpn_util.gen_route_str({country:this.country,pool:a.pool});let route_agent=set_agent_route(assign({},this.rule,{pool:a.pool}),route);route_agent.push(a);a=route_agent.find(a);this.push(a)}else this.push(E.find_agents(a)[0]||a)}};Agents.prototype.reinit=function(){this.rl={};this.uninited=undefined;if(this.get_best_agent_sp)this.get_best_agent_sp.return({reset:true});this.agents.forEach((function(a){a.uninit()}));this.agents=[];this.exclude.forEach((function(a){a.uninit()}));this.exclude=[];this.deselect={};this.deselected={};this.exclude_vendor={};if(this.load_agents_info_et)this.load_agents_info_et=void this.load_agents_info_et.return();return this.load_agents_info(null,"reset")};Agents.prototype.load_agents_info=function(ping_id,reason){let _this=this;return etask((function*_load_agents_info(){if(_this.load_agents_info_et)return yield this.wait_ext(_this.load_agents_info_et);let usable=_this.agents.filter((a=>!_this.should_replace(a)));if(usable.length>=_this.limit){zerr.info("load_agents_info %s use existing %O",_this.route,_this.agents);return}let since_last_no_agents=Date.now()-_this.last_no_agents_ts;if(_this.last_no_agents_ts&&since_last_no_agents<CG("no_agents_period",5*ms.MIN)){zerr.info("load_agents_info %s - ignore zgettunnels, no agents",_this.route);return}let rl=CG("get_agents_rl",{count:2,period:ms.MIN});if(rl.count&&!rate_limit(_this.rl,rl.period,rl.count)){zerr.info("load_agents_info %s - ignore zgettunnels, max rate",_this.route);return}let exclude=_this.agents.concat(_this.exclude);_this.load_agents_info_et=this;this.finally((()=>{delete _this.load_agents_info_et}));let zgettunnels=yield _this.zgettunnels(ping_id,{exclude,limit:_this.limit-usable.length});zerr.info("zgettunnels %s ret %O",_this.route,zgettunnels);if(zgettunnels.blocked)return void api.suspend_client(zgettunnels.permanent);if(zgettunnels.agent_key){api.storage.set("agent_key",zgettunnels.agent_key);E.emit("lib_event",{id:"set_agent_key",data:zgettunnels.agent_key})}else{api.perr({id:"agent_key_miss",info:{ret:zgettunnels},rate_limit:{count:2}})}if(!zgettunnels.ztun)return;if(!_this.agents.length&&_this.exclude.length&&_this.exclude.every((a=>a.is_verify_err()))){api.perr({id:"verify_all_failed",with_log:true,info:{agents:_this.exclude.map((a=>a.info())),route:_this.route},rate_limit:{count:1}});yield api.check_agent_domain_fallback(true)}let new_agents=zgettunnels.ztun[_this.route]||[];zerr.info("%s agents set, reason %s, %O",_this.route,reason,new_agents);delete _this.last_no_agents_ts;if(!new_agents.length){_this.last_no_agents_ts=Date.now();if(!exclude.length){zerr.info("zgettunnels no agents for %s",_this.route);if(_this.pool&&!_this.agents.length&&!_this.exclude.length){api.perr({id:"forget_route",info:{route:_this.route},rate_limit:{count:1}});_this.uninit()}}}else _this.add_agents(new_agents,zgettunnels)}))};Agents.prototype.usable=function(){let count=0;for(let agent of this.agents)count+=agent.is_usable(this);return count};Agents.prototype.dump_agents=function(){console.log(this.route+" Agents:");this.agents.forEach((a=>console.log(a.to_string(this))));console.log(this.route+" Excludes:");this.exclude.forEach((a=>console.log(a.to_string(this))))};Agents.prototype.set_busy=function(){if(this.usable()<=1)this.load_agents_info(gen_ping_id())};Agents.prototype.remove=function(s,agent){let i=s.findIndex((a=>a.host==agent.host));if(i<0)return;s.splice(i,1);return true};Agents.prototype.move=function(s,d,agent){if(!this.remove(s,agent))return;d.push(agent);return true};Agents.prototype.unset_exclude=function(agent){this.move(this.exclude,this.agents,agent);delete this.deselect[agent.host];delete this.deselected[agent.host];if(!this.exclude.some((e=>e.vendor==agent.vendor)))delete this.exclude_vendor[agent.vendor]};Agents.prototype.set_exclude=function(agent){this.move(this.agents,this.exclude,agent);this.deselect[agent.host]=true;this.exclude_vendor[agent.vendor]=Date.now();if(this.usable()<=1)this.load_agents_info(gen_ping_id())};Agents.prototype.forget=function(agent,reason){this.remove(this.exclude,agent);this.remove(this.agents,agent);delete this.deselect[agent.host];delete this.deselected[agent.host];api.perr({id:"forget_agent",info:{agent:agent.info(),route:this.route,reason},rate_limit:{count:1}});if(this.usable()==0)this.load_agents_info(gen_ping_id())};Agents.prototype.log=function(s){this._log.push(s)};Agents.prototype.has_rule=function(rule){return this.rules.some((r=>r.name==rule.name))};Agents.prototype.add_rule=function(rule){if(this.has_rule(rule))return;this.rules.push(rule)};Agents.prototype.should_replace=function(agent){return(!agent||!Object.keys(agent).length)&&"empty"||agent.is_not_usable(this)};Agents.prototype.get_best_agent=function(ping_id){let _this=this;return etask({async:true},(function*get_best_agent(){if(_this.uninited)return;this.finally((()=>{delete _this.get_best_agent_sp;for(let sp of _this.get_best_agent_waiting)sp.return(this.retval);_this.get_best_agent_waiting=[]}));try{if(_this.get_best_agent_sp){_this.get_best_agent_waiting.push(this);return yield this.wait()}_this.get_best_agent_sp=this;let _agents=_this.get_chosen();if(!_agents.length){yield _this.load_agents_info(ping_id,"missing agents");_agents=_this.get_chosen();if(!_agents.length)return}let verified_agent=_agents.find((a=>a.is_verified()));if(verified_agent)return{chosen:verified_agent};for(let a of _agents){this.spawn(etask((function*wait_verify(){yield a.wait_verified();return a})))}let res=yield this.wait_child("any",(a=>a&&a.is_verified()));if(res)return{chosen:res.child.retval}}catch(e){return{error:""+e}}}))};Agents.prototype.get_all_agents=function(){const ret=this.agents.filter((a=>!this.should_replace(a)));return!ret.length?this.agents:ret};Agents.prototype.get_chosen=function(){let ret=[];let add=(cond,check_vendor)=>{let _agents=this.agents.filter((e=>cond(e)&&(!check_vendor||check_vendor&&e.vendor&&!this.exclude_vendor[e.vendor])));if(!_agents.length)return;_agents.sort(((a,b)=>a.rtt-b.rtt));ret=ret.concat(_agents.slice(0,3-ret.length))};add((a=>!this.should_replace(a,true)));if(ret.length==3)return ret;add((a=>this.should_replace(a)));if(ret.length==3)return ret;this.exclude.sort(((a,b)=>a.err_ts(this)-b.err_ts(this)));ret=ret.concat(this.exclude.slice(0,3-ret.length));return ret};Agents.prototype.get_fallback=function(){if(CG("disable_fallback_aagents"))return;return this.fallback_agent=this.fallback_agent||api.get_fallback_agent(this.country.toUpperCase())};Agents.prototype.push=function(agent){if(this.find(agent))return-1;if(agent instanceof Agent)agent.add_parent(this);else agent=new Agent(agent,this);return this.agents.push(agent)};Agents.prototype.find=function(agent){function cmp_agents(a,b){let fb=api.get_agent_fallback_host;return(a.host==b.host||a.host&&b.host&&fb(a.host)==fb(b.host)||a.ip==b.ip)&&(!a.port||a.port==b.port)}return this.agents.find((a=>cmp_agents(agent,a)))||this.exclude.find((a=>cmp_agents(agent,a)))};Agents.prototype.to_str=function(){let s='"'+this.route+'":{"agents":[';this.agents.forEach(((a,i)=>{s+=(i?",":"")+a.to_str()}));s+='],"exclude":[';this.exclude.forEach(((a,i)=>{s+=(i?",":"")+a.to_str()}));return s+"]}"};E.find_agents=function(agent){let res=[];if(!agent.host&&!agent.ip)return res;for(let route in agents){let a=agents[route].find(agent);if(a)res.push(a)}return res};E.is_agent=o=>!!E.find_agents({ip:o,host:o})[0];E.update_chosen=agent=>{for(agent of E.find_agents(agent))agent.last_traffic=Date.now()};E.get_agents_by_route=route=>agents[route]?agents[route].get_all_agents():[];E.get_all_agents=function(){let res=[];for(let route in agents)res=res.concat(E.get_agents_by_route(route));return res};E.get_agents_type=route=>agents[route]&&agents[route].type;E.get_rule_routes=function(rule,raw){let routes=rule&&api.get_rule_routes?api.get_rule_routes(rule):[];return raw?routes:routes.map((r=>svc_vpn_util.gen_route_str(r)))};function set_agent_route(rule,route_str){if(agents[route_str])agents[route_str].add_rule(rule);else agents[route_str]=new Agents(rule,route_str);return agents[route_str]}E.get_agents=(ping_id,rule)=>etask((function*_get_agents(){let succ,res={rule,proxy_country:rule.country,verify_proxy:{}};ping_id=gen_ping_id(ping_id);active_reqs.push(this);this.finally((()=>array.rm_elm(active_reqs,this)));for(let route_str of E.get_rule_routes(rule)){let route_agents=set_agent_route(rule,route_str);let parent_et=this;this.spawn(etask((function*get_best_agent_child(){let ret=yield route_agents.get_best_agent(ping_id);if(!ret)return;if(ret.reset){parent_et.spawn(etask(get_best_agent_child));return}if(ret.error){res.verify_proxy[route_str]=[];return}succ=true;let a={host:ret.chosen.host,port:ret.chosen.port,ip:ret.chosen.ip,type:route_agents.type,verified:true};zutil.if_set(ret.chosen.pool,a,"pool");zutil.if_set(ret.chosen.port_list,a,"port_list");let r={agent:a,res:{version:ret.chosen.version,ip:ret.chosen.ip,bw_available:ret.chosen.bw_available,country:ret.chosen.country},t:ret.chosen.t};zutil.if_set(ret.chosen.bw_busy,r.res,"bw_busy");zutil.if_set(ret.chosen.busy,r.res,"busy");res.verify_proxy[route_str]=[r]})))}try{yield this.wait_child("all",CG("get_agents_timeout",10*SEC));if(!succ)throw new Error("not_found")}catch(e){api.perr({id:"get_agents_err",rate_limit:{count:2}},e);res.info={error:"catch",err:""+e}}return res}));E.replace_agents=(rule,replace)=>etask((function*_change_agents(){if(!force_agent_changed&&api.be_dev_mode&&api.be_dev_mode.get("force_agent")&&api.be_dev_mode.get("force_until_change")&&(replace||[])[0].vendor=="force_agent"){force_agent_changed=true}for(let agent_obj of replace){for(let agent of E.find_agents(agent_obj))agent.set_error("force_change","by change agents",rule)}return yield E.get_agents(null,rule)}));let def_cc_states={wait:{wait:ms.MIN,next:"hola"},hola:{next:"connectivity",priority:1,type:"direct"},connectivity:{urls:["google.com","microsoft.com","wikipedia.org"],next:"wait",next_success:"common_agents",type:"direct"},common_agents:{next:"mem_agents",agents:"common_agents",retries:1,priority:2,type:"proxy"},mem_agents:{next:"build_agents",agents:"mem_agents",retries:1,priority:2,type:"proxy"},build_agents:{next:"cloud_agents",agents:"build_agents",retries:1,priority:2,type:"proxy"},cloud_agents:{agents:"cloud_agents",retries:1,priority:2,type:"proxy"}};let def_cc_api={ajax_via_proxy:undefined,perr:function(opt){zerr("cc.perr not set, discarding "+opt.id)},CG:()=>{},apply_agent_fallback_rule:host=>host,get_agent_fallback_rules:()=>[]};function ConnectivityCheck(opt){this.api={};assign(this.api,def_cc_api,opt.api);this.opt=opt;this.logs=[];this.perrs={};this.selected=opt.selected;this.init_states()}ConnectivityCheck.prototype.init_states=function(){let opt=this.opt;this.states={};assign(this.states,def_cc_states,opt.states);if(opt.hola_mirrors){let hola_mirrors=typeof opt.hola_mirrors=="function"?opt.hola_mirrors():opt.hola_mirrors;let mirror_opt={delay:ms.SEC,priority:1,type:"direct"};let prev="hola";for(let urls of hola_mirrors){if(typeof urls=="string")urls=[urls];let name=svc_vpn_util.get_root_url(zurl.add_proto(urls[0])).replace(/[.-]/g,"_");this.states[name]=assign({urls},mirror_opt);this.states[prev].next=name;prev=name}this.states[prev].next="connectivity"}for(let name in this.states){let state=this.states[name]=assign({urls:[]},this.states[name]);state.name=name;if(state.name=="wait")continue;if(opt.ignore){state.ignore=opt.ignore instanceof RegExp?opt.ignore.test(name):opt.ignore.includes(name)}if(opt.ignore_direct&&state.type=="direct")state.ignore=true;if(!state.urls||state.urls.length)continue;let is_agent_state=name.endsWith("_agents");let use_urls=is_agent_state?opt.hola:opt[name];if(!use_urls){state.ignore=true;continue}if(typeof use_urls=="string")use_urls=[use_urls];if(is_agent_state)use_urls=use_urls.slice(0,1);state.urls=use_urls}};ConnectivityCheck.prototype.reset=function(){if(this.et)this.et=this.et.return();this.selected=this.state=undefined;this.init_states()};ConnectivityCheck.prototype.uninit=function(){this.reset()};ConnectivityCheck.prototype.log=function(log,state){this.logs.push({log,state})};ConnectivityCheck.prototype.perr=function(opt){let path=opt.info.name+"."+opt.id;if(zutil.get(this.perrs,path))return;zutil.set(this.perrs,path,true);if(opt.info&&this.opt.dbg_logs)opt.info.logs=this.logs.map((function(o){return o.log}));return this.api.perr(opt)};ConnectivityCheck.prototype.check=function(state,loop_et,mode){mode=mode||"syq";let _agents=this.opt[state.agents]||[],ret={error:"check failed"};let et_timeout,url_timeout={},ts,_this=this,next=0;let send_next=()=>{if(_agents[next]){clearTimeout(_agents[next].timeout);delete _agents[next].timeout}if(!_agents.length||next+1==_agents.length)return;if(_agents[++next])state.urls.forEach((url=>et.spawn(send_ajax(url))));else et_timeout=setTimeout((()=>et.return(ret)),3e3)};let ajax_via_proxy=(url,type,opt)=>etask((function*ajax_wrapper(){let resp=yield _this.api.ajax_via_proxy({url,type,state:state.name},opt);if(resp)resp.test_url=url;else resp={test_url:url};return resp}));let send_ajax=url=>{url=url.startsWith("http")?url:"https://"+url+(url.includes("/")?"":"/");let agent=_agents.length?_agents[next]:null;let opt={always:true,hdrs_abort:true,ignore_redir:true,hdrs:{"Cache-Control":"no-cache,no-store,must-revalidate,"+"max-age=-1"},force_headers:true,fix_307:true,agent,force:agent?"proxy":"direct",src:"bg_ajax"};if(opt.force=="proxy")opt.prot="proxy";_this.log("ajax "+(_agents.length?"proxy ":"")+url);ts=Date.now();let _et=ajax_via_proxy(url,"GET",opt);if(agent)agent.timeout=setTimeout(send_next,3e3);else{url_timeout[url]=setTimeout((()=>{_et.return({orig_res:{error:"timeout"},test_url:url})}),5e3)}return _et};let et=etask((function*connectivity_check(){this.finally((()=>{clearTimeout(et_timeout);for(let url in url_timeout)clearTimeout(url_timeout[url]);if(_agents.length)_agents.forEach((a=>clearTimeout(a.timeout)));let selected;if(!ret.error){if(state.next_success){_this.state=assign({},state);_this.retries=0;_this.state.next=state.next_success;if(mode=="parallel")selected={connected:true}}else{selected=assign({success_url:ret.url,ts:Date.now()},state);if(_agents.length)selected.agent=_agents[next];if(mode!="parallel"){_this.perr({id:"connectivity_check_success",rate_limit:{count:5},info:{name:state.name,check_name:_this.opt.name,mode,urls:state.urls,success:ret.url}})}}}else if(state.type!="proxy"||_agents.length){_this.perr({id:"connectivity_check_failed",rate_limit:{count:15},info:{name:state.name,mode,check_name:_this.opt.name,urls:state.urls,error:ret.error}})}if(mode!="parallel"&&selected)_this.selected=selected;loop_et.continue(selected)}));if(typeof _agents=="function")_agents=yield _agents();_agents=_agents||[];if(!_this.api.CG("disable_agent_domain_fallback")){let f_rules=_this.api.get_agent_fallback_rules()||[];let new_agents=[];for(let a of _agents){new_agents.push(a);for(let fr of f_rules){new_agents.push(assign({},a,{host:_this.api.apply_agent_fallback_rule(a.host,fr),fallback_rule:fr}))}}_agents=new_agents}if(state.agents&&!_agents.length)return;state.urls.forEach((url=>this.spawn(send_ajax(url))));yield this.wait_child("any",(resp=>{let url=resp&&resp.test_url;if(!ret.error)return;clearTimeout(et_timeout);clearTimeout(url_timeout[url]);let _ret=resp&&resp.orig_res?resp.orig_res:{error:"ajax failed"};_ret.url=url;_ret.statusCode=_ret.statusCode!=undefined?_ret.statusCode:_ret.code;if(!_ret.error&&(_ret.statusCode>=400||!_ret.statusCode))_ret.error="bad status code "+_ret.statusCode;delete _ret.body;if(resp&&resp.agent&&resp.agent.timeout)clearTimeout(resp.agent.timeout);let proxy_err=_agents.length&&/ERR_PROXY_CONNECTION_FAILED/.test(_ret.error);_this.log("resp "+(_ret.error||_ret.statusCode)+" after "+(Date.now()-ts)+"ms",state);if(_ret.error||proxy_err){ret.error=_ret.error;return void send_next()}if(next){_this.perr({id:"connectivity_check_failed_agent",rate_limit:{count:2},info:{name:state.name,check_name:_this.opt.name,mode,host:(_agents[next-1]||{}).host}})}return ret=_ret}))}));return et};ConnectivityCheck.prototype.get_state=function(){if(!this.state)return this.states.hola;if(this.state.ignore&&this.state.next_success)return this.states[this.state.next_success];return this.states[this.state.next]};ConnectivityCheck.prototype.run=function(opt){opt=opt||{};if(!opt.force&&Date.now()-this.error_ts<10*ms.MIN)return;let _this=this;return etask({async:true},(function*run(){this.finally((()=>{_this.et=undefined}));if(_this.et)return yield this.wait_ext(_this.et);_this.error_ts=_this.retries=0;_this.et=this;_this.perrs={};while(!_this.selected){let state=_this.get_state();if(!state)break;let max=state.retries||_this.opt.retries||3;if(_this.retries==max||state.ignore){_this.retries=0;_this.state=state;continue}_this.retries++;let _agents=_this.opt[state.agents];if(_agents&&_agents instanceof ConnectivityCheck){if(!_agents.selected)yield _agents.run();if(_agents.selected){_this.perr({id:"connectivity_check_success",rate_limit:{count:5},info:{name:state.name,check_name:_this.opt.name,urls:state.urls}});let success_url=_this.opt.def_url||_agents.selected.success_url;return _this.selected=assign({success_url,agent:_agents.selected.agent},state)}continue}let wait_et;if(state.wait)wait_et=etask.sleep(state.wait);else if(_this.check(state,this))wait_et=this.wait();if(!wait_et)break;if(opt.on_state)opt.on_state(state);yield wait_et}if(!_this.selected&&!_this.error_ts){_this.perr({id:"connectivity_check_all_failed",rate_limit:{count:5},info:{url:_this.opt.hola,check_name:_this.opt.name,mode:"syq"}});_this.error_ts=Date.now()}return _this.selected||{error:"all_failed"}}))};ConnectivityCheck.prototype.run_parallel=function(opt){opt=opt||{};let _this=this,mode="parallel";return etask({async:true},(function*run_parallel(){this.finally((()=>_this.et=undefined));if(_this.et)return yield this.wait_ext(_this.et);_this.error_ts=_this.retries=0;_this.et=this;_this.perrs={};const direct_tests=[];const test_groups=[direct_tests];for(let name in _this.states){let s=_this.states[name];if(!s.priority||s.ignore)continue;if(s.type=="direct")direct_tests.push(s);else test_groups.push([s])}for(let i=0;i<test_groups.length;i++){let tests=test_groups[i];let more_tests=i<test_groups.length-1;if(!tests.length)continue;for(let test of tests){this.spawn(etask({async:true},(function*run_parallel_child(){let res,_agents=_this.opt[test.agents];if(_agents&&_agents instanceof ConnectivityCheck){if(!_agents.selected)yield _agents.run_parallel();if(_agents.selected){let success_url=_this.opt.def_url||_agents.selected.success_url;res=assign({success_url,agent:_agents.selected.agent},test)}return res}if(test.delay&&!zutil.is_mocha())yield etask.sleep(test.delay);let wait_et;if(_this.check(test,this,mode))wait_et=this.wait();if(!wait_et)return;if(opt.on_state)opt.on_state(test);let r=yield wait_et;return r})))}yield this.wait_child("any",(selected=>{if(!selected)return;if(selected.priority==1)return _this.selected=selected;if(selected.name&&(!_this.selected||_this.selected.priority>selected.priority)){_this.selected=selected}}));if(_this.selected){_this.perr({id:"connectivity_check_success",rate_limit:{count:5},info:{name:_this.selected.name,check_name:_this.opt.name,urls:_this.selected.urls,mode}});return _this.selected}_this.perr({id:"connectivity_check_all_failed",rate_limit:{count:5},info:{url:_this.opt.hola,check_name:_this.opt.name,mode:"parallel"}});if(more_tests){let res=yield _this.check(_this.states.connectivity,this,mode);if(res&&res.connected)continue;_this.perr({id:"connectivity_check_no_internet",rate_limit:{count:5},info:{check_name:_this.opt.name,res}});if(--_this.opt.connectivity_retries<0)break;i=-1;if(!zutil.is_mocha())yield etask.sleep(_this.states.wait.wait)}}return _this.selected||{error:"all_failed"}}))};ConnectivityCheck.prototype.is_completed=function(){return!!this.selected};ConnectivityCheck.prototype.get_selected_state=function(){return this.selected?this.selected.name:undefined};ConnectivityCheck.prototype.get_backend_link=function(){const s=this.selected;return s?{url:s.success_url,agent:s.agent,name:s.name}:{url:this.opt.def_url}};E.ConnectivityCheck=ConnectivityCheck;E.get_chosen_agent=function(route_opt,rule){let fa;if(!force_agent_changed&&(fa=api.be_dev_mode&&api.be_dev_mode.get("force_agent"))&&api.be_dev_mode.get("force_until_change")){return assign({vendor:"force_agent"},fa)}route_opt=route_opt||{};const route_str=svc_vpn_util.gen_route_str(route_opt,{no_algo:true});let chosen,route_agent=set_agent_route(rule,route_str);if(!(chosen=route_agent.get_chosen())||!chosen.length||chosen[0].replace){route_agent.get_best_agent(Math.random());return route_agent.get_fallback()}return chosen[0].info()};E.get_active_agents=function(rule){let _agents=[];E.get_rule_routes(rule,true).forEach((r=>{let a;if(a=E.get_chosen_agent(r,rule))_agents=_agents.concat(a)}));return _agents};E.resolve_agents=(rules,opt)=>etask((function*_resolve_agents(){let ping_id=gen_ping_id();for(let rule of rules)this.spawn(E.get_agents(ping_id,rule,opt));yield this.wait_child("all")}));E.verify_agents=(period,wait)=>etask((function*_verify_agents(){let unverified=new Set,ts=Date.now();for(let a in agents)agents[a].agents.forEach((ag=>unverified.add(ag)));for(let agent of unverified){if(!agent.last_verified||ts-agent.last_verified>period)agent.reverify(period);else unverified.delete(agent)}if(!wait)return;for(;;){for(let agent of unverified){if(ts-agent.last_verified<=period)unverified.delete(agent)}if(!unverified.size)return;yield etask.sleep(wait)}}));let gen_stamp=()=>Math.floor(Math.random()*4294967295);function commit_rules(update){rules.stamp=gen_stamp();if(update)gen_rules(rules.set);api.storage.set("rules",rules)}E.has_rule=function(o){if(!o)return;if(typeof o=="function"){for(let i in rules.set){if(o(rules.set[i]))return true}return}return svc_vpn_util.find_rule(rules.set,o)};function rules_fixup(){let change,now=Date.now();let country=api.get_user_info().country;for(let i in rules.set){let r=rules.set[i];let diff=now-(r.ts||0);if(!r.enabled)continue;if(r.country==country&&diff>ms.DAY&&r.mode!="protect"&&r.src_country&&r.src_country!=country){zerr.notice("disabled rule after country change site");api.perr({id:"disable_rule_country_changed",with_log:true,info:{rule:{name:r.name,country:r.country,src_country:r.src_country},src_country:country}});change=true;r.enabled=false}}if(change)commit_rules(true)}function _set_rule(opt,pair){let r,i;svc_vpn_util.push_event("set_rule",{name:opt.name,src:opt.src,pair,country:opt.country,enabled:opt.enabled,mode:opt.mode,del:opt.del,mitm:opt.mitm});if(!rules||!opt.name||!opt.country)return;if(!rules.generated)rules.generated={};if(!rules.set)rules.set={};for(i in rules.set){r=rules.set[i];if(r.name!=opt.name||opt.src&&opt.src!=r.src)continue;delete rules.generated[i];delete rules.set[i]}if(!opt.del){if(opt.name.match(/^https?:\/\//))opt.name=svc_vpn_util.get_root_url(opt.name);r=E.gen_rule(opt);rules.generated[r.id]=r;rules.set[r.id]={name:r.name,country:r.country,enabled:r.enabled,ts:r.ts,mode:r.mode,src:r.src,src_country:r.src_country||""};zutil.if_set(opt.def_traffic,rules.set[r.id],"def_traffic");zutil.if_set(opt.proxy_traffic,rules.set[r.id],"proxy_traffic");zutil.if_set(opt.asnum,rules.set[r.id],"asnum");zutil.if_set(opt.cid,rules.set[r.id],"cid");zutil.if_set(opt.peer_country,rules.set[r.id],"peer_country");zutil.if_set(opt.peer_ip,rules.set[r.id],"peer_ip");zutil.if_set(opt.mitm,rules.set[r.id],"mitm")}if(pair)return;let root_urls=get_root_urls(opt.name);for(i=1;i<root_urls.length;i++)_set_rule(assign({},opt,{name:root_urls[i]}),true)}E.get_site_key=root_url=>{let sites=CG("sites",{});for(let k in sites){let v=sites[k];let urls=Array.isArray(v.root_url)?v.root_url:[v.root_url];if(urls.includes(root_url)&&v.min_ver&&version_util.cmp(ext_ver(),v.min_ver)>=0){return k}}};E.get_site_conf=root_url=>CG("sites."+E.get_site_key(root_url));function get_root_urls(domain){let site=E.get_site_conf(domain);return site?[...new Set([domain].concat(site.root_url))]:[domain]}E.set_rule=function(opt){if(!rules)return;opt=assign({ts:Date.now()},opt);unittest_set_rule(opt);E.emit("lib_event",{id:"before_rule_set",data:opt});_set_rule(opt);commit_rules()};function gen_rules(set){if(!set)return;rules.generated=null;rules.set=null;for(let i in set)_set_rule(set[i])}function is_supported_country(op,rule){if(!rule.country)return true;let c=rule.country;if(!c.list||!c.type||!(c.list instanceof Array))return true;if(c.type=="in"&&(!op.country||!c.list.includes(op.country))||c.type=="not_in"&&op.country&&c.list.includes(op.country)){return false}return true}function get_filtered_rules(urules,op){if(!urules)return;var m,res={};for(var i in urules){if(!is_supported_country(op,urules[i]))continue;res[i]=urules[i];if(!(m=urules[i].match))continue;if(m.min_ver&&version_util.cmp(product_ver(),m.min_ver)<0||m.browser&&!m.browser.includes((api.get_prod_info()||{}).browser)){delete urules[i].match}}return res}E.set_rules=_rules=>{if(!api.get_user_info||!rules)return;let opt={country:api.get_user_info().country};let need_update=rules.enable!=_rules.enable||!zutil.equal_deep(rules.blacklist,_rules.blacklist)||!zutil.equal_deep(rules.forbidden_host,_rules.forbidden_host)||["globals","plus"].some((e=>!zutil.equal_deep(rules[e],get_filtered_rules(_rules["unblocker_"+e],opt))));if(need_update){rules.globals=get_filtered_rules(_rules.unblocker_globals,opt);rules.plus=get_filtered_rules(_rules.unblocker_plus,opt);rules.blacklist=_rules.blacklist;rules.forbidden_host=_rules.forbidden_host;rules.enable=_rules.enable;api.storage.set("rules",rules)}};E.get_rules=()=>{if(!rules)return null;rules_fixup();if(!rules.globals)return null;let json={unblocker_rules:rules.generated||{},stamp:rules.stamp,enable:rules.enable,blacklist:rules.blacklist,forbidden_host:rules.forbidden_host};["globals","plus"].forEach((e=>json["unblocker_"+e]=rules[e]));return zutil.clone_deep(json)};E.get_groups=groups=>{let ret={unblocker_rules:{}};for(let group of groups){let r=E.gen_rule(group);ret.unblocker_rules[r.id]=r}return zutil.clone_deep(ret)};function agents_to_unittest_str(rule){let routes=E.get_rule_routes(rule);let _s='"def":{';for(let route in agents){if(!rule||routes.includes(route))_s+=agents[route].to_str()}return"{"+_s+"}}"}E.reauth_country_agents=(country,period)=>{if(CG("reauth.disable"))return;period=period!==undefined?period:CG("reauth.period",5*ms.MIN);for(let route in agents){let agent=agents[route];if(agent.country==country)agent.reauth(period)}};E.reauth_all_agents=()=>{for(let route in agents)agents[route].reauth(0)};E.reverify_country_agents=country=>{let period=get_verify_conf("reverify_period_ms",5*ms.MIN);for(let a in agents){let agent=agents[a];if(agent.country==country)agent.reverify(period)}};let get_ctx=id=>ctx.find((c=>c.id==id));E.add_ctx=function(id,rule,data){try{E.del_ctx(id);ctx.push({id,rule,data,ts:Date.now(),ids:{ew:0,bw:0,ea:0,ec:0},reqs:{},routes:E.get_rule_routes(rule),unittest:[],src:data.src});if(!gen_auto_unittest())return;c_unittest_push(id,"open(country="+api.get_user_info().country+' date="'+date.to_sql(new Date)+'" auto user_plus='+user_plus+" set_agents="+agents_to_unittest_str(rule)+")");c_unittest_push(id,"set_rule(raw="+JSON.stringify(rule)+")");c_unittest_push(id,"nav(url="+data.src+")");if(ctx.length>20)ctx.splice(0,10)}catch(e){console.error(e)}};E.del_ctx=id=>array.rm_elm(ctx,get_ctx(id));let agent_num=host=>host.match(/[a-z]+([0-9]+)/)[1];E.on_before=(url,req_id,ctx_id,data)=>{if(!gen_auto_unittest())return;try{let c=get_ctx(ctx_id);if(!c)return;c_unittest_push(ctx_id,"bw",">req(url="+url+" "+(data.strategy?'strategy="'+data.strategy+(data.agent?".z"+agent_num(data.agent):"")+'"':"")+")",req_id)}catch(e){console.error(e)}};E.on_completed=(req_id,ctx_id,data)=>{if(!gen_auto_unittest())return;try{let c=get_ctx(ctx_id);if(!c)return;let req=c.unittest.find((u=>u.req_id==req_id));if(!req)return;c_unittest_push(ctx_id,"bw",'<resp(status="'+(data.status||0)+'"'+(data.hdrs?" hdrs="+JSON.stringify(zutil.pick(data.hdrs,"content-length","x-hola-response","x-hola-error","location")):"")+")",req_id,req.roles_id)}catch(e){console.error(e)}};E.dump_unittest=ctx_id=>{let c=get_ctx(ctx_id);if(c)c.unittest.forEach((u=>console.log(u.s)))};class Proxy_exceptions{constructor(){this.ips=[];this.match_root_url={};let rule_props=["hosts","root_urls","src_country","proxy_country"];for(let name of rule_props){this[name]={};this[name+"_cache"]={};this[name+"_counter"]=0}}}let regex_ip2=/^((\d{1,3}\.){3}\d{1,3})(\/(\d+))?$/;class Proxy_rules_engine{constructor(unblocker_rules,proxy_rules,opt){this.proxy_rules=proxy_rules||{};opt=opt||{};this.opt={redir_direct:opt.redir_direct===undefined||opt.redir_direct,proxy_port:opt.proxy_port||6857,redir_port:opt.redir_port||6850,ext:opt.ext||0,by_rules:opt.by_rules||0,do_redir:opt.do_redir||0};this.hosts={hosts:{},ips:[],hosts_cache:{},hosts_counter:0};if(!this.opt.by_rules){for(let i in unblocker_rules){let rule=unblocker_rules[i];if(rule.internal||this.opt.ext&&!rule.enabled)continue;this.parse_cmds(i,rule,unblocker_rules,this.hosts)}}else{this.rules={};for(let i in unblocker_rules){let rule=unblocker_rules[i];if(rule.internal||this.opt.ext&&!rule.enabled)continue;if(!rule.root_url){this.parse_cmds(i,rule,unblocker_rules,this.hosts);continue}if(!rule.cmds)continue;this.rules[i]={hosts:{},ips:[],hosts_cache:{},hosts_counter:0};this.parse_cmds(i,rule,unblocker_rules,this.rules[i],1)}}this.exceptions=this.parse_exceptions(this.proxy_rules.free);this.exceptions_plus=this.parse_exceptions(this.proxy_rules.plus)}is_pool_country(country){return(this.proxy_rules.pool_countries||{})[country.toUpperCase()]}find_proxy_for_url_exception(url,host,opt){opt=opt||{};let rules=opt.is_trial||!opt.premium?this.exceptions:this.exceptions_plus;let ret;if(!(ret=this.find_proxy_for_match(url,host,rules,opt))){ret=this.find_proxy_for_url_exception_int(url,host,opt.root_url,rules,opt)}return ret&&ret.str}find_proxy_for_val(url,host,hosts,opt){opt=opt||{};if(!opt.name||!opt.val)return;let do_redir=this.opt.do_redir;let cname=opt.name+"_cache",counter=opt.name+"_counter";if(hosts[cname]){let c=hosts[cname][opt.val];if(c&&c.func)return c.func(url,host,do_redir,opt);if(c)return this.pac_redir(url,host,do_redir)}if(hosts[counter]>5e3){hosts[counter]=0;hosts[cname]={}}let func;if(!(func=hosts[opt.name][opt.val]))return;hosts[cname][opt.val]={func};hosts[counter]++;return func(url,host,do_redir,opt)}find_proxy_for_url_exception_int(url,host,root_url,rules,opt){let ret=this.find_proxy_for_url(url,host,rules,{exception:1});if(!ret&&root_url){ret=this.find_proxy_for_val(url,host,rules,{name:"root_urls",val:root_url,exception:1})}if(!ret&&opt.src_country){ret=this.find_proxy_for_val(url,host,rules,{name:"src_country",val:opt.src_country,exception:1})}if(!ret&&opt.proxy_country){ret=this.find_proxy_for_val(url,host,rules,{name:"proxy_country",val:opt.proxy_country,exception:1})}return ret}find_pac_proxy(url,host){let ret=this.find_proxy_for_url(url,host,this.hosts);if(ret.proxy){let ex=this.find_proxy_for_url(url,host,this.exceptions,{exception:1,orig_proxy:ret.str});if(ex)ret=ex}return ret.str}find_proxy_for_url(url,host,hosts,opt){opt=opt||{};let do_redir=this.opt.do_redir;if(hosts.hosts_cache){let c=hosts.hosts_cache[host];if(c&&c.func)return c.func(url,host,do_redir,opt);if(c)return this.pac_redir(url,host,do_redir)}if(hosts.hosts_counter>5e3){hosts.hosts_counter=0;hosts.hosts_cache={}}if(zurl.is_ip(host)){let ip=zurl.ip2num(host);let ips=hosts.ips;for(let i=0;i<ips.length;i++){let _ip=ips[i];if(ip>>>_ip.bits<<_ip.bits^_ip.mask)continue;hosts.hosts_cache[host]={func:_ip.func};hosts.hosts_counter++;return _ip.func(url,host,do_redir,opt)}}let index=-1;for(;;){let func=hosts.hosts["*"]||hosts.hosts[host.substr(index+1)];if(func){hosts.hosts_cache[host]={func};hosts.hosts_counter++;return func(url,host,do_redir,opt)}if((index=host.indexOf(".",index+1))<0)break}if(opt.exception)return null;hosts.hosts_cache[host]={};hosts.hosts_counter++;return this.pac_redir(url,host,do_redir)}find_proxy_for_match(url,host,rules,opt){if(!rules.match_root_url||!opt.root_url)return opt.orig_proxy;opt=opt||{};for(let root_url of[opt.root_url,opt.real_root_url,""]){let mr,mrules;if(root_url===undefined||!(mrules=rules.match_root_url[root_url])){continue}mr=mrules.find((r=>{if(r.fsrc_country&&!r.fsrc_country.includes(opt.src_country)){return false}if(r.fproxy_country&&!r.fproxy_country.includes(opt.proxy_country)){return false}return true}));if(mr){return this.find_proxy_for_url_exception_int(url,host,root_url||opt.root_url||opt.real_root_url,mr,opt)}}}parse_exceptions(rules){if(!rules)rules={};let exceptions=new Proxy_exceptions;for(let name in rules){let rule=rules[name];if(rule.match)this.parse_match(name,rule,exceptions);else this.parse_cmds(name,rule,rules,exceptions)}return exceptions}pac_redir(url,host,do_redir){if(!do_redir||!this.opt.redir_direct)return{proxy:false,str:"DIRECT"};if(zbrowser.isPlainHostName(host))return{proxy:false,str:"DIRECT"};let m=url.match(/^.+:([0-9]+)\/.*$/);if(m&&m.length==2&&m[1]!="80")return{proxy:false,str:"DIRECT"};if(url.match(/^https:.*$/))return{proxy:false,str:"DIRECT"};return{proxy:false,str:"PROXY 127.0.0.1:"+this.opt.redir_port+"; DIRECT"}}handle_then(value,url,host,do_redir,exception,orig_proxy){if(value=="DIRECT")return this.pac_redir(url,host,do_redir);if(value=="BLOCK")return{block:true,str:"BLOCK"};let n=value.split(" ");if(exception&&n[0]=="PROXY"){if(n.length==1)return null;if(n[1].startsWith("XX")&&orig_proxy){let c=orig_proxy.split(" ")[1].split(".")[0];return{proxy:true,str:"PROXY "+n[1].replace("XX",c)}}}if(n.length<2)return this.pac_redir(url,host,do_redir);else if(!{PROXY:1,SOCKS:1,SOCKS5:1,HTTPS:1}[n[0]])return this.pac_redir(url,host,do_redir);if(this.opt.ext)return{proxy:true,str:value};return{proxy:true,str:"PROXY 127.0.0.1:"+this.opt.proxy_port}}static get_ext(url){let ext="",index=url.indexOf("?");if(index>=0)url=url.slice(0,index);let ext_index=url.lastIndexOf(".",url.length);let _ext_index=url.lastIndexOf("/",url.length);if(ext_index>=0&&ext_index>_ext_index)ext=url.slice(ext_index+1);else if(_ext_index>=0)ext=url.slice(_ext_index+1);return ext}host_cb(name,rule,cmd,url,host,do_redir,opt){if(!cmd["if"]){if(cmd.dst_dns){return this.handle_then(cmd.then,url,host,do_redir,opt.exception,opt.orig_proxy)}cmd["if"]=[]}let ext=Proxy_rules_engine.get_ext(url);for(let i=0;i<cmd["if"].length;i++){let _if=cmd["if"][i];let arg=null,value=null;let type="==";if(!_if.then)continue;if(_if.type)type=_if.type;if(_if.host){arg=host;value=_if.host}else if(_if.url){arg=url;value=_if.url}else if(_if.ext){arg=ext;value=_if.ext}else if(_if.main){arg=opt.is_main;value=_if.main}else continue;let cmp;switch(type){case"==":cmp=arg==value;break;case"!=":cmp=arg!=value;break;case"=~":cmp=arg.match(value);break;case"!~":cmp=!arg.match(value);break;case"=a":case"in":cmp=value.includes(arg);break;case"!a":case"not_in":cmp=!value.includes(arg);break;case"=o":cmp=!!value[arg];break;case"!o":cmp=!value[arg];break;default:continue}if(cmp){return this.handle_then(_if.then,url,host,do_redir,opt.exception,opt.orig_proxy)}if(_if["else"]){return this.handle_then(_if["else"],url,host,do_redir,opt.exception,opt.orig_proxy)}}return this.handle_then(cmd.then,url,host,do_redir,opt.exception,opt.orig_proxy)}set_rule(name,rule,cmd,hosts){let add=prop=>{if(!cmd[prop]||!hosts[prop])return;for(let i=0;i<cmd[prop].length;i++){let val=cmd[prop][i];hosts[prop][val]=(url,host,do_redir,opt)=>this.host_cb(prop,rule,cmd,url,host,do_redir,opt)}return true};let _cif=cmd["if"];if(_cif){for(let i=0;i<_cif.length;i++){let _if=_cif[i];if(_if.type=="=~"||_if.type=="!~"){if(_if.host)_if.host=new RegExp(_if.host);else if(_if.url)_if.url=new RegExp(_if.url);else if(_if.ext)_if.ext=new RegExp(_if.ext)}}}if(!cmd.hosts){if(add("root_urls"))return;if(add("src_country"))return;if(add("proxy_country"))return;hosts.hosts["*"]=(url,host,do_redir,opt)=>this.host_cb(name,rule,cmd,url,host,do_redir,opt);return}for(let i=0;i<cmd.hosts.length;i++){let _host=cmd.hosts[i],n;if(n=_host.match(regex_ip2)){if(!cmd.ips)cmd.ips=[];let bits=32-(n[4]?+n[4]:32);if(bits<0)bits=0;let mask=zurl.ip2num(n[1])>>>bits<<bits;hosts.ips.push({mask,bits,func:(url,host,do_redir,exception)=>this.host_cb(name,rule,cmd,url,host,do_redir,exception)});continue}hosts.hosts[_host]=(url,host,do_redir,opt)=>this.host_cb(name,rule,cmd,url,host,do_redir,opt)}}parse_cmds(name,rule,rules,exceptions,by_rules){let cmds=rule.cmds;if(!cmds)return;for(let i=0;i<cmds.length;i++){let cmd=cmds[i];if(cmd.rule){let _name=cmd.rule;return this.parse_cmds(_name,rules[_name],rules,exceptions)}if(!cmd.hosts&&!by_rules&&!cmd.root_urls&&!cmd.src_country&&!cmd.proxy_country||!cmd.then){continue}this.set_rule(name,rule,cmd,exceptions)}}parse_match(name,rule,exceptions){let match=rule.match;if(!match||!match.rules||!match.root_urls)return;let res=[];for(let r of match.rules){let ex=new Proxy_exceptions;res.push(ex);this.parse_cmds(name,r,match,ex);ex.fsrc_country=r.src_country;ex.fproxy_country=r.proxy_country}match.root_urls.forEach((function(root_url){exceptions.match_root_url[root_url]=res}))}push(bw_rule,req){let acc=this.data[bw_rule.id];if(acc&&acc.rule!=req.opt.rule)this._send(bw_rule,acc);acc=this.data[bw_rule.id]=this.data[bw_rule.id]||{len:0,ms:0,rule:req.opt.rule};acc.len+=+req.proxy_resp.len;acc.ms+=Date.now()-req.start_ts;if(acc.len>(bw_rule.sample_size||10*1024*1024))this._send(bw_rule,acc)}get_global_rules(rules,is_plus){if(!rules)return{};const rules_map={};const add_host_rule=({rule,host,then})=>{const hosts_map=rules_map[rule.name];const country=rule.country.toUpperCase();then=then.replace(/\bXX\b/,country);let m=then.match(/PROXY ([A-Z]{2})/);if(m&&m[1]!=country)return;hosts_map[host]=then};const proxy_rules=Object.entries(is_plus?this.proxy_rules.plus:this.proxy_rules.free).sort(((a,b)=>{if(!a[1].match&&b[1].match)return-1;if(a[1].match&&!b[1].match)return 1;return a[0].localeCompare(b[0])})).map((a=>a[1]));for(const rule of rules){const is_all_browser=rule.name=="all_browser";rules_map[rule.name]={default:is_all_browser?`PROXY ${rule.country.toUpperCase()}`:"DIRECT"};const root_url=rule.name;const proxy_country=rule.country.toUpperCase();const country_match=countries=>!Array.isArray(countries)||countries.includes(proxy_country);const root_url_match=root_urls=>is_all_browser||!Array.isArray(root_urls)||root_urls.includes(root_url);for(let proxy_rule of proxy_rules){let subrules=zutil.get(proxy_rule,"match.rules");if(!root_url_match(zutil.get(proxy_rule,"match.root_urls")))continue;if(!Array.isArray(subrules))subrules=[proxy_rule];for(let sub_proxy_rule of subrules){if(!sub_proxy_rule||!Array.isArray(sub_proxy_rule.cmds))continue;if(!country_match(sub_proxy_rule.proxy_country))continue;for(let cmd of sub_proxy_rule.cmds){let hosts=cmd.hosts||cmd.root_urls;if(!country_match(cmd.proxy_country)||!hosts||!hosts.length||!root_url_match(cmd.root_urls)){continue}for(let host of hosts)add_host_rule({rule,host,then:cmd.then})}}}}return rules_map}}function c_unittest_push(ctx_id,roles,req,req_id,roles_id){if(arguments.length==2){req=roles;roles=null}let c;if(!(c=get_ctx(ctx_id)))return;if(!roles)return void c.unittest.push({s:req,req_id});roles_id=roles_id||++c.ids[roles];c.unittest.push({s:roles+roles_id+req,req_id,roles_id})}function on_not_working(id,e){let c;if(gen_auto_unittest()&&(c=get_ctx(id)))e.unittest=c.unittest.map((u=>u.s)).slice(0,300);api.perr({id:"be_not_working_trigger",info:e,rate_limit:{count:5,ms:date.ms.MIN}},true)}function unittest_req_by_route(routes,roles,req){if(!gen_auto_unittest())return;try{if(!Array.isArray(routes))routes=[routes];let req_id=gen_stamp();ctx.forEach((c=>{if(c.routes.some((r=>routes.includes(r))))c_unittest_push(c.id,roles,req,req_id)}));return req_id}catch(e){console.error(e)}}function unittest_resp_by_route(route,roles,resp,req_id){if(!gen_auto_unittest())return;try{ctx.forEach((c=>{if(!c.routes.includes(route))return;let req=c.unittest.find((u=>u.req_id==req_id));if(req)c_unittest_push(c.id,roles,resp,req_id,req.roles_id)}))}catch(e){console.error(e)}}function unittest_set_rule(opt){if(!gen_auto_unittest())return;try{c_unittest_push(opt.tab_id,"set_rule("+JSON.stringify(opt)+")")}catch(e){console.error(e)}}function gen_auto_unittest(){let conf=CG("auto_unittest",{});return conf&&conf.enable&&ext_ver()&&version_util.cmp(ext_ver(),conf.min_ver||"0.0.0")>=0&&E.is_conf_allowed(conf.on||100)}function get_conf(root,name,def){let conf=CG(root);if(conf&&conf.min_ver&&product_ver()&&version_util.cmp(product_ver(),conf.min_ver)>=0&&E.is_conf_allowed(conf.on||100)){return zutil.get(conf,name,def)}return def}let get_verify_conf=(name,def)=>get_conf("verify_proxy",name,def);let get_proxy_auth_conf=(name,def)=>get_conf("proxy_auth",name,def);let rules;let init_rules=()=>etask((function*init_rules_(){rules=yield api.storage.get("rules");if(!rules){rules={ver:ext_ver()};commit_rules()}if(rules.set)gen_rules(rules.set);if(zutil.is_mocha())E.t.rules=rules;E.emit("local_rules_set",rules.set)}));if(zutil.is_mocha()){E.t={Cache_entry,choose_strategy,expected_types,extensions,strategies,Agents,get_api:()=>api,ConnectivityCheck,find_agents:E.find_agents,rules_fixup,rules,Proxy_rules_engine}}return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},843:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){const is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(4996),__webpack_require__(1291),__webpack_require__(5305),__webpack_require__(6262)],__WEBPACK_AMD_DEFINE_RESULT__=function(sprintf,zutil,zurl,version_util){const E={};const assign=Object.assign;E.get_root_domain=zurl.get_root_domain;E.get_root_url=url=>{if(url=="chrome://newtab/")return"newtab";const n=(url||"").match(/^https?:\/\/([^\/]+)(\/.*)?$/);if(!n||!n[1])return null;return E.get_root_domain(n[1])};E.find_rule=(rules,opt)=>{if(!rules)return;for(let i in rules){const r=rules[i];if(opt.name==r.name&&(opt.type===undefined||opt.type==r.type)&&(opt.md5===undefined||opt.md5==r.md5)&&(opt.country===undefined||opt.country.toLowerCase()==r.country.toLowerCase())){return r}}return null};E.gen_route_str=(route_opt,opt)=>{opt=opt||{};if(route_opt.direct)return"direct";let s=route_opt.country.toLowerCase(),r=[];if(route_opt.peer)r.push("peer");if(route_opt.pool){r.push("pool"+(typeof route_opt.pool=="string"?"_"+route_opt.pool:""))}if(!opt.no_algo&&route_opt.algo)r.push(route_opt.algo);if(r.length)s+="."+r.join(",");return s};function ip_list_to_agents(ip_list){return fix_zagent(Object.keys(ip_list).join(","))}function fix_zagent(s){return s.replace(/.hola.org/g,"").replace(/zagent/g,"za")}function pad(num,size){return("000"+num).slice(-size)}function time_str(d){d=new Date(d);if(isNaN(d))return"00:00:00.000";return pad(d.getUTCHours(),2)+":"+pad(d.getUTCMinutes(),2)+":"+pad(d.getUTCSeconds(),2)+"."+pad(d.getUTCMilliseconds(),3)}E.events_enabled=false;E.events=[];E.events_n={};E.reset_events=()=>{E.events=[];E.events_n={}};E.push_event=(name,opt)=>{try{if(!E.events_enabled)return;if(E.events.length>512)E.events.splice(0,E.events.length/2);E.events.push({name,ts:Date.now(),opt});E.events_n[name]=(E.events_n[name]||0)+1}catch(err){console.error("push_event error %s",err&&err.stack)}};E.enable_events_logging=enabled=>{E.events_enabled=!!enabled;if(!enabled)E.reset_events()};E.get_event_n=e=>E.events_n[e];E.events_to_str=()=>{let s="",a=[];E.events.forEach((e=>{let s=time_str(e.ts)+" "+e.name,o=e.opt;switch(e.name){case">zgettunnels":s+=sprintf(" %s%s",o.country,(o.exclude||[]).length?" exclude "+o.exclude.map((e=>fix_zagent(e))).join(","):"");break;case"<zgettunnels":s+=sprintf(" %s%s",o.country," agents "+ip_list_to_agents(o.ip_list));break;case"set_rule":s+=sprintf(" %s%s%s%s%s",o.name,o.enabled?" "+o.country:" off",o.del?" del":"",o.src?" src "+o.src:"",!o.full_vpn?" !full_vpn":"",o.mode=="unblock"?"":" mode "+o.mode);break;case"<verify_err":s+=sprintf(" %s %s",o.host?fix_zagent(o.host):o.ip," "+o.err);break;case"<verify":s+=sprintf(" %s %s",o.host?fix_zagent(o.host):o.ip,o.rtt?o.rtt+"ms":"!rtt");break;case">verify":s+=sprintf(" %s",o.host?fix_zagent(o.host):o.ip);break;case">stuck":case">stuck_long":break;case"<stuck_end":s+=sprintf(" %sms",o.duration);break;case"pac_miss":s+=sprintf(" %s!=%s %s",o.req_ip,o.agent_ip,o.url);break;case"pac_reload":s+=sprintf(" after %ssec",(o.new_ts-o.init_ts)/1e3);break;case"navgiate":s+=sprintf(" tab %s %s",o.tab_id,o.url);break;case"popup_render":case"tpopup_render":break;case"pac_slow":s+=sprintf(" %dms %s",o.dur,(o.url||"").substr(0,50));break;default:s+=JSON.stringify(o)||"";break}a.push(s)}));a=a.reverse();return a.join("\n")};class Domain_tree{constructor(){this.clear()}*[Symbol.iterator](){let parts=[];for(let item of Domain_tree.iterate_subtree(parts,this.tree))yield item}clear(){this.tree={}}get_value(domain){if(!domain)return;let parts=domain.split(".");let leaf=this.tree,value=leaf[Domain_tree.VALUE];for(let i=parts.length-1;leaf&&i>=0;i--){leaf=leaf[parts[i]];value=leaf&&Domain_tree.VALUE in leaf?leaf[Domain_tree.VALUE]:value}return value}set_value(domain,value){if(!domain)return void(this.tree[Domain_tree.VALUE]=value);let parts=domain.split(".");let leaf=this.tree;for(let i=parts.length-1;i>=0;i--)leaf=leaf[parts[i]]=leaf[parts[i]]||{};leaf[Domain_tree.VALUE]=value}}Domain_tree.VALUE=Symbol.for("value");Domain_tree.iterate_subtree=function*(parts,leaf){if(Domain_tree.VALUE in leaf)yield[parts.slice().reverse().join("."),leaf[Domain_tree.VALUE]];for(let key in leaf){parts.push(key);for(let item of Domain_tree.iterate_subtree(parts,leaf[key]))yield item;parts.pop()}};E.Domain_tree=Domain_tree;E.get_site_key=(conf,ext_opt,root_url)=>{let{ext_ver}=ext_opt;let sites=conf&&conf.sites||{};return Object.keys(sites).find((k=>{let v=sites[k];let urls=Array.isArray(v.root_url)?v.root_url:[v.root_url];return urls.includes(root_url)&&E.check_min_ver(ext_ver,v.min_ver)}))};const get_match_fn=operator=>{if(operator=="gt")return(a,b)=>a>b;if(operator=="gte")return(a,b)=>a>=b;if(operator=="lt")return(a,b)=>a<b;if(operator=="lte")return(a,b)=>a<=b;if(operator=="re")return(a,b)=>new RegExp(b).test(a);if(operator=="in"||operator=="nin"){return(a,b)=>{let found;if(!Array.isArray(b))return false;if(!Array.isArray(a))found=b.includes(a);else found=b.some((i=>a.includes(i)));return operator=="in"?found:!found}}if(operator=="eq"||operator=="neq"){return(a,b)=>{let equal;if(!Array.isArray(a))equal=a==b;else if(!Array.isArray(b))equal=a.includes(b);else equal=b.every((i=>a.includes(i)));return operator=="eq"?equal:!equal}}return(a,b)=>false};E.match_filter=(query,filter)=>{if(!filter)return true;if(!query)return false;query=assign({},query);for(let key in query){if(key.endsWith("_ts")&&query.now)query["since_"+key]=query.now-query[key]}for(let f_key in filter){if(!f_key)continue;let m=f_key.match(/^(.*)_(gt|gte|lt|lte|in|nin|re|eq|neq)$/);let q_key=m?m[1]:f_key;let operator=m?m[2]:"eq";if(operator=="in"&&!Array.isArray(filter[f_key])||operator=="nin"&&!Array.isArray(filter[f_key])){q_key=f_key;operator="eq"}let op1,op2;if(q_key.endsWith("_ver")&&/(gt|gte|lt|lte|eq|neq)/.test(operator)){op1=version_util.cmp(query[q_key],filter[f_key]);op2=0}else{op1=query[q_key];op2=filter[f_key]}if(!get_match_fn(operator)(op1,op2))return false}return true};const apply_conf_override=(site_conf,ext_opt)=>{let{ext_ver,install_ver,install_ts}=ext_opt;let{override}=site_conf;site_conf=zutil.omit(site_conf,["override"]);if(!override)return site_conf;let versions=Object.keys(override).sort(((a,b)=>-version_util.cmp(a,b)));let ver=versions.find((v=>E.check_min_ver(ext_ver,v)&&E.check_min_install_ver(install_ver,override[v].install_min_ver)&&E.check_min_install_ts(install_ts,override[v].install_min_ts)));if(ver){site_conf=zutil.extend_deep(zutil.clone_deep(site_conf),zutil.omit(override[ver],["install_min_ver","install_min_ts"]))}return site_conf};const apply_trial_conf_override=(tconf,ext_opt)=>{let{override}=tconf;tconf=zutil.omit(tconf,["override"]);if(!override||!ext_opt)return tconf;let{ext_ver,trial_state,now}=ext_opt;let first_start_ts=trial_state&&trial_state.first_start_ts;if(!first_start_ts||!now||version_util.cmp(ext_ver,"1.174.712")<0)return tconf;let match_opt=assign({first_start_ts},ext_opt);delete match_opt.trial_state;match_opt.first_start=now-first_start_ts;let ov=override.slice().reverse().find((o=>E.match_filter(match_opt,o.filter)));if(ov)tconf=zutil.extend_deep(zutil.clone_deep(tconf),ov.conf);return tconf};E.get_all_sites_conf=(conf,ext_opt)=>{let{ext_ver,install_ver,install_ts}=ext_opt;let c=conf&&conf.sites_default||{};if(!E.check_min_ver(ext_ver,c.min_ver)||!E.check_min_install_ver(install_ver,c.install_min_ver)||!E.check_min_install_ts(install_ts,c.install_min_ts)){return}return apply_conf_override(c,ext_opt)};E.get_specific_site_conf=(conf,ext_opt,root_url)=>{let site_conf=zutil.get(conf&&conf.sites,E.get_site_key(conf,ext_opt,root_url));if(site_conf)site_conf=apply_conf_override(site_conf,ext_opt);return site_conf};E.get_site_conf=(conf,ext_opt,root_url,path,def)=>{let site_conf=root_url&&E.get_specific_site_conf(conf,ext_opt,root_url)||E.get_all_sites_conf(conf,ext_opt);return path?zutil.get(site_conf,path,def):site_conf};E.get_trial_conf=(conf,ext_opt,root_url,path,def)=>{let{ext_ver}=ext_opt;let tconf=E.get_site_conf(conf,ext_opt,root_url,"trial");if(!tconf)return;let def_trial=zutil.get(E.get_all_sites_conf(conf,ext_opt),"trial");if(tconf.all_sites_timer&&!def_trial)tconf=zutil.omit(tconf,["all_sites_timer"]);if(tconf.all_sites_timer&&def_trial)tconf=assign({},tconf,zutil.omit(def_trial,["skip_signin"]));tconf=apply_trial_conf_override(tconf,ext_opt);let{time_ended_bonus}=tconf;if(time_ended_bonus&&!E.check_min_ver(ext_ver,time_ended_bonus.min_ver)){tconf=zutil.omit(tconf,["time_ended_bonus"])}return path?zutil.get(tconf,path,def):tconf};E.check_min_ver=(ext_ver,min_ver)=>version_util.valid(min_ver)&&version_util.cmp(ext_ver,min_ver)>=0;E.check_min_install_ver=(install_ver,min_ver)=>!min_ver||version_util.valid(min_ver)&&version_util.cmp(install_ver,min_ver)>=0;E.check_min_install_ts=(install_ts,ts)=>!ts||+install_ts>=+ts;return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},6069:(module,exports)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){var E={};function dnsResolve(host){return null}E.dnsDomainIs=function(host,domain){return host.length>=domain.length&&host.substring(host.length-domain.length)==domain};E.dnsDomainLevels=function(host){return host.split(".").length-1};E.convert_addr=convert_addr;function convert_addr(ipchars){var bytes=ipchars.split(".");var result=(bytes[0]&255)<<24|(bytes[1]&255)<<16|(bytes[2]&255)<<8|bytes[3]&255;return result>>>0}E.isInNet=function(ipaddr,pattern,maskstr){var test=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/.exec(ipaddr);if(test==null){ipaddr=dnsResolve(ipaddr);if(ipaddr==null)return false}else if(test[1]>255||test[2]>255||test[3]>255||test[4]>255)return false;var host=convert_addr(ipaddr);var pat=convert_addr(pattern);var mask=convert_addr(maskstr);return(host&mask)==(pat&mask)};E.isPlainHostName=function(host){return!host.includes(".")};E.isResolvable=function(host){var ip=dnsResolve(host);return ip!=null};E.localHostOrDomainIs=function(host,hostdom){return host==hostdom||hostdom.lastIndexOf(host+".",0)==0};E.shExpMatch=function(url,pattern){pattern=pattern.replace(/\./g,"\\.").replace(/\*/g,".*").replace(/\?/g,".");var newRe=new RegExp("^"+pattern+"$");return newRe.test(url)};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},3787:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var hash,assert,zerr,vm;var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node){assert=function(){};if(self.hola&&self.hola.zerr)zerr=self.hola.zerr;else{zerr=function(){console.log.apply(console,arguments)};zerr.perr=zerr}}else{require("./config.js");zerr=require("./zerr.js");hash=require("crypto");assert=require("assert");vm=require("vm")}!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1291)],__WEBPACK_AMD_DEFINE_RESULT__=function(zutil){var E={};var has_map=typeof Map=="function"&&Map.prototype.get&&Map.prototype.set;has_map=0;E.cache_str_map_fn=function(fn){var cache=new Map;return function(s){s=""+s;var v=cache.get(s);if(v!==undefined||cache.has(s))return v;cache.set(s,v=fn(s));return v}};E.cache_str_obj_fn=function(fn){var cache={};return function(s){if(s in cache)return cache[s];return cache[s]=fn(s)}};E.cache_str_fn=has_map?E.cache_str_map_fn:E.cache_str_obj_fn;E.cache_str_fn2=function(fn){var cache={};return function(s1,s2){var cache2=cache[s1]=cache[s1]||{};if(s2 in cache2)return cache2[s2];return cache2[s2]=fn(s1,s2)}};E.o=function(oct_str){return parseInt(oct_str,8)};E.md5=function(buf,hash_len,encoding){return hash.createHash("md5").update(buf,encoding||"utf8").digest("hex").slice(0,hash_len)};E.md5_zero=function(key,hash_len){assert(hash_len<=32,"invalid hash len"+hash_len);if(!key||!key.length)return"0".repeat(hash_len);return E.md5(key,hash_len)};E.md5_etag=function(buf){return E.md5(buf,8)};E.inet_ntoa_t=function(ip){return((ip&4278190080)>>>24)+"."+((ip&16711680)>>>16)+"."+((ip&65280)>>>8)+"."+(ip&255)};E.inet_addr=function(ip){var code,res=0,shift=24,num=undefined;ip=""+ip;for(var i=0,l=ip.length;i<l;++i){code=ip.charCodeAt(i);if(code>47&&code<58){num=(num||0)*10+code-48;continue}if(code==46){if(num==undefined||num>255)return null;res+=num<<shift;num=undefined;shift-=8;continue}return null}return shift==0&&num!=undefined&&num<256?res+(num|0)>>>0:null};function flags_to_str_once(flags,conv){var f='var s = "";\n';f+='if (!flags) return "";\n';for(var i in conv){if(!conv.hasOwnProperty(i))continue;f+="if (flags & "+conv[i]+") "+"{ s += "+JSON.stringify(i.toLowerCase())+'+" ";'+" flags &= ~"+conv[i]+"; }\n"}f+="if (flags && conv.__conv_to_str.err) "+"conv.__conv_to_str.err(flags, conv);\n";f+="return s.slice(0, -1);\n";var func=new Function(["flags","conv"],f);Object.defineProperty(conv,"__conv_to_str",{enumerable:false,writable:true});conv.__conv_to_str=func;func.err=function(_flags,_conv){zerr.perr("flags_str_invalid","flags "+_flags+" "+JSON.stringify(_conv).slice(0,30))};return conv.__conv_to_str(flags,conv)}E.flags_to_str=function(flags,conv){if(conv.__conv_to_str)return conv.__conv_to_str(flags,conv);return flags_to_str_once(flags,conv)};function flags_from_str_once(s,conv){var f="var flags = 0, a, i;\n";f+="if (!s) return 0;\n";f+="s = s.toUpperCase();\n";f+='a = s.split(",");\n';f+="for (i=0; i<a.length; i++)\n";f+="{\n";f+="    if (!conv[a[i]])\n";f+="    {\n";f+="        if (flags && conv.__conv_from_str.err) "+"conv.__conv_from_str.err(flags, conv);\n";f+="        return -1;\n";f+="    }\n";f+="    flags |= conv[a[i]];\n";f+="}\n";f+="return flags;\n";var func=new Function(["s","conv"],f);Object.defineProperty(conv,"__conv_from_str",{enumerable:false,writable:true});conv.__conv_from_str=func;func.err=function(_s,_conv){zerr.perr("flags_str_invalid","flags "+_s+" "+JSON.stringify(_conv).slice(0,30))};return conv.__conv_from_str(s,conv)}E.flags_from_str=function(s,conv){if(conv.__conv_from_str)return conv.__conv_from_str(s,conv);return flags_from_str_once(s,conv)};E.scale_vals={1e3:[{s:"",n:1},{s:"K",n:1e3},{s:"M",n:1e6},{s:"G",n:1e9},{s:"T",n:1e12},{s:"P",n:1e15}],1024:[{s:"",n:1},{s:"K",n:1024},{s:"M",n:Math.pow(1024,2)},{s:"G",n:Math.pow(1024,3)},{s:"T",n:Math.pow(1024,4)},{s:"P",n:Math.pow(1024,5)}]};function apply_scale(num,opt){opt=opt||{};var per=opt.per,scale=opt.scale;var base=opt.base==1024?1024:1e3,ratio=opt.ratio||1;var scale_vals=E.scale_vals[base],i=0;if(num<0)num=-num;if(scale==null)for(;i<scale_vals.length-1&&num>=scale_vals[i+1].n*ratio;i++);else i=scale_vals.findIndex((function(_scale){return _scale.s==scale}));if(per=="ms"&&i){per="s";i--;num=num/1e3}return{num,per,base,scale:scale_vals[i]}}E.get_unscaled=function(str,opt){opt=opt||{};var match=/(\d+)(\S)?/.exec(str);if(!match)return;var num=+match[1],scale=(match[2]||"").toUpperCase();if(!scale)return num;var base=opt.base==1024?1024:1e3;var scale_vals=E.scale_vals[base],i=0;for(;i<scale_vals.length;i++){if(scale_vals[i].s==scale)return num*scale_vals[i].n}};E.get_unit=function(num,opt){var res=apply_scale(num,opt);return res.scale.s+(res.per?E.fmt_per(res.per):"")};E.scaled_number=function(num,opt){opt=opt||{};var sign="";var unit=opt.unit===undefined||opt.unit;if(num<0){sign="-";num=-num}if(num===undefined)return"";if(isNaN(num))return opt.nan||"x";if(num==Infinity)return sign+"∞";var res=apply_scale(num,opt);var _per=unit&&res.per?E.fmt_per(res.per):"";num=res.num;if(opt.is_scale)return res.scale.n;num/=res.scale.n;if(num<.001)return"0"+_per;if(num>=res.base-1)num=Math.trunc(num);var str=num.toFixed(num<1?3:num<10?2:num<100?1:0);return sign+str.replace(/((\.\d*[1-9])|\.)0*$/,"$2")+(unit?(opt.space?" ":"")+res.scale.s:"")+_per};E.scaled_bytes=function(num,opt){return E.scaled_number(num,Object.assign({base:1e3},opt))};E.fmt_currency=function(amount,digits,currency_sign){if(amount===undefined)return;if(digits===undefined)digits=2;if(currency_sign===undefined)currency_sign="$";var sign=amount<0?"-":"";amount=Math.abs(amount);amount=(+amount).toLocaleString("en-GB",{useGrouping:true,maximumFractionDigits:digits})||amount;return sign+currency_sign+amount};E.fmt_per=function(per){if(!per)return"";switch(per){case"s":case"ms":return per;case"%":case"%%":return"%";default:return"/"+per[0]}};E.parse_function=function(f){var m=/^function\s*([\w$]+)?\s*\(\n?([\s\w$,]*?)(\s*\/\*`*\*\/)?\)\s*\{\n?([\s\S]*?)\n?\}$/.exec(f);return{name:m[1]||null,args:m[2]?m[2].split(/\s*,\s*/):[],body:m[4]}};function date_stringify(d){return{__ISODate__:d.toISOString()}}var pos_inf={__Infinity__:1};var neg_inf={__Infinity__:-1};function replace_inf(k,v){switch(v){case Infinity:return pos_inf;case-Infinity:return neg_inf;default:return v}}E.JSON_stringify=function(obj,opt){var s,prev_date,_date,prev_func,prev_re;var date_class,func_class,re_class;opt=opt||{};if(opt.date)_date=typeof opt.date=="function"?opt.date:date_stringify;if(opt.mongo)_date=date_stringify;if(_date){date_class=opt.vm_context?vm.runInContext("Date",opt.vm_context):Date;prev_date=date_class.prototype.toJSON;date_class.prototype.toJSON=function(){return _date(this)}}if(opt.func){func_class=opt.vm_context?vm.runInContext("Function",opt.vm_context):Function;prev_func=func_class.prototype.toJSON;func_class.prototype.toJSON=function(){return{__Function__:this.toString()}}}if(opt.re){re_class=opt.vm_context?vm.runInContext("RegExp",opt.vm_context):RegExp;prev_re=re_class.prototype.toJSON;Object.defineProperty(re_class.prototype,"toJSON",{value:function(){return{__RegExp__:this.toString()}},writable:true})}var opt_replacer=opt.replacer;var replacer=opt_replacer;if(opt.inf){if(opt_replacer&&typeof opt_replacer=="function"){replacer=function(k,v){if(this==pos_inf||this==neg_inf)return v;return opt_replacer.call(this,k,replace_inf.call(this,k,v))}}else if(opt_replacer&&Array.isArray(opt_replacer)){replacer=function(k,v){if(v==obj||this==pos_inf||this==neg_inf)return v;if(opt_replacer.includes(k))return replace_inf.call(this,k,v)}}else replacer=replace_inf}try{s=JSON.stringify(obj,replacer,opt.spaces)}finally{if(_date)date_class.prototype.toJSON=prev_date;if(opt.func)func_class.prototype.toJSON=prev_func;if(opt.re)re_class.prototype.toJSON=prev_re}if(opt.mongo)s=s.replace(/\{"__ISODate__":("[0-9TZ:.-]+")\}/g,"ISODate($1)");return s};function parse_leaf(v,opt){if(!v||typeof v!="object"||Object.keys(v).length!=1)return v;if(v.__ISODate__&&opt.date)return new Date(v.__ISODate__);if(v.__Function__&&opt.func){if(vm)return vm.runInThisContext('"use strict";('+v.__Function__+")");return new Function("",'"use strict";return ('+v.__Function__+");")()}if(v.__RegExp__&&opt.re){var parsed=/^\/(.*)\/(\w*)$/.exec(v.__RegExp__);if(!parsed)throw new Error("failed parsing regexp");return new RegExp(parsed[1],parsed[2])}if(v.__Infinity__&&opt.inf)return v.__Infinity__<0?-Infinity:Infinity;if(v.__ObjectId__&&typeof opt.object_id=="function")return opt.object_id(v.__ObjectId__);return v}function parse_obj(v,opt){if(!v||typeof v!="object")return v;if(Array.isArray(v)){for(var i=0;i<v.length;i++)v[i]=parse_obj(v[i],opt);return v}var v2=parse_leaf(v,opt);if(v2!==v)return v2;for(var key in v)v[key]=parse_obj(v[key],opt);return v}E.JSON_parse=function(s,opt){opt=Object.assign({date:true,re:true,inf:true},opt,{func:false});return JSON.parse(s,(function(k,v){return parse_leaf(v,opt)}))};E.JSON_parse_obj=function(v,opt){opt=Object.assign({date:true,re:true,inf:true},opt,{func:false});return parse_obj(v,opt)};E.JSON_parse_unsafe=function(s,opt){opt=Object.assign({date:true,re:true,func:true,inf:true},opt);return JSON.parse(s,(function(k,v){return parse_leaf(v,opt)}))};E.JSON_parse_obj_unsafe=function(v,opt){opt=Object.assign({date:true,re:true,func:true,inf:true},opt);return parse_obj(v,opt)};E.hex2bin=function(hex,opt){var byte_array=opt&&opt.byte_array;var bin=byte_array?new Uint8Array:[];var re=/('.)|([0-9a-f][0-9a-f]?)|\s+|[.-]|(.)/gi;var m,v;for(re.lastIndex=0;m=re.exec(hex);){if(m[1])v=m[1].charCodeAt(1);else if(m[2])v=parseInt(m[2],16);else if(m[3])return null;else continue;bin.push(v)}return bin};E.bin2hex=function(arr){var s="",v,i;for(i=0;i<arr.length;i++){v=(arr[i]&255).toString(16).toUpperCase();s+=(v.length<2?"0":"")+v+" "}return s.trim()};E.str2bin=function(s,offset){var len;if(!s||!(len=s.length))return;offset=offset||0;var arr=new Uint8Array(len-offset);for(var i=offset,j=0;i<len;i++,j++)arr[j]=s.charCodeAt(i);return arr};E.tab2sp=function(line){var added=0;return line.replace(/\t/g,(function(m,offset,str){var insert=8-(added+offset)%8;added+=insert-1;return" ".repeat(insert)}))};E.str2utf8bin=function(s){if(!s||!s.length)return;var arr=new Uint8Array(s.length*3);var len=s.length,i=0,j=0,c,extra;while(i<len){c=s.charCodeAt(i++);if(c>=55296&&c<=56319&&i<len){extra=s.charCodeAt(i++);if((extra&64512)==56320)c=((c&1023)<<10)+(extra&1023)+65536;else i--}if((c&4294967168)==0)arr[j++]=c;else{if((c&4294965248)==0)arr[j++]=c>>6&31|192;else if((c&4294901760)==0){arr[j++]=c>>12&15|224;arr[j++]=c>>6&63|128}else if((c&4292870144)==0){arr[j++]=c>>18&7|240;arr[j++]=c>>12&63|128;arr[j++]=c>>6&63|128}arr[j++]=c&63|128}}return arr.slice(0,j)};E.utf8bin2str=function(arr,offset,len){if(arr.byteLength&&!arr.length)arr=new Uint8Array(arr);var out="",i=offset||0,cp;var c,char2,char3,char4;len=len?i+len:arr.length;while(i<len){c=arr[i++];switch(c>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:out+=String.fromCharCode(c);break;case 12:case 13:char2=arr[i++];out+=String.fromCharCode((c&31)<<6|char2&63);break;case 14:char2=arr[i++];char3=arr[i++];out+=String.fromCharCode((c&15)<<12|(char2&63)<<6|(char3&63)<<0);break;case 15:char2=arr[i++];char3=arr[i++];char4=arr[i++];cp=(c&3)<<18|(char2&63)<<12|(char3&63)<<6|char4&63;cp-=65536;out+=String.fromCharCode(55296|cp>>10);out+=String.fromCharCode(56320|cp&1023);break}}return out};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},2569:(module,exports)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){var E={};E.list={AF:"Afghanistan",AL:"Albania",DZ:"Algeria",AX:"Aland Islands",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",JE:"Bailiwick of Jersey",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BQ:"Bonaire (Caribbean Netherlands)",BA:"Bosnia And Herzegovina",BW:"Botswana",BR:"Brazil",BN:"Brunei",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire (Ivory Coast)",HR:"Croatia (Hrvatska)",CU:"Cuba",CW:"Curacao",CY:"Cyprus",CZ:"Czech Republic",CD:"Democratic Republic Of Congo (Zaire)",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EU:"European Union",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GB:"Great Britain",GR:"Greece",GL:"Greenland",GD:"Grenada",GU:"Guam",GP:"Guadeloupe",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",XK:"Kosovo",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Laos",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macau",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar (Burma)",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",KP:"North Korea",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Réunion",RO:"Romania",RU:"Russia",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",VC:"Saint Vincent And The Grenadines",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten (Dutch part)",SK:"Slovak Republic",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And South Sandwich Islands",KR:"South Korea",SS:"South Sudan",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syria",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",UK:"United Kingdom",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VA:"Vatican City (Holy See)",VE:"Venezuela",VN:"Vietnam",VG:"Virgin Islands (British)",VI:"Virgin Islands (US)",WF:"Wallis And Futuna Islands",EH:"Western Sahara",WS:"Western Samoa",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"};E.iso_list={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:["Bosnia And Herzegovina","Bosnia and Herzegovina"],BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:["Cape Verde","Cabo Verde"],CW:"Curacao",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:["Cote D'Ivoire","Côte d'Ivoire"],HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:["Iran, Islamic Republic Of","Iran, Islamic Republic of"],IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:["Korea","Korea, Republic of","Republic of Korea"],KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States Of",MD:"Moldova, Republic of",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:["Palestinian Territory, Occupied","Palestine"],PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:["United Kingdom","Great Britain"],US:"United States",UM:["United States Outlying Islands","United States Minor Outlying Islands"],UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:["Viet Nam","Vietnam"],VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"};E.adj_list={AF:{name:"Afghanistan",adj:"Afghan"},AX:{name:"Åland Islands",adj:"Åland Island"},AL:{name:"Albania",adj:"Albanian"},DZ:{name:"Algeria",adj:"Algerian"},AS:{name:"American Samoa",adj:"American Samoan"},AD:{name:"Andorra",adj:"Andorran"},AO:{name:"Angola",adj:"Angolan"},AI:{name:"Anguilla",adj:"Anguillan"},AG:{name:"Antigua and Barbuda",adj:"Antiguan"},AR:{name:"Argentina",adj:"Argentinian"},AM:{name:"Armenia",adj:"Armenian"},AW:{name:"Aruba",adj:"Aruban"},AU:{name:"Australia",adj:"Australian"},AT:{name:"Austria",adj:"Austrian"},AZ:{name:"Azerbaijan",adj:"Azerbaijani"},BS:{name:"Bahamas",adj:"Bahamian"},BH:{name:"Bahrain",adj:"Bahraini"},BD:{name:"Bangladesh",adj:"Bengali"},BB:{name:"Barbados",adj:"Barbadian"},BY:{name:"Belarus",adj:"Belarusian"},BE:{name:"Belgium",adj:"Belgian"},BZ:{name:"Belize",adj:"Belizean"},BJ:{name:"Benin",adj:"Beninese"},BM:{name:"Bermuda",adj:"Bermudan"},BT:{name:"Bhutan",adj:"Bhutanese"},BO:{name:"Bolivia",adj:"Bolivian"},BA:{name:"Bosnia and Herzegovina",adj:"Bosnian"},BW:{name:"Botswana",adj:"Botswanan"},BR:{name:"Brazil",adj:"Brazilian"},BN:{name:"Brunei",adj:"Bruneian"},BG:{name:"Bulgaria",adj:"Bulgarian"},BF:{name:"Burkina Faso",adj:"Burkinabé"},BI:{name:"Burundi",adj:"Burundian"},CV:{name:"Cabo Verde",adj:"Cabo Verdean"},KH:{name:"Cambodia",adj:"Cambodian"},CM:{name:"Cameroon",adj:"Cameroonian"},CA:{name:"Canada",adj:"Canadian"},KY:{name:"Cayman Islands",adj:"Caymanian"},TD:{name:"Chad",adj:"Chadian"},CL:{name:"Chile",adj:"Chilean"},CN:{name:"China",adj:"Chinese"},CX:{name:"Christmas Island",adj:"Christmas Island"},CO:{name:"Colombia",adj:"Colombian"},KM:{name:"Comoros",adj:"Comoran"},CG:{name:"Congo",adj:"Congolese"},CK:{name:"Cook Islands",adj:"Cook Island"},CR:{name:"Costa Rica",adj:"Costa Rican"},CI:{name:"Côte d'Ivoire",adj:"Ivorian"},HR:{name:"Croatia",adj:"Croatian"},CU:{name:"Cuba",adj:"Cuban"},CW:{name:"Curaçao",adj:"Curaçaoan"},CY:{name:"Cyprus",adj:"Cypriot"},CZ:{name:"Czech Republic",adj:"Czech"},DK:{name:"Denmark",adj:"Danish"},DJ:{name:"Djibouti",adj:"Djiboutian"},DM:{name:"Dominica",adj:"Dominican"},DO:{name:"Dominican Republic",adj:"Dominican"},EC:{name:"Ecuador",adj:"Ecuadorian"},EG:{name:"Egypt",adj:"Egyptian"},SV:{name:"El Salvador",adj:"Salvadoran"},GQ:{name:"Equatorial Guinea",adj:"Equatorial Guinean"},EE:{name:"Estonia",adj:"Estonian"},ET:{name:"Ethiopia",adj:"Ethiopian"},FO:{name:"Faroe Islands",adj:"Faroese"},FJ:{name:"Fiji",adj:"Fijian"},FI:{name:"Finland",adj:"Finnish"},FR:{name:"France",adj:"French"},PF:{name:"French Polynesia",adj:"French Polynesian"},GA:{name:"Gabon",adj:"Gabonese"},GM:{name:"Gambia",adj:"Gambian"},GE:{name:"Georgia",adj:"Georgian"},DE:{name:"Germany",adj:"German"},GH:{name:"Ghana",adj:"Ghanaian"},GI:{name:"Gibraltar",adj:"Gibraltar"},GR:{name:"Greece",adj:"Greek"},GL:{name:"Greenland",adj:"Greenlandic"},GD:{name:"Grenada",adj:"Grenadian"},GU:{name:"Guam",adj:"Guamanian"},GT:{name:"Guatemala",adj:"Guatemalan"},GG:{name:"Guernsey",adj:"Channel Island"},GN:{name:"Guinea",adj:"Guinean"},GW:{name:"Guinea-Bissau",adj:"Bissau-Guinean"},GY:{name:"Guyana",adj:"Guyanese"},HT:{name:"Haiti",adj:"Haitian"},HN:{name:"Honduras",adj:"Honduran"},HK:{name:"Hong Kong",adj:"Hong Kong"},HU:{name:"Hungary",adj:"Hungarian"},IS:{name:"Iceland",adj:"Icelandic"},IN:{name:"India",adj:"Indian"},ID:{name:"Indonesia",adj:"Indonesian"},IR:{name:"Iran",adj:"Iranian"},IQ:{name:"Iraq",adj:"Iraqi"},IE:{name:"Ireland",adj:"Irish"},IM:{name:"Isle of Man",adj:"Manx"},IL:{name:"Israel",adj:"Israeli"},IT:{name:"Italy",adj:"Italian"},JM:{name:"Jamaica",adj:"Jamaican"},JP:{name:"Japan",adj:"Japanese"},JE:{name:"Jersey",adj:"Channel Island"},JO:{name:"Jordan",adj:"Jordanian"},KZ:{name:"Kazakhstan",adj:"Kazakhstani"},KE:{name:"Kenya",adj:"Kenyan"},KI:{name:"Kiribati",adj:"I-Kiribati"},KW:{name:"Kuwait",adj:"Kuwaiti"},KG:{name:"Kyrgyzstan",adj:"Kyrgyzstani"},LA:{name:"Laos",adj:"Lao, Laotian"},LV:{name:"Latvia",adj:"Latvian"},LB:{name:"Lebanon",adj:"Lebanese"},LS:{name:"Lesotho",adj:"Basotho"},LR:{name:"Liberia",adj:"Liberian"},LY:{name:"Libya",adj:"Libyan"},LI:{name:"Liechtenstein",adj:"Liechtensteiner"},LT:{name:"Lithuania",adj:"Lithuanian"},LU:{name:"Luxembourg",adj:"Luxembourgish"},MO:{name:"Macau",adj:"Macanese"},MK:{name:"Macedonia",adj:"Macedonian"},MG:{name:"Madagascar",adj:"Malagasy"},MW:{name:"Malawi",adj:"Malawian"},MY:{name:"Malaysia",adj:"Malaysian"},MV:{name:"Maldives",adj:"Maldivian"},ML:{name:"Mali",adj:"Malian"},MT:{name:"Malta",adj:"Maltese"},MH:{name:"Marshall Islands",adj:"Marshallese"},MQ:{name:"Martinique",adj:"Martinican"},MR:{name:"Mauritania",adj:"Mauritanian"},MU:{name:"Mauritius",adj:"Mauritian"},YT:{name:"Mayotte",adj:"Mahoran"},MX:{name:"Mexico",adj:"Mexican"},FM:{name:"Micronesia",adj:"Micronesian"},MD:{name:"Moldova",adj:"Moldovan"},MC:{name:"Monaco",adj:"Monacan"},MN:{name:"Mongolia",adj:"Mongolian"},ME:{name:"Montenegro",adj:"Montenegrin"},MA:{name:"Morocco",adj:"Moroccan"},MZ:{name:"Mozambique",adj:"Mozambican"},MM:{name:"Myanmar",adj:"Burmese"},NA:{name:"Namibia",adj:"Namibian"},NR:{name:"Nauru",adj:"Nauruan"},NP:{name:"Nepal",adj:"Nepali"},NL:{name:"Netherlands",adj:"Dutch"},NC:{name:"New Caledonia",adj:"New Caledonian"},NZ:{name:"New Zealand",adj:"Zelanian"},NI:{name:"Nicaragua",adj:"Nicaraguan"},NE:{name:"Niger",adj:"Nigerien"},NG:{name:"Nigeria",adj:"Nigerian"},MP:{name:"Northern Mariana Islands",adj:"Niuean"},NO:{name:"Norway",adj:"Norwegian"},OM:{name:"Oman",adj:"Omani"},PK:{name:"Pakistan",adj:"Pakistani"},PW:{name:"Palau",adj:"Palauan"},PS:{name:"Palestine",adj:"Palestinian"},PA:{name:"Panama",adj:"Panamanian"},PG:{name:"Papua New Guinea",adj:"Papuan"},PY:{name:"Paraguay",adj:"Paraguayan"},PE:{name:"Peru",adj:"Peruvian"},PH:{name:"Philippines",adj:"Filipino"},PL:{name:"Poland",adj:"Polish"},PT:{name:"Portugal",adj:"Portuguese"},PR:{name:"Puerto Rico",adj:"Puerto Rican"},QA:{name:"Qatar",adj:"Qatari"},RO:{name:"Romania",adj:"Romanian"},RU:{name:"Russia",adj:"Russian"},RW:{name:"Rwanda",adj:"Rwandan"},BL:{name:"Saint Barthélemy",adj:"Barthélemois"},KN:{name:"Saint Kitts and Nevis",adj:"Kittitian"},LC:{name:"Saint Lucia",adj:"Saint Lucian"},MF:{name:"Saint Martin",adj:"Saint-Martinoise"},VC:{name:"Saint Vincent and the Grenadines",adj:"Saint Vincentian"},SM:{name:"San Marino",adj:"Sammarinese"},SA:{name:"Saudi Arabia",adj:"Saudi"},SN:{name:"Senegal",adj:"Senegalese"},RS:{name:"Serbia",adj:"Serbian"},SC:{name:"Seychelles",adj:"Seychellois"},SL:{name:"Sierra Leone",adj:"Sierra Leonean"},SG:{name:"Singapore",adj:"Singaporean"},SK:{name:"Slovakia",adj:"Slovak"},SI:{name:"Slovenia",adj:"Slovenian"},SB:{name:"Solomon Islands",adj:"Solomon Island"},SO:{name:"Somalia",adj:"Somali"},ZA:{name:"South Africa",adj:"South African"},KR:{name:"South Korea",adj:"South Korean"},SS:{name:"South Sudan",adj:"South Sudanese"},ES:{name:"Spain",adj:"Spanish"},LK:{name:"Sri Lanka",adj:"Sri Lankan"},SD:{name:"Sudan",adj:"Sudanese"},SR:{name:"Surinam",adj:"Surinamese"},SZ:{name:"Swaziland",adj:"Swazi"},SE:{name:"Sweden",adj:"Swedish"},CH:{name:"Switzerland",adj:"Swiss"},SY:{name:"Syria",adj:"Syrian"},TW:{name:"Taiwan",adj:"Taiwanese"},TJ:{name:"Tajikistan",adj:"Tajikistani"},TZ:{name:"Tanzania",adj:"Tanzanian"},TH:{name:"Thailand",adj:"Thai"},TL:{name:"Timor-Leste",adj:"Timorese"},TG:{name:"Togo",adj:"Togolese"},TT:{name:"Trinidad and Tobago",adj:"Trinidadian"},TN:{name:"Tunisia",adj:"Tunisian"},TR:{name:"Turkey",adj:"Turkish"},TC:{name:"Turks and Caicos Islands",adj:"Turks and Caicos Island"},UG:{name:"Uganda",adj:"Ugandan"},UA:{name:"Ukraine",adj:"Ukrainian"},AE:{name:"United Arab Emirates",adj:"Emirati"},GB:{name:"United Kingdom",adj:"British"},US:{name:"United States",adj:"American"},UY:{name:"Uruguay",adj:"Uruguayan"},UZ:{name:"Uzbekistan",adj:"Uzbekistani"},VU:{name:"Vanuatu",adj:"Vanuatuan"},VE:{name:"Venezuela",adj:"Venezuelan"},VN:{name:"Vietnam",adj:"Vietnamese"},VG:{name:"Virgin Islands, British",adj:"British Virgin Island"},VI:{name:"Virgin Islands, United States",adj:"U.S. Virgin Island"},YE:{name:"Yemen",adj:"Yemeni"},ZM:{name:"Zambia",adj:"Zambian"},ZW:{name:"Zimbabwe",adj:"Zimbabwean"}};E.timezone={CI:"Africa/Abidjan",GH:"Africa/Accra",ET:"Africa/Addis_Ababa",DZ:"Africa/Algiers",ER:"Africa/Asmara",ML:"Africa/Bamako",CF:"Africa/Bangui",GM:"Africa/Banjul",GW:"Africa/Bissau",MW:"Africa/Blantyre",CG:"Africa/Brazzaville",BI:"Africa/Bujumbura",EG:"Africa/Cairo",MA:"Africa/Casablanca",GN:"Africa/Conakry",SN:"Africa/Dakar",TZ:"Africa/Dar_es_Salaam",DJ:"Africa/Djibouti",CM:"Africa/Douala",EH:"Africa/El_Aaiun",SL:"Africa/Freetown",BW:"Africa/Gaborone",ZW:"Africa/Harare",ZA:"Africa/Johannesburg",SS:"Africa/Juba",UG:"Africa/Kampala",SD:"Africa/Khartoum",RW:"Africa/Kigali",CD:"Africa/Kinshasa",NG:"Africa/Lagos",GA:"Africa/Libreville",TG:"Africa/Lome",AO:"Africa/Luanda",ZM:"Africa/Lusaka",GQ:"Africa/Malabo",MZ:"Africa/Maputo",LS:"Africa/Maseru",SZ:"Africa/Mbabane",SO:"Africa/Mogadishu",LR:"Africa/Monrovia",KE:"Africa/Nairobi",TD:"Africa/Ndjamena",NE:"Africa/Niamey",MR:"Africa/Nouakchott",BF:"Africa/Ouagadougou",BJ:"Africa/Porto-Novo",ST:"Africa/Sao_Tome",LY:"Africa/Tripoli",TN:"Africa/Tunis",NA:"Africa/Windhoek",AI:"America/Anguilla",AG:"America/Antigua",AR:"America/Argentina/Buenos_Aires",AW:"America/Aruba",PY:"America/Asuncion",BB:"America/Barbados",BZ:"America/Belize",CO:"America/Bogota",VE:"America/Caracas",KY:"America/Cayman",CR:"America/Costa_Rica",CW:"America/Curacao",DM:"America/Dominica",SV:"America/El_Salvador",GL:"America/Godthab",TC:"America/Grand_Turk",GD:"America/Grenada",GT:"America/Guatemala",EC:"America/Guayaquil",GY:"America/Guyana",CU:"America/Havana",JM:"America/Jamaica",BO:"America/La_Paz",PE:"America/Lima",NI:"America/Managua",MF:"America/Marigot",MQ:"America/Martinique",MX:"America/Mexico_City",UY:"America/Montevideo",MS:"America/Montserrat",BS:"America/Nassau",BR:"America/Sao_Paulo",PA:"America/Panama",SR:"America/Paramaribo",HT:"America/Port-au-Prince",TT:"America/Port_of_Spain",PR:"America/Puerto_Rico",CL:"America/Santiago",DO:"America/Santo_Domingo",BL:"America/St_Barthelemy",KN:"America/St_Kitts",LC:"America/St_Lucia",VI:"America/St_Thomas",VC:"America/St_Vincent",HN:"America/Tegucigalpa",VG:"America/Tortola",AQ:"Pacific/Auckland",YE:"Asia/Aden",KZ:"Asia/Almaty",JO:"Asia/Amman",TM:"Asia/Ashgabat",IQ:"Asia/Baghdad",BH:"Asia/Bahrain",AZ:"Asia/Baku",TH:"Asia/Bangkok",LB:"Asia/Beirut",KG:"Asia/Bishkek",BN:"Asia/Brunei",IN:"Asia/Colombo",LK:"Asia/Colombo",SY:"Asia/Damascus",BD:"Asia/Dhaka",TL:"Asia/Dili",AE:"Asia/Dubai",TJ:"Asia/Dushanbe",PS:"Asia/Gaza",VN:"Asia/Ho_Chi_Minh",HK:"Asia/Hong_Kong",ID:"Asia/Jakarta",AF:"Asia/Kabul",PK:"Asia/Karachi",NP:"Asia/Kathmandu",MY:"Asia/Kuala_Lumpur",KW:"Asia/Kuwait",MO:"Asia/Macau",PH:"Asia/Manila",OM:"Asia/Muscat",CY:"Asia/Nicosia",KH:"Asia/Phnom_Penh",KP:"Asia/Pyongyang",QA:"Asia/Qatar",MM:"Asia/Rangoon",SA:"Asia/Riyadh",KR:"Asia/Seoul",CN:"Asia/Shanghai",SG:"Asia/Singapore",TW:"Asia/Taipei",UZ:"Asia/Tashkent",GE:"Asia/Tbilisi",IR:"Asia/Tehran",BT:"Asia/Thimphu",JP:"Asia/Tokyo",MN:"Asia/Ulaanbaatar",LA:"Asia/Vientiane",AM:"Asia/Yerevan",BM:"Atlantic/Bermuda",CV:"Atlantic/Cape_Verde",FO:"Atlantic/Faroe",IS:"Atlantic/Reykjavik",GS:"Atlantic/South_Georgia",SH:"Atlantic/St_Helena",FK:"Atlantic/Stanley",AU:"Australia/Sydney",CA:"America/Toronto",NL:"Europe/Amsterdam",AD:"Europe/Andorra",GR:"Europe/Athens",RS:"Europe/Belgrade",DE:"Europe/Berlin",SK:"Europe/Bratislava",BE:"Europe/Brussels",RO:"Europe/Bucharest",HU:"Europe/Budapest",DK:"Europe/Copenhagen",IE:"Europe/Dublin",GI:"Europe/Gibraltar",GG:"Europe/Guernsey",FI:"Europe/Helsinki",IM:"Europe/Isle_of_Man",MD:"Europe/Istanbul",TR:"Europe/Istanbul",JE:"Europe/Jersey",UA:"Europe/Kiev",PT:"Europe/Lisbon",SI:"Europe/Ljubljana",GB:"Europe/London",UK:"Europe/London",LU:"Europe/Luxembourg",ES:"Europe/Madrid",MT:"Europe/Malta",AX:"Europe/Mariehamn",BY:"Europe/Minsk",MC:"Europe/Monaco",RU:"Europe/Moscow",NO:"Europe/Oslo",FR:"Europe/Paris",ME:"Europe/Podgorica",CZ:"Europe/Prague",LV:"Europe/Riga",IT:"Europe/Rome",SM:"Europe/San_Marino",BA:"Europe/Sarajevo",MK:"Europe/Skopje",BG:"Europe/Sofia",SE:"Europe/Stockholm",EE:"Europe/Tallinn",AL:"Europe/Tirane",LI:"Europe/Vaduz",VA:"Europe/Vatican",AT:"Europe/Vienna",LT:"Europe/Vilnius",HR:"Europe/Zagreb",CH:"Europe/Zurich",MG:"Indian/Antananarivo",CX:"Indian/Christmas",CC:"Indian/Cocos",KM:"Indian/Comoro",TF:"Indian/Kerguelen",SC:"Indian/Mahe",MV:"Indian/Maldives",MU:"Indian/Mauritius",YT:"Indian/Mayotte",IL:"Israel",WS:"Pacific/Apia",NZ:"Pacific/Auckland",FM:"Pacific/Chuuk",VU:"Pacific/Efate",TK:"Pacific/Fakaofo",FJ:"Pacific/Fiji",TV:"Pacific/Funafuti",SB:"Pacific/Guadalcanal",GU:"Pacific/Guam",MH:"Pacific/Majuro",NR:"Pacific/Nauru",NU:"Pacific/Niue",NF:"Pacific/Norfolk",NC:"Pacific/Noumea",AS:"Pacific/Pago_Pago",PW:"Pacific/Palau",PN:"Pacific/Pitcairn",PG:"Pacific/Port_Moresby",CK:"Pacific/Rarotonga",MP:"Pacific/Saipan",PF:"Pacific/Tahiti",KI:"Pacific/Tarawa",TO:"Pacific/Tongatapu",WF:"Pacific/Wallis",PL:"Europe/Warsaw",US:"America/New_York"};E.regions={AD:["Southern Europe","EMEA"],AE:["Western Asia","EMEA"],AF:["Southern Asia","EMEA"],AG:["Caribbean","AMER"],AI:["Caribbean","AMER"],AL:["South-Eastern Europe","EMEA"],AM:["Western Asia","EMEA"],AN:["Caribbean"],AO:["Middle Africa","EMEA"],AQ:["Antarctica","APAC"],AR:["South America","AMER"],AS:["Polynesia","South America","AMER"],AT:["Western Europe","EMEA"],AU:["Australia and New Zealand","APAC"],AW:["Caribbean","AMER"],AX:["Scandinavia","EMEA","Northern Europe"],AZ:["Western Asia","EMEA"],BA:["South-Eastern Europe","EMEA"],BB:["Caribbean","AMER"],BD:["Southern Asia","APAC"],BE:["Western Europe","EMEA"],GF:["South America","AMER"],BF:["Western Africa","EMEA"],BG:["Eastern Europe","EMEA"],BH:["Western Asia","EMEA"],BI:["Eastern Africa","EMEA"],BJ:["Western Africa","EMEA"],BL:["Caribbean","AMER"],BM:["Northern America","AMER"],BN:["South-Eastern Asia","EMEA"],BO:["South America","AMER"],BQ:["Caribbean","AMER"],BR:["South America","AMER"],BS:["Caribbean","AMER"],BT:["Southern Asia","APAC"],BW:["Southern Africa","EMEA"],BY:["Eastern Europe","EMEA"],BZ:["South America","AMER"],CA:["Northern America","AMER"],CC:["Australia and New Zealand","APAC"],CD:["Middle Africa","EMEA"],CF:["Middle Africa","EMEA"],CG:["Middle Africa","EMEA"],CH:["Western Europe","EMEA"],CI:["Western Africa","EMEA"],CK:["Polynesia","APAC"],CL:["South America","AMER"],CM:["Middle Africa","EMEA"],CN:["Asia","China"],CO:["South America","AMER"],CR:["South America","AMER"],CU:["Caribbean","AMER"],CV:["Western Africa","EMEA"],CW:["Caribbean",""],CX:["Australia and New Zealand","APAC"],CY:["South-Eastern Europe","EMEA"],CZ:["Eastern Europe","EMEA"],DE:["Western Europe","EMEA"],DJ:["Eastern Africa","EMEA"],DK:["Scandinavia","EMEA","Northern Europe"],DM:["Caribbean","AMER"],DO:["Caribbean","AMER"],DZ:["Northern Africa","EMEA"],EC:["South America","AMER"],EE:["Eastern Europe","EMEA"],EG:["Northern Africa","EMEA"],EH:["Northern Africa","EMEA"],ER:["Eastern Africa","EMEA"],ES:["Southern Europe","EMEA"],ET:["Eastern Africa","EMEA"],EU:["Western Europe"],FI:["Scandinavia","EMEA","Northern Europe"],FJ:["Melanesia","APAC"],FK:["South America","AMER"],FM:["Micronesia","APAC"],FO:["Scandinavia","EMEA","Northern Europe"],FR:["Western Europe","EMEA"],GA:["Middle Africa","EMEA"],GB:["Northern Europe","EMEA"],GD:["Caribbean","AMER"],GE:["Western Asia","EMEA"],GG:["Northern Europe","EMEA"],GH:["Western Africa","EMEA"],GI:["Southern Europe","EMEA"],GL:["Scandinavia","EMEA","Northern Europe"],GM:["Western Africa","EMEA"],GN:["Western Africa","EMEA"],GP:["Caribbean","AMER"],GQ:["Middle Africa","EMEA"],GR:["South-Eastern Europe","EMEA"],GS:["Antarctica","South America","AMER"],GT:["South America","AMER"],GU:["Micronesia","APAC"],GW:["Western Africa","EMEA"],GY:["South America","EMEA"],HK:["Eastern Asia","China"],HN:["South America","AMER"],HR:["South-Eastern Europe","EMEA"],HT:["Caribbean","AMER"],HU:["Eastern Europe","EMEA"],ID:["South-Eastern Asia","APAC"],IE:["Northern Europe","EMEA"],IL:["Western Asia","EMEA"],IM:["Northern Europe","EMEA"],IN:["Southern Asia","APAC"],IQ:["Western Asia","EMEA"],IR:["Southern Asia","EMEA"],IS:["Scandinavia","EMEA","Northern Europe"],IT:["Southern Europe","EMEA"],JE:["Northern Europe","EMEA"],JM:["Caribbean","AMER"],JO:["Western Asia","EMEA"],JP:["Eastern Asia","APAC"],KE:["Eastern Africa","EMEA"],KG:["Central Asia","EMEA"],KH:["South-Eastern Asia","APAC"],KI:["Micronesia","EMEA"],KM:["Eastern Africa","EMEA"],KN:["Caribbean","AMER"],KP:["Eastern Asia","APAC"],KR:["Eastern Asia","APAC"],KW:["Western Asia","EMEA"],KY:["Caribbean","AMER"],KZ:["Central Asia","EMEA"],LA:["South-Eastern Asia","APAC"],LB:["Western Asia","EMEA"],LC:["Caribbean","AMER"],LI:["Western Europe","EMEA"],LK:["Southern Asia","APAC"],LR:["Western Africa","EMEA"],LS:["Southern Africa","EMEA"],LT:["Eastern Europe","EMEA"],LU:["Western Europe","EMEA"],LV:["Eastern Europe","EMEA"],LY:["Northern Africa","EMEA"],MA:["Northern Africa","EMEA"],MC:["Western Europe","EMEA"],MD:["Eastern Europe","EMEA"],ME:["South-Eastern Europe","EMEA"],MF:["Caribbean","AMER"],MG:["Eastern Africa","EMEA"],MH:["Micronesia","AMER"],MK:["South-Eastern Europe","EMEA"],ML:["Western Africa","EMEA"],MM:["South-Eastern Asia","APAC"],MN:["Eastern Asia","APAC"],MO:["Eastern Asia","APAC"],MP:["Micronesia","AMER"],MQ:["Caribbean","EMEA"],MR:["Western Africa","EMEA"],MS:["Caribbean","AMER"],MT:["Southern Europe","EMEA"],MU:["Eastern Africa","EMEA"],MV:["Southern Asia","APAC"],MW:["Eastern Africa","EMEA"],MX:["South America","AMER"],MY:["South-Eastern Asia","APAC"],MZ:["Eastern Africa","EMEA"],NA:["Southern Africa","EMEA"],NC:["Melanesia","APAC"],NE:["Western Africa","EMEA"],NF:["Australia and New Zealand","AMER"],NG:["Western Africa","EMEA"],NI:["South America","AMER"],NL:["Western Europe","EMEA"],NO:["Scandinavia","EMEA","Northern Europe"],NP:["Southern Asia","APAC"],NR:["Micronesia","AMER"],NU:["Polynesia","AMER"],NZ:["Australia and New Zealand","APAC"],OM:["Western Asia","EMEA"],PA:["South America","AMER"],PE:["South America","AMER"],PF:["Polynesia","EMEA"],PG:["Melanesia","APAC"],PH:["South-Eastern Asia","APAC"],PK:["Southern Asia","EMEA"],PL:["Eastern Europe","EMEA"],PN:["Polynesia","AMER"],PR:["Caribbean","AMER"],PS:["Western Asia","EMEA"],PT:["Southern Europe","EMEA"],PW:["Micronesia","APAC"],PY:["South America","AMER"],QA:["Western Asia","EMEA"],RE:["Eastern Africa","EMEA"],RO:["Eastern Europe","EMEA"],RS:["South-Eastern Europe","EMEA"],RU:["Eastern Europe","EMEA"],RW:["Eastern Africa","EMEA"],SA:["Western Asia","EMEA"],SB:["Melanesia","APAC"],SC:["Eastern Africa","APAC"],SD:["Northern Africa","EMEA"],SE:["Scandinavia","EMEA","Northern Europe"],SG:["South-Eastern Asia","APAC"],SX:["Caribbean","AMER"],SH:["Western Africa","EMEA"],SI:["South-Eastern Europe","EMEA"],SK:["Eastern Europe","EMEA"],SL:["Western Africa","EMEA"],SM:["Southern Europe","EMEA"],SN:["Western Africa","EMEA"],SO:["Eastern Africa","EMEA"],SR:["South America","AMER"],SS:["Eastern Africa","EMEA"],ST:["Middle Africa","EMEA"],SV:["South America","AMER"],SY:["Western Asia","EMEA"],SZ:["Southern Africa","EMEA"],TC:["Caribbean","AMER"],TD:["Middle Africa","EMEA"],TF:["Antarctica","EMEA"],TG:["Western Africa","EMEA"],TH:["South-Eastern Asia","APAC"],TJ:["Central Asia","EMEA"],TK:["Polynesia","EMEA"],TL:["South-Eastern Asia","APAC"],TM:["Central Asia","EMEA"],TN:["Northern Africa","EMEA"],TO:["Polynesia","APAC"],TR:["South-Eastern Europe","EMEA"],TT:["Caribbean","AMER"],TV:["Polynesia","AMER"],TW:["Eastern Asia","China"],TZ:["Eastern Africa","EMEA"],UA:["Eastern Europe","EMEA"],UG:["Eastern Africa","EMEA"],UK:["Northern Europe","EMEA"],US:["Northern America","AMER"],UY:["South America","AMER"],UZ:["Central Asia","EMEA"],VA:["Southern Europe","EMEA"],VC:["Caribbean","AMER"],VE:["South America","AMER"],VG:["Caribbean","AMER"],VI:["Caribbean","AMER"],VN:["South-Eastern Asia","APAC"],VU:["Melanesia","APAC"],WF:["Polynesia","AMER"],WS:["Polynesia","APAC"],XK:["South-Eastern Europe","EMEA"],YE:["Western Asia","EMEA"],YT:["Eastern Africa","EMEA"],ZA:["Southern Africa","EMEA"],ZM:["Eastern Africa","EMEA"],ZW:["Eastern Africa","EMEA"]};var supraregions={"Northern America":["America"],"South America":["LATAM"],"Central America":["LATAM"],Caribbean:["LATAM","South America"],LATAM:["America"],"Eastern Europe":["Eastern Europe (W/E)"],"South-Eastern Europe":["Eastern Europe (W/E)"],"Western Europe":["Western Europe (W/E)"],"Southern Europe":["Western Europe (W/E)"],"Northern Europe":["Western Europe (W/E)"],"Western Europe (W/E)":["Europe"],"Eastern Europe (W/E)":["Europe"],Polynesia:["Oceania"],Melanesia:["Oceania"],Micronesia:["Oceania"],"Australia and New Zealand":["Oceania"],Oceania:["APAC"],"South-Eastern Asia":["APAC","Asia"],"Southern Asia":["APAC","Asia"],"Eastern Asia":["APAC","Asia"],"Central Asia":["Asia"],"Western Asia":["Asia"],"Eastern Africa":["Africa"],"Western Africa":["Africa"],"Southern Africa":["Africa"],"Northern Africa":["Africa"],"Middle Africa":["Africa"]};var extend_regions=function(regions){for(var i=0;i<regions.length;i++){(supraregions[regions[i]]||[]).filter((function(extra){return!regions.includes(extra)})).forEach((function(extra){regions.push(extra)}))}regions.push("All")};(function(){for(var country in E.regions)extend_regions(E.regions[country])})();E.unallowed_list={SY:1,LB:1,IR:1,IQ:1,DO:1};E.is_allowed=function(code){return E.list[code]&&!E.unallowed_list[code]};E.gdpr_countries=["AT","BE","BG","CY","CZ","DE","DK","EE","ES","FI","FR","GB","GF","GP","GR","HR","HU","IC","IE","IS","IT","JE","LI","LT","LU","LV","MF","MQ","MT","NL","NO","PL","PT","RE","RO","SI","SK","SW","YT","UK"];E.dialing_code_list={AF:"93",AL:"355",DZ:"213",AX:"358",AS:"1684",AD:"376",AO:"244",AI:"1264",AQ:"672",AG:"1268",AR:"54",AM:"374",AW:"297",AU:"61",AT:"43",AZ:"994",BS:"1242",BH:"973",JE:"44",BD:"880",BB:"1246",BY:"375",BE:"32",BZ:"501",BJ:"229",BM:"1441",BT:"975",BO:"591",BA:"387",BW:"267",BR:"55",BN:"673",BG:"359",BF:"226",BI:"257",KH:"855",CM:"237",CV:"238",KY:"1345",CF:"236",TD:"235",CL:"56",CN:"86",CX:"61",CC:"61",CO:"57",KM:"269",CG:"242",CK:"682",CR:"506",CI:"225",HR:"385",CU:"53",CW:"599",CY:"357",CZ:"420",CD:"243",DK:"45",DJ:"253",DM:"1767",EC:"593",EG:"20",SV:"503",GQ:"240",ER:"291",EE:"372",ET:"251",FK:"500",FO:"298",FJ:"679",FI:"358",FR:"33",PF:"689",TF:"262",GA:"241",GM:"220",GE:"995",DE:"49",GH:"233",GI:"350",GB:"44",GR:"30",GL:"299",GD:"1473",GU:"1671",GT:"502",GG:"44",GN:"224",GW:"245",GY:"592",HT:"509",HN:"504",HK:"852",HU:"36",IS:"354",IN:"91",ID:"62",IR:"98",IQ:"964",IE:"353",IM:"44",IL:"972",IT:"39",JM:"1876",JP:"81",JO:"962",KE:"254",KI:"686",KW:"965",KG:"996",LA:"856",LV:"371",LB:"961",LS:"266",LR:"231",LY:"218",LI:"423",LT:"370",LU:"352",MO:"853",MK:"389",MG:"261",MW:"265",MY:"60",MV:"960",ML:"223",MT:"356",MH:"692",MQ:"596",MR:"222",MU:"230",YT:"262",MX:"52",FM:"691",MD:"373",MC:"377",MN:"976",ME:"382",MS:"1664",MA:"212",MZ:"258",MM:"95",NA:"264",NR:"674",NP:"977",NL:"31",AN:"599",NC:"687",NZ:"64",NI:"505",NE:"227",NG:"234",NU:"683",NF:"672",KP:"850",MP:"1670",NO:"47",OM:"968",PK:"92",PW:"680",PS:"970",PA:"507",PG:"675",PY:"595",PE:"51",PH:"63",PN:"64",PL:"48",PT:"351",QA:"974",RO:"40",RW:"250",BL:"590",SH:"290",KN:"1869",LC:"1758",MF:"590",VC:"1784",SM:"378",ST:"239",SA:"966",SN:"221",RS:"381",SC:"248",SL:"232",SG:"65",SK:"421",SI:"386",SB:"677",SO:"252",ZA:"27",GS:"500",KR:"82",SS:"211",ES:"34",LK:"94",SD:"249",SR:"597",SZ:"268",SE:"46",CH:"41",SY:"963",TW:"886",TJ:"992",TZ:"255",TH:"66",TL:"670",TG:"228",TK:"690",TO:"676",TT:"1868",TN:"216",TR:"90",TM:"993",TC:"1649",TV:"688",UG:"256",UA:"380",AE:"971",UK:"44",UY:"598",UZ:"998",VU:"678",VA:"39",VE:"58",VN:"84",VG:"1284",VI:"1340",WF:"681",EH:"212",WS:"685",YE:"967",ZM:"260",ZW:"263",DO:"1",CA:"1",KZ:"7",US:"1",PR:"1",RU:"7"};E.dialing_code_rlist={1:"US",1403:"CA",1587:"CA",1780:"CA",1825:"CA",1236:"CA",1250:"CA",1604:"CA",1778:"CA",1204:"CA",1431:"CA",1506:"CA",1709:"CA",1902:"CA",1782:"CA",1226:"CA",1249:"CA",1289:"CA",1343:"CA",1365:"CA",1416:"CA",1437:"CA",1519:"CA",1548:"CA",1613:"CA",1647:"CA",1705:"CA",1807:"CA",1905:"CA",1418:"CA",1438:"CA",1450:"CA",1514:"CA",1579:"CA",1581:"CA",1819:"CA",1873:"CA",1306:"CA",1639:"CA",1867:"CA",1787:"PR",1939:"PR",1809:"DO",1829:"DO",1849:"DO",1242:"BS",1246:"BB",1264:"AI",1268:"AG",1284:"VG",1340:"VI",1345:"KY",1441:"BM",1473:"GD",1649:"TC",1664:"MS",1670:"MP",1671:"GU",1684:"AS",1758:"LC",1767:"DM",1784:"VC",1868:"TT",1869:"KN",1876:"JM",20:"EG",211:"SS",212:"MA",212528:"EH",213:"DZ",216:"TN",218:"LY",220:"GM",221:"SN",222:"MR",223:"ML",224:"GN",225:"CI",226:"BF",227:"NE",228:"TG",229:"BJ",230:"MU",231:"LR",232:"SL",233:"GH",234:"NG",235:"TD",236:"CF",237:"CM",238:"CV",239:"ST",240:"GQ",241:"GA",242:"CG",243:"CD",244:"AO",245:"GW",248:"SC",249:"SD",250:"RW",251:"ET",252:"SO",253:"DJ",254:"KE",255:"TZ",256:"UG",257:"BI",258:"MZ",260:"ZM",261:"MG",262:"TF",262269:"YT",262639:"YT",263:"ZW",264:"NA",265:"MW",266:"LS",267:"BW",268:"SZ",269:"KM",27:"ZA",290:"SH",291:"ER",297:"AW",298:"FO",299:"GL",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",350:"GI",351:"PT",352:"LU",353:"IE",354:"IS",355:"AL",356:"MT",357:"CY",358:"FI",35818:"AX",358457:"AX",359:"BG",36:"HU",370:"LT",371:"LV",372:"EE",373:"MD",374:"AM",375:"BY",376:"AD",377:"MC",378:"SM",380:"UA",381:"RS",382:"ME",385:"HR",386:"SI",387:"BA",389:"MK",39:"IT",39066987:"VA",39066988:"VA",40:"RO",41:"CH",420:"CZ",421:"SK",423:"LI",43:"AT",44:"GB",441481:"GG",441534:"JE",441624:"IM",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",500:"FK",501:"BZ",502:"GT",503:"SV",504:"HN",505:"NI",506:"CR",507:"PA",509:"HT",51:"PE",52:"MX",53:"CU",54:"AR",55:"BR",56:"CL",57:"CO",58:"VE",590:"BL",591:"BO",592:"GY",593:"EC",595:"PY",596:"MQ",597:"SR",598:"UY",599:"AN",60:"MY",61:"AU",619162:"CC",619164:"CX",62:"ID",63:"PH",64:"NZ",65:"SG",66:"TH",670:"TL",6721:"AQ",67232:"NF",67235:"NF",673:"BN",674:"NR",675:"PG",676:"TO",677:"SB",678:"VU",679:"FJ",680:"PW",681:"WF",682:"CK",683:"NU",685:"WS",686:"KI",687:"NC",688:"TV",689:"PF",690:"TK",691:"FM",692:"MH",7:"RU",76:"KZ",77:"KZ",81:"JP",82:"KR",84:"VN",850:"KP",852:"HK",853:"MO",855:"KH",856:"LA",86:"CN",880:"BD",886:"TW",90:"TR",91:"IN",92:"PK",93:"AF",94:"LK",95:"MM",960:"MV",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",967:"YE",968:"OM",970:"PS",971:"AE",972:"IL",973:"BH",974:"QA",975:"BT",976:"MN",977:"NP",98:"IR",992:"TJ",993:"TM",994:"AZ",995:"GE",996:"KG",998:"UZ"};E.google_list={AD:"Andorra",AE:"United Arab Emirates",AF:"Afghanistan",AG:"Antigua and Barbuda",AL:"Albania",AM:"Armenia",AO:"Angola",AQ:"Antarctica",AR:"Argentina",AS:"American Samoa",AT:"Austria",AU:"Australia",AZ:"Azerbaijan",BA:"Bosnia and Herzegovina",BB:"Barbados",BD:"Bangladesh",BE:"Belgium",BF:"Burkina Faso",BG:"Bulgaria",BH:"Bahrain",BI:"Burundi",BJ:"Benin",BN:"Brunei",BO:"Bolivia",BQ:"Caribbean Netherlands",BR:"Brazil",BS:"The Bahamas",BT:"Bhutan",BW:"Botswana",BY:"Belarus",BZ:"Belize",CA:"Canada",CC:"Cocos (Keeling) Islands",CD:"Democratic Republic of the Congo",CF:"Central African Republic",CG:"Republic of the Congo",CH:"Switzerland",CI:"Cote d'Ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"China",CO:"Colombia",CR:"Costa Rica",CV:"Cape Verde",CW:"Curacao",CX:"Christmas Island",CY:"Cyprus",CZ:"Czechia",DE:"Germany",DJ:"Djibouti",DK:"Denmark",DM:"Dominica",DO:"Dominican Republic",DZ:"Algeria",EC:"Ecuador",EE:"Estonia",EG:"Egypt",ER:"Eritrea",ES:"Spain",ET:"Ethiopia",FI:"Finland",FJ:"Fiji",FM:"Federated States of Micronesia",FR:"France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",GE:"Georgia",GG:"Guernsey",GH:"Ghana",GM:"The Gambia",GN:"Guinea",GQ:"Equatorial Guinea",GR:"Greece",GS:"South Georgia and the South Sandwich Islands",GT:"Guatemala",GU:"Guam",GW:"Guinea-Bissau",GY:"Guyana",HM:"Heard Island and McDonald Islands",HN:"Honduras",HR:"Croatia",HT:"Haiti",HU:"Hungary",ID:"Indonesia",IE:"Ireland",IL:"Israel",IN:"India",IQ:"Iraq",IS:"Iceland",IT:"Italy",JE:"Jersey",JM:"Jamaica",JO:"Jordan",JP:"Japan",KE:"Kenya",KG:"Kyrgyzstan",KH:"Cambodia",KI:"Kiribati",KM:"Comoros",KN:"Saint Kitts and Nevis",KR:"South Korea",KW:"Kuwait",KZ:"Kazakhstan",LA:"Laos",LB:"Lebanon",LC:"Saint Lucia",LI:"Liechtenstein",LK:"Sri Lanka",LR:"Liberia",LS:"Lesotho",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",LY:"Libya",MA:"Morocco",MC:"Monaco",MD:"Moldova",ME:"Montenegro",MG:"Madagascar",MH:"Marshall Islands",MK:"North Macedonia",ML:"Mali",MM:"Myanmar (Burma)",MN:"Mongolia",MP:"Northern Mariana Islands",MR:"Mauritania",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"Mexico",MY:"Malaysia",MZ:"Mozambique",NA:"Namibia",NC:"New Caledonia",NE:"Niger",NF:"Norfolk Island",NG:"Nigeria",NI:"Nicaragua",NL:"Netherlands",NO:"Norway",NP:"Nepal",NR:"Nauru",NU:"Niue",NZ:"New Zealand",OM:"Oman",PA:"Panama",PE:"Peru",PF:"French Polynesia",PG:"Papua New Guinea",PH:"Philippines",PK:"Pakistan",PL:"Poland",PM:"Saint Pierre and Miquelon",PN:"Pitcairn Islands",PT:"Portugal",PW:"Palau",PY:"Paraguay",QA:"Qatar",RO:"Romania",RS:"Serbia",RU:"Russia",RW:"Rwanda",SA:"Saudi Arabia",SB:"Solomon Islands",SC:"Seychelles",SE:"Sweden",SG:"Singapore",SH:"Saint Helena, Ascension and Tristan da Cunha",SI:"Slovenia",SK:"Slovakia",SL:"Sierra Leone",SM:"San Marino",SN:"Senegal",SO:"Somalia",SR:"Suriname",ST:"Sao Tome and Principe",SV:"El Salvador",SX:"Sint Maarten",SZ:"Eswatini",TD:"Chad",TF:"French Southern and Antarctic Lands",TG:"Togo",TH:"Thailand",TJ:"Tajikistan",TK:"Tokelau",TL:"Timor-Leste",TM:"Turkmenistan",TN:"Tunisia",TO:"Tonga",TR:"Turkey",TT:"Trinidad and Tobago",TV:"Tuvalu",TZ:"Tanzania",UA:"Ukraine",UG:"Uganda",UM:"United States Minor Outlying Islands",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VA:"Vatican City",VC:"Saint Vincent and the Grenadines",VE:"Venezuela",VN:"Vietnam",VU:"Vanuatu",WF:"Wallis and Futuna",WS:"Samoa",YE:"Yemen",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe"};E.us_state_zip_list=[{min:35e3,max:36999,code:"AL",name:"Alabama"},{min:99500,max:99999,code:"AK",name:"Alaska"},{min:85e3,max:86999,code:"AZ",name:"Arizona"},{min:71600,max:72999,code:"AR",name:"Arkansas"},{min:9e4,max:96699,code:"CA",name:"California"},{min:8e4,max:81999,code:"CO",name:"Colorado"},{min:6e3,max:6999,code:"CT",name:"Connecticut"},{min:19700,max:19999,code:"DE",name:"Deleware"},{min:32e3,max:34999,code:"FL",name:"Florida"},{min:3e4,max:31999,code:"GA",name:"Georgia"},{min:96700,max:96999,code:"HI",name:"Hawaii"},{min:83200,max:83999,code:"ID",name:"Idaho"},{min:6e4,max:62999,code:"IL",name:"Illinois"},{min:46e3,max:47999,code:"IN",name:"Indiana"},{min:5e4,max:52999,code:"IA",name:"Iowa"},{min:66e3,max:67999,code:"KS",name:"Kansas"},{min:4e4,max:42999,code:"KY",name:"Kentucky"},{min:7e4,max:71599,code:"LA",name:"Louisiana"},{min:3900,max:4999,code:"ME",name:"Maine"},{min:20600,max:21999,code:"MD",name:"Maryland"},{min:1e3,max:2799,code:"MA",name:"Massachusetts"},{min:48e3,max:49999,code:"MI",name:"Michigan"},{min:55e3,max:56999,code:"MN",name:"Minnesota"},{min:38600,max:39999,code:"MS",name:"Mississippi"},{min:63e3,max:65999,code:"MO",name:"Missouri"},{min:59e3,max:59999,code:"MT",name:"Montana"},{min:27e3,max:28999,code:"NC",name:"North Carolina"},{min:58e3,max:58999,code:"ND",name:"North Dakota"},{min:68e3,max:69999,code:"NE",name:"Nebraska"},{min:88900,max:89999,code:"NV",name:"Nevada"},{min:3e3,max:3899,code:"NH",name:"New Hampshire"},{min:7e3,max:8999,code:"NJ",name:"New Jersey"},{min:87e3,max:88499,code:"NM",name:"New Mexico"},{min:1e4,max:14999,code:"NY",name:"New York"},{min:43e3,max:45999,code:"OH",name:"Ohio"},{min:73e3,max:74999,code:"OK",name:"Oklahoma"},{min:97e3,max:97999,code:"OR",name:"Oregon"},{min:15e3,max:19699,code:"PA",name:"Pennsylvania"},{min:300,max:999,code:"PR",name:"Puerto Rico"},{min:2800,max:2999,code:"RI",name:"Rhode Island"},{min:29e3,max:29999,code:"SC",name:"South Carolina"},{min:57e3,max:57999,code:"SD",name:"South Dakota"},{min:37e3,max:38599,code:"TN",name:"Tennessee"},{min:75e3,max:79999,code:"TX",name:"Texas"},{min:88500,max:88599,code:"TX",name:"Texas"},{min:84e3,max:84999,code:"UT",name:"Utah"},{min:5e3,max:5999,code:"VT",name:"Vermont"},{min:22e3,max:24699,code:"VA",name:"Virgina"},{min:2e4,max:20599,code:"DC",name:"Washington DC"},{min:98e3,max:99499,code:"WA",name:"Washington"},{min:24700,max:26999,code:"WV",name:"West Virginia"},{min:53e3,max:54999,code:"WI",name:"Wisconsin"},{min:82e3,max:83199,code:"WY",name:"Wyoming"}];E.in_state_list={AN:"Andaman and Nicobar Islands",AP:"Andhra Pradesh",AR:"Arunachal Pradesh",AS:"Assam",BR:"Bihar",CG:"Chandigarh",CH:"Chhattisgarh",DN:"Dadra and Nagar Haveli",DD:"Daman and Diu",DL:"Delhi",GA:"Goa",GJ:"Gujarat",HR:"Haryana",HP:"Himachal Pradesh",JK:"Jammu and Kashmir",JH:"Jharkhand",KA:"Karnataka",KL:"Kerala",LA:"Ladakh",LD:"Lakshadweep",MP:"Madhya Pradesh",MH:"Maharashtra",MN:"Manipur",ML:"Meghalaya",MZ:"Mizoram",NL:"Nagaland",OR:"Odisha",PY:"Puducherry",PB:"Punjab",RJ:"Rajasthan",SK:"Sikkim",TN:"Tamil Nadu",TS:"Telangana",TR:"Tripura",UP:"Uttar Pradesh",UK:"Uttarakhand",WB:"West Bengal"};E.get_state_by_zip=function(zip){zip=parseInt(""+zip,10);var state=E.us_state_zip_list.filter((function(s){return s.min<=zip&&zip<=s.max}));if(state.length)return state[0].code};E.currency_list={AF:"AFN",AL:"ALL",DZ:"DZD",AS:"USD",AD:"EUR",AO:"AOA",AI:"XCD",AG:"XCD",AR:"ARS",AM:"AMD",AW:"AWG",AU:"AUD",AT:"EUR",AZ:"AZN",BS:"BSD",BH:"BHD",BD:"BDT",BB:"BBD",BY:"BYN",BE:"EUR",BZ:"BZD",BJ:"XOF",BM:"BMD",BT:"BTN",BO:"BOB",BQ:"USD",BA:"BAM",BW:"BWP",BV:"NOK",BR:"BRL",IO:"USD",BN:"BND",BG:"BGN",BF:"XOF",BI:"BIF",CV:"CVE",KH:"KHR",CM:"XAF",CA:"CAD",KY:"KYD",CF:"XAF",TD:"XAF",CL:"CLF",CN:"CNY",CX:"AUD",CC:"AUD",CO:"COP",KM:"KMF",CD:"CDF",CG:"XAF",CK:"NZD",CR:"CRC",HR:"EUR",CU:"CUC",CW:"ANG",CY:"EUR",CZ:"CZK",CI:"XOF",DK:"DKK",DJ:"DJF",DM:"XCD",DO:"DOP",EC:"USD",EG:"EGP",SV:"SVC",GQ:"XAF",ER:"ERN",EE:"EUR",ET:"ETB",FK:"FKP",FO:"DKK",FJ:"FJD",FI:"EUR",FR:"EUR",GF:"EUR",PF:"XPF",TF:"EUR",GA:"XAF",GM:"GMD",GE:"GEL",DE:"EUR",GH:"GHS",GI:"GIP",GR:"EUR",GL:"DKK",GD:"XCD",GP:"EUR",GU:"USD",GT:"GTQ",GG:"GBP",GN:"GNF",GW:"XOF",GY:"GYD",HT:"HTG",HM:"AUD",VA:"EUR",HN:"HNL",HK:"HKD",HU:"HUF",IS:"ISK",IN:"INR",ID:"IDR",IR:"IRR",IQ:"IQD",IE:"EUR",IM:"GBP",IL:"ILS",IT:"EUR",JM:"JMD",JP:"JPY",JE:"GBP",JO:"JOD",KZ:"KZT",KE:"KES",KI:"AUD",KP:"KPW",KR:"KRW",KW:"KWD",KG:"KGS",LA:"LAK",LV:"EUR",LB:"LBP",LS:"LSL",LR:"LRD",LY:"LYD",LI:"CHF",LT:"EUR",LU:"EUR",MO:"MOP",MG:"MGA",MW:"MWK",MY:"MYR",MV:"MVR",ML:"XOF",MT:"EUR",MH:"USD",MQ:"EUR",MR:"MRU",MU:"MUR",YT:"EUR",MX:"MXN",FM:"USD",MD:"MDL",MC:"EUR",MN:"MNT",ME:"EUR",MS:"XCD",MA:"MAD",MZ:"MZN",MM:"MMK",NA:"NAD",NR:"AUD",NP:"NPR",NL:"EUR",NC:"XPF",NZ:"NZD",NI:"NIO",NE:"XOF",NG:"NGN",NU:"NZD",NF:"AUD",MP:"USD",NO:"NOK",OM:"OMR",PK:"PKR",PW:"USD",PA:"PAB",PG:"PGK",PY:"PYG",PE:"PEN",PH:"PHP",PN:"NZD",PL:"PLN",PT:"EUR",PR:"USD",QA:"QAR",MK:"MKD",RO:"RON",RU:"RUB",RW:"RWF",RE:"EUR",BL:"EUR",SH:"SHP",KN:"XCD",LC:"XCD",MF:"EUR",PM:"EUR",VC:"XCD",WS:"WST",SM:"EUR",ST:"STN",SA:"SAR",SN:"XOF",RS:"RSD",SC:"SCR",SL:"SLL",SG:"SGD",SX:"ANG",SK:"EUR",SI:"EUR",SB:"SBD",SO:"SOS",ZA:"ZAR",SS:"SSP",ES:"EUR",LK:"LKR",SD:"SDG",SR:"SRD",SJ:"NOK",SE:"SEK",CH:"CHF",SY:"SYP",TW:"TWD",TJ:"TJS",TZ:"TZS",TH:"THB",TL:"USD",TG:"XOF",TK:"NZD",TO:"TOP",TT:"TTD",TN:"TND",TR:"TRY",TM:"TMT",TC:"USD",TV:"AUD",UG:"UGX",UA:"UAH",AE:"AED",GB:"GBP",UM:"USD",US:"USD",UY:"UYI",UZ:"UZS",VU:"VUV",VE:"VEF",VN:"VND",VG:"USD",VI:"USD",WF:"XPF",EH:"MAD",YE:"YER",ZM:"ZMW",ZW:"ZWL",AX:"EUR"};E.paypal_currency_list=["AUD","BRL","CAD","CZK","DKK","EUR","HKD","HUF","ILS","JPY","MXN","TWD","NZD","NOK","PHP","PLN","GBP","SGD","SEK","CHF","THB","USD"];E.bluesnap_currency_list=["AED","AFN","ALL","AMD","ANG","ARS","AUD","AWG","BAM","BBD","BGN","BHD","BMD","BND","BOB","BRL","BSD","BWP","BYR","CAD","CHF","CLP","CNY","CRC","CZK","DKK","DOP","DZD","EGP","EUR","FJD","GBP","GEL","GIP","GTQ","HKD","HUF","IDR","ILS","INR","ISK","JMD","JOD","JPY","KES","KHR","KRW","KWD","KYD","KZT","LKR","MAD","MDL","MKD","MUR","MWK","MXN","MYR","NAD","NGN","NOK","NPR","NZD","OMR","PAB","PEN","PGK","PHP","PKR","PLN","QAR","RON","RSD","SAR","SCR","SDG","SEK","SGD","THB","TND","TRY","TTD","TWD","TZS","UAH","USD","UYU","UZS","VND","XCD","XOF","ZAR","COP"];E.bluesnap_prohibited_countries=["AF","AX","BQ","CO","CU","EU","IR","IQ","XK","LB","LY","MM","KP","BL","SS","SD","SY","TL","YE"];E.avangate_currency_list=["USD","EUR","GBP","RON","AUD","CAD","CHF","CZK","DKK","HUF","JPY","NOK","PLN","SEK","TRY","RUB","CNY","BGN","BRL","HKD","KRW","MXN","NZD","SGD","ZAR","MDL","AED","EGP","INR","RSD","UAH","TWD","ILS","QAR","SAR","ARS","CLP","BOB","COP","PYG","PEN","UYU","NGN","NAD","TND","DZD","KES","BYN"];E.avangate_prohibited_countries=["CU","IR","LY","SD","SY","KP","AF","DZ","AS","AG","BS","BJ","BW","BN","KH","CM","CI","FO","GF","GA","GE","GH","GL","GP","GG","GN","IQ","JM","LY","MV","ML","MZ","MM","NA","NC","NI","MP","QA","RE","RW","SN","SC","SZ","TJ","TZ","TL","TN","TM","UG","UM","VE","YE"];E.stripe_currency_list=["USD","AED","AFN","ALL","AMD","ANG","AOA","ARS","AUD","AWG","AZN","BAM","BBD","BDT","BGN","BIF","BMD","BND","BOB","BRL","BSD","BWP","BZD","CAD","CDF","CHF","CLP","CNY","COP","CRC","CVE","CZK","DJF","DKK","DOP","DZD","EGP","ETB","EUR","FJD","FKP","GBP","GEL","GIP","GMD","GNF","GTQ","GYD","HKD","HNL","HTG","HUF","IDR","ILS","INR","ISK","JMD","JPY","KES","KGS","KHR","KMF","KRW","KYD","KZT","LAK","LKR","LRD","LSL","MAD","MDL","MGA","MKD","MMK","MNT","MOP","MUR","MVR","MWK","MXN","MYR","MZN","NAD","NGN","NIO","NOK","NPR","NZD","PAB","PEN","PGK","PHP","PKR","PLN","PYG","QAR","RON","RSD","RWF","SAR","SBD","SCR","SEK","SGD","SHP","SLL","SOS","SRD","STD","SZL","THB","TJS","TOP","TRY","TTD","TWD","TZS","UAH","UGX","UYU","VND","VUV","WST","XAF","XCD","XOF","XPF","YER","ZAR","ZMW"];E.currency_decimals={BYR:0,CLP:0,JPY:0,KRW:0,VND:0,XOF:0,HUF:0,TWD:0,ISK:0,ALL:0,ARS:0,COP:0,CRC:0,IDR:0,KHR:0,LBP:0,MWK:0,SDG:0,TZS:0,UZS:0};E.adyen_currency_units={AED:2,ALL:2,AMD:2,ANG:2,AOA:2,ARS:2,AUD:2,AWG:2,AZN:2,BAM:2,BBD:2,BDT:2,BGN:2,BHD:3,BMD:2,BND:2,BOB:2,BRL:2,BSD:2,BWP:2,BYN:2,BZD:2,CAD:2,CHF:2,CLP:2,CNH:2,CNY:2,COP:2,CRC:2,CUP:2,CVE:0,CZK:2,DJF:0,DKK:2,DOP:2,DZD:2,EGP:2,ETB:2,EUR:2,FJD:2,FKP:2,GBP:2,GEL:2,GHS:2,GIP:2,GMD:2,GNF:0,GTQ:2,GYD:2,HKD:2,HNL:2,HTG:2,HUF:2,IDR:0,ILS:2,INR:2,IQD:3,ISK:2,JMD:2,JOD:3,JPY:0,KES:2,KGS:2,KHR:2,KMF:0,KRW:0,KWD:3,KYD:2,KZT:2,LAK:2,LBP:2,LKR:2,LYD:3,MAD:2,MDL:2,MKD:2,MMK:2,MNT:2,MOP:2,MRU:2,MUR:2,MVR:2,MWK:2,MXN:2,MYR:2,MZN:2,NAD:2,NGN:2,NIO:2,NOK:2,NPR:2,NZD:2,OMR:3,PAB:2,PEN:2,PGK:2,PHP:2,PKR:2,PLN:2,PYG:0,QAR:2,RON:2,RSD:2,RUB:2,RWF:0,SAR:2,SBD:2,SCR:2,SEK:2,SGD:2,SHP:2,SLE:2,SOS:2,SRD:2,STN:2,SVC:2,SZL:2,THB:2,TND:3,TOP:2,TRY:2,TTD:2,TWD:2,TZS:2,UAH:2,UGX:0,USD:2,UYU:2,UZS:2,VEF:2,VND:0,VUV:0,WST:2,XAF:0,XCD:2,XOF:0,XPF:0,YER:2,ZAR:2,ZMW:2};E.currency_sign_list={USD:"$",EUR:"€",GBP:"£",ARS:"$",AUD:"$",BRL:"R$",CAD:"C$",CHF:"Fr",CZK:"Kč",KRW:"₩",INR:"₹",ILS:"₪",MXN:"$",NOK:"kr",PHP:"₱",PLN:"zł",RUB:"₽",SEK:"kr",SGD:"S$",TRY:"₺"};E.code2label=function(code){code=code.toUpperCase();return E.list[code]||code};E.code2adj=function(code){code=code.toUpperCase();return E.adj_list[code]||code};E.code2timezone=function(code){code=code.toUpperCase();return E.timezone[code]||code};E.label2code=function(label){for(var i in E.list){if(E.list[i]===label)return i}return""};E.mixed2code=function(mixed){if(!mixed)return;if(/^[A-Z]{2}$/.test(mixed))return mixed;if(mixed.length==2)return mixed.toUpperCase();if(mixed=="USA")return"US";for(var code in E.list){if(E.list[code].toLowerCase()==mixed.toLowerCase())return code}return mixed};E.www2code=function(code){return code=="UK"?"GB":code=="uk"?"gb":code};E.code2www=function(code){return code=="GB"?"UK":code=="gb"?"uk":code};E.gl2uule=function(gl){gl=E.www2code(gl.toUpperCase());return E.google_list[gl]||gl};E.code2currency=function(code){return E.currency_list[code.toUpperCase()]};E.currency2sign=function(currency){currency=currency&&currency.toUpperCase();return E.currency_sign_list[currency]||""};E.code2currency_sign=function(code){return E.currency2sign(E.code2currency(code))};E.currency2prefix=function(currency){var sign=E.currency2sign(currency);return sign?sign:currency+" "};E.format_sign_before_price=function(sign,price){return sign+price};E.format_sign_before_price_with_space=function(sign,price){return sign+" "+price};E.format_sign_after_price=function(sign,price){return price+sign};E.format_sign_after_price_with_space=function(sign,price){return price+" "+sign};E.sign_format_list={USD:E.format_sign_before_price,EUR:E.format_sign_after_price_with_space,GBP:E.format_sign_before_price,ARS:E.format_sign_before_price,AUD:E.format_sign_before_price,BRL:E.format_sign_before_price,CAD:E.format_sign_before_price,CHF:E.format_sign_before_price_with_space,CZK:E.format_sign_after_price_with_space,KRW:E.format_sign_before_price,INR:E.format_sign_before_price,ILS:E.format_sign_before_price,MXN:E.format_sign_before_price,NOK:E.format_sign_after_price_with_space,PHP:E.format_sign_before_price,PLN:E.format_sign_after_price_with_space,RUB:E.format_sign_after_price,SEK:E.format_sign_after_price_with_space,SGD:E.format_sign_before_price,TRY:E.format_sign_after_price};E.format_price=function(currency,price,disable_rounding){var sign=E.currency2sign(currency);var format=E.sign_format_list[currency];var fraction_digits=E.get_currency_decimals(currency);var options=!disable_rounding?{minimumFractionDigits:fraction_digits,maximumFractionDigits:fraction_digits}:{};if(!currency)return price.toLocaleString(undefined,options);if(!sign||!format)return currency+" "+price.toLocaleString(undefined,options);return format(sign,price.toLocaleString(undefined,options))};var currency_rlist;E.get_currency_rlist=function(){if(currency_rlist)return currency_rlist;currency_rlist={};for(var co in E.currency_list){var cu=E.currency_list[co];if(!currency_rlist[cu])currency_rlist[cu]=co;else{if(!Array.isArray(currency_rlist[cu]))currency_rlist[cu]=[currency_rlist[cu]];currency_rlist[cu].push(co)}}return currency_rlist};E.get_currency_decimals=function(currency){var decimals=E.currency_decimals[currency&&currency.toUpperCase()];return decimals===undefined?2:decimals};E.country2isocode=function(country){return country_lookup[(""+country).toLowerCase()]};E.isocode2country=function(iso_code){var name=E.iso_list[iso_code];return Array.isArray(name)?name[0]:name};var country_lookup=function(){var lookup={};Object.keys(E.iso_list).forEach((function(iso_code){var names=E.iso_list[iso_code];(Array.isArray(names)?names:[names]).forEach((function(n){lookup[n.toLowerCase()]=iso_code}))}));return lookup}();E.get_country_object=function(code,t){var name=E.code2label(code);var name_low=name.toLowerCase();var name_locale=t?t(name=="Croatia (Hrvatska)"?"Croatia":name).toLowerCase():"";return{code:code.toLowerCase(),name,name_low,name_locale,top:false}};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},6386:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var process,zerr,assert;var is_node=typeof module=="object"&&module.exports&&module.children&&typeof __webpack_require__!="function";if(!is_node){process={nextTick:function(fn){setTimeout(fn,0)},env:{}};if(self.hola&&self.hola.zerr)zerr=self.hola.zerr;else{zerr=function(){console.log.apply(console,arguments)};zerr.perr=zerr;zerr.debug=function(){};zerr.is=function(){return false};zerr.L={DEBUG:0}}if(!zerr.is)zerr.is=function(){return false}}else{require("./config.js");process=global.process||require("_process");zerr=require("./zerr.js");assert=require("assert")}if(typeof assert!="function")assert=function(){};!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(8425),__webpack_require__(6545),__webpack_require__(1291)],__WEBPACK_AMD_DEFINE_RESULT__=function(events,array,zutil){var E=Etask;var GEN_FN="GeneratorFunction";var env=process.env,assign=Object.assign;E.use_bt=+env.ETASK_BT;E.root=new Set;E.assert_extra=+env.ETASK_ASSERT_EXTRA;E.nextTick=process.nextTick;E.set_zerr=function(_zerr){zerr=_zerr};E.events=new events;var cb_pre,cb_post,cb_ctx,longcb_ms,perf_enable;E.perf_stat={};function _cb_pre(et){return{start:Date.now()}}function _cb_post(et,ctx){ctx=ctx||cb_ctx;var ms=Date.now()-ctx.start;if(longcb_ms&&ms>longcb_ms){zerr("long cb "+ms+"ms: "+et.get_name()+", "+et.funcs[et.cur_state].toString().slice(0,128))}if(perf_enable){var name=et.get_name();var perf=E.perf_stat[name]||(E.perf_stat[name]={ms:0,n:0,max:0});if(perf.max<ms)perf.max=ms;perf.ms+=ms;perf.n++}}function cb_set(){if(longcb_ms||perf_enable){cb_pre=_cb_pre;cb_post=_cb_post;cb_ctx={start:Date.now()}}else cb_pre=cb_post=cb_ctx=undefined}E.longcb=function(ms){longcb_ms=ms;cb_set()};E.perf=function(enable){if(arguments.length){perf_enable=enable;cb_set()}return perf_enable};E.longcb(+env.LONGCB);E.perf(+env.ETASK_PERF);function stack_get(){var prev=Error.stackTraceLimit,err;Error.stackTraceLimit=4;err=new Error;Error.stackTraceLimit=prev;return err}function Etask(opt,states){if(!(this instanceof Etask)){if(Array.isArray(opt)||typeof opt=="function"){states=opt;opt=undefined}opt=typeof opt=="string"&&{name:opt}||opt||{};if(typeof states=="function"&&states.constructor.name==GEN_FN)return E._generator(null,states,opt);return new Etask(opt,typeof states=="function"?[states]:states)}assert(Array.isArray(states),"states must be an array");events.EventEmitter.call(this);this.name=opt.name;this.cancelable=opt.cancel;this.then_waiting=new Set;this.child=new Set;this.child_guess=new Set;this.cur_state=-1;this.next_state=-1;this.state0_args=opt.state0_args;this.states_idx={};this.tm_create=Date.now();this.use_retval=false;this.at_return=false;this.free=false;this._stack=Etask.use_bt?stack_get():undefined;this._finally=-1;this._cancel=-1;if(opt.zexit_on_err!=null)this.info.zexit_on_err=opt.zexit_on_err;if(opt.skip_err_metrics!=null)this.info.skip_err_metrics=opt.skip_err_metrics;this.error=this.running=this.at_continue=this.wait_timer=this.retval=this.down=this.up=this.parent=this._alarm=this.tm_completed=this.parent_type=this.parent_guess=this.wait_retval=this.generator=this.generator_ctor=undefined;this.funcs=states;this.states=[];for(var i=0;i<states.length;++i){var func=states[i];assert(typeof func=="function","invalid state type");var type=this._get_state_type(func.name,undefined);if(type.label)this.states_idx[type.label]=i;if(type.finally){assert(this._finally==-1,"more than 1 finally$");this._finally=i}if(type.cancel){assert(this._cancel==-1,"more than 1 cancel$");this._cancel=i}this.states.push(type)}E.root.add(this);var in_run;if(opt.spawn_parent)this.spawn_parent(opt.spawn_parent);else if(opt.up)opt.up._set_down(this);else if(in_run=E.in_run_top())this._spawn_parent_guess(in_run);if(opt.init)opt.init.call(this);if(opt.async){var _this=this;var wait_retval=this._set_wait_retval();E.nextTick((function(){if(_this.running===undefined)_this._got_retval(wait_retval)}))}else if(this._next())this._run();return this}zutil.inherits(Etask,events.EventEmitter);Object.defineProperty(E.prototype,"info",{get:function(){if(!this._info)this._info={};return this._info},set:function(v){this._info=v}});E.prototype._root_remove=function(){assert(!this.parent,"cannot remove from root when has parent");if(!E.root.delete(this))assert(0,"etask not in root\n"+E.ps({MARK:this}))};E.prototype._parent_remove=function(){if(this.up){var up=this.up;this.up=this.up.down=undefined;if(up.tm_completed)up._check_free();return}if(this.parent_guess)this._parent_guess_remove();if(!this.parent)return this._root_remove();if(!this.parent.child.delete(this)){assert(0,"etask child not in parent\n"+E.ps({MARK:[["child",this],["parent",this.parent]]}))}if(this.parent.tm_completed)this.parent._check_free();this.parent=undefined};E.prototype._check_free=function(){if(this.down||this.child.size)return;this._parent_remove();this.free=true};E.prototype._call_err=function(e){E.ef(e,this)};E.prototype.emit_safe=function(){try{this.emit.apply(this,arguments)}catch(e){this._call_err(e)}};E.prototype._call_safe=function(state_fn){try{return state_fn.call(this)}catch(e){this._call_err(e)}};E.prototype._complete=function(){if(zerr.is(zerr.L.DEBUG))zerr.debug(this.shortname()+": close");this.tm_completed=Date.now();this.parent_type=this.up?"call":"spawn";if(this.error)this.emit_safe("uncaught",this.error);if(this._finally!==-1){var ret=this._call_safe(this.funcs[this._finally]);if(E.is_err(ret))this._set_retval(ret)}this.emit_safe("finally");this.emit_safe("ensure");if(this.error&&!this.up&&!this.parent&&!this.parent_guess)E.events.emit("uncaught",this);if(this.parent)this.parent.emit("child",this);if(this.up&&(this.down||this.child.size)){var up=this.up;this.up=this.up.down=undefined;this.parent=up;up.child.add(this)}this._check_free();this._del_wait_timer();this.del_alarm();this._ecancel_child();this.emit_safe("finally1");for(let v of this.then_waiting.values()){this.then_waiting.delete(v);v()}};E.prototype._next=function(rv){if(this.tm_completed)return false;var states=this.states;var state=this.at_return?states.length:this.next_state!=-1?this.next_state:this.cur_state+1;this.retval=rv&&rv.ret;this.error=rv&&rv.err;if(this.error!==undefined){if(zerr.on_exception)zerr.on_exception(this.error,this);if(this.cur_state>-1&&states[this.cur_state].try_catch){this.use_retval=true;for(;state<states.length&&states[state].sig;state++);}else for(;state<states.length&&!states[state].catch;state++);}else for(;state<states.length&&states[state].aux;state++);this.cur_state=state;this.next_state=-1;if(this.cur_state<states.length)return true;this._complete();return false};E.prototype._handle_rv=function(rv){var wait_retval,_this=this,ret=rv.ret;if(ret===this.retval);else if(!ret);else if(ret instanceof Etask){if(!ret.tm_completed){this._set_down(ret);wait_retval=this._set_wait_retval();ret.then_waiting.add((function(){_this._got_retval(wait_retval,E.err_res(ret.error,ret.retval))}));return true}rv.err=ret.error;rv.ret=ret.retval}else if(ret instanceof Etask_err){rv.err=ret.error;rv.ret=undefined}else if(typeof ret=="object"){if(typeof ret.then=="function"){wait_retval=this._set_wait_retval();ret.then((function(_ret){_this._got_retval(wait_retval,_ret)}),(function(err){_this._got_retval(wait_retval,E.err(err))}));return true}else if(typeof ret.next=="function"&&typeof ret.throw=="function"){rv.ret=E._generator(ret,this.funcs[this.cur_state],{});return this._handle_rv(rv)}}return false};E.prototype._set_retval=function(ret){if(ret===this.retval&&!this.error);else if(!ret){this.retval=ret;this.error=undefined}else if(ret instanceof Etask){if(ret.tm_completed){this.retval=ret.retval;this.error=ret.error}}else if(ret instanceof Etask_err){this.retval=undefined;this.error=ret.error}else if(typeof ret.then=="function");else if(typeof ret.next=="function"&&typeof ret.throw=="function");else{this.retval=ret;this.error=undefined}return ret};E.prototype._set_wait_retval=function(){return this.wait_retval=new Etask_wait(this,"wait_int")};E.in_run=[];E.in_run_top=function(){return E.in_run[E.in_run.length-1]};E.prototype._run=function(){var rv={ret:undefined,err:undefined};var _cb_ctx;while(1){this.running=true;rv.ret=rv.err=undefined;E.in_run.push(this);if(zerr.is(zerr.L.DEBUG))zerr.debug(this.shortname()+":S"+this.cur_state+": running");if(cb_pre)_cb_ctx=cb_pre(this);try{rv.ret=this.state0_args&&this.cur_state==0?this.funcs[this.cur_state].apply(this,this.state0_args):this.funcs[this.cur_state].call(this,this.error&&!this.use_retval?this.error:this.retval)}catch(e){rv.err=e;if(rv.err instanceof Error)rv.err.etask=this}this.use_retval=false;if(cb_post)cb_post(this,_cb_ctx);this.running=false;E.in_run.pop();for(let vv of this.child_guess.values()){this.child_guess.delete(vv);vv.parent_guess=undefined}if(rv.ret instanceof Etask_wait){var wait_completed=false,wait=rv.ret;if(!this.at_continue&&!wait.ready){this.wait_retval=wait;if(wait.op=="wait_child")wait_completed=this._set_wait_child(wait);if(wait.timeout)this._set_wait_timer(wait.timeout);if(!wait_completed)return;this.wait_retval=undefined}rv.ret=this.at_continue?this.at_continue.ret:wait.ready&&!wait.completed?wait.ready.ret:undefined;wait.completed=true}this.at_continue=undefined;if(this._handle_rv(rv))return;if(!this._next(rv))return}};E.prototype._set_down=function(down){if(this.down)assert(0,"caller already has a down\n"+this.ps());if(down.parent_guess)down._parent_guess_remove();assert(!down.parent,"returned etask already has a spawn parent");assert(!down.up,"returned etask already has a caller parent, consider using wait_ext");down._parent_remove();this.down=down;down.up=this};var state_type_cache={};E.prototype._get_state_type=function(name,on_fail){var type=state_type_cache[name];if(type)return type;type=state_type_cache[name]=new Etask_state_type;if(!name)return type;type.name=name;var n=name.split("$");if(n.length==1){type.label=n[0];return type}if(n.length>2)return type;if(n[1].length)type.label=n[1];var f=n[0].split("_");for(var j=0;j<f.length;j++){if(f[j]=="try"){type.try_catch=true;if(j+1<f.length&&f[j+1]=="catch")j++}else if(f[j]=="catch")type["catch"]=true;else if(f[j]=="finally"||f[j]=="ensure")type.finally=true;else if(f[j]=="cancel")type.cancel=true;else{return void(on_fail||assert.bind(null,false))("unknown func name "+name)}}if(+(type.catch||type.try_catch)+ +type.finally+ +type.cancel>1){return void(on_fail||assert.bind(null,false))("invalid multiple state types")}type.sig=type.finally||type.cancel;type.aux=type.sig||type.catch;return type};class Etask_state_type{constructor(){this.name=undefined;this.label=undefined;this.try_catch=false;this.catch=false;this.finally=false;this.cancel=false;this.sig=false;this.aux=false}}E.prototype.spawn=function(child,replace){if(!(child instanceof Etask)&&child&&typeof child.then=="function"){var promise=child;child=new Etask({},[function(){return promise}])}if(!(child instanceof Etask)){this.emit("child",child);return child}if(!replace&&child.parent)assert(0,"child already has a parent\n"+child.parent.ps());child.spawn_parent(this);return child};E.prototype._spawn_parent_guess=function(parent){this.parent_guess=parent;parent.child_guess.add(this)};E.prototype._parent_guess_remove=function(){if(!this.parent_guess.child_guess.delete(this)){assert(0,"etask not in parent_guess\n"+this.ps({MARK:this})+"\n"+E.ps({MARK:this}))}this.parent_guess=undefined};E.prototype.spawn_parent=function(parent){if(this.up)assert(0,"child already has an up\n"+this.up.ps());if(this.tm_completed&&!this.parent)return;this._parent_remove();if(parent&&parent.free)parent=undefined;if(!parent)return void E.root.add(this);parent.child.add(this);this.parent=parent};E.prototype.set_state=function(name){var state=this.states_idx[name];assert(state!==undefined,'named func "'+name+'" not found');return this.next_state=state};E.prototype.finally=function(cb){if(this.tm_completed)process.nextTick(cb);else this.prependListener("finally",cb)};E.prototype.goto_fn=function(name){return this.goto.bind(this,name)};E.prototype.goto=function(name,promise){this.set_state(name);assert(!this.states[this.next_state].sig,"goto to sig");return this.continue(promise)};E.prototype.loop=function(promise){this.next_state=this.cur_state;return promise};E.prototype._set_wait_timer=function(timeout){var _this=this;this.wait_timer=setTimeout((function(){_this.wait_timer=undefined;if(_this._next({ret:undefined,err:"timeout"}))_this._run()}),timeout)};E.prototype._del_wait_timer=function(){if(this.wait_timer)this.wait_timer=clearTimeout(this.wait_timer);this.wait_retval=undefined};E.prototype._get_child_running=function(){for(let v of this.child.values()){if(!v.tm_completed)return v}};E.prototype._set_wait_child=function(wait_retval){var _this=this,child=wait_retval.child;var cond=wait_retval.cond,wait_on;var rethrow=wait_retval.rethrow;assert(!cond||child=="any",'condition supported only for "any" '+"option, you can add support if needed");if(child=="any"){if(!this._get_child_running())return true;wait_on=function(){_this.once("child",(function(_child){if(rethrow&&E.is_err(_child))return this._got_retval(wait_retval,_child);if(!cond||cond.call(_child,_child.retval))return _this._got_retval(wait_retval,{child:_child});if(!_this._get_child_running())return _this._got_retval(wait_retval);wait_on()}))};wait_on()}else if(child=="all"){if(!this._get_child_running())return true;wait_on=function(){_this.once("child",(function(_child){if(rethrow&&E.is_err(_child))return _this._got_retval(wait_retval,_child);if(!_this._get_child_running())return _this._got_retval(wait_retval);wait_on()}))};wait_on()}else{assert(child,"no child provided");assert(this===child.parent,"child does not belong to parent");if(child.tm_completed)return true;child.once("finally",(function(){return _this._got_retval(wait_retval,{child})}))}this.emit_safe("wait_on_child");return false};E.prototype._got_retval=function(wait_retval,res){if(this.wait_retval!==wait_retval||wait_retval.completed)return;wait_retval.completed=true;if(this._next(E._res2rv(res)))this._run()};E.prototype.continue_fn=function(){return this.continue.bind(this)};E.continue_depth=0;E.prototype.continue=function(promise,sync){this.wait_retval=undefined;this._set_retval(promise);if(this.tm_completed)return promise;if(this.down)this.down._ecancel();this._del_wait_timer();var rv={ret:promise,err:undefined};if(this.running){this.at_continue=rv;return promise}if(this._handle_rv(rv))return rv.ret;var _this=this;if(E.is_final(promise)&&(!E.continue_depth&&!E.in_run.length||sync)){E.continue_depth++;if(this._next(rv))this._run();E.continue_depth--}else{E.nextTick((function(){if(_this._next(rv))_this._run()}))}return promise};E.prototype._ecancel=function(){if(this.tm_completed)return this;this.emit_safe("cancel");if(this._cancel!=-1)return this._call_safe(this.funcs[this._cancel]);if(this.cancelable)return this.return()};E.prototype._ecancel_child=function(){if(!this.child.size)return;var children=Array.from(this.child.values());for(var child of children)child._ecancel()};E.prototype.return_fn=function(){return this.return.bind(this)};E.prototype.return=function(promise){if(this.tm_completed)return this._set_retval(promise);this.at_return=true;this.next_state=-1;return this.continue(promise,true)};E.prototype.del_alarm=function(){var a=this._alarm;if(!a)return;clearTimeout(a.id);if(a.cb)this.removeListener("sig_alarm",a.cb);this._alarm=undefined};E.prototype.upd_alarm=function(ms){var a=this._alarm;if(!a)return;var cb=a.cb;this.alarm(ms,cb)};E.prototype.inc_alarm=function(ms){var a=this._alarm;if(!a)return;var cb=a.cb;var left=this.alarm_left();this.alarm(ms+left,cb)};E.prototype.alarm_left=function(){var a=this._alarm;if(!a)return 0;return a.start+a.ms-Date.now()};E.prototype.alarm_elapsed=function(){var a=this._alarm;if(!a)return 0;return Date.now()-a.start};E.prototype._operation_opt=function(opt){if(opt.goto)return{ret:this.goto(opt.goto,opt.ret)};if(opt.throw)return{ret:this.throw(opt.throw)};if(opt.return!==undefined)return{ret:this.return(opt.return)};if(opt.continue!==undefined)return{ret:this.continue(opt.continue)}};E.prototype.alarm=function(ms,cb){var _this=this,opt,a;if(cb&&typeof cb!="function"){opt=cb;cb=function(){var v;if(!(v=_this._operation_opt(opt)))assert(0,"invalid alarm cb opt");return v.ret}}this.del_alarm();a=this._alarm={ms,cb,start:Date.now()};a.id=setTimeout((function(){_this._alarm=undefined;_this.emit("sig_alarm")}),a.ms);if(cb)this.once("sig_alarm",cb)};function Etask_wait(et,op,timeout,child,cond,rethrow){this.timeout=timeout;this.et=et;this.op=op;this.child=child;this.cond=cond;this.rethrow=rethrow;this.ready=undefined;this.completed=false}Etask_wait.prototype.continue=function(res){if(this.completed)return;if(!this.et.wait_retval)return void(this.ready={ret:res});if(this!==this.et.wait_retval)return;this.et.continue(res)};Etask_wait.prototype.continue_fn=function(){return this.continue.bind(this)};Etask_wait.prototype.throw=function(err){return this.continue(E.err(err))};Etask_wait.prototype.throw_fn=function(){return this.throw.bind(this)};E.prototype.wait=function(timeout){return new Etask_wait(this,"wait",timeout)};E.prototype.wait_child=function(child,timeout,cond,opt){if(typeof timeout=="function"){cond=timeout;opt=cond;timeout=0}else if(typeof timeout=="object"){cond=undefined;opt=timeout;timeout=0}return new Etask_wait(this,"wait_child",timeout,child,cond,opt&&opt.rethrow)};E.prototype.throw_fn=function(err){return err?this.throw.bind(this,err):this.throw.bind(this)};E.prototype.throw=function(err){return this.continue(E.err(err))};E.prototype.get_name=function(flags){var stack=this._stack instanceof Error?this._stack.stack.split("\n"):undefined;var caller;flags=flags||{};if(stack){caller=/^ {4}at (.*)$/.exec(stack[4]);caller=caller?caller[1]:undefined}var names=[];if(this.name)names.push(this.name);if(caller&&!(this.name&&flags.SHORT_NAME))names.push(caller);if(!names.length)names.push("noname");return names.join(" ")};E.prototype.state_str=function(){return this.cur_state+(this.next_state>=0?"->"+this.next_state:"")};E.prototype.get_depth=function(){var i=0,et=this;for(;et;et=et.up,i++);return i};function trim_space(s){if(s[s.length-1]!=" ")return s;return s.slice(0,-1)}function ms_to_str(ms){var s=""+ms;return s.length<=3?s+"ms":s.slice(0,-3)+"."+s.slice(-3)+"s"}E.prototype.get_time_passed=function(){return ms_to_str(Date.now()-this.tm_create)};E.prototype.get_time_completed=function(){return ms_to_str(Date.now()-this.tm_completed)};E.prototype.get_info=function(){var info=this.info,s="",_i;if(!info)return"";for(var i in info){_i=info[i];if(!_i)continue;if(s!=="")s+=" ";if(typeof _i=="function")s+=_i();else s+=_i}return trim_space(s)};function Etask_err(err){this.error=err||new Error}E.Etask_err=Etask_err;E.err=function(err){return new Etask_err(err)};E.is_err=function(v){return v instanceof Etask&&v.error!==undefined||v instanceof Etask_err};E.err_res=function(err,res){return err?E.err(err):res};E._res2rv=function(res){return E.is_err(res)?{ret:undefined,err:res.error}:{ret:res,err:undefined}};E.is_final=function(v){return!v||typeof v.then!="function"||v instanceof Etask_err||v instanceof Etask&&!!v.tm_completed};E.prototype.then=function(on_res,on_err){var _this=this;function on_done(){if(!_this.error)return!on_res?_this.retval:on_res(_this.retval);return!on_err?E.err(_this.error):on_err(_this.error)}if(this.tm_completed){return new Etask({name:"then_completed"},[function(){return on_done()}])}var then_wait=new Etask({name:"then_wait"},[function(){return this.wait()}]);this.then_waiting.add((function(){try{then_wait.continue(on_done())}catch(e){then_wait.throw(e)}}));return then_wait};E.prototype.otherwise=E.prototype.catch=function(on_err){return this.then(null,on_err)};E.prototype.ensure=function(on_ensure){return this.then((function(res){on_ensure();return res}),(function(err){on_ensure();throw err}))};Etask_err.prototype.then=function(on_res,on_err){var _this=this;return new Etask({name:"then_err"},[function(){return!on_err?E.err(_this.error):on_err(_this.error)}])};Etask_err.prototype.otherwise=Etask_err.prototype.catch=function(on_err){return this.then(null,on_err)};Etask_err.prototype.ensure=function(on_ensure){this.then(null,(function(){on_ensure()}));return this};E.resolve=function(v){return new Etask({},[function(){return v}])};E.reject=function(e){return new Etask({},[function(){throw e}])};E.prototype.wait_ext=function(promise){if(!promise||typeof promise.then!="function")return promise;var wait=this.wait();promise.then(wait.continue_fn(),wait.throw_fn());return wait};E.prototype.shortname=function(){return this.name===undefined?"noname":this.name};E.prototype.longname=function(flags){flags=flags||{TIME:1};var s="",_s;if(this.running)s+="RUNNING ";s+=this.get_name(flags)+(!this.tm_completed?"."+this.state_str():"")+" ";if(this.tm_completed)s+="COMPLETED"+(flags.TIME?" "+this.get_time_completed():"")+" ";if(flags.TIME)s+=this.get_time_passed()+" ";if(_s=this.get_info())s+=_s+" ";return trim_space(s)};E.prototype.stack=function(flags){var et=this,s="";flags=assign({STACK:1,RECURSIVE:1,GUESS:1},flags);while(et){var _s=et.longname(flags)+"\n";if(et.up)et=et.up;else if(et.parent){_s=(et.parent_type=="call"?"CALL":"SPAWN")+" "+_s;et=et.parent}else if(et.parent_guess&&flags.GUESS){_s="SPAWN? "+_s;et=et.parent_guess}else et=undefined;if(flags.TOPDOWN)s=_s+s;else s+=_s}return s};E.prototype._ps=function(pre_first,pre_next,flags){var i,s="",task_trail,et=this,child_guess;if(++flags.limit_n>=flags.LIMIT)return flags.limit_n==flags.LIMIT?"\nLIMIT "+flags.LIMIT+"\n":"";for(;et.up;et=et.up);for(var first=1;et;et=et.down,first=0){s+=first?pre_first:pre_next;first=0;if(flags.MARK&&(i=flags.MARK.sp.indexOf(et))>=0)s+=(flags.MARK.name[i]||"***")+" ";s+=et.longname(flags)+"\n";if(flags.RECURSIVE){var stack_trail=et.down?".":" ";var child=et.child;if(flags.GUESS)child=new Set([...child,...et.child_guess]);i=0;for(let child_i of child.values()){task_trail=i<child.size-1?"|":stack_trail;child_guess=child_i.parent_guess?"\\? ":child_i.parent_type=="call"?"\\> ":"\\_ ";s+=child_i._ps(pre_next+task_trail+child_guess,pre_next+task_trail+"   ",flags);i++}}}return s};function ps_flags(flags){var m,_m;if(m=flags.MARK){if(!Array.isArray(m))_m={sp:[m],name:[]};else if(!Array.isArray(flags.MARK[0]))_m={sp:m,name:[]};else{_m={sp:[],name:[]};for(var i=0;i<m.length;i++){_m.name.push(m[i][0]);_m.sp.push(m[i][1])}}flags.MARK=_m}}E.prototype.ps=function(flags){flags=assign({STACK:1,RECURSIVE:1,LIMIT:1e7,TIME:1,GUESS:1},flags,{limit_n:0});ps_flags(flags);return this._ps("","",flags)};E._longname_root=function(){return(zerr.prefix?zerr.prefix+"pid "+process.pid+" ":"")+"root"};E.ps=function(flags){var s="",task_trail;flags=assign({STACK:1,RECURSIVE:1,LIMIT:1e7,TIME:1,GUESS:1},flags,{limit_n:0});ps_flags(flags);s+=E._longname_root()+"\n";var child=Array.from(E.root.values());if(flags.GUESS){child=[];E.root.forEach((root_i=>{if(!root_i.parent_guess)child.push(root_i)}))}child.forEach(((child_i,i)=>{task_trail=i<child.length-1?"|":" ";s+=child_i._ps(task_trail+"\\_ ",task_trail+"   ",flags)}));return s};function assert_tree_unique(a){var i;for(i=0;i<a.length-1;i++)assert(!a.includes(a[i],i+1))}E.prototype._assert_tree=function(opt){var et;opt=opt||{};assert_tree_unique(this.child);assert(this.parent);if(this.down){et=this.down;assert(et.up===this);assert(!et.parent);assert(!et.parent_guess);this.down._assert_tree(opt)}for(let _et of this.child.values()){assert(_et.parent===this);assert(!_et.parent_guess);assert(!_et.up);_et._assert_tree(opt)}if(this.child_guess.size)assert(E.in_run.includes(this));for(let _et of this.child_guess.values()){assert(_et.parent_guess===this);assert(!_et.parent);assert(!_et.up)}};E._assert_tree=function(opt){opt=opt||{};assert_tree_unique(E.root);for(let et of this.child.values()){assert(!et.parent);assert(!et.up);et._assert_tree(opt)}};E.prototype._assert_parent=function(){if(this.up)return assert(!this.parent&&!this.parent_guess);assert(this.parent&&this.parent_guess,"parent_guess together with parent");if(this.parent){var child=this.parent?this.parent.child:E.root;assert(child.has(this),"cannot find in parent "+(this.parent?"":"root"))}else if(this.parent_guess){assert(this.parent_guess.child_guess.has(this),"cannot find in parent_guess");assert(E.in_run.includes(this.parent_guess))}};E.prototype.return_child=function(){var child=Array.from(this.child.values());for(var i=0;i<child.length;i++)child[i].return()};E.sleep=function(ms){var timer;ms=ms||0;return new Etask({name:"sleep",cancel:true},[function(){this.info.ms=ms+"ms";timer=setTimeout(this.continue_fn(),ms);return this.wait()},function finally$(){clearTimeout(timer)}])};var ebreak_obj={ebreak:1};E.prototype.break=function(ret){return this.throw({ebreak:ebreak_obj,ret})};E.for=function(cond,inc,opt,states){if(Array.isArray(opt)||typeof opt=="function"){states=opt;opt=undefined}states=typeof states=="function"?[states]:states;return new Etask({name:"for",cancel:true,init:opt&&opt.init_parent},[function loop(){return!cond||cond.call(this)},function try_catch$(res){if(!res)return this.return();return new Etask({name:"for_iter",cancel:true,init:opt&&opt.init},states||[])},function(){if(this.error){if(this.error.ebreak===ebreak_obj)return this.return(this.error.ret);return this.throw(this.error)}return inc&&inc.call(this)},function(){return this.goto("loop")}])};E.for_each=function(obj,states){var keys=Object.keys(obj);var iter={obj,keys,i:0,key:undefined,val:undefined};function init_iter(){this.iter=iter}return E.for((function(){this.iter=this.iter||iter;iter.key=keys[iter.i];iter.val=obj[keys[iter.i]];return iter.i<keys.length}),(function(){return iter.i++}),{init:init_iter,init_parent:init_iter},states)};E.while=function(cond,states){return E.for(cond,null,states)};E.all=function(a_or_o,ao2){var i,j,opt={};if(ao2){opt=a_or_o;a_or_o=ao2}if(Array.isArray(a_or_o)){var a=Array.from(a_or_o);i=0;return new Etask({name:"all_a",cancel:true},[function(){for(j=0;j<a.length;j++)this.spawn(a[j])},function try_catch$loop(){if(i>=a.length)return this.return(a);this.info.at="at "+i+"/"+a.length;var _a=a[i];if(_a instanceof Etask)_a.spawn_parent();return _a},function(res){if(this.error){if(!opt.allow_fail)return this.throw(this.error);res=E.err(this.error)}a[i]=res;i++;return this.goto("loop")}])}else if(a_or_o instanceof Object){var keys=Object.keys(a_or_o),o={};i=0;return new Etask({name:"all_o",cancel:true},[function(){for(j=0;j<keys.length;j++)this.spawn(a_or_o[keys[j]])},function try_catch$loop(){if(i>=keys.length)return this.return(o);var _i=keys[i],_a=a_or_o[_i];this.info.at="at "+_i+" "+i+"/"+keys.length;if(_a instanceof Etask)_a.spawn_parent();return _a},function(res){if(this.error){if(!opt.allow_fail)return this.throw(this.error);res=E.err(this.error)}o[keys[i]]=res;i++;return this.goto("loop")}])}assert(0,"invalid type")};E.all_limit=function(limit,arr_iter,cb){var at=0;var iter=!Array.isArray(arr_iter)?arr_iter:function(){if(at<arr_iter.length)return cb.call(this,arr_iter[at],at++)};return new Etask({name:"all_limit",cancel:true},[function(){var next;if(!(next=iter.call(this)))return this.goto("done");if(E.is_err(next))return this.throw(next.error);var _this=this;if(typeof next.catch=="function")next.catch((function(e){_this.throw(e)}));this.spawn(next);this.loop();if(this.child.size>=limit)return this.wait_child("any",{rethrow:true})},function done(){return this.wait_child("all",{rethrow:true})}])};E._apply=function(opt,func,_this,args){var func_name;if(typeof _this=="string"){assert(_this[0]==".","invalid method "+_this);var method=_this.slice(1),_class=func;func=_class[method];_this=_class;assert(_this instanceof Object,"invalid method ."+method);func_name=method}else if(Array.isArray(_this)&&!args){args=_this;_this=null}opt.name=opt.name||func_name||func.name;return new Etask(opt,[function(){var et=this,ret_sync,returned=0;args=Array.from(args);args.push((function cb(err,res){if(typeof opt.ret_sync=="string"&&!returned){var a=arguments;returned++;return void E.nextTick((function(){cb.apply(null,a)}))}var nfn=opt.nfn===undefined||opt.nfn?1:0;if(opt.ret_o){var o={},i;if(Array.isArray(opt.ret_o)){for(i=0;i<opt.ret_o.length;i++)o[opt.ret_o[i]]=arguments[i+nfn]}else if(typeof opt.ret_o=="string")o[opt.ret_o]=array.slice(arguments,nfn);else assert(0,"invalid opt.ret_o");if(typeof opt.ret_sync=="string")o[opt.ret_sync]=ret_sync;res=o}else if(opt.ret_a)res=array.slice(arguments,nfn);else if(!nfn)res=err;et.continue(nfn?E.err_res(err,res):res)}));ret_sync=func.apply(_this,args);if(Array.isArray(opt.ret_sync))opt.ret_sync[0][opt.ret_sync[1]]=ret_sync;returned++;return this.wait()}])};E.nfn_apply=function(opt,func,_this,args){var _opt={nfn:1,cancel:1};if(typeof opt=="function"||typeof func=="string"){args=_this;_this=func;func=opt;opt=_opt}else opt=assign(_opt,opt);return E._apply(opt,func,_this,args)};E.cb_apply=function(opt,func,_this,args){var _opt={nfn:0};if(typeof opt=="function"||typeof func=="string"){args=_this;_this=func;func=opt;opt=_opt}else opt=assign(_opt,opt);return E._apply(opt,func,_this,args)};E.prototype.continue_nfn=function(){return function(err,res){this.continue(E.err_res(err,res))}.bind(this)};E.augment=function(_prototype,method,e_method){var i,opt={};if(method instanceof Object&&!Array.isArray(method)){assign(opt,method);method=arguments[2];e_method=arguments[3]}if(Array.isArray(method)){if(e_method)opt.prefix=e_method;for(i=0;i<method.length;i++)E.augment(_prototype,opt,method[i]);return}opt.prefix=opt.prefix||"e_";if(!e_method)e_method=opt.prefix+method;var fn=_prototype[method];_prototype[e_method]=function(){return E._apply({name:e_method,nfn:1},fn,this,arguments)}};E.wait=function(timeout){return new Etask({name:"wait",cancel:true},[function(){return this.wait(timeout)}])};E.to_nfn=function(promise,cb,opt){return new Etask({name:"to_nfn",async:true},[function try_catch$(){return promise},function(res){var ret=[this.error];if(opt&&opt.ret_a)ret=ret.concat(res);else ret.push(res);cb.apply(null,ret)}])};function etask_fn(opt,states,push_this){if(Array.isArray(opt)||typeof opt=="function"){states=opt;opt=undefined}var is_gen=typeof states=="function"&&states.constructor.name==GEN_FN;var arg_start=+push_this;var wrap=function(){var _opt=assign({},opt);_opt.state0_args=new Array(arg_start+arguments.length);if(push_this)_opt.state0_args[0]=this;for(var i=0;i<arguments.length;i++)_opt.state0_args[arg_start+i]=arguments[i];if(is_gen)return E._generator(null,states,_opt);return new Etask(_opt,typeof states=="function"?[states]:states)};if(states.name){Object.defineProperty(wrap,"name",{value:states.name,writable:false})}return wrap}E.fn=function(opt,states){return etask_fn(opt,states,false)};E._fn=function(opt,states){return etask_fn(opt,states,true)};E._generator=function(gen,ctor,opt){opt=opt||{};opt.name=opt.name||ctor&&ctor.name||"generator";opt.cancel=opt.cancel===undefined?true:opt.cancel;var done=false;return new Etask(opt,[function(){this.generator=gen=gen||ctor.apply(this,arguments);this.generator_ctor=ctor;return{ret:undefined,err:undefined}},function try_catch$loop(rv){var res;try{res=rv.err?gen.throw(rv.err):gen.next(rv.ret)}catch(e){return this.return(E.err(e))}if(res.done){done=true;return this.return(res.value)}return res.value},function(ret){return this.goto("loop",this.error?{ret:undefined,err:this.error}:{ret,err:undefined})},function finally$(){if(!done&&gen&&gen.return)try{gen.return()}catch(e){}}])};E.ef=function(err,et){if(zerr.on_exception)zerr.on_exception(err,et);return err};E.interval=function(opt,states){if(typeof opt=="number")opt={ms:opt};if(!opt.mode||opt.mode=="smart")return interval_smart(opt,states);if(opt.mode=="fixed")return interval_fixed(opt,states);if(opt.mode=="spawn")return interval_spawn(opt,states);throw new Error("unexpected mode "+opt.mode)};function interval_smart(opt,states){var STATE_BEGIN=0;var STATE_OPS=1;var STATE_TIMER=2;var STATE_DONE=4;var state,w,timer,gap_timer;var init_parent=function(){w=this.wait();this.finally((()=>clearTimeout(timer)))};const set_state=(for_et,flag)=>{if((state=state|flag)!=(STATE_OPS|STATE_TIMER))return;state=state|STATE_DONE;if(flag==STATE_TIMER)return void for_et.continue();if(gap_timer&&zutil.is_timer_refresh)gap_timer.refresh();else{clearTimeout(gap_timer);gap_timer=setTimeout(for_et.continue_fn(),0)}};return E.for((function(){state=STATE_BEGIN;if(timer&&zutil.is_timer_refresh)timer.refresh();else{clearTimeout(timer);timer=setTimeout((()=>set_state(this,STATE_TIMER)),opt.ms)}return true}),(function(){set_state(this,STATE_OPS);return w}),{init_parent},states)}function interval_fixed(opt,states){var w,timer;var init_parent=function(){w=this.wait();this.finally((()=>clearTimeout(timer)))};return E.for(null,(function(){if(timer&&zutil.is_timer_refresh)timer.refresh();else{clearTimeout(timer);timer=setTimeout(this.continue_fn(),opt.ms)}return w}),{init_parent},states)}function interval_spawn(opt,states){var w,timer,stopped=false;var init=function(){w=this.wait();this.finally((()=>clearTimeout(timer)))};states=typeof states=="function"?[states]:states;return new Etask({name:"interval_spawn",cancel:true,init},[function loop(){new Etask({},[function try_catch$(){return new Etask({},states)},function(res){if(!this.error)return;if(this.error.ebreak!==ebreak_obj)return this.throw(this.error);stopped=true}])},function(){if(stopped)return this.return();if(timer&&zutil.is_timer_refresh)timer.refresh();else{clearTimeout(timer);timer=setTimeout(this.continue_fn(),opt.ms)}return w},function(){if(stopped)return this.return();return this.goto("loop")}])}E._class=function(cls){var proto=cls.prototype,keys=Object.getOwnPropertyNames(proto);for(var i=0;i<keys.length;i++){var key=keys[i];var descr=Object.getOwnPropertyDescriptor(proto,key);if(descr.get||descr.set)continue;var p=proto[key];if(typeof p=="function"&&p.constructor.name==GEN_FN)proto[key]=E._fn(p)}return cls};E.shutdown=function(){var prev;while(E.root.size){var e=E.root.values().next().value;if(e==prev){assert(e.tm_completed);zerr.zexit("etask root not removed after return - "+"fix non-cancelable child etask")}prev=e;e.return()}};E.race=function(ets){return new Etask({},[function race(){if(!Array.isArray(ets))zerr.zexit("provided argument is not an array");if(!ets.length)return;var race_et=E.wait();var _this=this;function _child_error_handler(e){race_et.throw(e)}var _race=new Etask({},[function(){return E.for_each(ets,(function(){var et=this.iter.val;_this.spawn(new Etask({},[function(){this.on("uncaught",_child_error_handler);return et},function(res){race_et.continue(res)}]))}))},function(){return race_et}]);_race.finally((function(){_this.return_child()}));return _race}])};E.any=function(opt,ets){if(!ets){ets=opt;opt={}}opt=opt||{};opt.rethrow=opt.rethrow==undefined?1:opt.rethrow;return new Etask({},[function race(){if(!Array.isArray(ets))zerr.zexit("provided argument is not an array");var length=ets.length;if(!length)return;var race_et=E.wait();var errors=[];var _this=this;function _child_error_handler(e){errors.push(e);if(errors.length!=length)return;var err=new Error("aggregation error");err.errors=errors;if(opt.rethrow)race_et.throw(err);else race_et.continue()}var _race=new Etask({},[function(){return E.for_each(ets,(function(){var et=this.iter.val;var child=_this.spawn(new Etask({},[function(){this.on("uncaught",_child_error_handler);return et},function(res){race_et.continue(res)}]));if(opt.timeout)setTimeout((()=>child.throw("timeout")),opt.timeout)}))},function(){return race_et}]);_race.finally((function(){_this.return_child()}));return _race}])};return Etask}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},8425:(module,exports)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){function EventEmitter(){this._events={}}EventEmitter.prototype.listeners=function listeners(name){var events=this._events&&this._events[name]||[];var length=events.length,listeners=[],event;for(var i=0;i<length;event=events[++i])listeners.push(events[i].fn);return listeners};EventEmitter.prototype.emit=function emit(name,a1,a2,a3,a4,a5){if(!this._events||!this._events[name])return false;var listeners=this._events[name],length=listeners.length;var len=arguments.length,event=listeners[0],args,i;if(length===1){switch(len){case 1:event.fn.call(event.context||this);break;case 2:event.fn.call(event.context||this,a1);break;case 3:event.fn.call(event.context||this,a1,a2);break;case 4:event.fn.call(event.context||this,a1,a2,a3);break;case 5:event.fn.call(event.context||this,a1,a2,a3,a4);break;case 6:event.fn.call(event.context||this,a1,a2,a3,a4,a5);break;default:for(i=1,args=new Array(len-1);i<len;i++)args[i-1]=arguments[i];event.fn.apply(event.context||this,args)}if(event.once)remove_listener.apply(this,[name,event])}else{for(i=1,args=new Array(len-1);i<len;i++)args[i-1]=arguments[i];for(i=0;i<length;event=listeners[++i]){event.fn.apply(event.context||this,args);if(event.once)remove_listener.apply(this,[name,event])}}return true};function add_listener(name,fn,opt){opt=opt||{};if(!this._events)this._events={};if(!this._events[name])this._events[name]=[];var event={fn};if(opt.context)event.context=opt.context;if(opt.once)event.once=opt.once;if(opt.prepend)this._events[name].unshift(event);else this._events[name].push(event);return this}function remove_listener(name,listener){if(!this._events||!this._events[name])return this;var listeners=this._events[name],events=[];var is_fn=typeof listener=="function";for(var i=0,length=listeners.length;i<length;i++){if(!listener)continue;if(is_fn&&listeners[i].fn!==listener||!is_fn&&listeners[i]!==listener){events.push(listeners[i])}}if(events.length)this._events[name]=events;else this._events[name]=null;return this}EventEmitter.prototype.on=function on(name,fn,context){return add_listener.apply(this,[name,fn,{context}])};EventEmitter.prototype.once=function once(name,fn,context){return add_listener.apply(this,[name,fn,{context,once:true}])};EventEmitter.prototype.prependListener=function prependListener(name,fn,context){return add_listener.apply(this,[name,fn,{context,prepend:true}])};EventEmitter.prototype.prependOnceListener=function prependOnceListener(name,fn,context){return this.prependListener(name,fn,{context,prepend:true,once:true})};EventEmitter.prototype.removeListener=function removeListener(name,fn){return remove_listener.apply(this,[name,fn])};EventEmitter.prototype.removeAllListeners=function removeAllListeners(name){if(!this._events)return this;if(name)this._events[name]=null;else this._events={};return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.addListener=EventEmitter.prototype.on;EventEmitter.prototype.setMaxListeners=function setMaxListeners(){return this};EventEmitter.prototype.eventNames=function eventNames(){var _this=this;return Object.keys(this._events).filter((function(e){return _this._events[e]!==null}))};EventEmitter.EventEmitter=EventEmitter;EventEmitter.EventEmitter2=EventEmitter;EventEmitter.EventEmitter3=EventEmitter;return EventEmitter}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},1889:(module,exports)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){var E={};function imul64h(a,b){var ah=a>>>16&65535;var al=a&65535;var bh=b>>>16&65535;var bl=b&65535;return ah*bh+(ah*bl+al*bh)>>16|0}E.hash_int=function(val){var xh=imul64h(val,1103515245);var xl=Math.imul(val,1103515245);return xl-xh>>>0};E.hash_string=function(s){if(!s.length)return 0;var hash=E.hash_int(s.length);for(var i=0;i<s.length;i+=2){hash=E.hash_int(hash+(s.charCodeAt(i)<<16)+(s.charCodeAt(i+1)|0)>>>0)}return hash};E.sum_parse=function(str){var parts=/([0-9a-f]+)\s+([ *]?)(.*)/i.exec(str);if(!parts)return null;return{hash:parts[1],type:parts[2]=="*"?"binary":"text",file:parts[3]}};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},4135:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(6545)],__WEBPACK_AMD_DEFINE_RESULT__=function(array){var E={};var is_jtest=false;var jtest_vals={};var MAX_INT=2147483647;var MIN_INT=-MAX_INT-1;function jtest_pop(s){var elm;if(s===undefined)return null;if((elm=jtest_vals[s])===undefined)return null;return elm.shift()}E.rand=function(s){var ret;if(is_jtest&&(ret=jtest_pop(s))!==null)return ret;return Math.random()};E.rand_int32=function(s){var ret;if(is_jtest&&(ret=jtest_pop(s))!==null)return ret;return Math.floor(Math.random()*(MAX_INT-MIN_INT+1))-MAX_INT};E.rand_range=function(from,to,s){var ret;if(is_jtest&&(ret=jtest_pop(s))!==null)return ret;return Math.floor(Math.random()*(to-from))+from};E.rand_element=function(a,s){if(a.length)return a[E.rand_range(0,a.length,s)]};E.rand_subset=function(a,size,s){var shuffled=a.slice(0);for(var i=0;i<size;i++){var j=E.rand_range(i,shuffled.length,s);var tmp=shuffled[j];shuffled[j]=shuffled[i];shuffled[i]=tmp}return shuffled.slice(0,size)};E.jtest_push=function(s,arr){if(!jtest_vals[s])jtest_vals[s]=[];if(Array.isArray(arr))array.push(jtest_vals[s],arr);else jtest_vals[s].push(arr)};E.jtest_init=function(){is_jtest=true;jtest_vals={}};E.jtest_uninit=function(){is_jtest=false};E.basic_u32=function(v){return 1103515245*v+12345>>>0};E.basic_u31=function(v){return 1103515245*v+12345&2147483647};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},5516:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(6545)],__WEBPACK_AMD_DEFINE_RESULT__=function(array){var E={};E.rm_empty_last=function(a){if(a[a.length-1]==="")a.pop();return a};E.split_trim=function(s,sep,limit){return array.compact_self(s.split(sep,limit))};E.split_ws=function(s){return E.split_trim(s,/\s+/)};E.qw=function(s){if(Array.isArray(s)&&!s.raw)return s;return E.split_ws(!Array.isArray(s)?s:E.es6_str(arguments))};E.chomp=function(s){return s.replace(/\n$/,"")};E.split_crlf=function(s){return E.rm_empty_last(s.split(/\r?\n/))};E.split_nl=function(s){return E.rm_empty_last(s.split("\n"))};E.to_array_buffer=function(s){var buf=new ArrayBuffer(s.length),buf_view=new Uint8Array(buf),i;for(i=0;i<s.length;i++)buf_view[i]=s.charCodeAt(i);return buf};E.from_array_buffer=function(buf){return String.fromCharCode.apply(null,new Uint8Array(buf))};E.capitalize=function(s){s=""+s;return(s[0]||"").toUpperCase()+s.slice(1)};E.trunc=function(s,len){if(s.length<=len)return s;return s.slice(0,len)+"..."};E.template=function(strings){var keys=Array.prototype.slice.call(arguments,1);return function(){var values=arguments;var dict=values[values.length-1]||{};var result=[strings[0]];keys.forEach((function(key,i){var value=Number.isInteger(key)?values[key]:dict[key];result.push(value,strings[i+1])}));return result.join("")}};E.es6_str=function(args){var parts=args[0],s="";if(!Array.isArray(parts))return parts;s+=parts[0];for(var i=1;i<parts.length;i++){s+=args[i];s+=parts[i]}return s};E.align=function(){var str=E.es6_str(arguments),lines=str.split("\n");if(!lines[0])lines.shift();var spaces=Infinity;for(var i=0;i<lines.length;i++){var space=lines[i].match(/^\s*/)[0];if(space.length==lines[i].length)space=lines[i]="";else spaces=Math.min(spaces,space.length)}if(spaces>0&&spaces!=Infinity)lines=array.sed(lines,new RegExp("^ {"+spaces+"}"),"");return lines.join("\n")};E.nl2sp=function(){return E.es6_str(arguments).replace(/\n\s*/g," ")};E.nl2jn=function(){return E.es6_str(arguments).replace(/\n\s*/g,"")};E.nl2br=function(){return E.es6_str(arguments).replace(/\n\s*/g,"<br>")};E.detach=function(s){return(" "+s).slice(1)};E.hash=function(s){var hash=0;for(var i=0,l=s.length;i<l;i++)hash=(hash<<5)-hash+s.charCodeAt(i)>>>0;return hash};var alphabet="0123456789abcdefghijklmnopqrstuvwxyz";E.generate=function(len){len=len||12;var ret="";for(var i=0;i<len;i++)ret+=alphabet[Math.random()*alphabet.length|0];return ret};E.longest=function(){var i,s;for(i=0;i<arguments.length;i++)s=(arguments[i]||"").length>(s||"").length?arguments[i]:s;return s};E.trim=function(s){return(""+s).replace(/^[\s\u00a0\u200c]*/g,"").replace(/[\s\u00a0\u200c]*$/g,"")};function _encode_decode_prototype(s,opt,node_func,browser_func){var encode_decode=function(val){if(typeof process==="object")return node_func(val);return browser_func(val)};if(!opt.safe)return encode_decode(s);try{return encode_decode(s)}catch(e){return undefined}}E.b64encode=function(s,opt){opt=opt||{};return _encode_decode_prototype(s,opt,(function(val){return Buffer.from(val,opt.encoding).toString("base64")}),(function(val){return btoa(val)}))};E.b64decode=function(s,opt){opt=opt||{};return _encode_decode_prototype(s,opt,(function(val){return Buffer.from(val,"base64").toString(opt.encoding)}),(function(val){return atob(val)}))};var snake_case_regex=/(([A-Z](?![^A-Z]))+|[A-Z])[^A-Z]*|[^A-Z]+/g;E.to_snake_case=function(str){return Array.from((str||"").matchAll(snake_case_regex)).map((function(m){return m[0].toLowerCase()})).join("_")};E.wrap=function wrap(str,width,nbsp_to_space){nbsp_to_space=nbsp_to_space!==false;var lines=str.split("\n");if(lines.length>1){return lines.map((function(line){return wrap(line,width)})).join("\n")}var words=str.split(" ");var output="";var cur_line="";for(var i=0;i<words.length;i++){var word=words[i];var possible_line=cur_line?cur_line+" "+word:word;if(possible_line[width]){output+=cur_line+"\n";cur_line=word}else cur_line=possible_line}output+=cur_line;return nbsp_to_space?output.replace(/\u00A0/g," "):output};E.sp2nbsp=function(){return E.es6_str(arguments).replace(/ /g," ")};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},5305:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;var qs;if(!is_node);else{var _require=require;qs=_require("querystring")}!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1291),__webpack_require__(5516)],__WEBPACK_AMD_DEFINE_RESULT__=function(zutil,zstring){var assign=Object.assign;var E={};function replace_slashes(url){return url.replace(/\\/g,"/")}E.add_proto=function(url){if(!url.match(/^([a-z0-9]+:)?\/\//i))url="http://"+url;return url};E.rel_proto_to_abs=function(url){var proto=is_node?"http:":location.protocol;return url.replace(/^\/\//,proto+"//")};E.get_top_level_domain=function(host){var n=host.match(/\.([^.]+)$/);return n?n[1]:""};E.get_host=function(url){if(url.indexOf("chrome://")==0){var ch_host=url.split("chrome://")[1].split("/")[0];return ch_host}var n=replace_slashes(url).match(/^(https?:)?\/\/([^\/]+)\/.*$/);return n?n[2]:""};E.get_host_without_tld=function(host){return host.replace(/^([^.]+)\.[^.]{2,3}(\.[^.]{2,3})?$/,"$1")};var generic_2ld={com:1,biz:1,net:1,org:1,xxx:1,edu:1,gov:1,ac:1,co:1,or:1,ne:1,kr:1,jp:1,jpn:1,cn:1,mil:1,info:1,int:1};var non_generic_2ld=["bc.ca","bel.tr","bet.ar","blog.br","ca.us","ce.it","def.br","dn.ua","fl.us","g12.br","ga.us","gc.ca","go.cr","go.id","go.jp","go.ke","go.kr","go.th","gob.ar","gob.bo","gob.cl","gob.do","gob.ec","gob.es","gob.gt","gob.hn","gob.mx","gob.pa","gob.pe","gob.sv","gob.ve","gop.pk","gos.pk","gouv.fr","gouv.ht","govt.nz","gv.at","health.nz","hs.kr","idf.il","idv.tw","il.us","in.rs","in.th","in.ua","ind.in","inf.br","jus.br","kh.ua","kharkov.ua","kiev.ua","kommune.no","ks.ua","kyiv.ua","lazio.it","leg.br","lg.ua","lviv.ua","mb.ca","me.uk","mi.us","mil.by","mil.iq","mn.us","mus.br","my.id","nhs.uk","nic.in","nj.us","nm.us","ny.us","od.ua","odessa.ua","of.by","oh.us","pa.us","pe.kr","police.uk","pro.in","qc.ca","rep.kp","res.in","rv.ua","sch.id","te.ua","tx.us","web.id","web.tr"];var non_generic_2ld_re=domains_re(non_generic_2ld);E.get_root_domain=function(domain){if(E.is_ip(domain))return domain;var s=domain.split("."),root=s,len=s.length;if(non_generic_2ld_re.test(domain))root=s.slice(-3,len);else if(len>2){var hd=0;if(s[len-1]=="hola"){hd=2;if(s[len-2].match(/^\d+$/))hd=3}if(generic_2ld[s[len-2-hd]])root=s.slice(-3-hd,len-hd);else root=s.slice(-2-hd,len-hd)}return root.join(".")};E.is_domain_suffix=function(domain){domain="test."+domain;return E.get_root_domain(domain)==domain};E.get_domain_email=function(email){var match=email.toLowerCase().match(/^[a-z0-9_.\-+*%]+@(.*)$/);return match&&match[1]};E.get_root_domain_email=function(email){var domain=E.get_domain_email(email);return domain&&E.get_root_domain(domain)};E.get_path=function(url){var n=url.match(/^https?:\/\/[^\/]+(\/.*$)/);return n?n[1]:""};E.get_proto=function(url){var n=url.match(/^([a-z0-9]+):\/\//);return n?n[1]:""};E.get_host_gently=function(url){var n=replace_slashes(url).match(/^(?:(?:[a-z0-9]+?:)?\/\/)?([^\/]+)/);return n?n[1]:""};E.is_ip=function(host){var m=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/.exec(host);if(!m)return false;for(var i=1;i<=4;i++){if(+m[i]>255)return false}return true};E.is_ip_mask=function(host){var m=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/.exec(host);if(!m)return false;if(E.ip2num(host)==0)return false;var final=false;var check_num_mask=function(num){var arr=(num>>>0).toString(2).split(""),fin=false;for(var i=0;i<arr.length;i++){if(fin&&arr[i]=="1")return false;if(!fin&&arr[i]=="0")fin=true}return true};for(var i=1;i<=4;i++){if(+m[i]>255)return false;if(final&&+m[i]>0)return false;if(!final&&+m[i]<255){if(!check_num_mask(+m[i]))return false;final=true}}return!!final};E.ip2num=function(ip){var num=0;ip.split(".").forEach((function(octet){num<<=8;num+=+octet}));return num>>>0};E.num2ip=function(num){return(num>>>24)+"."+(num>>16&255)+"."+(num>>8&255)+"."+(num&255)};E.is_ip_subnet=function(host){var m=/(.+?)\/(\d+)$/.exec(host);return m&&E.is_ip(m[1])&&+m[2]<=32};E.cbl_key2sub=function(ip){return ip.replace(/_/g,".")+"/24"};E.is_ip_netmask=function(host){if(!host||typeof host.split!=="function")return false;var ips=host.split("/");if(ips.length!=2||!E.is_ip(ips[0])||!E.is_ip_mask(ips[1]))return false;return true};E.is_ip_range=function(host){if(typeof host.split!=="function")return false;var ips=host.split("-");if(ips.length!=2||!E.is_ip(ips[0])||!E.is_ip(ips[1]))return false;return E.ip2num(ips[0])<E.ip2num(ips[1])};E.is_ip_port=function(host){var m=/(.+?)(?::(\d{1,5}))?$/.exec(host);return m&&E.is_ip(m[1])&&!(+m[2]>65535)};E.is_valid_url=function(url){return/^(https?:\/\/)?([a-z0-9-]+\.)+[a-z0-9-]+(:\d+)?(\/.*)?$/i.test(url)};E.is_valid_domain=function(domain){return/^([a-z0-9]([a-z0-9-_]*[a-z0-9])?\.)+[a-z]{2,63}$/.test(domain)||/^(new-tab-page|hola-new-tab-page)$/.test(domain)||/^(hola-diagnostics|hola-settings|settings)$/.test(domain)};E.hola_domains=["hola.org","zspeed-cdn.com","h-vpn.org","holavpn.com","holavpnworld.com","holavpnextension.com","holavpninstaller.com","holabrowser.com","holafreevpn.com","holavpnrussia.com","hola-vpn.com","holax.io","holavpn.net","holavpnandroid.com","c6gj-static.net","su89-cdn.net","yd6n63ptky.com","yg5sjx5kzy.com","kbz0pwvxmv.com","wbzby2a2k9.com","hola-compat.com","x-cdn-static.com"];var additional_domains=["haffnetwork\\w{2}.com"];E.hola_ext_domains=["shoopit.com","toolip.io"];E.hola_browser_internal_domains=["new-tab-page","hola-new-tab-page","hola-diagnostics","hola-settings","settings"];function domains_re(arr){var domains=arr.join("|").replace(/\./g,"\\.");return new RegExp("^(.*\\.)?("+domains+")$")}function init_hola_domains_re(){var domains=E.hola_domains.concat(additional_domains).concat(E.hola_browser_internal_domains).concat(E.hola_ext_domains);return domains_re(domains)}var hola_domain_re=init_hola_domains_re();E.is_hola_domain=function(domain){return E.is_valid_domain(domain)&&domain.search(hola_domain_re)!=-1};E.is_hola_url=function(url){return E.is_hola_domain(E.get_host(url))};E.is_valid_email=function(email){if(!email)return false;var re=/^[a-z0-9_\-+*]+(?:\.[a-z0-9_\-+*]+)*@(.*)$/;var n=email.toLowerCase().match(re);return!!(n&&E.is_valid_domain(n[1]))};E.is_alias_email=function(email){if(!E.is_valid_email(email))return false;var n=email.toLowerCase().match(/^([a-z0-9_.\-+*]+)@.*$/);return!!(n&&/.+\+.+/.test(n[1]))};E.get_main_email=function(email){if(!E.is_valid_email(email))return;if(E.is_alias_email(email))return email.replace(/\+.+@/,"@");return email};E.is_ip_in_range=function(ips_range,ip){if(!E.is_ip_range(ips_range)||!E.is_ip(ip))return false;var ips=ips_range.split("-");var min_ip=E.ip2num(ips[0]),max_ip=E.ip2num(ips[1]);var num_ip=E.ip2num(ip);return num_ip>=min_ip&&num_ip<=max_ip};E.is_ip_local=function(ip){return E.is_ip_in_range("10.0.0.0-10.255.255.255",ip)||E.is_ip_in_range("172.16.0.0-172.31.255.255",ip)||E.is_ip_in_range("192.168.0.0-192.168.255.255",ip)||E.is_ip_in_range("169.254.0.0-169.254.255.255",ip)};E.host_lookup=function(lookup,host){var pos;while(1){if(host in lookup)return lookup[host];if((pos=host.indexOf("."))<0)return;host=host.slice(pos+1)}};E.uri_obj_href=function(uri){return(uri.protocol||"")+(uri.slashes?"//":"")+(uri.host?(uri.auth?uri.auth+"@":"")+uri.host:"")+uri.path+(uri.hash||"")};var protocol_re=/^((?:about|http|https|file|ftp|ws|wss):)?(\/\/)?/i;var host_section_re=/^(.*?)(?:[\/?#]|$)/;var host_re=/^(?:(([^:@]*):?([^:@]*))?@)?([a-zA-Z0-9._+-]*)(?::(\d*))?/;var path_section_re=/^([^?#]*)(\?[^#]*)?(#.*)?$/;var path_re_loose=/^(\/(?:.(?![^\/]*\.[^\/.]+$))*\/?)?([^\/]*?(?:\.([^.]+))?)$/;var path_re_strict=/^(\/(?:.(?![^\/]*(?:\.[^\/.]+)?$))*\/?)?([^\/]*?(?:\.([^.]+))?)$/;E.parse=function(url,strict){function re(expr,str){var m;try{m=expr.exec(str)}catch(e){m=null}if(!m)return m;for(var i=0;i<m.length;i++)m[i]=m[i]===undefined?null:m[i];return m}url=url||location.href;var uri={orig:url};url=replace_slashes(url);var m,remaining=url;if(!(m=re(protocol_re,remaining)))return{};uri.protocol=m[1];if(uri.protocol!==null)uri.protocol=uri.protocol.toLowerCase();uri.slashes=!!m[2];if(!uri.protocol&&!uri.slashes){uri.protocol="http:";uri.slashes=true}remaining=remaining.slice(m[0].length);if(!(m=re(host_section_re,remaining)))return{};uri.authority=m[1];remaining=remaining.slice(m[1].length);if(!(m=re(host_re,uri.authority)))return{};uri.auth=m[1];uri.user=m[2];uri.password=m[3];uri.hostname=m[4];uri.port=m[5];if(uri.hostname!==null){uri.hostname=uri.hostname.toLowerCase();uri.host=uri.hostname+(uri.port?":"+uri.port:"")}if(!(m=re(path_section_re,remaining)))return{};uri.relative=m[0];uri.pathname=m[1];uri.search=m[2];uri.query=uri.search?uri.search.substring(1):null;uri.hash=m[3];if(!(m=re(strict?path_re_strict:path_re_loose,uri.pathname)))return{};uri.directory=m[1];uri.file=m[2];uri.ext=m[3];if(uri.file=="."+uri.ext)uri.ext=null;if(!uri.pathname)uri.pathname="/";uri.path=uri.pathname+(uri.search||"");uri.href=E.uri_obj_href(uri);return uri};E.qs_parse=function(q,opt){var obj={};opt=opt||{};q=q.length?q.split("&"):[];var len=q.length;var unescape_val=opt.bin?function(val){return qs.unescapeBuffer(val,true).toString("binary")}:opt.safe?function(val){try{return decodeURIComponent(val.replace(/\+/g," "))}catch(e){return val}}:function(val){return decodeURIComponent(val.replace(/\+/g," "))};for(var i=0;i<len;++i){var x=q[i];var idx=x.indexOf("=");var kstr=idx>=0?x.substr(0,idx):x;var vstr=idx>=0?x.substr(idx+1):"";var k=unescape_val(kstr);var v=unescape_val(vstr);if(obj[k]===undefined)obj[k]=v;else if(Array.isArray(obj[k]))obj[k].push(v);else obj[k]=[obj[k],v]}if(!opt.disable_qid_parse){var extend_obj=function(){var obj_ext=JSON.parse(zstring.b64decode(obj.qid,opt));obj=assign(obj_ext,zutil.omit(obj,"qid"))};while(obj.qid){if(opt.safe)try{extend_obj()}catch(e){obj=zutil.omit(obj,"qid")}else extend_obj()}}return obj};function token_regex(s,end){return end?"^"+s+"$":s}E.http_glob_host=function(host,end){var port="";var parts=host.split(":");host=parts[0];if(parts.length>1)port=":"+parts[1].replace("*","[0-9]+");var n=host.match(/^(|.*[^*])(\*+)$/);if(n){host=E.http_glob_host(n[1])+(n[2].length==1?"[^./]+":"[^/]"+(n[1]?"*":"+"));return token_regex(host+port,end)}host=host.replace(/\*\*\./,"**").replace(/\*\./,"*").replace(/\./g,"\\.").replace(/\*\*/g,"(([^./]+\\.)+)?").replace(/\*/g,"[^./]+\\.");return token_regex(host+port,end)};E.http_glob_path=function(path,end){if(path[0]=="*")return E.http_glob_path("/"+path,end);var n=path.match(/^(|.*[^*])(\*+)([^*^\/]*)$/);if(n){path=E.http_glob_path(n[1])+(n[2].length==1?"[^/]+":".*")+E.http_glob_path(n[3]);return token_regex(path,end)}path=path.replace(/\*\*\//,"**").replace(/\*\//,"*").replace(/\//g,"\\/").replace(/\./g,"\\.").replace(/\*\*/g,"(([^/]+\\/)+)?").replace(/\*/g,"[^/]+\\/");return token_regex(path,end)};E.http_glob_url=function(url,end){var n=url.match(/^((.*):\/\/)?([^\/]+)(\/.*)?$/);if(!n)return null;var prot=n[1]?n[2]:"*";var host=n[3];var path=n[4]||"**";if(prot=="*")prot="https?";host=E.http_glob_host(host);path=E.http_glob_path(path);return token_regex(prot+":\\/\\/"+host+path,end)};E.root_url_cmp=function(a,b){var a_s=a.match(/^[*.]*([^*]+)$/);var b_s=b.match(/^[*.]*([^*]+)$/);if(!a_s&&!b_s)return false;var re,s;if(a_s&&b_s&&a_s[1].length>b_s[1].length||a_s&&!b_s){s=a_s[1];re=b}else{s=b_s[1];re=a}s=E.add_proto(s)+"/";if(!(re=E.http_glob_url(re,1)))return false;try{re=new RegExp(re)}catch(e){return false}return re.test(s)};E.qs_strip=function(url){return/^[^?#]*/.exec(url)[0]};E.qs_str=function(_qs){var q=[];for(var k in _qs){(Array.isArray(_qs[k])?_qs[k]:[_qs[k]]).forEach((function(v){q.push(encodeURIComponent(k)+"="+encodeURIComponent(v))}))}return q.join("&")};E.qs_add=function(url,_qs,opt){var u=E.parse(url),q=assign(u.query?E.qs_parse(u.query,opt):{},_qs);u.path=u.pathname+"?"+E.qs_str(q);return E.uri_obj_href(u)};E.qs_parse_url=function(url,opt){return E.qs_parse(url.replace(/(^.*\?)|(^[^?]*$)/,""),opt)};E.qs_pack_qid=function(_qs){return zstring.b64encode(JSON.stringify(_qs))};E.qs_str_qid=function(_qs){return E.qs_str({qid:E.qs_pack_qid(_qs)})};E.url_qs_encode_qid=function(url,opt){var u=E.parse(url),q=assign(u.query?E.qs_parse(u.query,opt):{});u.path=u.pathname+"?"+E.qs_str_qid(q);return E.uri_obj_href(u)};E.segments=function(url){var parsed=E.parse(url||location.href);var dir=parsed.directory||"/";if(dir=="/")return[""];return dir.split("/")};E.safe_redir=function(url,default_hostname){if(!url)return;var u=E.parse(url,true);var hostname=u.hostname||default_hostname;if(!/^https?:$/.test(u.protocol)||!hostname)return;if(E.is_hola_domain(hostname)||zutil.is_mocha()&&hostname=="localhost")return"https://"+hostname+encodeURI(u.path)};E.alt_holaorg=function(domain,kw){if(domain=="hola.org"&&kw&&kw.hola_org_blocked)return"hola-vpn.com";return domain};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},901:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_RESULT__=function(){var E={};var win_versions={"10.0":"10.0",6.3:"8.1",6.2:"8",6.1:"7","6.0":"vista",5.2:"2003",5.1:"xp","5.0":"2000"};var arch_mapping={x86_64:"64",i686:"32",arm:"arm"};var check_hola=/\bhola_android\b/i;var check_hola_viewer=/\bHola help viewer\b/i;var check_opera=/\bOPR\b\/(\d+)/i;var check_edge=/\bEdge\b\/(\d+)/i;var check_xbox=/\bxbox\b/i;var check_ucbrowser=/\bUCBrowser\b\/(\d+)/i;var check_webview=/ Version\/(\d+)(\.\d)/;var check_chromium_edge=/\bEdg\/(\d+)/i;var is_browser=!is_node&&typeof self!="undefined";function is_ipad_os(ua){return/Macintosh/.test(ua)&&typeof navigator=="object"&&navigator.maxTouchPoints>1}function ios_ua(ua,safari_ver){var res;if(res=/(?:iPhone|iPad|iPod|iPod touch);.*?OS ([\d._]+)/.exec(ua)){var ios_ver=res[1];var is_chrome=/CriOS/.test(ua);var is_firefox=/FxiOS/.test(ua);var ucbrowser_ver=(check_ucbrowser.exec(ua)||[])[1];var is_ucbrowser=!!ucbrowser_ver;return{browser:"safari",version:safari_ver||ios_ver,ios:ios_ver,hola_viewer:check_hola_viewer.test(ua),chrome:is_chrome,firefox:is_firefox,ucbrowser:is_ucbrowser,ucbrowser_version:ucbrowser_ver,webview:/Twitter/.test(ua)?"twitter":/GSA\/\d+/.test(ua)?"googlesearch":/FBAV\/\d+/.test(ua)?"facebook":!safari_ver&&!is_chrome&&!is_firefox&&!is_ucbrowser}}}function check_chromium(ua){if(check_webview.test(ua)||/Android/.test(ua)||/ Mobile /.test(ua)||check_opera.test(ua)||check_chromium_edge.test(ua)){return false}var group="(?: (\\w*)\\/)?",ver="\\/[\\d\\.]+";var res=new RegExp("AppleWebKit"+ver+"(?: \\(.*\\))?"+group+".* Chrome"+ver+group+".* Safari"+ver+group).exec(ua);return res&&(res[1]||res[2]||res[3])}E.guess_browser=function(ua){var res;var nav=is_browser?self.navigator&&navigator:null;ua=ua||(is_browser?nav.userAgent:"");if(res=/\bOpera Mini\/(\d+)/.exec(ua))return{browser:"opera_mini",version:res[1]};var ucbrowser=check_ucbrowser.exec(ua);if(res=/[( ]MSIE ([6789]|10).\d[);]/.exec(ua))return{browser:"ie",version:res[1],xbox:check_xbox.test(ua)};if(res=/[( ]Trident\/\d+(\.\d)+.*rv:(\d\d)(\.\d)+[);]/.exec(ua))return{browser:"ie",version:res[2],xbox:check_xbox.test(ua)};if(res=/ Chrome\/(\d+)(\.\d+)+.* Safari\/\d+(\.\d+)+/.exec(ua)){var opera=check_opera.exec(ua);var edge;if(edge=check_edge.exec(ua))return{browser:"edge",version:edge[1]};var chromium_based=check_chromium(ua);var brands=nav&&nav.userAgentData&&nav.userAgentData.brands;var brand=brands&&brands.length&&brands[0]&&brands[0].brand;return{browser:"chrome",version:res[1],android:ua.match(/Android/),webview:ua.match(check_webview),hola_android:check_hola.test(ua),hola_browser:chromium_based=="Hola"||brand=="Hola",hola_viewer:check_hola_viewer.test(ua),chromium_based,edge:check_chromium_edge.test(ua),opera:opera&&!!opera[1],opera_version:opera?opera[1]:undefined,ucbrowser:ucbrowser&&!!ucbrowser[1],ucbrowser_version:ucbrowser?ucbrowser[1]:undefined,webos_app:/Web0S/.test(ua),samsung_browser:/SamsungBrowser/.test(ua),samsung:/(SAMSUNG|SM-)/i.test(ua),huawei:/HUAWEI/i.test(ua)}}if(res=/ QupZilla\/(\d+\.\d+\.\d+).* Safari\/\d+.\d+/.exec(ua))return{browser:"qupzilla",version:res[1]};if(res=/\(PlayStation (\d+) (\d+\.\d+)\).* AppleWebKit\/\d+.\d+/.exec(ua)){return{browser:"playstation"+res[1],version:res[2]}}if(res=/\(SMART-TV; Linux; Tizen ([0-9.]+)\) AppleWebkit\//.exec(ua))return{browser:"samsung_tizen",version:res[1]};if(res=/ Version\/(\d+)(\.\d)+.* Safari\/\d+.\d+/.exec(ua)){if(!ua.match(/Android/))return ios_ua(ua,res[1])||{browser:"safari",version:res[1]};return{browser:"chrome",version:res[1],android:true,webview:true,hola_android:check_hola.test(ua),ucbrowser:ucbrowser&&!!ucbrowser[1],ucbrowser_version:ucbrowser?ucbrowser[1]:undefined,samsung_browser:/SamsungBrowser/.test(ua),samsung:/(SAMSUNG|SM-)/.test(ua),huawei:/HUAWEI/.test(ua)}}if(res=/ (Firefox|PaleMoon)\/(\d+).\d/.exec(ua)){return{browser:"firefox",version:res[2],palemoon:res[1]=="PaleMoon"}}if(/Hola\/\d+\.\d+.*?(?:iPhone|iPad|iPod)/.exec(ua))return{browser:"safari",version:"Hola"};if(res=ios_ua(ua))return res;return{}};E.browser_to_string=function(browser){if(typeof browser!="object"||!browser.browser)return"unknown";var s=browser.browser=="ie"&&browser.version>11?"edge":browser.browser;if(browser.version)s+=" "+browser.version;if(browser.chrome)s+=" chrome";if(browser.firefox)s+=" firefox";if(browser.xbox)s+=" xbox";if(browser.android)s+=" android";if(browser.webview){s+=" webview";if(typeof browser.webview=="string")s+="-"+browser.webview}if(browser.chromium_based)s+=" chromium_based";if(browser.samsung_browser)s+=" samsung";if(browser.edge)s+=" edge";if(browser.opera){s+=" opera";if(browser.opera_version)s+="-"+browser.opera_version}if(browser.hola_android)s+=" hola_android";if(browser.hola_viewer)s+=" hola_viewer";if(browser.ucbrowser){s+=" ucbrowser";if(browser.ucbrowser_version)s+="-"+browser.ucbrowser_version}if(browser.palemoon)s+=" palemoon";if(browser.ios)s+=" ios";if(browser.webos_app)s+=" webos_app";return s?s:"unknown"};E.guess=function(ua,platform){var res;ua=ua||(is_browser?navigator.userAgent:"");platform=platform||(is_browser?navigator.platform:"");if(check_xbox.exec(ua))return{os:"xbox",mobile:false};if(res=/Windows(?: NT(?: (.*?))?)?[);]/.exec(ua)){return{os:"windows",version:win_versions[res[1]],release_version:res[1],arch:ua.match(/WOW64|Win64|x64/)?"64":"32",mobile:false}}if(/Windows Phone/.exec(ua))return{os:"winphone",mobile:true};if(/Macintosh/.exec(ua)){if(is_ipad_os(ua))return{os:"ios",mobile:true};if(res=/Macintosh.*; (?:Intel|PPC) Mac OS X (\d+[._]\d+)/.exec(ua)){return{os:"macos",version:res[1].replace("_","."),mobile:false}}return{os:"macos",mobile:false}}if(/Web0S.*SmartTV/.exec(ua)){return{os:"webos",version:/Chrome/.test(ua)?"3":"2",mobile:false,tv:true}}if(/droid.+aft(\w)( bui|\))/i.exec(ua))return{os:"fireos",mobile:false,tv:true};if(/(apple) ?tv/i.exec(ua))return{os:"tvos",mobile:false,tv:true};if(res=/(Android|Andr0id)(?: (\d+\.\d+))?/.exec(ua))return{os:"android",version:res[2],mobile:true};if(res=/(Linux|CrOS|OpenBSD|FreeBSD)(?: (x86_64|i686|arm))?/.exec(ua)){if(check_opera.test(ua)&&res[1]=="Linux"&&res[2]=="x86_64"&&/^Linux arm/.test(platform)){return{os:"android",mobile:true}}return{os:res[1].toLowerCase(),arch:arch_mapping[res[2]],nix:true,mobile:false}}if(res=/(?:iPhone|iPad|iPod|iPod touch);.*?OS (\d+[._]\d+)/.exec(ua))return{os:"ios",version:res[1].replace("_","."),mobile:true};if(/iPhone|iPad|iPod/.exec(ua))return{os:"ios",mobile:true};if(/PLAYSTATION/.exec(ua))return{os:"ps",mobile:false};if(/HitLeap Viewer/.exec(ua))return{os:"windows",mobile:false};return{}};E.guess_device=function(ua){var res;ua=ua||(is_browser?navigator.userAgent:"");if(res=/(iPhone|iPad|iPod)/.exec(ua))return{device:res[1].toLowerCase()};if(/Macintosh/.test(ua))return{device:is_ipad_os(ua)?"ipad":"mac"};return{}};E.support_fullscreen=function(){return!!(is_browser&&typeof document!="undefined"&&(document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled))};E.support_hover=function(){if(!is_browser)return false;if(self.matchMedia&&self.matchMedia("(hover: hover)").matches)return true;return!E.guess().mobile};E.is_invalid=function(ua){return/^(python-request|python-urllib|blackberry)/i.test(ua)};return E}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},6262:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(4996),__webpack_require__(3787)],__WEBPACK_AMD_DEFINE_RESULT__=function(sprintf,conv){var E={};var ver_regexp=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/;E._expand=function(ver){var v;if(!ver)return"";if(!(v=ver_regexp.exec(ver)))return;return sprintf("%03d.%03d.%03d",+v[1],+v[2],+v[3])};E.expand=conv.cache_str_fn(E._expand);E._trim=function(ver){var v;if(!ver)return"";if(!(v=ver_regexp.exec(ver)))return;return""+ +v[1]+"."+ +v[2]+"."+ +v[3]};E.trim=conv.cache_str_fn(E._trim);E._cmp=function(v1,v2){if(!v1||!v2)return+!!v1-+!!v2;var _v1=(""+v1).split("."),_v2=(""+v2).split("."),i;for(i=0;i<_v1.length&&i<_v2.length&&+_v1[i]==+_v2[i];i++);if(_v1.length==i||_v2.length==i)return _v1.length-_v2.length;return+_v1[i]-+_v2[i]};E.cmp=conv.cache_str_fn2(E._cmp);E._valid=function(v){return ver_regexp.test(""+v)};var version_valid_cache={};E.valid=function(v){var cache=version_valid_cache,res;v=""+v;if(v in cache)return cache[v];if(res=E._valid(v))cache[v]=res;return res};function iter_ver(version,cb){var v;if(!E.valid(version))return version;v=version.split(".");for(var i=v.length-1;i>=0&&!cb(v,i);i--);return v.join(".")}E.inc=function(version){return iter_ver(version,(function(v,i){if(v[i]<999){v[i]=+v[i]+1;return true}v[i]=0}))};E.dec=function(version){return iter_ver(version,(function(v,i){if(v[i]>0){v[i]=+v[i]-1;return true}v[i]=999}))};E.get_max=function(versions,cmp){var v,i;versions=versions.sort(cmp||function(v1,v2){return E.cmp(v2.version,v1.version)});for(i=0;i<versions.length;i++){v=versions[i];if(+v.isbranch||!+v.soft_tag||!+v.onsymbol||v.repository!="zon"||!E.valid(v.version)){continue}return v.version}};E.cmp_get_min=function(versions,cmp){if(versions.length<=0)return;return versions.sort(cmp?function(v1,v2){return-cmp(v1,v2)}:function(v1,v2){return-E.cmp(v2,v1)})[0]};E.hash=function(ver){return conv.md5("wQ"+ver+"\n",8)};E.ver2int=function(ver){var m=ver_regexp.exec(ver);return m&&+m[1]*1e6+ +m[2]*1e3+ +m[3]};E.int2ver=function(n){if(!n)return"";var n3=n%1e3;n=n/1e3|0;var n2=n%1e3;n=n/1e3|0;return n+"."+n2+"."+n3};E.get_major_minor=function(ver){return ver&&ver.replace(/^(\d+(\.\d+)?).*$/,"$1")};E.win_build2ver=function(v){if(!/^\d+\.\d+/.test(v))v="0.0";var vv=v.split(".");var ver=+vv.slice(0,2).join(".");var build=vv.length>=3?+vv[2]:0;return ver>=10&&build>=21996?"v11":ver>=10?"v10":ver>=6.3?"v8.1":ver>=6.2?"v8":ver>=6.1?"v7":ver>=6?"vista":ver>=5.2?"xp":"other"};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},5678:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){let next_tick;let is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node){next_tick=function(){var can_set_immediate=typeof self!=="undefined"&&self.setImmediate;var can_post=typeof self!=="undefined"&&self.postMessage&&self.addEventListener;if(can_set_immediate)return function(f){return self.setImmediate(f)};if(can_post){var queue=[];self.addEventListener("message",(function(ev){var source=ev.source;if((source===self||source===null)&&ev.data==="process-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}}),true);return function(fn){queue.push(fn);self.postMessage("process-tick","*")}}return function(fn){setTimeout(fn,0)}}()}else;next_tick=next_tick||process.nextTick;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(3787),__webpack_require__(6386),__webpack_require__(8425),__webpack_require__(5516),__webpack_require__(9824),__webpack_require__(1291),__webpack_require__(932)],__WEBPACK_AMD_DEFINE_RESULT__=function(conv,etask,events,string,zerr,zutil,date){const ef=etask.ef,assign=Object.assign;const zjson_opt_default={func:false,date:true,re:true};const is_win=/^win/.test(is_node&&process.platform);const is_darwin=is_node&&process.platform=="darwin";const default_user_agent=is_node?(()=>{const zconf=require("./config.js");const conf=require("./conf.js");return`Hola ${conf.app}/${zconf.ZON_VERSION}`})():undefined;const DEBUG_STR_LEN=4096,DEFAULT_WIN_SIZE=1048576;const SEC=1e3,MIN=60*SEC,VFD_SZ=8,VFD_BIN_SZ=12;let zcounter;const net=is_node?require("net"):null;const SERVER_NO_MASK_SUPPORT="server_no_mask_support";const BUFFER_CONTENT=10;const BUFFER_IPC_CALL=11;let SnappyStream,UnsnappyStream;const EventEmitter=is_node?require("events").EventEmitter:events.EventEmitter;const json_event=flag=>flag?"zjson":"json";function noop(){}const BUFFER_MESSAGES_CONTENT=20;const BUFFER_MESSAGES_TYPE_BIN=0;const BUFFER_MESSAGES_TYPE_STRING=1;const BUFFER_MESSAGES_TYPE_JSON=2;const BUFFER_MESSAGES_BIN_SZ=4;const BUFFER_MESSAGES_MAX_LENGTH=Math.pow(2,32)-1;class Buffers_array{static is_buffer(buf){if(!(buf instanceof Buffer)||buf.length<3*BUFFER_MESSAGES_BIN_SZ)return false;let prefix=buf.readUInt32BE(0);let msg_type=buf.readUInt32BE(BUFFER_MESSAGES_BIN_SZ);let length=buf.readUInt32BE(BUFFER_MESSAGES_BIN_SZ*2);return prefix===0&&length==buf.length&&msg_type==BUFFER_MESSAGES_CONTENT}static parse(buf){let offset=3*BUFFER_MESSAGES_BIN_SZ,messages=[];while(offset<buf.length){let msg_type=buf.readUInt8(offset);let msg_len=buf.readUInt32BE(offset+1);let msg_value=buf.slice(offset+1+BUFFER_MESSAGES_BIN_SZ,offset+1+BUFFER_MESSAGES_BIN_SZ+msg_len);if(msg_type==BUFFER_MESSAGES_TYPE_STRING||msg_type==BUFFER_MESSAGES_TYPE_JSON){msg_value=msg_value.toString()}messages.push(msg_value);offset=offset+1+BUFFER_MESSAGES_BIN_SZ+msg_len}return messages}constructor(){this.clean()}push(value){let type;if(value instanceof Buffer)type=BUFFER_MESSAGES_TYPE_BIN;else if(typeof value=="string"){type=BUFFER_MESSAGES_TYPE_STRING;value=Buffer.from(value)}else{type=BUFFER_MESSAGES_TYPE_JSON;value=Buffer.from(JSON.stringify(value))}let new_bytes_size=this._bytes_size+1+BUFFER_MESSAGES_BIN_SZ+value.length;if(new_bytes_size>BUFFER_MESSAGES_MAX_LENGTH)throw new Error(`Buffers_array overflow ${new_bytes_size}`);this._bytes_size+=1+BUFFER_MESSAGES_BIN_SZ+value.length;this._buffer.push({type,value})}clean(){this._buffer=[];this._bytes_size=3*BUFFER_MESSAGES_BIN_SZ}get_buffer(){let buf=Buffer.allocUnsafe(this._bytes_size);buf.writeUInt32BE(0,0);buf.writeUInt32BE(BUFFER_MESSAGES_CONTENT,BUFFER_MESSAGES_BIN_SZ);buf.writeUInt32BE(this._bytes_size,BUFFER_MESSAGES_BIN_SZ*2);let offset=3*BUFFER_MESSAGES_BIN_SZ;for(let{type,value}of this._buffer){buf.writeUInt8(type,offset);buf.writeUInt32BE(value.length,offset+1);value.copy(buf,offset=offset+1+BUFFER_MESSAGES_BIN_SZ);offset+=value.length}return buf}}const make_ipc_server_class=ws_opt=>{if(ws_opt.ipc_server&&!ws_opt.ipc_server_class)ws_opt.ipc_server_class=IPC_server_base.build(ws_opt)};const make_ipc_client_class=ws_opt=>{if(ws_opt.ipc_client&&!ws_opt.ipc_client_class)ws_opt.ipc_client_class=IPC_client_base.build(ws_opt)};const counter_cache={};const make_counter=opt=>{const zcounter_glob=opt&&opt.zcounter_glob;const cache_key=zcounter_glob?"glob_counter":"local_counter";if(counter_cache[cache_key])return counter_cache[cache_key];const counter={};["inc","inc_level","avg","max","min","set_level"].forEach((m=>{counter[m]=zcounter_glob?zcounter[`glob_${m}`]:zcounter[m];counter[m]=counter[m].bind(zcounter)}));counter_cache[cache_key]=counter;return counter};class WS extends events.EventEmitter{constructor(opt){super();make_ipc_server_class(opt);make_ipc_client_class(opt);this.ws=undefined;this.data=opt.data;this.connected=false;this.reason=undefined;this.listen_bin_throttle=opt.listen_bin_throttle;this.zc_rx=opt.zcounter=="rx"||opt.zcounter=="all";this.zc_tx=opt.zcounter=="tx"||opt.zcounter=="all";this.zc_tx_per_cmd=this.zc_tx&&opt.zcounter_tx_per_cmd;this.zc_mux=opt.zcounter=="mux"||opt.zcounter=="all";this.msg_log=assign({},{treshold_size:null,print_size:100},opt.msg_log);this.zc=opt.zc_label||(opt.zcounter?opt.label?`${opt.label}_ws`:"ws":undefined);const zjson_opt=assign({},zjson_opt_default,opt.zjson_opt);this.zjson_opt_send=assign({},zjson_opt,opt.zjson_opt_send);this.zjson_opt_receive=assign({},zjson_opt,opt.zjson_opt_receive);this.label=opt.label;this.remote_label=undefined;this.local_addr=undefined;this.local_port=undefined;this.remote_addr=undefined;this.remote_port=undefined;this.remote_forwarded=false;this.status="disconnected";if(this.ping=is_node&&opt.ping!=false){this.ping_interval=typeof opt.ping_interval=="function"?opt.ping_interval():opt.ping_interval||6e4;this.ping_timeout=typeof opt.ping_timeout=="function"?opt.ping_timeout():opt.ping_timeout||1e4;this.ping_timer=undefined;this.ping_expire_timer=undefined;this.ping_last=0}this.pong_received=true;this.refresh_ping_on_msg=opt.refresh_ping_on_msg!==false;this.idle_timeout=opt.idle_timeout;this.idle_timer=undefined;this.ipc=opt.ipc_client_class?new opt.ipc_client_class(this):undefined;if(opt.ipc_server_class)new opt.ipc_server_class(this);this.bin_methods=opt.bin_methods||this.ipc&&this.ipc.bin_methods;this.time_parse=opt.time_parse;this.mux=opt.mux?new Mux(this,opt.backpressuring):undefined;if((this.zc||this.zc_mux)&&!zcounter)zcounter=require("./zcounter.js");if(zcounter)this._counter=make_counter(opt);this._send_throttle_t=undefined;this._buffers=undefined}get_bin_prefix(msg){return this.bin_methods&&msg instanceof Buffer&&msg.readUInt32BE(0)===0?msg.readUInt32BE(4):undefined}_clean_throttle(){if(this._send_throttle_t){clearTimeout(this._send_throttle_t);this._send_throttle_t=undefined}this._buffers=undefined}_send_throttle(msg,throttle_ts){this._buffers=this._buffers||new Buffers_array;this._buffers.push(msg);this._send_throttle_t=this._send_throttle_t||setTimeout((()=>{this._send_throttle_t=undefined;this.ws.send(this._buffers.get_buffer());this._buffers.clean()}),throttle_ts)}send(msg,opt){if(zerr.is.debug()){zerr.debug(typeof msg=="string"?`${this}> str: ${string.trunc(msg,DEBUG_STR_LEN)}`:`${this}> buf: ${msg.length} bytes`)}if(!this.connected){if(zerr.is.info())zerr.info(`${this}: sending failed: disconnected`);return false}if(this.ws.readyState==2){if(zerr.is.info())zerr.info(`${this}: sending failed: socket closing`);return false}this._update_idle();if(opt&&opt.bin_throttle)this._send_throttle(msg,opt.bin_throttle);else this.ws.send(msg,this.uws2?typeof msg!="string":opt);if(this.zc_tx){this._counter.inc(`${this.zc}_tx_msg`);this._counter.inc(`${this.zc}_tx_bytes`,msg.length);this._counter.avg(`${this.zc}_tx_bytes_per_msg`,msg.length)}if(this.zc_tx_per_cmd&&opt&&opt.cmd){this._counter.inc(`${this.zc}.${opt.cmd}_tx_msg`);this._counter.inc(`${this.zc}.${opt.cmd}_tx_bytes`,msg.length);this._counter.avg(`${this.zc}.${opt.cmd}_tx_bytes_per_msg`,msg.length)}return true}bin(data){data.msg=data.msg||Buffer.alloc(0);let cmd=data.cmd;let buf=Buffer.alloc(16+cmd.length+data.msg.length);buf.writeUInt32BE(0,0);buf.writeUInt32BE(BUFFER_IPC_CALL,4);buf.writeUInt32BE(data.cookie,8);buf.writeUInt32BE(cmd.length,12);buf.write(cmd,16);data.msg.copy(buf,16+cmd.length);return this.send(buf,{cmd:data.cmd})}json(data){return this.send(JSON.stringify(data),{cmd:data.cmd})}zjson(data){return this.send(conv.JSON_stringify(data,this.zjson_opt_send),{cmd:data.cmd})}_check_status(){let prev=this.status;this.status=this.ws?this.connected?"connected":"connecting":"disconnected";if(this.status!=prev){this.emit(this.status);this.emit("status",this.status);if(this.status=="disconnected")this._on_disconnected()}}_on_disconnected(){this.emit("destroyed")}_assign(ws){this.ws=ws;this.uws2=this.ws.uws2;this.ws.onopen=this._on_open.bind(this);this.ws.onclose=this._on_close.bind(this);this.ws.onmessage=this._on_message.bind(this);(this.ws.handlers||this.ws).onerror=this._on_error.bind(this);if(is_node){this.ws.on("upgrade",this._on_upgrade.bind(this));this.ws.on("unexpected-response",this._on_unexpected_response.bind(this))}if(this.ping)this.ws.on("pong",this._on_pong.bind(this))}abort(code,reason){this.reason=reason||code;let msg=`${this}: closed locally`;if(this.reason)msg+=` (${this.reason})`;if(!is_node&&!(code==1e3||code>=3e3&&code<5e3))code+=3e3;this._close(true,code,reason);zerr.warn(msg);if(this.zc&&code)this._counter.inc(`${this.zc}_err_${code}`);this._check_status()}_close(close,code,reason){zerr.debug(`${this}: ws._close from ${(new Error).stack}`);if(!this.ws)return;if(this.ping){clearTimeout(this.ping_timer);clearTimeout(this.ping_expire_timer);this.ping_timer=undefined;this.ping_expire_timer=undefined;this.ping_last=0;this.pong_received=true;this.ws.removeAllListeners("pong")}this.ws.onopen=undefined;this.ws.onclose=undefined;this.ws.onmessage=undefined;(this.ws.handlers||this.ws).onerror=noop;if(is_node){this.ws.removeAllListeners("unexpected-response");this.ws.removeAllListeners("upgrade")}this.local_addr=undefined;this.local_port=undefined;this.remote_addr=undefined;this.remote_port=undefined;if(close){if(this.ws.terminate&&(!this.connected||code==-2)){zerr.info(`${this}: ws.terminate`);this.ws.terminate()}else{zerr.info(`${this}: ws.close`);this.ws.close(code,reason)}}this.ws=undefined;this.connected=false;this._clean_throttle()}toString(){let res=this.label?`${this.label} WS`:"WS";if(this.remote_label||this.remote_addr)res+=" (";if(this.remote_label)res+=this.remote_label;if(this.remote_label&&this.remote_addr)res+=" ";if(this.remote_addr)res+=this.remote_addr;if(this.remote_label||this.remote_addr)res+=")";return res}_on_open(){if(this.connected)return;this.connected=true;let sock=this.ws._socket||{};this.local_addr=sock.localAddress;this.local_port=sock.localPort;if(this.remote_addr==sock.remoteAddress)this.remote_forwarded=false;if(!this.remote_forwarded){this.remote_addr=sock.remoteAddress;this.remote_port=sock.remotePort}zerr.notice(`${this}: connected`);if(this.ping){this.pong_received=true;this.ping_timer=setTimeout((()=>this._ping()),this.ping_interval);this.ping_expire_timer=setTimeout((()=>this._ping_expire()),this.ping_timeout)}this._check_status()}_on_close(event){this.reason=event.reason||event.code;zerr.notice(`${this}: closed by remote (${this.reason})`);this._close();this._check_status()}_on_error(event){this.reason=event.message||"Network error";zerr(`${this}: ${this.reason}`);if(this.zc)this._counter.inc(`${this.zc}_err`);this._close();this._check_status()}_on_unexpected_response(req,resp){this._on_error({message:"unexpected response"});this.emit("unexpected-response")}_on_upgrade(resp){zerr.debug(`${this}: upgrade conn`)}_on_message(event){let msg=event.data;if(msg instanceof ArrayBuffer)msg=Buffer.from(Buffer.from(msg));if(!this.listen_bin_throttle||!Buffers_array.is_buffer(msg))return this._on_message_base(msg);for(const data of Buffers_array.parse(msg))this._on_message_base(data)}_on_message_base(msg){if(zerr.is.debug()){zerr.debug(typeof msg=="string"?`${this}< str: ${string.trunc(msg,DEBUG_STR_LEN)}`:`${this}< buf: ${msg.length} bytes`)}if(this.zc_rx){this._counter.inc(`${this.zc}_rx_msg`);this._counter.inc(`${this.zc}_rx_bytes`,msg.length);this._counter.avg(`${this.zc}_rx_bytes_per_msg`,msg.length);this._counter.max(`${this.zc}_rx_bytes_per_msg_max`,msg.length)}try{if(!this._parse_message(msg))this.abort(1003,"Unexpected message");this._update_idle();if(this.refresh_ping_on_msg)this._refresh_ping_timers()}catch(e){ef(e);zerr(`${this}: ${zerr.e2s(e)}`);return this.abort(1011,e.message)}}_parse_message(msg){let handled=false;const bin_event=this._parse_bin_message(msg);if(bin_event){this.emit("json",bin_event);handled=true}if(typeof msg=="string"){let parsed;if(this._events.zjson){const zjson_opt=this.zjson_opt_receive;if(this.zc&&this.time_parse){const t=date.monotonic();parsed=conv.JSON_parse_unsafe(msg,zjson_opt);const d=date.monotonic()-t;this._counter.avg(`${this.zc}_parse_zjson_ms`,d);this._counter.max(`${this.zc}_parse_zjson_max_ms`,d)}else parsed=conv.JSON_parse_unsafe(msg,zjson_opt);this.emit("zjson",parsed);handled=true}if(this._events.json){if(this.zc&&this.time_parse&&!parsed){const t=date.monotonic();parsed=JSON.parse(msg);const d=date.monotonic()-t;this._counter.avg(`${this.zc}_parse_json_ms`,d);this._counter.max(`${this.zc}_parse_json_max_ms`,d)}else parsed=parsed||JSON.parse(msg);this.emit("json",parsed);handled=true}if(this._events.text){this.emit("text",msg);handled=true}if(this.msg_log.treshold_size&&msg.length>=this.msg_log.treshold_size){zerr.warn(`${this}: Message length treshold`+` ${this.msg_log.treshold_size} exceeded:`+` ${msg.substr(0,this.msg_log.print_size)}`)}}else if(this._events.bin){this.emit("bin",msg);handled=true}if(this._events.raw){this.emit("raw",msg);handled=true}return handled}_parse_bin_message(msg){const type=this.get_bin_prefix(msg);if(type==BUFFER_CONTENT){const bin_event_len=msg.readUInt32BE(VFD_SZ);const bin_event=JSON.parse(msg.slice(VFD_BIN_SZ,VFD_BIN_SZ+bin_event_len).toString());bin_event.msg=msg.slice(VFD_BIN_SZ+bin_event_len);return bin_event}if(type==BUFFER_IPC_CALL){const cookie=msg.readUInt32BE(8);const cmd_length=msg.readUInt32BE(12);const cmd=msg.slice(16,16+cmd_length).toString();const res=msg.slice(16+cmd_length);return{type:"ipc_call",cookie,cmd,msg:res,bin:true}}}_on_pong(){this.pong_received=true;let rtt=date.monotonic()-this.ping_last;zerr.debug(`${this}< pong (rtt ${rtt}ms)`);if(this.zc)this._counter.avg(`${this.zc}_ping_ms`,rtt)}_ping(){if(!this.pong_received)return;this.pong_received=false;if(!this.connected||this.ws.readyState==2)return;try{this.ws.ping()}catch(e){return zerr("Ping attempt fail, for"+` ${JSON.stringify(this.inspect())} ${zerr.e2s(e)}`)}this._refresh_ping_timers();this.ping_last=date.monotonic();if(zerr.is.debug())zerr.debug(`${this}> ping (max ${this.ping_timeout}ms)`)}_ping_expire(){if(this.pong_received)return;this.abort(1002,"Ping timeout")}_refresh_ping_timers(){if(!this.ping_timer||!this.ping_expire_timer)return;if(zutil.is_timer_refresh){this.ping_timer.refresh();this.ping_expire_timer.refresh();return}clearTimeout(this.ping_timer);this.ping_timer=setTimeout((()=>this._ping()),this.ping_interval);clearTimeout(this.ping_expire_timer);this.ping_expire_timer=setTimeout((()=>this._ping_expire()),this.ping_timeout)}_idle(){if(this.zc)this._counter.inc(`${this.zc}_idle_timeout`);this.emit("idle_timeout");this.abort(1002,"Idle timeout")}_update_idle(){this.idle_since=Date.now();if(!this.idle_timeout)return;clearTimeout(this.idle_timer);this.idle_timer=setTimeout(this._idle.bind(this),this.idle_timeout)}close(code,reason){if(!this.ws)return;let msg=`${this}: closed locally`;if(reason||code)msg+=` (${reason||code})`;this._close(true,code,reason);zerr.notice(msg);if(this.zc&&code)this._counter.inc(`${this.zc}_err_${code}`);this._check_status()}inspect(){return{class:this.constructor.name,label:this.toString(),status:this.status,reason:this.reason,local_addr:this.local_addr,local_port:this.local_port,remote_addr:this.remote_addr,remote_port:this.remote_port}}}class Client extends WS{constructor(url,opt={}){if(opt.mux)opt.mux=assign({},opt.mux);super(opt);this.status="connecting";this.impl=client_impl(opt);this.url=url;this.servername=opt.servername;this.retry_interval=opt.retry_interval||1e4;this.retry_max=opt.retry_max||this.retry_interval;this.retry_random=opt.retry_random;this.next_retry=this.retry_interval;this.no_retry=opt.no_retry;this.retry_chances=opt.retry_chances;this._retry_count=0;this.lookup=opt.lookup;this.lookup_ip=opt.lookup_ip;this.fallback=opt.fallback&&assign({retry_threshold:1,retry_mod:5},opt.fallback);this.headers=undefined;this.deflate=!!opt.deflate;this.agent=opt.agent;if(opt.e1008_exit_reason){this.e1008_exit_reason=opt.e1008_exit_reason;this.e1008_ts_start=date.monotonic()}this.reason=undefined;this.reconnect_timer=undefined;this.server_no_mask_support=false;this.handshake_timeout=opt.handshake_timeout===undefined?5e4:opt.handshake_timeout;this.handshake_timer=undefined;if(this.zc)this._counter.inc_level(`level_${this.zc}_online`,0,"sum");if(opt.proxy){let _lib=require("https-proxy-agent");this.agent=new _lib(opt.proxy)}if(is_node){this.headers=assign({"User-Agent":opt.user_agent||default_user_agent},opt.headers,{"client-no-mask-support":1})}this._connect()}_on_disconnected(){}send(msg){return super.send(msg,this.server_no_mask_support?{mask:false}:undefined)}_on_message(ev){if(!this.server_no_mask_support&&ev.data===SERVER_NO_MASK_SUPPORT){this.server_no_mask_support=true;return void this.emit(SERVER_NO_MASK_SUPPORT)}return super._on_message(ev)}_assign(ws){super._assign(ws);if(this.zc)this._counter.inc_level(`level_${this.zc}_online`,1,"sum")}_close(close,code,reason){if(this.zc&&this.ws)this._counter.inc_level(`level_${this.zc}_online`,-1,"sum");if(this.handshake_timer)this.handshake_timer=clearTimeout(this.handshake_timer);super._close(close,code,reason)}_connect(){this.reason=undefined;this.reconnect_timer=undefined;this.server_no_mask_support=false;let opt={headers:this.headers};let url=this.url,lookup_ip=this.lookup_ip,fb=this.fallback,v;if(fb&&fb.url&&this._retry_count%fb.retry_mod>fb.retry_threshold){url=fb.url;lookup_ip=fb.lookup_ip}opt.agent=this.agent;opt.perMessageDeflate=this.deflate;opt.servername=this.servername;opt.lookup=this.lookup;if(lookup_ip&&net&&(v=net.isIP(lookup_ip))){opt.lookup=(h,o,cb)=>{cb=cb||o;next_tick((()=>cb(undefined,o&&o.all?[{address:lookup_ip,family:v}]:lookup_ip,v)))}}if(this.zc)this._counter.inc(`${this.zc}_fallback`,url==this.url?0:1);zerr.notice(`${this}: connecting to ${url}`);this._assign(new this.impl(url,undefined,opt));if(this.handshake_timeout){this.handshake_timer=setTimeout((()=>this.abort(1002,"Handshake timeout")),this.handshake_timeout)}this._check_status()}_reconnect(){if(this.no_retry)return false;if(this.retry_chances&&this._retry_count>=this.retry_chances-1){this.close();this.emit("out_of_retries");return false}this.emit("reconnecting");let delay=this.next_retry;if(typeof delay=="function")delay=delay();else{let coeff=this.retry_random?1+Math.random():2;this.next_retry=Math.min(Math.round(delay*coeff),typeof this.retry_max=="function"?this.retry_max():this.retry_max)}if(zerr.is.info())zerr.info(`${this}: will retry in ${delay}ms`);this._retry_count++;this.reconnect_timer=setTimeout((()=>this._connect()),delay)}_on_open(){if(this.handshake_timer)this.handshake_timer=clearTimeout(this.handshake_timer);this.next_retry=this.retry_interval;this._retry_count=0;super._on_open()}_handle_e1008(event){if(!this.e1008_exit_reason)return;if(event.code!=1008||this.e1008_exit_reason!=event.reason)return;if(!this.no_retry&&date.monotonic()-this.e1008_ts_start<6e4)return;zerr.zexit(`Got '${event.reason}' from ${event.target.url}`)}_on_close(event){this._handle_e1008(event);this._reconnect();super._on_close(event)}_on_error(event){this._reconnect();super._on_error(event)}abort(code,reason){this._reconnect();super.abort(code,reason)}close(code,reason){if(this.ws)this.emit("destroyed");super.close(code,reason);if(this.reconnect_timer){clearTimeout(this.reconnect_timer);this.reconnect_timer=undefined;this.emit("destroyed")}}inspect(){return assign(super.inspect(),{url:this.url,lookup_ip:this.lookup_ip,retry_interval:this.retry_interval,retry_max:this.retry_max,next_retry:this.next_retry,handshake_timeout:this.handshake_timeout,deflate:this.deflate,reconnecting:!!this.reconnect_timer,fallback:this.fallback})}}class Server extends events.EventEmitter{constructor(opt={},handler=undefined){super();if(opt.mux)opt.mux=assign({},{dec_vfd:true},opt.mux);make_ipc_server_class(opt);make_ipc_client_class(opt);this.handler=handler;let ws_opt={server:opt.http_server,host:opt.host||"0.0.0.0",port:opt.port,noServer:!opt.http_server&&!opt.port,path:opt.path,clientTracking:false,perMessageDeflate:!!opt.deflate};if(opt.max_payload)ws_opt.maxPayload=opt.max_payload;if(opt.verify)ws_opt.verifyClient=opt.verify;const impl=server_impl(opt);this.ws_server=new impl.Server(ws_opt);this.server_no_mask_support=impl.server_no_mask_support;this.opt=opt;this.label=opt.label;this.connections=new Set;this.zc=opt.zcounter!=false?opt.label?`${opt.label}_ws`:"ws":undefined;this.ws_server.addListener("connection",this.accept.bind(this));this.ws_server.addListener("error",this._on_error.bind(this));this.ws_server.addListener("listening",this._on_listening.bind(this));if(opt.port)zerr.notice(`${this}: listening on port ${opt.port}`);if(!zcounter)zcounter=require("./zcounter.js");this._counter=make_counter(opt);if(this.zc)this._counter.inc_level(`level_${this.zc}_conn`,0,"sum")}_on_error(...args){this.emit("error",...args)}_on_listening(...args){this.emit("listening",...args)}_check_origin(whitelist,origin){if(typeof whitelist=="function")return whitelist(origin);return whitelist.includes(origin)}toString(){return this.label?`${this.label} WS server`:"WS server"}upgrade(req,socket,head){this.ws_server.handleUpgrade(req,socket,head,(ws=>this.accept(ws,req)))}accept(ws,req=ws.upgradeReq){if(!ws._socket.remoteAddress){ws.onerror=noop;return zerr.warn(`${this}: dead incoming connection`)}let headers=req&&req.headers||{};if(this.opt.origin_whitelist){if(!this._check_origin(this.opt.origin_whitelist,headers.origin)){if(ws._socket.destroy)ws._socket.destroy();else if(ws.terminate)ws.terminate();return zerr.notice("incoming conn from %s rejected",headers.origin||"unknown origin")}zerr.notice("incoming conn from %s",headers.origin)}let zws=new WS(this.opt);if(this.opt.conn_max_event_listeners!==undefined)zws.setMaxListeners(this.opt.conn_max_event_listeners);if(this.opt.trust_forwarded){let forwarded=headers["x-real-ip"];if(!forwarded){forwarded=headers["x-forwarded-for"];if(forwarded){let ips=forwarded.split(",");forwarded=ips[ips.length-1]}}if(forwarded){zws.remote_addr=forwarded;zws.remote_forwarded=true}}let ua=headers["user-agent"];let m=/^Hola (.+)$/.exec(ua);zws.remote_label=m?m[1]:ua?"web":undefined;zws._assign(ws);zws._on_open();if(this.server_no_mask_support&&headers["client-no-mask-support"])zws.send(SERVER_NO_MASK_SUPPORT);this.connections.add(zws);if(this.zc){this._counter.inc(`${this.zc}_conn`);this._counter.inc_level(`level_${this.zc}_conn`,1,"sum")}zws.addListener("disconnected",(()=>{this.connections.delete(zws);if(this.zc)this._counter.inc_level(`level_${this.zc}_conn`,-1,"sum")}));if(this.handler){try{zws.data=this.handler(zws,req)}catch(e){ef(e);zerr(zerr.e2s(e));return zws.close(1011,String(e))}}return zws}broadcast(msg){if(zerr.is.debug()){zerr.debug(typeof msg=="string"?`${this}> broadcast str: ${string.trunc(msg,DEBUG_STR_LEN)}`:`${this}> broadcast buf: ${msg.length} bytes`)}for(let zws of this.connections)zws.send(msg)}broadcast_json(data){if(this.connections.size)this.broadcast(JSON.stringify(data))}broadcast_zjson(data){if(this.connections.size)this.broadcast(conv.JSON_stringify(data,this.zjson_opt_send))}close(code,reason){zerr.notice(`${this}: closed`);this.ws_server.close();for(let zws of this.connections)zws.close(code,reason)}inspect(){let connections=[];for(let c of this.connections)connections.push(c.inspect());return{class:this.constructor.name,label:this.toString(),opt:this.opt,connections}}}class Uws2_impl extends EventEmitter{constructor(ws_opt,handlers={onconnection:noop}){super();this.lib=require("uws2");this.verifyClient=ws_opt.verifyClient;this.handlers=handlers;this.listen_socket=null;const app_opt={};if(ws_opt.ssl_conf){app_opt.key_file_name=ws_opt.ssl_conf.key;app_opt.cert_file_name=ws_opt.ssl_conf.cert}const ws_handler={idleTimeout:Math.min(ws_opt.srv_timeout,960),maxPayloadLength:ws_opt.maxPayloadLength||1024*1024*100,upgrade:(res,req,context)=>{let req_aborted={aborted:false};res.onAborted((()=>{req_aborted.aborted=true}));const _handlers=Object.assign({},this.handlers);const emitter=new EventEmitter;emitter.on("error",((...args)=>_handlers.onerror&&_handlers.onerror(...args)));const headers={origin:req.getHeader("origin")||undefined,"x-real-ip":req.getHeader("x-real-ip"),"x-forwarded-for":req.getHeader("x-forwarded-for"),"user-agent":req.getHeader("user-agent"),"client-no-mask-support":req.getHeader("client-no-mask-support")};if(!this.verify(res,headers))return;const user_data={headers,handlers:_handlers,emitter,uws2:true,_socket:{remoteAddress:Buffer.from(Buffer.from(res.getRemoteAddressAsText())).toString(),localPort:ws_opt.port},on:(event,handler)=>emitter.on(event,handler),emit:(event,msg)=>emitter.emit(event,msg),removeAllListeners:ev=>emitter.removeAllListeners(ev)};res.upgrade(user_data,req.getHeader("sec-websocket-key"),req.getHeader("sec-websocket-protocol"),req.getHeader("sec-websocket-extensions"),context)},open:ws=>this.handlers.onconnection&&this.handlers.onconnection(ws),close:(ws,code,message)=>{message=Buffer.from(message).toString();if(message=="WebSocket timed out from inactivity"){if(this.handlers.ontimeout)this.handlers.ontimeout(ws)}return ws.onclose&&ws.onclose({code,message})},message:(ws,message,is_bin)=>{if(!is_bin)message=Buffer.from(Buffer.from(message));return ws.onmessage&&ws.onmessage({data:is_bin?message:message.toString()})},pong:(ws,message)=>ws.emitter.emit("pong",{ws,message})};const req_handler=(res,req)=>{if(!this.handlers.onreq)return res.end();let req_aborted={aborted:false};res.onAborted((()=>{req_aborted.aborted=true}));this.handlers.onreq(req,res,req_aborted)};this.server=this.lib[ws_opt.ssl_conf?"SSLApp":"App"](app_opt).ws("/",ws_handler).any("/*",req_handler);if(ws_opt.ssl_conf&&ws_opt.ssl_conf.sni){for(let servername in ws_opt.ssl_conf.sni){this.server.addServerName("*."+servername,{key_file_name:ws_opt.ssl_conf.sni[servername]+".key",cert_file_name:ws_opt.ssl_conf.sni[servername]+".crt"}).domain("*."+servername).ws("/",ws_handler).any("/*",req_handler)}}this.server.listen(ws_opt.host||"0.0.0.0",ws_opt.port,(token=>{if(token){this.emit("listening");this.listen_socket=token}}))}on(event,handler){if(event=="listening"&&this.listen_socket)handler();else super.on(event,handler)}close(){if(!this.listen_socket)return;this.lib.us_listen_socket_close(this.listen_socket);this.listen_socket=null;this.emit("close")}verify(res,headers){if(!this.verifyClient)return true;let verify_res,arg={origin:headers.origin,secure:false,req:{headers}};const cb=(v_res,status="403",reason="Unauthorized",_headers={})=>{verify_res=v_res;if(!v_res){res.cork((()=>{res.writeStatus(status);for(let h in _headers)res.writeHeader(h,_headers[h]);res.end(reason)}))}};if(this.verifyClient.length==1){verify_res=this.verifyClient(arg);if(!verify_res)res.end()}else this.verifyClient(arg,cb);return verify_res}}class Server_uws2{constructor(opt={},handler=undefined){if(opt.mux)opt.mux=assign({},{dec_vfd:true},opt.mux);make_ipc_server_class(opt);make_ipc_client_class(opt);this.handler=handler;let ws_opt={host:opt.host,port:opt.port,ssl_conf:opt.ssl_conf,srv_timeout:opt.srv_timeout,on_timeout:opt.on_timeout,req_handler:opt.req_handler};if(opt.max_payload)ws_opt.maxPayloadLength=opt.max_payload;if(opt.verify)ws_opt.verifyClient=opt.verify;this.ws_server=new Uws2_impl(ws_opt,{onconnection:this.accept.bind(this),ontimeout:opt.on_timeout,onreq:opt.req_handler});this.server_no_mask_support=false;this.opt=opt;this.label=opt.label;this.connections=new Set;this.zc=opt.zcounter!=false?opt.label?`${opt.label}_ws`:"ws":undefined;if(opt.port)zerr.notice(`${this}: listening on port ${opt.port}`);if(!zcounter)zcounter=require("./zcounter.js");this._counter=make_counter(opt);if(this.zc)this._counter.inc_level(`level_${this.zc}_conn`,0,"sum")}toString(){return this.label?`${this.label} WS server`:"WS server"}upgrade(req,socket,head){}accept(ws,i){if(!ws._socket.remoteAddress){ws.handlers.onerror=noop;return zerr.warn(`${this}: dead incoming connection`)}let headers=ws.headers||{};if(this.opt.origin_whitelist){if(!this.opt.origin_whitelist.includes(headers.origin)){ws.close();return zerr.notice("incoming conn from %s rejected",headers.origin||"unknown origin")}zerr.notice("incoming conn from %s",headers.origin)}let zws=new WS(this.opt,i);if(this.opt.conn_max_event_listeners!==undefined)zws.setMaxListeners(this.opt.conn_max_event_listeners);if(this.opt.trust_forwarded){let forwarded=headers["x-real-ip"];if(!forwarded){forwarded=headers["x-forwarded-for"];if(forwarded){let ips=forwarded.split(",");forwarded=ips[ips.length-1]}}if(forwarded){zws.remote_addr=forwarded;zws.remote_forwarded=true}}let ua=headers["user-agent"];let m=/^Hola (.+)$/.exec(ua);zws.remote_label=m?m[1]:ua?"web":undefined;zws._assign(ws,true);zws._on_open();if(this.server_no_mask_support&&headers["client-no-mask-support"])zws.send(SERVER_NO_MASK_SUPPORT);this.connections.add(zws);if(this.zc){this._counter.inc(`${this.zc}_conn`);this._counter.inc_level(`level_${this.zc}_conn`,1,"sum")}zws.addListener("disconnected",(()=>{this.connections.delete(zws);if(this.zc)this._counter.inc_level(`level_${this.zc}_conn`,-1,"sum")}));if(this.handler){try{zws.data=this.handler(zws)}catch(e){ef(e);zerr(zerr.e2s(e));return zws.close(1011,String(e))}}return zws}broadcast(msg){if(zerr.is.debug()){zerr.debug(typeof msg=="string"?`${this}> broadcast str: ${string.trunc(msg,DEBUG_STR_LEN)}`:`${this}> broadcast buf: ${msg.length} bytes`)}for(let zws of this.connections)zws.send(msg)}broadcast_json(data){if(this.connections.size)this.broadcast(JSON.stringify(data))}broadcast_zjson(data){if(this.connections.size)this.broadcast(conv.JSON_stringify(data,this.zjson_opt_send))}close(code,reason){zerr.notice(`${this}: closed`);this.ws_server.close();for(let zws of this.connections)zws.close(code,reason)}inspect(){let connections=[];for(let c of this.connections)connections.push(c.inspect());return{class:this.constructor.name,label:this.toString(),opt:this.opt,connections}}}let ipc_clients_cookie=0;const ERROR_CODES={bad_ipc_call_attempt:"bad_ipc_call_attempt"};class IPC_client_base{static build(ws_opt){const ipc_opt={zjson:ws_opt.ipc_zjson,mux:ws_opt.mux,timeout:ws_opt.ipc_timeout};class IPC_client extends IPC_client_base{constructor(zws){super(zws,ipc_opt)}}if(Array.isArray(ws_opt.ipc_client)){for(const name of ws_opt.ipc_client){Object.defineProperty(IPC_client.prototype,name,{value:function(...arg){return this._call(ipc_opt,name,arg)},writable:true})}return IPC_client}for(const[name,spec]of Object.entries(ws_opt.ipc_client)){const opt=assign({},ipc_opt,typeof spec=="string"?{type:spec}:spec);if((opt.bin||opt.send_bin)&&!IPC_client.prototype.bin_methods){Object.defineProperty(IPC_client.prototype,"bin_methods",{value:true})}let fn;switch(opt.type||"call"){case"call":fn=function(...arg){return this._call(opt,name,arg)};break;case"post":fn=function(...arg){return this._post(opt,name,arg)};break;case"mux":fn=function(...arg){return this._mux(opt,name,arg)};break;default:zerr.zexit(`${ws_opt.label} ${name}: Invalid IPC client spec`)}Object.defineProperty(IPC_client.prototype,name,{value:fn,writable:true})}return IPC_client}constructor(zws,opt){this.mux=opt.mux;this._vfd=opt.mux?opt.mux.start_vfd==undefined?2147483647:opt.mux.start_vfd:0;this._ws=zws;this._pending=new Map;this._ws.addListener(json_event(opt.zjson),this._on_resp.bind(this));this._ws.addListener("status",this._on_status.bind(this));this._ws.addListener("destroyed",this._on_status.bind(this,"destroyed"))}pending_count(){return this._pending.size}_call(opt,cmd,arg){const _this=this;const send_retry_timeout=3*SEC;const timeout=opt.timeout!==null?typeof opt.timeout=="function"?opt.timeout():opt.timeout||5*MIN:undefined;return etask((function*IPC_client_call(){let req={type:opt.type=="mux"?"ipc_mux":"ipc_call",cmd,cookie:++ipc_clients_cookie,bin:opt.bin?1:undefined};_this._req_set_arg(req,arg);this.info.label=()=>_this._ws.toString();this.info.cmd=cmd;this.info.cookie=req.cookie;_this._pending.set(req.cookie,this);this.finally((()=>_this._pending.delete(req.cookie)));if(timeout){this.alarm(timeout,(()=>{let e=new Error(`${cmd} timeout`);e.code="ipc_timeout";this.throw(e)}))}let res={status:_this._ws.status},prev;while(res.status){switch(res.status){case"disconnected":if(opt.retry==false||!_this._ws.reconnect_timer)throw _this._err_ipc_call();break;case"connecting":if(opt.retry==false)throw _this._err_ipc_call("Connection not ready");break;case"destroyed":throw _this._err_ipc_call();case"connected":while(!_this._send(opt,req)){if(opt.retry==false)throw _this._err_ipc_call();yield etask.sleep(send_retry_timeout)}break}do{prev=res.status;res=yield this.wait()}while(prev==res.status)}return res.value}))}_post(opt,cmd,arg){let req={type:"ipc_post",cmd};this._req_set_arg(req,arg);this._send(opt,req)}_mux(opt,cmd,arg){if(!this._ws.mux)throw new Error("Mux is not defined");const _this=this;const vfd=this.mux.dec_vfd?--this._vfd:++this._vfd;return etask((function*IPC_client__mux(){let stream=_this._ws.mux.open(vfd,_this.mux.bytes_allowed,_this.mux);stream.close=()=>_this._ws.mux.close(vfd);arg.unshift(vfd);yield _this._call(opt,cmd,arg);return stream}))}_req_set_arg(req,arg){if(arg.length==1)req.msg=arg[0];else if(arg)req.arg=arg}_send(opt,req){if(opt.send_bin)return this._ws.bin(req);if(opt.zjson)return this._ws.zjson(req);return this._ws.json(req)}_err_ipc_call(msg=this._ws.reason||"Connection closed"){let e=new Error(msg);e.code=ERROR_CODES.bad_ipc_call_attempt;return e}_on_resp(msg){if(!msg||msg.type!="ipc_result"&&msg.type!="ipc_error")return;let task=this._pending.get(msg.cookie);if(!task){this._ws.emit("ipc_resp_miss",msg);return void zerr.info(`${this._ws}: `+`unexpected IPC cookie ${msg.cookie}`)}if(msg.type=="ipc_result")return void task.continue({value:msg.msg});let err=new Error(msg.msg);err.code=msg.err_code;err._ws=""+this._ws;task.throw(err)}_on_status(status){for(let task of this._pending.values())task.continue({status})}}class IPC_server_base{static build(ws_opt){const ipc_opt={zjson:ws_opt.ipc_zjson,call_zerr:ws_opt.ipc_call_zerr,mux:ws_opt.mux};const specs=Array.isArray(ws_opt.ipc_server)?ws_opt.ipc_server.reduce(((o,name)=>(o[name]=true,o)),{}):ws_opt.ipc_server;class IPC_server_methods{constructor(zws){this._zws=zws}}Object.setPrototypeOf(IPC_server_methods.prototype,null);for(const name in specs){const value=specs[name]===true?function(arg){return this._zws.data[name].apply(this._zws.data||this._zws,arg)}:function(arg){return specs[name].apply(this._zws.data||this._zws,arg)};Object.defineProperty(IPC_server_methods.prototype,name,{value,writable:true})}return class IPC_server extends IPC_server_base{constructor(zws){super(zws,ipc_opt);this.methods=new IPC_server_methods(zws)}}}constructor(zws,opt){this.ws=zws;this.mux=opt.mux;this.zjson=!!opt.zjson;this.call_zerr=!!opt.call_zerr;this.pending=new Set;zws.addListener(json_event(this.zjson),(v=>this._on_call(v)));zws.addListener("disconnected",this._on_disconnected.bind(this))}_on_call(msg){if(!msg||!msg.cmd)return;if(!msg.type||msg.type=="ipc_call")return void new IPC_server_resp_call(this,msg);if(msg.type=="ipc_post")return void new IPC_server_resp_post(this,msg);if(msg.type=="ipc_mux")return void new IPC_server_resp_mux(this,msg)}_on_disconnected(){for(let task of this.pending)task.return()}}class IPC_server_resp{constructor(ipc,msg){this.ipc=ipc;this.msg=msg;this.arg=msg.arg||[msg.msg];if(!this.is_method_undefined())this.exec_handle()}exec(){return this.ipc.methods[this.msg.cmd](this.arg)}exec_handle(){let et;try{if(!((et=this.exec())instanceof etask))return void this.on_response(et)}catch(e){return this.on_error(e)}const _this=this;return etask((function*IPC_server_handle(){_this.on_handle(this);_this.assign_info(this);try{_this.on_response(yield et)}catch(e){_this.on_error(e)}}))}assign_info(et){et.info.label=()=>this.ipc.ws.toString();et.info.cmd=this.msg.cmd;et.info.cookie=this.msg.cookie}json(res){if(this.ipc.zjson)return void this.ipc.ws.zjson(res);this.ipc.ws.json(res)}add_pending(et){this.ipc.pending.add(et);et.finally((()=>this.ipc.pending.delete(et)))}is_method_undefined(){if(typeof this.ipc.methods[this.msg.cmd]=="function")return false;this.ipc.ws.json({type:"ipc_error",cmd:this.msg.cmd,cookie:this.msg.cookie,msg:`Method ${this.msg.cmd} not defined`});return true}call_response(rv){if(this.msg.bin&&rv instanceof Buffer)return void this.call_response_buf(rv);this.json({type:"ipc_result",cmd:this.msg.cmd,cookie:this.msg.cookie,msg:rv})}call_response_buf(rv){const res_buf=Buffer.from(JSON.stringify({type:"ipc_result",cmd:this.msg.cmd,cookie:this.msg.cookie}));const buf=Buffer.allocUnsafe(rv.length+VFD_BIN_SZ+res_buf.length);buf.writeUInt32BE(0,0);buf.writeUInt32BE(BUFFER_CONTENT,4);buf.writeUInt32BE(res_buf.length,VFD_SZ);res_buf.copy(buf,VFD_BIN_SZ);rv.copy(buf,VFD_BIN_SZ+res_buf.length);this.ipc.ws.send(buf)}on_handle(handle){}on_response(rv){}on_error(e){if(is_node&&+process.env.WS_ZEXIT_ON_TYPEERROR&&zerr.on_exception)zerr.on_exception(e);if(this.ipc.call_zerr)zerr(`${this.ipc.ws}: ${this.msg.cmd}: ${zerr.e2s(e)}`);this.ipc.ws.json({type:"ipc_error",cmd:this.msg.cmd,cookie:this.msg.cookie,msg:e.message||String(e),err_code:e.code})}mux_open(){if(!this.ipc.ws.mux){return this.ipc.ws.json({type:"ipc_error",cmd:this.msg.cmd,cookie:this.msg.cookie,msg:"Mux is not defined"})}const vfd=this.arg[0];const stream=this.ipc.ws.mux.open(vfd,this.ipc.mux.bytes_allowed,this.ipc.mux);stream.close=()=>this.ipc.ws.mux.close(vfd);this.arg[0]=stream;this.json({type:"ipc_result",cmd:this.msg.cmd,cookie:this.msg.cookie})}}class IPC_server_resp_call extends IPC_server_resp{on_response(rv){return this.call_response(rv)}}class IPC_server_resp_post extends IPC_server_resp{is_method_undefined(){if(typeof this.ipc.methods[this.msg.cmd]=="function")return false;zerr(`${this.ipc.ws}: Method ${this.msg.cmd} not defined`);return true}on_handle(handle){this.add_pending(handle)}on_error(e){zerr(`${this.ipc.ws}: ${this.msg.cmd}: ${zerr.e2s(e)}`)}}class IPC_server_resp_mux extends IPC_server_resp{exec_handle(...args){this.mux_open();super.exec_handle(...args)}on_handle(handle){this.add_pending(handle)}}class Mux{constructor(zws,backpressuring=false){this.ws=zws;this.backpressuring=backpressuring;this.streams=new Map;this.ws.on("bin",this._on_bin.bind(this));this.ws.on("json",this._on_json.bind(this));this.ws.on("disconnected",this._on_disconnected.bind(this))}open(vfd,bytes_allowed=Infinity,opt={}){this.ignore_unexpected_acks=opt.ignore_unexpected_acks;return this.streams.get(vfd)||(opt.use_ack?this.open_ack(vfd,opt):this.open_bp(vfd,bytes_allowed,opt))}open_bp(vfd,bytes_allowed,opt={}){const _lib=require("stream");let _this=this,suspended;const stream=new _lib.Duplex(assign({read(size){},write(data,encoding,cb){if(bytes_allowed<=0){suspended=()=>this._write(data,encoding,cb);return}if(zerr.is.debug())zerr.debug(`${_this.ws}> vfd ${vfd}`);bytes_allowed-=data.length;let buf=Buffer.allocUnsafe(data.length+VFD_SZ);buf.writeUInt32BE(vfd,0);buf.writeUInt32BE(0,4);data.copy(buf,VFD_SZ);cb(_this.ws.send(buf)?undefined:new Error(_this.ws.reason||_this.ws.status));this.last_use_ts=date.monotonic()},destroy(err,cb){stream.prependListener("error",(()=>{if(stream._writableState)stream._writableState.errorEmitted=true}));try{stream.push(null)}catch(e){zerr.notice("DEBUG RECURSIVE DESTROY "+e)}stream.end();this.emit("_close");next_tick(cb,err)}},opt));let _stacktrace=(new Error).stack;stream.create_ts=date.monotonic();stream.prependListener("data",(function(chunk){if(_this.backpressuring&&this.readableLength<=this.readableHighWaterMark>>1){_this.remote_write_resume(vfd)}this.last_use_ts=date.monotonic();if(!this._httpMessage||this.parser&&this.parser.socket===this)return;const{parsers}=require("_http_common");if(this.ws.zc)this.ws._counter.inc(`mux_no_parser`);zerr("\n--- assert failed, socketinfo:\n"+`DEBUG HEADER: ${this._httpMessage._header}\n`+`DEBUG mux.open(): ${_stacktrace}\n`+`DEBUG WS: ${_this.ws.remote_addr}:${_this.ws.remote_port}`);const old_parser=this.parser;const parser=this.parser=parsers.alloc();const old_execute=parser.execute;parser.socket=this;parser.execute=buf=>{parser.execute=old_execute;this.parser=old_parser;return Object.assign(new Error("Mux Duplex parser removed "+"before data consumed"),{code:"ws_mutex.parsed_removed"})}}));stream.allow=(bytes=Infinity)=>{bytes_allowed=bytes;if(bytes_allowed<=0||!suspended)return;suspended();suspended=undefined;if(_this.ws.zc){_this.ws._counter.inc("mux_write_"+(bytes>0?"allow":"disallow"))}};stream.setNoDelay=()=>{};stream.on("_close",(()=>{if(this.streams.delete(vfd)){zerr.info(`${this.ws}: vfd ${vfd} closed`);let zc=this.ws.zc;if(zc){this.ws._counter.inc_level(`level_${zc}_mux_vfd`,-1,"sum")}}}));this.streams.set(vfd,stream);zerr.info(`${this.ws}: vfd ${vfd} open`);if(this.ws.zc){this.ws._counter.inc_level(`level_${this.ws.zc}_mux_vfd`,1,"sum")}return stream}open_ack(vfd,opt={}){const _lib=require("stream");const _this=this;const bin_throttle_opt=opt&&opt.bin_throttle?{bin_throttle:opt.bin_throttle}:null;opt.fin_timeout=opt.fin_timeout||10*SEC;const zasync=opt.zasync&&is_node||false;const w_log=(e,str)=>zerr.warn(`${_this.ws}: ${str}: ${vfd}-${zerr.e2s(e)}`);let pending,zfin_pending,send_ack_timeout,send_ack_ts=0;const stream=new _lib.Duplex(assign({read(size){},write(data,encoding,cb){const{buf,buf_pending}=stream.process_data(data);if(buf){if(!_this.ws.send(buf,bin_throttle_opt))return cb(new Error(_this.ws.reason||_this.ws.status));stream.sent+=buf.length-VFD_SZ;stream.last_use_ts=date.monotonic()}if(zerr.is.debug()){zerr.debug(`${_this.ws}> vfd ${vfd} sent ${stream.sent} `+`ack ${stream.ack} win_size ${stream.win_size}`)}if(!buf_pending||!buf_pending.length)return void(zasync?setImmediate(cb):cb());pending=etask((function*_mux_stream_pending(){yield this.wait();pending=null;stream._write(buf_pending,encoding,cb)}));pending.buf_size=buf_pending.length},writev:opt.decodeStrings===false?null:function(chunks,cb){stream._write(Buffer.concat(chunks.map((item=>item.chunk))),null,cb)},destroy(err,cb){return etask((function*_mux_stream_destroy(){if(stream.zdestroy){yield this.wait_ext(stream.zdestroy);return next_tick(cb,err)}stream.zdestroy=this;if(stream._unused_tm)clearTimeout(stream._unused_tm);stream.prependListener("error",(()=>{if(stream._writableState)stream._writableState.errorEmitted=true}));if(zfin_pending)zfin_pending.continue();yield zfinish(false,err);if(!err)try{stream.push(null)}catch(e){}next_tick((()=>{cb(err);stream.emit("_close")}))}))}},opt));stream.allow=size=>{if(stream.win_size_got)return;stream.win_size=size||Infinity;if(!size&&_this.ws.zc)_this.wc._counter.inc("mux_legacy_allow_call")};stream.process_data=data=>{let bytes=Math.min(stream.win_size-(stream.sent-stream.ack),data.length);if(bytes<=0)return{buf_pending:data};const buf=Buffer.allocUnsafe(bytes+VFD_SZ);buf.writeUInt32BE(vfd,0);buf.writeUInt32BE(0,4);data.copy(buf,VFD_SZ,0,bytes);if(bytes==data.length)return{buf};const buf_pending=Buffer.allocUnsafe(data.length-bytes);data.copy(buf_pending,0,bytes);return{buf,buf_pending}};const zfinish=(wait_rmt,err)=>etask((function*_zfinish(){if(stream.zfin)return yield this.wait_ext(stream.zfin);stream.zfin=this;zerr.info(`${_this.ws}:vfd:${vfd}:zfin:${wait_rmt}`);if(pending){stream.win_size+=pending.buf_size;pending.continue(null,true)}if(!stream.destroyed&&stream._writableState&&!stream._writableState.finished){stream.once("finish",this.continue_fn());try{yield this.wait(opt.fin_timeout/2)}catch(e){if(!stream.destroyed){w_log(e,"fin_wait");stream.end();try{yield this.wait(opt.fin_timeout/2)}catch(_e){w_log(_e,"fin_wait2")}}}}if(pending&&!etask.is_final(pending)){try{pending.return();pending=null}catch(e){w_log(e,"destroy write pending")}stream.emit("error",new Error("Fail to write pending data"))}stream.send_fin(opt.emit_socket_error?err:undefined);if(wait_rmt&&!stream.fin_got){try{yield zfin_pending=this.wait(2*opt.fin_timeout)}catch(e){w_log(e,"zfin_pending")}}if(stream.destroy)stream.destroy()}));stream.create_ts=date.monotonic();stream.win_size=DEFAULT_WIN_SIZE;stream.sent=stream.ack=stream.zread=0;stream.fin_got=false;stream.prependListener("finish",(()=>zfinish(true)));stream.prependListener("data",(function(chunk){this.zread+=chunk.length;this.send_ack();this.last_use_ts=date.monotonic();if(!this._httpMessage||this.parser&&this.parser.socket===this)return;const{parsers}=require("_http_common");const _stacktrace=(new Error).stack;if(this.ws.zc)this.ws._counter.inc(`mux_ack_no_parser`);zerr("\n--- assert failed, socketinfo:\n"+`DEBUG HEADER: ${this._httpMessage._header}\n`+`DEBUG mux.open(): ${_stacktrace}\n`+`DEBUG WS: ${_this.ws.remote_addr}:${_this.ws.remote_port}`);const old_parser=this.parser;const parser=this.parser=parsers.alloc();const old_execute=parser.execute;parser.socket=this;parser.execute=buf=>{parser.execute=old_execute;this.parser=old_parser;return new Error("Mux Duplex parser removed before data "+"consumed")}}));const throttle_ack=+opt.throttle_ack;const _send_ack=()=>{_this.ws.send(`{"vfd":${vfd},"ack":${stream.zread}}`,bin_throttle_opt);send_ack_ts=date.monotonic()};stream.send_ack=!throttle_ack?_send_ack:()=>{if(send_ack_timeout)return;if(!send_ack_ts&&opt.delayed_ack)send_ack_ts=date.monotonic();const delta=date.monotonic()-send_ack_ts;if(delta>=throttle_ack)return _send_ack();send_ack_timeout=setTimeout((()=>{send_ack_timeout=null;_send_ack()}),throttle_ack-delta)};stream.on_ack=ack=>{stream.ack=ack;if(pending)pending.continue(null,true);if(_this.ws.zc_mux)this.ws._counter.inc(`${_this.ws.zc||"unknown"}_mux_on_ack`)};stream.send_win_size=()=>{if(stream.win_size_sent)return;_this.ws.send(`{"vfd":${vfd},"win_size":${opt.win_size||DEFAULT_WIN_SIZE}}`,bin_throttle_opt);stream.win_size_sent=true};stream.on_win_size=size=>{stream.win_size=size;stream.win_size_got=true;if(pending)pending.continue(null,true)};stream.send_fin=error=>{if(send_ack_timeout){clearTimeout(send_ack_timeout);_send_ack()}if(bin_throttle_opt){_this.ws.send(error?{vfd,fin:1,error}:`{"vfd":${vfd},"fin":1}`,bin_throttle_opt)}else if(error)_this.ws.json({vfd,fin:1,error});else _this.ws.send(`{"vfd":${vfd},"fin":1}`);stream.fin_sent=true};stream.on_fin=msg=>{stream.fin_got=true;if(_this.ws.zc_mux)this.ws._counter.inc(`${_this.ws.zc||"unknown"}_mux_on_fin`);const fn=()=>next_tick((()=>zfin_pending?zfin_pending.continue():zfinish(false)));etask((function*_mux_stream_on_fin(){stream.once("end",this.continue_fn());try{if(opt.emit_socket_error&&msg&&msg.error)stream.emit("error",msg.error);else stream.push(null);const state=stream._readableState;if(!stream.readableLength||state&&state.endEmitted)return fn();yield this.wait(opt.fin_timeout)}catch(e){w_log(e,"ending")}fn()}))};stream.set_timeout=timeout=>{clearTimeout(stream._unused_tm);if(!timeout||stream.zdestroy)return;stream._unused_tm_fn=()=>{const delta=date.monotonic()-(stream.last_use_ts||0);if(delta>=timeout)return stream.emit("timeout");stream._unused_tm=setTimeout(stream._unused_tm_fn,timeout-delta)};stream._unused_tm=setTimeout(stream._unused_tm_fn,timeout)};stream.setNoDelay=()=>{};stream.on("_close",(()=>{if(!this.streams.delete(vfd))return;zerr.info(`${this.ws}: vfd ${vfd} closed`);let zc=this.ws.zc;if(zc)this.ws._counter.inc_level(`level_${zc}_mux`,-1,"sum")}));this.streams.set(vfd,stream);zerr.info(`${this.ws}: vfd ${vfd} open`);if(this.ws.zc)this.ws._counter.inc_level(`level_${this.ws.zc}_mux`,1,"sum");if(opt.compress||opt.decompress){if(!SnappyStream||!UnsnappyStream)({SnappyStream,UnsnappyStream}=require("snappystream"));const snappy_s=opt.compress?new SnappyStream:new UnsnappyStream;const ensure_snappy_destroyed=()=>{if(snappy_s.destroyed)return;setTimeout((()=>snappy_s.destroy()),30*SEC)};stream.pipe(snappy_s).pipe(stream);snappy_s.once("close",(()=>this.ws.mux.close(vfd)));stream.once("close",ensure_snappy_destroyed);return snappy_s}return stream}close(vfd){let stream=this.streams.get(vfd);if(!stream)return false;if(stream.destroy)stream.destroy();else{stream.push(null);stream.end();stream.emit("_close")}return true}remote_write_pause(id){const stream=this.streams.get(id);if(!stream||stream.remote_write_paused)return;this.ws.json({stream_id:id,backpressure_cmd:"write_pause",log:this.backpressuring.log});stream.remote_write_paused=true;if(this.ws.zc)this.ws._counter.inc("mux_remote_write_pause")}remote_write_resume(id){const stream=this.streams.get(id);if(!stream||!stream.remote_write_paused)return;this.ws.json({stream_id:id,backpressure_cmd:"write_resume",log:this.backpressuring.log});stream.remote_write_paused=false;if(this.ws.zc)this.ws._counter.inc("mux_remote_write_resume")}_on_bin(buf){if(this.ws.get_bin_prefix(buf)==BUFFER_CONTENT)return;if(this.listen_bin_throttle&&Buffers_array.is_buffer(buf))return zerr(`${this.ws}: unexpected Buffers_array on bin event`);if(buf.length<VFD_SZ)return zerr(`${this.ws}: malformed binary message`);let vfd=buf.readUInt32BE(0);if(zerr.is.debug())zerr.debug(`${this.ws}< vfd ${vfd}`);let stream=this.streams.get(vfd);if(!stream)return zerr(`${this.ws}: unexpected stream vfd ${vfd}`);if(!stream.on_ack)return this._on_bin_bp(stream,buf,vfd);try{stream.send_win_size();stream.push(buf.slice(VFD_SZ))}catch(e){zerr(`${this.ws}: ${zerr.e2s(e)}`);throw e}}_on_bin_bp(stream,buf,vfd){if(!stream.push(buf.slice(VFD_SZ))&&this.backpressuring)this.remote_write_pause(vfd)}_on_json(msg){if(msg&&msg.backpressure_cmd)this._on_json_bp(msg);else this._on_json_ack(msg)}_on_json_bp(msg){const stream=this.streams.get(msg.stream_id);if(!stream||!msg.backpressure_cmd)return;if(msg.log)zerr.notice(`${this.ws}: ${msg.backpressure_cmd}`);switch(msg.backpressure_cmd){case"write_pause":return stream.allow(0);case"write_resume":return stream.allow()}}_on_json_ack(msg){if(!msg||msg.vfd===undefined)return;const stream=this.streams.get(msg.vfd);if(!stream)return zerr.info(`${this.ws}: unexpected stream ID %O`,msg);if(msg.ack&&stream.on_ack)return void stream.on_ack(msg.ack);if(msg.win_size&&stream.on_win_size)return void stream.on_win_size(msg.win_size);if(msg.fin&&stream.on_fin)return void stream.on_fin(msg);stream.emit("unexpected_ack",msg);zerr(`${this.ws}: unexpected json_ack %O`,msg);if(this.ws.zc)this.ws._counter.inc("mux_unexpected_ack")}_on_disconnected(){let err=new Error(this.ws.reason||"disconnected");for(let stream of this.streams.values()){if(stream.destroy)stream.destroy(err);else{stream.emit("error",err);stream.emit("_close")}}this.streams.clear()}}function lib(impl){if(impl=="ws"){if(process.zon||process.env.ZNODE_DEP_SCAN)return require("ws_embed");return require("ws")}if((impl=="uws"||impl=="uws2")&&!is_win&&!is_darwin)return require("uws");zerr.zexit(`WS library ${impl} is not available`)}function client_impl(opt){if(!is_node&&!opt.impl)return self.WebSocket;return lib(opt.impl||"ws")}function server_impl(opt){if(!is_node)throw new Error(`WS server is not available`);const impl=opt.impl||(is_win||is_darwin?"ws":"uws");const l=lib(impl);l.server_no_mask_support=false;return l}return{Client,Server,Server_uws2,Mux,lib,t:{WS,IPC_server_base},ERROR_CODES}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},4118:module=>{"use strict";module.exports=JSON.parse('{"BUILDTYPE_DEBUG":false,"ZON_VERSION":"1.230.678","_RELEASE":true,"_RELEASE_LEVEL":2}')}};var __webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(cachedModule!==undefined){return cachedModule.exports}var module=__webpack_module_cache__[moduleId]={exports:{}};__webpack_modules__[moduleId].call(module.exports,module,module.exports,__webpack_require__);return module.exports}__webpack_require__.m=__webpack_modules__;__webpack_require__.x=()=>{var __webpack_exports__=__webpack_require__.O(undefined,[64,216,824],(()=>__webpack_require__(1349)));__webpack_exports__=__webpack_require__.O(__webpack_exports__);return __webpack_exports__};(()=>{var deferred=[];__webpack_require__.O=(result,chunkIds,fn,priority)=>{if(chunkIds){priority=priority||0;for(var i=deferred.length;i>0&&deferred[i-1][2]>priority;i--)deferred[i]=deferred[i-1];deferred[i]=[chunkIds,fn,priority];return}var notFulfilled=Infinity;for(var i=0;i<deferred.length;i++){var[chunkIds,fn,priority]=deferred[i];var fulfilled=true;for(var j=0;j<chunkIds.length;j++){if((priority&1===0||notFulfilled>=priority)&&Object.keys(__webpack_require__.O).every((key=>__webpack_require__.O[key](chunkIds[j])))){chunkIds.splice(j--,1)}else{fulfilled=false;if(priority<notFulfilled)notFulfilled=priority}}if(fulfilled){deferred.splice(i--,1);var r=fn();if(r!==undefined)result=r}}return result}})();(()=>{__webpack_require__.n=module=>{var getter=module&&module.__esModule?()=>module["default"]:()=>module;__webpack_require__.d(getter,{a:getter});return getter}})();(()=>{__webpack_require__.d=(exports,definition)=>{for(var key in definition){if(__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)){Object.defineProperty(exports,key,{enumerable:true,get:definition[key]})}}}})();(()=>{__webpack_require__.f={};__webpack_require__.e=chunkId=>Promise.all(Object.keys(__webpack_require__.f).reduce(((promises,key)=>{__webpack_require__.f[key](chunkId,promises);return promises}),[]))})();(()=>{__webpack_require__.u=chunkId=>"bg."+({64:"conf",216:"vendors"}[chunkId]||chunkId)+".bundle.js"})();(()=>{__webpack_require__.g=function(){if(typeof globalThis==="object")return globalThis;try{return this||new Function("return this")()}catch(e){if(typeof window==="object")return window}}()})();(()=>{__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop)})();(()=>{__webpack_require__.r=exports=>{if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})}})();(()=>{var scriptUrl;if(__webpack_require__.g.importScripts)scriptUrl=__webpack_require__.g.location+"";var document=__webpack_require__.g.document;if(!scriptUrl&&document){if(document.currentScript)scriptUrl=document.currentScript.src;if(!scriptUrl){var scripts=document.getElementsByTagName("script");if(scripts.length){var i=scripts.length-1;while(i>-1&&!scriptUrl)scriptUrl=scripts[i--].src}}}if(!scriptUrl)throw new Error("Automatic publicPath is not supported in this browser");scriptUrl=scriptUrl.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/");__webpack_require__.p=scriptUrl})();(()=>{__webpack_require__.b=self.location+"";var installedChunks={372:1};var installChunk=data=>{var[chunkIds,moreModules,runtime]=data;for(var moduleId in moreModules){if(__webpack_require__.o(moreModules,moduleId)){__webpack_require__.m[moduleId]=moreModules[moduleId]}}if(runtime)runtime(__webpack_require__);while(chunkIds.length)installedChunks[chunkIds.pop()]=1;parentChunkLoadingFunction(data)};__webpack_require__.f.i=(chunkId,promises)=>{if(!installedChunks[chunkId]){if(true){importScripts(__webpack_require__.p+__webpack_require__.u(chunkId))}}};var chunkLoadingGlobal=self["webpackChunk"]=self["webpackChunk"]||[];var parentChunkLoadingFunction=chunkLoadingGlobal.push.bind(chunkLoadingGlobal);chunkLoadingGlobal.push=installChunk})();(()=>{var next=__webpack_require__.x;__webpack_require__.x=()=>Promise.all([64,216,824].map(__webpack_require__.e,__webpack_require__)).then(next)})();var __webpack_exports__=__webpack_require__.x()})();
//# sourceMappingURL=https://hola.org/be_source_map/1.230.678/bg.bg.bundle.js.map?build=nopeer_v3